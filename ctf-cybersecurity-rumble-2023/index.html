<!DOCTYPE html><html lang="ja"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.e71379dda153709d1a9a.css" id="gatsby-global-css">html{font-size:100}body{margin:0 0 0 calc(100vw - 100%);color:#222;line-height:1.4;font-size:.875rem;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;background-color:#fcfcfc}body,h1,h2,h3,h4,h5,h6{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif}h1,h2,h3,h4,h5,h6{font-weight:600}h1{font-size:1.575rem;line-height:2.25rem;margin-top:5rem;margin-bottom:1.25rem}h2{font-size:1.47656rem;line-height:1.875rem}h2,h3{margin-top:2.5rem;margin-bottom:.625rem}h3{font-size:1.20313rem;line-height:1.25rem}h4{font-size:1.05rem;margin-top:1.875rem}h4,h5{line-height:1.25rem;margin-bottom:.625rem}h5,h6{font-size:.875rem;margin-top:3.125rem}h6{line-height:1.25rem;margin-bottom:.625rem}img{max-width:100%;margin:inherit auto}hr,img{border:0;display:block}hr{color:#222;height:1.625rem;margin:3.25rem auto;background-size:100% 26px;background-image:linear-gradient(180deg,transparent 1px,transparent 11px,#222 0,#222 15px,transparent 0,transparent 26px);width:6.25rem}a{color:#918d40;text-decoration:none}a:active,a:focus,a:hover{color:#a9d159}b,strong{font-weight:600}ul{list-style:square;margin-bottom:1.25rem}ul li{padding:0 .3125rem;margin-bottom:.625rem}p{line-height:1.25rem;margin-bottom:1.25rem}blockquote{font-style:italic;text-align:center;background-color:#f5f5f5;padding:.1875rem .625rem}figure{display:block;width:100%;height:auto}figcaption{line-height:.9375rem;margin-top:.3125rem;color:#222;font-size:.75rem;font-style:italic;margin-bottom:0;text-align:center}.anchor{margin-left:-1.875rem!important;padding-right:.875rem!important}@media screen and (min-width:685px){figure.float-left,figure.float-right{max-width:19.375rem;padding:0 1.25rem}.float-right{float:right}.float-left{float:left}}code[class*=language-],pre[class*=language-]{color:#ccc;background:0 0;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}li>code[class*=language-text],p>code[class*=language-text]{background:#f9f9f9!important;color:#2d2d2d!important}.Author-module--author__photo--36xCH{display:inline-block;margin-bottom:0;border-radius:50%;background-clip:padding-box}.Author-module--author__title--2CaTb{font-size:.98438rem;font-weight:600;line-height:1.40625rem;margin:.625rem 0}.Author-module--author__title-link--Yrism,.Author-module--author__title-link--Yrism:focus,.Author-module--author__title-link--Yrism:hover{color:#222}.Author-module--author__subtitle--cAaEB{color:#888;line-height:1.25rem;margin-bottom:1.25rem}.Icon-module--icon--Gpyvw{display:inline-block;width:1em;height:1em;stroke-width:0;stroke:currentColor;fill:currentColor;font-style:normal;font-weight:400;speak:none;margin-right:.2em;text-align:center;font-variant:normal;text-transform:none;line-height:1em;margin-left:.2em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.Contacts-module--contacts--1rGd1{margin-bottom:1.25rem}.Contacts-module--contacts__list--3OgdW{display:flex;flex-flow:row wrap;flex-grow:0;flex-shrink:0;list-style:none;padding:0;margin:.625rem -.1875rem;width:8.75rem}.Contacts-module--contacts__list-item--16p9q{padding:0;margin:.25rem;display:flex;align-content:center;align-items:center;justify-content:center;height:2.1875rem;width:2.1875rem;line-height:2.1875rem;border-radius:50%;text-align:center;border:1px solid #ebebeb}.Contacts-module--contacts__list-item-link--2MIDn{border:0;display:flex;color:#222}.Contacts-module--contacts__list-item-link--2MIDn:focus,.Contacts-module--contacts__list-item-link--2MIDn:hover{color:#918d40}.Copyright-module--copyright--1ariN{color:#b6b6b6;font-size:.75rem}.Menu-module--menu--Efbin{margin-bottom:1.25rem}.Menu-module--menu__list--31Zeo{list-style:none;padding:0;margin:0}.Menu-module--menu__list-item--1lJ6B{padding:0;margin:.625rem 0}.Menu-module--menu__list-item-link--10Ush{font-size:.875rem;color:#222;font-weight:400;border:0}.Menu-module--menu__list-item-link--10Ush:focus,.Menu-module--menu__list-item-link--10Ush:hover{color:#918d40;border-bottom:1px solid #918d40}.Menu-module--menu__list-item-link--active--2CbUO{color:#222;border-bottom:1px solid #222}.Sidebar-module--sidebar--X4z2p{width:100%}.Sidebar-module--sidebar__inner--Jdc5s{position:relative;padding:1.5625rem 1.25rem 0}.Sidebar-module--headerimage--19Rdy{width:100%;min-height:70px;max-height:120px;margin:0 0 .625rem}.Sidebar-module--logo-image--XDYae{min-height:70px;max-height:120px;margin:0 auto}input{-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:.625rem;margin:.3125rem 0;border:1px solid #999;border-radius:.3125rem}.Sidebar-module--search-container--17C6F{position:relative}.Sidebar-module--search-container-input--27Tw4{width:100%}.Sidebar-module--search-container-submit--WwtLg{position:absolute;width:2.375rem;height:2.375rem;top:calc(50% - 19px);right:0;border:3px solid #999;border-radius:0 .25rem .25rem 0;background:#999}.Sidebar-module--search-container-submit--WwtLg:before{position:absolute;content:"";width:.9375rem;height:.9375rem;top:calc(50% - 9px);left:calc(50% - 9px);border-radius:50%;box-shadow:0 0 0 2px #fff}.Sidebar-module--search-container-submit--WwtLg:after{position:absolute;content:"";width:.5rem;height:.375rem;top:calc(50% + 6px);left:calc(50% + 2px);border-top:2px solid #fff;transform:rotate(45deg)}@media screen and (min-width:685px){.Sidebar-module--sidebar--X4z2p{width:calc(41.625% - 1.09375rem)}.Sidebar-module--sidebar--X4z2p:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--X4z2p:last-child{margin-right:0}.Sidebar-module--sidebar--X4z2p:nth-child(12n){margin-right:0;float:right}.Sidebar-module--sidebar--X4z2p:nth-child(12n+1){clear:both}.Sidebar-module--sidebar__inner--Jdc5s{padding:1.875rem 1.25rem 0}.Sidebar-module--sidebar__inner--Jdc5s:after{background:#e6e6e6;background:linear-gradient(180deg,#e6e6e6 0,#e6e6e6 48%,#fff);position:absolute;content:"";width:.0625rem;height:33.75rem;top:30px;right:-10px;bottom:0}}@media screen and (min-width:960px){.Sidebar-module--sidebar--X4z2p{width:calc(33.3% - 1.25rem)}.Sidebar-module--sidebar--X4z2p:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--X4z2p:last-child{margin-right:0}.Sidebar-module--sidebar--X4z2p:nth-child(3n){margin-right:0;float:right}.Sidebar-module--sidebar--X4z2p:nth-child(3n+1){clear:both}.Sidebar-module--sidebar__inner--Jdc5s{padding:2.5rem}}.Layout-module--layout--3Pyz6{max-width:66.875rem;margin-left:auto;margin-right:auto}.Layout-module--layout--3Pyz6:before{content:"";display:table}.Layout-module--layout--3Pyz6:after{content:"";display:table;clear:both}.Feed-module--feed__item--2D5rE{margin-bottom:1.5625rem}.Feed-module--feed__item--2D5rE:last-child{margin-bottom:.625rem}.Feed-module--feed__item-title--3nigr{font-size:1.47656rem;line-height:1.875rem;margin-top:0;margin-bottom:.625rem}.Feed-module--feed__item-title-link--iFMRs{color:#222}.Feed-module--feed__item-title-link--iFMRs:focus,.Feed-module--feed__item-title-link--iFMRs:hover{color:#222;border-bottom:1px solid #222}.Feed-module--feed__item-description--1uO8e{font-size:.875rem;line-height:1.25rem;margin-bottom:.9375rem}.Feed-module--feed__item-meta-time--3t1fg{font-size:.75rem;color:#222;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-divider--N-Q0A{margin:0 .3125rem}.Feed-module--feed__item-meta-category-link--23f8F{font-size:.75rem;color:#a9d159;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-category-link--23f8F:focus,.Feed-module--feed__item-meta-category-link--23f8F:hover{color:#918d40}.Feed-module--feed__item-readmore--1u6bI{font-size:.875rem;color:#918d40}.Feed-module--feed__item-readmore--1u6bI:focus,.Feed-module--feed__item-readmore--1u6bI:hover{color:#918d40;border-bottom:1px solid #918d40}.Page-module--page--2nMky{margin-bottom:2.5rem}.Page-module--page__inner--2M_vz{padding:1.5625rem 1.25rem}.Page-module--page__title--GPD8L{font-size:1.575rem;font-weight:600;line-height:2.5rem;margin-top:0;margin-bottom:1.8125rem}.Page-module--page__body--Ic6i6{font-size:.875rem;line-height:1.25rem;margin:0 0 1.25rem}@media screen and (min-width:685px){.Page-module--page--2nMky{width:calc(58.275% - .78125rem)}.Page-module--page--2nMky:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--2nMky:last-child{margin-right:0}.Page-module--page--2nMky:nth-child(12n){margin-right:0;float:right}.Page-module--page--2nMky:nth-child(12n+1){clear:both}.Page-module--page__inner--2M_vz{padding:1.875rem 1.25rem}}@media screen and (min-width:960px){.Page-module--page--2nMky{width:calc(66.6% - .625rem)}.Page-module--page--2nMky:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--2nMky:last-child{margin-right:0}.Page-module--page--2nMky:nth-child(3n){margin-right:0;float:right}.Page-module--page--2nMky:nth-child(3n+1){clear:both}.Page-module--page__inner--2M_vz{padding:2.5rem 2.1875rem}}.Pagination-module--pagination--2H3nO{margin-top:2.5rem;display:flex}.Pagination-module--pagination__prev--bet5s{width:50%;text-align:left}.Pagination-module--pagination__prev-link--1Nzs6{color:#a9d159;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__prev-link--1Nzs6:focus,.Pagination-module--pagination__prev-link--1Nzs6:hover{color:#918d40}.Pagination-module--pagination__prev-link--disable--Yklx9{pointer-events:none;color:#bbb}.Pagination-module--pagination__next--3hFiN{width:50%;text-align:right}.Pagination-module--pagination__next-link--3FUtA{color:#a9d159;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__next-link--3FUtA:focus,.Pagination-module--pagination__next-link--3FUtA:hover{color:#918d40}.Pagination-module--pagination__next-link--disable--30UwZ{pointer-events:none;color:#bbb}.Author-module--author--2Yefr{border-top:1px solid #e6e6e6;max-width:43.75rem;padding-top:1.25rem;line-height:1.25rem;margin-top:1.25rem;margin-bottom:2.5rem}.Author-module--author__bio-twitter--n-O9n{display:block;text-decoration:underline}@media screen and (min-width:685px){.Author-module--author--2Yefr{margin-left:auto;margin-right:auto}}.Content-module--content--3p512{max-width:62.8125rem;padding:0 .9375rem;margin:0 auto}.Content-module--content__title--2BDW9{font-size:1.75rem;max-width:43.75rem;font-weight:600;text-align:center;line-height:2.0625rem;margin:1.25rem auto 0}.Content-module--content__body--2TrQ- figure{margin-bottom:1.25rem}.Content-module--content__body--2TrQ- figure blockquote{font-style:italic;text-align:center;margin-top:0;padding:1.25rem 0}.Content-module--content__body--2TrQ- figure blockquote p{max-width:43.75rem;font-size:1.47149rem;margin-top:1.25rem;margin-bottom:1.25rem;line-height:1.875rem}.Content-module--content__body--2TrQ- a{text-decoration:underline}.Content-module--content__body--2TrQ- *{max-width:43.75rem;margin-left:auto;margin-right:auto}.Content-module--content__body--2TrQ- img{max-width:100%;margin-top:.625rem;margin-bottom:.625rem}.Content-module--content__body--2TrQ- li ul{margin-bottom:.625rem}.Content-module--content__body--2TrQ- li p{line-height:1.25rem;margin-bottom:.625rem}.Content-module--content__body--2TrQ- h2{position:relative;padding:1rem 1.5rem;color:#fff;border-radius:.625rem;background:#0c0000}.Content-module--content__body--2TrQ- h2:after{position:absolute;bottom:-9px;left:1rem;width:0;height:0;content:"";border-color:#0c0000 transparent transparent;border-style:solid;border-width:10px 10px 0}.Content-module--content__body--2TrQ- h3{border-bottom:3px dotted #0c0000;padding:1rem 0}@media screen and (min-width:960px){.Content-module--content--3p512{padding:0}.Content-module--content__title--2BDW9{font-size:1.75rem;line-height:2.8125rem;margin-top:2.8125rem;margin-bottom:1.875rem}.Content-module--content__body--2TrQ-,.Content-module--content__body--2TrQ- p{font-size:.98438rem;line-height:1.40625rem;margin-bottom:1.40625rem}.Content-module--content__body--2TrQ- li p{line-height:1.25rem;margin-bottom:.625rem}}.Meta-module--meta__date--29eD7{font-style:italic}.Tags-module--tags--1L_ct{margin-bottom:.625rem}.Tags-module--tags__list--91FqN{list-style:none;margin:0 -.625rem;padding:0}.Tags-module--tags__list-item--1M30P{display:inline-block;margin:.625rem .3125rem}.Tags-module--tags__list-item-link--3SL_8{display:inline-block;height:2.1875rem;padding:0 1.5rem;line-height:2.1875rem;border:1px solid #e6e6e6;text-decoration:none;border-radius:1.25rem;color:#222}.Tags-module--tags__list-item-link--3SL_8:focus,.Tags-module--tags__list-item-link--3SL_8:hover{color:#918d40}.Post-module--post__comments--25y6I,.Post-module--post__footer--3WzWU{max-width:43.75rem;margin:0 auto;padding:0 .9375rem}.Post-module--post__home-button--16Kl0{display:block;max-width:5.625rem;height:2.1875rem;padding:0 1.5rem;line-height:2.1875rem;text-align:center;color:#222;border:1px solid #e6e6e6;border-radius:1.25rem;font-size:.875rem;font-weight:400;margin-left:auto;margin-right:auto;margin-top:1.25rem}.Post-module--post__home-button--16Kl0:focus,.Post-module--post__home-button--16Kl0:hover{color:#918d40}@media screen and (min-width:960px){.Post-module--post__comments--25y6I,.Post-module--post__footer--3WzWU{padding:0}.Post-module--post__home-button--16Kl0{position:fixed;max-width:auto;margin:0;top:30px;left:30px}}</style><meta name="generator" content="Gatsby 2.32.13"/><link rel="alternate" type="application/rss+xml" title="かえるのひみつきち" href="/rss.xml"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-122086587-6"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-122086587-6', {"send_page_view":false});
      }
      </script><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="icon" href="/favicon-32x32.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#F7A046"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><title data-react-helmet="true">Cyber Security Rumble CTF 2023 Writeup - かえるのひみつきち</title><meta data-react-helmet="true" name="description" content="Cyber Security Rumble CTF 2023 の Writeup です。"/><meta data-react-helmet="true" property="og:site_name" content="Cyber Security Rumble CTF 2023 Writeup - かえるのひみつきち"/><meta data-react-helmet="true" property="og:image" content="https://kashiwaba-yuki.com/static/e896b189daf825dfc86bef394b230f76/ctf-cybersecurity-rumble-2023.png"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:title" content="Cyber Security Rumble CTF 2023 Writeup - かえるのひみつきち"/><meta data-react-helmet="true" name="twitter:description" content="Cyber Security Rumble CTF 2023 の Writeup です。"/><meta data-react-helmet="true" name="twitter:image" content="https://kashiwaba-yuki.com/static/e896b189daf825dfc86bef394b230f76/ctf-cybersecurity-rumble-2023.png"/><link as="script" rel="preload" href="/webpack-runtime-a3c0f166cb4b802ff58f.js"/><link as="script" rel="preload" href="/framework-3761df4ab6ee9f056936.js"/><link as="script" rel="preload" href="/532a2f07-92db97c0addf07d5cb73.js"/><link as="script" rel="preload" href="/dc6a8720040df98778fe970bf6c000a41750d3ae-0c55613236457468f588.js"/><link as="script" rel="preload" href="/app-3c6584a5d7e2e261544c.js"/><link as="script" rel="preload" href="/styles-407fe62976dc5310c43e.js"/><link as="script" rel="preload" href="/cd95ea5cbd2c605f26db819f07999610c9ff4310-c2f05dc74373de400085.js"/><link as="script" rel="preload" href="/component---src-templates-post-template-js-381c1b847824134fa4bd.js"/><link as="fetch" rel="preload" href="/page-data/ctf-cybersecurity-rumble-2023/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/251939775.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/401334301.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/825871152.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="Layout-module--layout--3Pyz6"><div><a class="Post-module--post__home-button--16Kl0" href="/">All Articles</a><div><div class="Content-module--content--3p512"><h1 class="Content-module--content__title--2BDW9">Cyber Security Rumble CTF 2023 Writeup</h1><div class="Content-module--content__body--2TrQ-"><p>7/8 から開催されていた Cyber Security Rumble CTF 2023 に 0nePadding として参加し、35 位/ 622 チームでした。</p>
<p>今回は日本の参加者が少なかったようで、まさかの国内チームとしては 1 位の結果でした笑</p>
<p>いつも通り Writeup を書いていきます。</p>
<h2 id="shellcode-ceptionrev" style="position:relative;"><a href="#shellcode-ceptionrev" aria-label="shellcode ceptionrev permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>SHELLCODE-CEPTION(Rev)</h2>
<blockquote>
<p>I think I lost my flag in some kind of inception. Can you help me find my flag?</p>
</blockquote>
<p>問題バイナリをデコンパイルすると、以下のような出力を得られました。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 618px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/0d315e27a85ebfec358455f84866abbd/6e6fb/image-20230709011605412.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 60.416666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABlUlEQVQoz52STUvcUBSG87dLNyKKC9GF4MKF4EJw4Q9oQap0qG2plKILa24Gh44fmUwnXzeZfNw4eTwJolOVmbYXHu5J4L73vOe91rv3J7x902Fp6ZiFhSPZD1lb67QsLx+yuPiBlZUjVlc/sr7eYWPjE5ubx2xtfWF7+ys7O9/Y3T1hb+87+/s/sE5Pzzk7+8xP+4AL+wKlIhxnxNVVSL8f8qsf0Je6+b6+jri5ibi9bYhx3ZjBIMbzNN5QMxQsx3HQSQ8zucRUCcYg1Pzvsmzbxg9yknEjlLY0azKpX1DX87G63a50mFGaQn5UM29vDrQ79WP9okMllqNIE/gxSZrghxrXz/CCClf/JsoSMpNTT+on0RkTkRnaMtQx3iAj0kPSNOJy5OHGIUGSMhJRX/uYO9NCPadDR0koWktZyPxyoRJRI5TkuaEyElRZUtyVjIvxQ3ezLCtbnkMg8ReM/JA884mLiKRIXz1UM8eyshvLYq9NWrdpTofwnLmWlVIPlnlVaDrdv3qHvV6PvCj+EPpXkel1D/LHlFDQsBz+AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/0d315e27a85ebfec358455f84866abbd/8ac56/image-20230709011605412.webp 240w,
/static/0d315e27a85ebfec358455f84866abbd/d3be9/image-20230709011605412.webp 480w,
/static/0d315e27a85ebfec358455f84866abbd/fd768/image-20230709011605412.webp 618w"
              sizes="(max-width: 618px) 100vw, 618px"
              type="image/webp"
            />
          <source
            srcset="/static/0d315e27a85ebfec358455f84866abbd/8ff5a/image-20230709011605412.png 240w,
/static/0d315e27a85ebfec358455f84866abbd/e85cb/image-20230709011605412.png 480w,
/static/0d315e27a85ebfec358455f84866abbd/6e6fb/image-20230709011605412.png 618w"
            sizes="(max-width: 618px) 100vw, 618px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/0d315e27a85ebfec358455f84866abbd/6e6fb/image-20230709011605412.png"
            alt="image-20230709011605412"
            title="image-20230709011605412"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>プログラム内のデータを XOR してメモリに保存して、その領域に mprotect で PROT_EXEC などの属性を設定しています。</p>
<p>参考：<a href="https://man7.org/linux/man-pages/man2/mprotect.2.html" target="_blank" rel="nofollow noopener noreferrer">mprotect(2) - Linux manual page</a></p>
<p>このことから、プログラム内でデコードしたシェルコードを実行する機能を持っていると推測できました。</p>
<p>そこで、以下のスクリプトで対象のシェルコードをファイルとして抽出します。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">data <span class="token operator">=</span> <span class="token string">b'\x3c\x21\xe0\x8c\x21\xd1\x6b\x7b\x7a\x53\x58\x1c\x4b\x43\x21\xd3\x41\x46\x4f\x77\x19\x46\x4b\x1b\x21\xe0\x2c\xb9\x21\xe0\x3c\xb1\x21\xd1\x58\x5c\x19\x18\x46\x77\x4b\x1c\x21\xd3\x46\x77\x4a\x4d\x77\x1c\x46\x46\x21\xe0\x2c\x89\x21\xe0\x3c\x81\xae\x2c\x99\x47\x51\x19\x46\x0f\xae\x2c\x9d\x4f\x55\xaf\x2c\x9f\x69\xae\x2c\x95\x69\x69\x69\x69\x82\x75\xe2\x2c\x95\x21\xf1\x66\xdf\x2d\x6c\xb9\xea\x99\x28\xe0\xab\xe2\x2c\x95\x21\xf1\xe1\x3d\x6c\xb9\xea\x2c\x95\x68\xea\x14\x95\x4c\x17\xb7\xae\x2c\x91\x69\x69\x69\x69\x82\x67\xe2\x2c\x91\x21\xf1\xaf\x2d\x6c\xb9\x69\xea\x2c\x91\x68\xea\x14\x91\x4c\x17\x85\xf9\x34\xaa'</span>
dist <span class="token operator">=</span> <span class="token string">b''</span>
<span class="token keyword">for</span> d <span class="token keyword">in</span> data<span class="token punctuation">:</span>
    dist <span class="token operator">+=</span> <span class="token punctuation">(</span>d<span class="token operator">^</span><span class="token number">0x69</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'big'</span><span class="token punctuation">)</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"shellcode"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>dist<span class="token punctuation">)</span></code></pre></div>
<p>抽出したシェルコードをさらに Ghidra で解析すると、以下の結果が得られました。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 734px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/7233f866ad54b0d13f24b66e559b3753/c6d67/image-20230709011545535.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 75.83333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAABoklEQVQ4y6WSbVPiMBSF+f//Zx0ZV74yIzIwuChuKVIqFFEKNEmTNGnPHur4NvvBquncmSRNnpx772m1T89wcvIL7fZvxhnOzzvodDrodru46PXQu7xEv9/HYDDAcDjEaDTC1dUfjMdjXF/fYDKZ4Pb2L4IgwHQaohVNL+DdDjoHjHmOn4zWfL6AJkQoB+c0isKgqqpvRyuKYsSJQ7TUUGoNKR/5Az8ALghcO8yPQJkQ+ATy/jvYOOXZLEKysXhMLaw5wFr5+vMroFdgGM5ZQ8fLvlZWVuUHVd9QOKOyLVS+x4N8wEqssMxWSNXuA/CzqM/yq4F5nkCIJ9xnS0T7CItDjK3afh1Y1cA75GrDZmyRiDU2cgPjLHzp6zebjhcoa3hHdQYHIbDLBNIshSsEtNbc0/RmgVx7Gr6AVAV9quC9YYkcjLXQ9K4vyzeFYXhM2dPYtE2usRMHwgQP51wbdt3BFp5gT5gnrEBZOhSu5Jz7nJfvUz4CpXRI95ZKLDKpuVa8LAizz6pYgmP3G6UcBFMqBF+rGtXp06bE8X3jbjYx+z8/bo8evrs0bgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/7233f866ad54b0d13f24b66e559b3753/8ac56/image-20230709011545535.webp 240w,
/static/7233f866ad54b0d13f24b66e559b3753/d3be9/image-20230709011545535.webp 480w,
/static/7233f866ad54b0d13f24b66e559b3753/a242a/image-20230709011545535.webp 734w"
              sizes="(max-width: 734px) 100vw, 734px"
              type="image/webp"
            />
          <source
            srcset="/static/7233f866ad54b0d13f24b66e559b3753/8ff5a/image-20230709011545535.png 240w,
/static/7233f866ad54b0d13f24b66e559b3753/e85cb/image-20230709011545535.png 480w,
/static/7233f866ad54b0d13f24b66e559b3753/c6d67/image-20230709011545535.png 734w"
            sizes="(max-width: 734px) 100vw, 734px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/7233f866ad54b0d13f24b66e559b3753/c6d67/image-20230709011545535.png"
            alt="image-20230709011545535"
            title="image-20230709011545535"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>処理自体はシンプルでしたので、以下の Solver を作成して Flag を取得しました。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">import</span> struct

a <span class="token operator">=</span> <span class="token number">0x2a2275313a131202</span>
b <span class="token operator">=</span> <span class="token number">0x72222f701e262f28</span>
c <span class="token operator">=</span> <span class="token number">0x75221e2f71703531</span>
d <span class="token operator">=</span> <span class="token number">0x2f2f751e24231e2f</span>
e <span class="token operator">=</span> <span class="token number">0x2f70382e</span>
f <span class="token operator">=</span> <span class="token number">0x3c26</span>

<span class="token comment"># https://docs.python.org/ja/3.9/library/struct.html</span>
data <span class="token operator">=</span> struct<span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token string">"&lt;qqqqih"</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span>e<span class="token punctuation">,</span>f<span class="token punctuation">)</span>
<span class="token keyword">for</span> d <span class="token keyword">in</span> data<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>d<span class="token operator">^</span><span class="token number">0x41</span><span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>

<span class="token comment"># CSR{p4cking_1nc3pt10n_c4n_be_4nnoy1ng}</span></code></pre></div>
<h2 id="lightbulbrev" style="position:relative;"><a href="#lightbulbrev" aria-label="lightbulbrev permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>LIGHTBULB(Rev)</h2>
<blockquote>
<p>I have a very nice light bulb at home, and I found out I can switch with my phone using the app I wrote.</p>
<p>But the app only works on my phone, so good luck switching my light!</p>
</blockquote>
<p>問題バイナリとして apk ファイルが与えられます。</p>
<p>エミュレータで実行してみると、パスワードを使用してログインをした後に、電灯スイッチの ON/OFF を切り替えることができるアプリであることがわかりました。</p>
<p>とりあえず apktool で展開したファイルを一通り眺めていくと、ログインパスワードに使用する情報である <code class="language-text">583908295080</code> が平文で格納されていることがわかります。</p>
<p>そして、ログイン後の動作を追うために Smali2Java を使用して Smali ファイルを Java にデコンパイルした結果を確認しました。</p>
<p>すると、以下の処理が LightSwitchingActivity で行われていることがわかります。</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token class-name">String</span> string <span class="token operator">=</span> sharedPreferences<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"secret_key"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"LIGHTSWITCH"</span><span class="token punctuation">,</span> <span class="token string">"the sk was "</span> <span class="token operator">+</span> string<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Intrinsics</span><span class="token punctuation">.</span><span class="token function">checkNotNull</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">Charsets</span><span class="token punctuation">.</span>UTF_8<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Intrinsics</span><span class="token punctuation">.</span><span class="token function">checkNotNullExpressionValue</span><span class="token punctuation">(</span>bytes<span class="token punctuation">,</span> <span class="token string">"this as java.lang.String).getBytes(charset)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">APIKeyHash</span> aPIKeyHash <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">APIKeyHash</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">StringBuilder</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token string">"CSR{"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes2 <span class="token operator">=</span> <span class="token string">"APIKEY"</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">Charsets</span><span class="token punctuation">.</span>UTF_8<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Intrinsics</span><span class="token punctuation">.</span><span class="token function">checkNotNullExpressionValue</span><span class="token punctuation">(</span>bytes2<span class="token punctuation">,</span> <span class="token string">"this as java.lang.String).getBytes(charset)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>apiKey <span class="token operator">=</span> sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token class-name">LightSwitchingActivityKt</span><span class="token punctuation">.</span><span class="token function">toHex</span><span class="token punctuation">(</span>aPIKeyHash<span class="token punctuation">.</span><span class="token function">hash</span><span class="token punctuation">(</span>bytes2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token char">'}'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">RequestQueue</span> newRequestQueue <span class="token operator">=</span> <span class="token class-name">Volley</span><span class="token punctuation">.</span><span class="token function">newRequestQueue</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Context</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Intrinsics</span><span class="token punctuation">.</span><span class="token function">checkNotNullExpressionValue</span><span class="token punctuation">(</span>newRequestQueue<span class="token punctuation">,</span> <span class="token string">"newRequestQueue(this)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>requestQueue <span class="token operator">=</span> newRequestQueue<span class="token punctuation">;</span>
<span class="token class-name">SwitchCompat</span> findViewById <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token number">2131231147</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Intrinsics</span><span class="token punctuation">.</span><span class="token function">checkNotNullExpressionValue</span><span class="token punctuation">(</span>findViewById<span class="token punctuation">,</span> <span class="token string">"findViewById(R.id.switch_light_bulb)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
findViewById<span class="token punctuation">.</span><span class="token function">setOnCheckedChangeListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LightSwitchingActivity</span>$<span class="token punctuation">.</span><span class="token function">ExternalSyntheticLambda0</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>ここではまず、ログインパスワードにもなっている secret_key の文字列をバイト列に変換した後に、APIKeyHash クラスを作成しています。</p>
<p>その後、APIKEY という文字列をバイト列に変換したものを引数として APIKeyHash クラスの hash メソッドを呼び出します。</p>
<p>そして、hash メソッドの戻り値になるバイト列をさらに LightSwitchingActivityKt.toHex() に与えた結果が Flag になりることがわかりました。</p>
<p>APIKeyHash クラスと LightSwitchingActivityKt の実装は、さきほどと同じく Smali2Java を使用することで Java にデコンパイルすることで確認しました。</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token comment">// LightSwitchingActivityKt </span>
<span class="token keyword">package</span> <span class="token namespace">club<span class="token punctuation">.</span>redrocket<span class="token punctuation">.</span>lightbulb</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">kotlin<span class="token punctuation">.</span></span><span class="token class-name">Metadata</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">kotlin<span class="token punctuation">.</span>jvm<span class="token punctuation">.</span>internal<span class="token punctuation">.</span></span><span class="token class-name">Intrinsics</span><span class="token punctuation">;</span>
<span class="token comment">/* compiled from: LightSwitchingActivity.kt */</span>
<span class="token annotation punctuation">@Metadata</span><span class="token punctuation">(</span>d1 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"\u0000\u0012\n\u0000\n\u0002\u0010\u0019\n\u0000\n\u0002\u0010\u000e\n\u0002\u0010\u0012\n\u0000\u001a\n\u0010\u0002\u001a\u00020\u0003*\u00020\u0004\"\u000e\u0010\u0000\u001a\u00020\u0001X\u0082\u0004¢\u0006\u0002\n\u0000¨\u0006\u0005"</span><span class="token punctuation">}</span><span class="token punctuation">,</span> d2 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"HEX_CHARS"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"toHex"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"app_release"</span><span class="token punctuation">}</span><span class="token punctuation">,</span> k <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> mv <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> xi <span class="token operator">=</span> <span class="token number">48</span><span class="token punctuation">)</span>
<span class="token comment">/* loaded from: /tmp/jadx-9359415826287627730.dex */</span>
<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">LightSwitchingActivityKt</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> HEX_CHARS<span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> charArray <span class="token operator">=</span> <span class="token string">"0123456789ABCDEF"</span><span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Intrinsics</span><span class="token punctuation">.</span><span class="token function">checkNotNullExpressionValue</span><span class="token punctuation">(</span>charArray<span class="token punctuation">,</span> <span class="token string">"this as java.lang.String).toCharArray()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        HEX_CHARS <span class="token operator">=</span> charArray<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token function">toHex</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bArr4<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Intrinsics</span><span class="token punctuation">.</span><span class="token function">checkNotNullParameter</span><span class="token punctuation">(</span>bArr4<span class="token punctuation">,</span> <span class="token string">"&lt;this>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">StringBuffer</span> stringBuffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">byte</span> b <span class="token operator">:</span> bArr4<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cArr <span class="token operator">=</span> HEX_CHARS<span class="token punctuation">;</span>
            stringBuffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>cArr<span class="token punctuation">[</span><span class="token punctuation">(</span>b <span class="token operator">&amp;</span> <span class="token number">240</span><span class="token punctuation">)</span> <span class="token operator">>>></span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            stringBuffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>cArr<span class="token punctuation">[</span>b <span class="token operator">&amp;</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">String</span> stringBuffer2 <span class="token operator">=</span> stringBuffer<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Intrinsics</span><span class="token punctuation">.</span><span class="token function">checkNotNullExpressionValue</span><span class="token punctuation">(</span>stringBuffer2<span class="token punctuation">,</span> <span class="token string">"result.toString()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> stringBuffer2<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// APIKeyHash </span>
<span class="token keyword">package</span> <span class="token namespace">club<span class="token punctuation">.</span>redrocket<span class="token punctuation">.</span>lightbulb</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">kotlin<span class="token punctuation">.</span></span><span class="token class-name">Metadata</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">kotlin<span class="token punctuation">.</span>jvm<span class="token punctuation">.</span>internal<span class="token punctuation">.</span></span><span class="token class-name">Intrinsics</span><span class="token punctuation">;</span>
<span class="token comment">/* compiled from: APIKeyHash.kt */</span>
<span class="token annotation punctuation">@Metadata</span><span class="token punctuation">(</span>d1 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"\u0000\u001a\n\u0002\u0018\u0002\n\u0002\u0010\u0000\n\u0000\n\u0002\u0010\u0012\n\u0002\b\u0005\n\u0002\u0010\u0002\n\u0002\b\u0002\u0018\u00002\u00020\u0001B\u000f\b\u0000\u0012\u0006\u0010\u0002\u001a\u00020\u0003¢\u0006\u0002\u0010\u0004J\u000e\u0010\u0006\u001a\u00020\u00032\u0006\u0010\u0007\u001a\u00020\u0003J\b\u0010\b\u001a\u00020\tH\u0002J\u0006\u0010\n\u001a\u00020\tR\u000e\u0010\u0002\u001a\u00020\u0003X\u0082\u0004¢\u0006\u0002\n\u0000R\u000e\u0010\u0005\u001a\u00020\u0003X\u0082\u0004¢\u0006\u0002\n\u0000¨\u0006\u000b"</span><span class="token punctuation">}</span><span class="token punctuation">,</span> d2 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"Lclub/redrocket/lightbulb/APIKeyHash;"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"key"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"([B)V"</span><span class="token punctuation">,</span> <span class="token string">"s"</span><span class="token punctuation">,</span> <span class="token string">"hash"</span><span class="token punctuation">,</span> <span class="token string">"plaintext"</span><span class="token punctuation">,</span> <span class="token string">"initializeS"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"reset"</span><span class="token punctuation">,</span> <span class="token string">"app_release"</span><span class="token punctuation">}</span><span class="token punctuation">,</span> k <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> mv <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> xi <span class="token operator">=</span> <span class="token number">48</span><span class="token punctuation">)</span>
<span class="token comment">/* loaded from: /tmp/jadx-2851593408582218842.dex */</span>
<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">APIKeyHash</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> key<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> s<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">APIKeyHash</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bArr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Intrinsics</span><span class="token punctuation">.</span><span class="token function">checkNotNullParameter</span><span class="token punctuation">(</span>bArr<span class="token punctuation">,</span> <span class="token string">"key"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>key <span class="token operator">=</span> bArr<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>bArr<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">||</span> bArr<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">256</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"key length must be between 1 and 256"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">initializeS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">initializeS</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bArr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> i<span class="token punctuation">;</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bArr2 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>key<span class="token punctuation">;</span>
            bArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> bArr2<span class="token punctuation">[</span>i <span class="token operator">%</span> bArr2<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">int</span> i2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i3 <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> i3<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bArr3 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>s<span class="token punctuation">;</span>
            <span class="token keyword">byte</span> b <span class="token operator">=</span> bArr3<span class="token punctuation">[</span>i3<span class="token punctuation">]</span><span class="token punctuation">;</span>
            i2 <span class="token operator">=</span> <span class="token punctuation">(</span>i2 <span class="token operator">+</span> b <span class="token operator">+</span> bArr<span class="token punctuation">[</span>i3<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">255</span><span class="token punctuation">;</span>
            <span class="token keyword">byte</span> b2 <span class="token operator">=</span> bArr3<span class="token punctuation">[</span>i2<span class="token punctuation">]</span><span class="token punctuation">;</span>
            bArr3<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">=</span> b<span class="token punctuation">;</span>
            bArr3<span class="token punctuation">[</span>i3<span class="token punctuation">]</span> <span class="token operator">=</span> b2<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">initializeS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">hash</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bArr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Intrinsics</span><span class="token punctuation">.</span><span class="token function">checkNotNullParameter</span><span class="token punctuation">(</span>bArr<span class="token punctuation">,</span> <span class="token string">"plaintext"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bArr2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>bArr<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> length <span class="token operator">=</span> bArr<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> i2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i3 <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i3<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            i <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">255</span><span class="token punctuation">;</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bArr3 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>s<span class="token punctuation">;</span>
            <span class="token keyword">byte</span> b <span class="token operator">=</span> bArr3<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            i2 <span class="token operator">=</span> <span class="token punctuation">(</span>i2 <span class="token operator">+</span> b<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">255</span><span class="token punctuation">;</span>
            <span class="token keyword">byte</span> b2 <span class="token operator">=</span> bArr3<span class="token punctuation">[</span>i2<span class="token punctuation">]</span><span class="token punctuation">;</span>
            bArr3<span class="token punctuation">[</span>i2<span class="token punctuation">]</span> <span class="token operator">=</span> b<span class="token punctuation">;</span>
            bArr3<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> b2<span class="token punctuation">;</span>
            bArr2<span class="token punctuation">[</span>i3<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>bArr3<span class="token punctuation">[</span><span class="token punctuation">(</span>b2 <span class="token operator">+</span> bArr3<span class="token punctuation">[</span>i2<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">255</span><span class="token punctuation">]</span> <span class="token operator">^</span> bArr<span class="token punctuation">[</span>i3<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> bArr2<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>上記のデコンパイル結果を元に以下の Solver を Java で作成し、アプリの動作を再現することで、静的解析で Flag を取得することに成功しました。</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Arrays</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>charset<span class="token punctuation">.</span></span><span class="token class-name">StandardCharsets</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Solver</span> <span class="token punctuation">{</span>    
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> key<span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> s<span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes <span class="token operator">=</span> <span class="token string">"583908295080"</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span>UTF_8<span class="token punctuation">)</span><span class="token punctuation">;</span>
        key <span class="token operator">=</span> bytes<span class="token punctuation">;</span>
        s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token comment">// initializeS</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bArr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> i<span class="token punctuation">;</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bArr2 <span class="token operator">=</span> key<span class="token punctuation">;</span>
            bArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> bArr2<span class="token punctuation">[</span>i <span class="token operator">%</span> bArr2<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">int</span> i4 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i3 <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> i3<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bArr3 <span class="token operator">=</span> s<span class="token punctuation">;</span>
            <span class="token keyword">byte</span> b <span class="token operator">=</span> bArr3<span class="token punctuation">[</span>i3<span class="token punctuation">]</span><span class="token punctuation">;</span>
            i4 <span class="token operator">=</span> <span class="token punctuation">(</span>i4 <span class="token operator">+</span> b <span class="token operator">+</span> bArr<span class="token punctuation">[</span>i3<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">255</span><span class="token punctuation">;</span>
            <span class="token keyword">byte</span> b2 <span class="token operator">=</span> bArr3<span class="token punctuation">[</span>i4<span class="token punctuation">]</span><span class="token punctuation">;</span>
            bArr3<span class="token punctuation">[</span>i4<span class="token punctuation">]</span> <span class="token operator">=</span> b<span class="token punctuation">;</span>
            bArr3<span class="token punctuation">[</span>i3<span class="token punctuation">]</span> <span class="token operator">=</span> b2<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// hash</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bhash <span class="token operator">=</span> <span class="token string">"APIKEY"</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span>UTF_8<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bArr4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>bhash<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> length <span class="token operator">=</span> bhash<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token keyword">int</span> i5 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> i6 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i7 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i7 <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i7<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            i5 <span class="token operator">=</span> <span class="token punctuation">(</span>i5 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">255</span><span class="token punctuation">;</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bArr5 <span class="token operator">=</span> s<span class="token punctuation">;</span>
            <span class="token keyword">byte</span> b <span class="token operator">=</span> bArr5<span class="token punctuation">[</span>i5<span class="token punctuation">]</span><span class="token punctuation">;</span>
            i6 <span class="token operator">=</span> <span class="token punctuation">(</span>i6 <span class="token operator">+</span> b<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">255</span><span class="token punctuation">;</span>
            <span class="token keyword">byte</span> b2 <span class="token operator">=</span> bArr5<span class="token punctuation">[</span>i6<span class="token punctuation">]</span><span class="token punctuation">;</span>
            bArr5<span class="token punctuation">[</span>i6<span class="token punctuation">]</span> <span class="token operator">=</span> b<span class="token punctuation">;</span>
            bArr5<span class="token punctuation">[</span>i5<span class="token punctuation">]</span> <span class="token operator">=</span> b2<span class="token punctuation">;</span>
            bArr4<span class="token punctuation">[</span>i7<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>bArr5<span class="token punctuation">[</span><span class="token punctuation">(</span>b2 <span class="token operator">+</span> bArr5<span class="token punctuation">[</span>i6<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">255</span><span class="token punctuation">]</span> <span class="token operator">^</span> bhash<span class="token punctuation">[</span>i7<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> charArray <span class="token operator">=</span> <span class="token string">"0123456789ABCDEF"</span><span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> bArr4<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>charArray<span class="token punctuation">[</span><span class="token punctuation">(</span>bArr4<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">240</span><span class="token punctuation">)</span> <span class="token operator">>>></span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>charArray<span class="token punctuation">[</span><span class="token punctuation">(</span>bArr4<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// DE404B983322</span></code></pre></div>
<h2 id="ransomware-traffic-analysis-part-1forensic" style="position:relative;"><a href="#ransomware-traffic-analysis-part-1forensic" aria-label="ransomware traffic analysis part 1forensic permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>RANSOMWARE TRAFFIC ANALYSIS PART 1(Forensic)</h2>
<blockquote>
<p>DISCLAIMER: This might contain real ransomware. DO NOT EXECUTE ANY FILES IN AN UNSAFE ENVIRONMENT. Please use a virtual machine for this challenge.</p>
<p>ARC Industries dedicated an entire month of hard work and effort to create a tender document for a highly esteemed project that held the key to their financial stability. Unfortunately, on Thursday, May 25th 2023, the company fell victim to a malicious act of ransomware, suspected to be orchestrated by a rival competitor. As a result, the crucial final version of the tender document has been rendered inaccessible due to encryption. It is both unreadable and has a file extension appended to the filename. Urgently, ARC Industries seeks the assistance of a skilled expert capable of decrypting this invaluable document.</p>
<p>Armed with only the network traffic logs, it’s time for you to showcase your expertise, Defender!!</p>
</blockquote>
<p>問題バイナリとしてランサムウェアに感染した端末の pcap ファイルが与えられます。</p>
<p>pcap を調査してみると、HTTP や SMB でいくつか怪しげなファイルのやり取りをしています。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/f6c0f1465ffa8635e7f6b779650929b9/87a80/image-20230709010301843.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 30.41666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABFUlEQVQY012Q2W7CMBBF8/8/VJZAWiCICgEpUh8KATtxCGmzlweWNrmMJ2oFPFx5GfvMsQ0ZmPDDPvJyDD0P9hbSYow4G6E8THC6zFDjDUluw5Vt7D6fEUQWVtsWr//uC9XcNT6kCR0/GmLl9bD2+/CiAYLYxlcxQXmc41gtESY23t02xO4FG2XxOZci9wPE5SvSwxQZxZCqg41HnVSXs5G6cwtJNkT5PcblZwaQYVaM4IoW0nyE03mK32pO5guqOVxvRkcDuxB+Fyrskb4GtrmBBhYEPN8AdU3vAUtU9QIVAXi8iSHIcOt34O1MNnRl8zePQG22Fk/813p9D3L+w08WBGRD1RgykADF3ZNtbnYLrMnwMVf5vrIbh6OA6gAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/f6c0f1465ffa8635e7f6b779650929b9/8ac56/image-20230709010301843.webp 240w,
/static/f6c0f1465ffa8635e7f6b779650929b9/d3be9/image-20230709010301843.webp 480w,
/static/f6c0f1465ffa8635e7f6b779650929b9/e46b2/image-20230709010301843.webp 960w,
/static/f6c0f1465ffa8635e7f6b779650929b9/0ea8a/image-20230709010301843.webp 973w"
              sizes="(max-width: 960px) 100vw, 960px"
              type="image/webp"
            />
          <source
            srcset="/static/f6c0f1465ffa8635e7f6b779650929b9/8ff5a/image-20230709010301843.png 240w,
/static/f6c0f1465ffa8635e7f6b779650929b9/e85cb/image-20230709010301843.png 480w,
/static/f6c0f1465ffa8635e7f6b779650929b9/d9199/image-20230709010301843.png 960w,
/static/f6c0f1465ffa8635e7f6b779650929b9/87a80/image-20230709010301843.png 973w"
            sizes="(max-width: 960px) 100vw, 960px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/f6c0f1465ffa8635e7f6b779650929b9/d9199/image-20230709010301843.png"
            alt="image-20230709010301843"
            title="image-20230709010301843"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>特に SMB の通信を見たところ、以下のようなランサムノートとともに暗号化された .micro 拡張子付きのファイルが送信されていました。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/5c94c13112f9756d103526e5e0598cfb/86a1e/image-20230709010859694.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 50.416666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABvklEQVQoz32RW5OaQBCF+f+/KEmZzT5Ed2sr0fKyakABGebGRRBYkBU5mRkvycMmXfVVDzDVfc7BmntLLOkUM7KGI39hLdaYhQ5eyQqbyEWQE9CSgWkqbs4fwa5YgRzBDr8jEBSERdiFApRxSEYg1DufMIg4NXAZQyb6nCBK94j3iixDouBpjkBmsEI2gON+AqMJ3E0Bb3sA2ZXgwQERr1BkR0N1aFHmR3TtGeh64Hylu3A+9ejee1hUPMANBghIDNvO4XkHhGEJGdVg/A1RXCNNG9RNh0ZRN6cL9QnHYwddPf6URfkDPDKA60nM53szMAgK03d+ccdzlfJALZJqiVqWxI0Zequ+1yiFXH7Dxv8C1xfw/QqMVaBKoe5CvIHS6zO9fCOkxG5XGBe3O0XRom0vai2mBtruZ9gbjp8/Yry8cEzGESaTCE9PDI6TGcu5yi9TWR5Ulho9xHTFWWWpMQN59GgsO1uB+WyPxTzBdBpjsUhVBIlhu82RJI3K8IT/lbEs4kf44Vd4vsTyNcNqlSJWGWkFVfWOrjvfL9/6v7hb1gqXK4rRkGM4pBiPJZ6fGUYjan6CtnrL6O/BH9VvJR/wCpq5oIEAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/5c94c13112f9756d103526e5e0598cfb/8ac56/image-20230709010859694.webp 240w,
/static/5c94c13112f9756d103526e5e0598cfb/d3be9/image-20230709010859694.webp 480w,
/static/5c94c13112f9756d103526e5e0598cfb/e46b2/image-20230709010859694.webp 960w,
/static/5c94c13112f9756d103526e5e0598cfb/0b716/image-20230709010859694.webp 1296w"
              sizes="(max-width: 960px) 100vw, 960px"
              type="image/webp"
            />
          <source
            srcset="/static/5c94c13112f9756d103526e5e0598cfb/8ff5a/image-20230709010859694.png 240w,
/static/5c94c13112f9756d103526e5e0598cfb/e85cb/image-20230709010859694.png 480w,
/static/5c94c13112f9756d103526e5e0598cfb/d9199/image-20230709010859694.png 960w,
/static/5c94c13112f9756d103526e5e0598cfb/86a1e/image-20230709010859694.png 1296w"
            sizes="(max-width: 960px) 100vw, 960px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/5c94c13112f9756d103526e5e0598cfb/d9199/image-20230709010859694.png"
            alt="image-20230709010859694"
            title="image-20230709010859694"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>これは、以下の記事のランサムウェアの特徴に一致します。</p>
<p>参考：<a href="https://www.pcrisk.com/removal-guides/20097-micro-ransomware" target="_blank" rel="nofollow noopener noreferrer">Micro Ransomware - Decryption, removal, and lost files recovery (updated)</a></p>
<p>このランサムウェアは TESLACRYPT と呼ばれるマルウェアのようですが、どうやらすでに攻撃者が復号用のマスターキーを開示しているようです。</p>
<p>そのため、複数のセキュリティベンダが TESLACRYPT の復号ツールを公開していました。</p>
<p>今回は、Trendmicro のツールを利用します。</p>
<p>参考：<a href="https://success.trendmicro.com/dcx/s/solution/1114221-downloading-and-using-the-trend-micro-ransomware-file-decryptor?language=en_US" target="_blank" rel="nofollow noopener noreferrer">Using the Trend Micro Ransomware File Decryptor Tool</a></p>
<p>上記からダウンロードしたツールを起動し、以下のように TESLACRYPT を指定して問題バイナリを復号します。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 514px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/b72877acb92cee5e0de583874451aa39/dea13/image-20230709011100079.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 90.41666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC1klEQVQ4y31Uy27TUBT0R4JYVAghISQkKFJBYsWCH+ADkAqooEJBIEJa2IBYIJZV1IhH3Lyah5PYvn7biR0/hnNukialDZZG9zjnZjwz59qK8WwHvYeP0Lq1ifbN2+hsPcDJ5n3CPZzcpfXO1unKvda1G2hc3kDzytUlNq6jcWkD+pNtKN73HwhLZUz23sB5+QruhzLC8if4pX0EjPclBOUDBB8PEO5/hv/6LcTTHZgkRBBMqsWLXZjbz8FcCuiqpcCeAHyq/XiCrmGgbwm56r6Pketi6NgY2BaGnod1V0FQxmmO3bqDx4d9VLwcrjBxrB6j2+mg3WyirqqEY7QaDai1mrwfhxHSJEEyiQkTxOMxpnGCLE2hpFmOQz3E144NLS6oMYFhmBDCguM4MA0dtm3P7m0HtmVhNBrCME0Yuo6BpkHTBrAdF0VRQGHWjKSGrLco1tspcuR5Lv8021pILPsFUlaY0aa03UFKaiKSP44ijMlCGIaIqI7C2T2T/Q9MOJ1OiZDYx+9K8H7/gUGkthDSokEDscge196aQTDJGUKpMMuwanRCGUZzlbwyoczSNAgCQRBI+DT9CTlakDJHQq5mhIScQQ1WpVPYrJDX6tERKpUKqtUj1GjKus7Epuyx8jOE9IBzCmdh5+dCP9tfYtUycykZFfGXb/DrDeikTtDTWeVCxcLuIlNWaNszF67rLhWeTpnUJNWfiGljlMRyypwd58Q58uTiOEZMdhI6zDJbyooz5HqVcDblueWFOd7Ig+Cnd+htadAb0qQ3pt1uy3UwGMge7+GjdSFhns3PE/0oCckmB97r9SRRr9tFl8CEw9FI9jiKkM5oLgmLVUL6MiBfg4vPHovIslwOj/cVeSZ7MkNhe1B7FtSuhTqv87rRt6S1f8HqGL7vQTMc/DoRGAgfqlqTg1J8kt03fWhz9I1lzZai6Dz4dx6e7QbojDwIN5IfCo7rLyXIRvTVQZW9AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/b72877acb92cee5e0de583874451aa39/8ac56/image-20230709011100079.webp 240w,
/static/b72877acb92cee5e0de583874451aa39/d3be9/image-20230709011100079.webp 480w,
/static/b72877acb92cee5e0de583874451aa39/7a333/image-20230709011100079.webp 514w"
              sizes="(max-width: 514px) 100vw, 514px"
              type="image/webp"
            />
          <source
            srcset="/static/b72877acb92cee5e0de583874451aa39/8ff5a/image-20230709011100079.png 240w,
/static/b72877acb92cee5e0de583874451aa39/e85cb/image-20230709011100079.png 480w,
/static/b72877acb92cee5e0de583874451aa39/dea13/image-20230709011100079.png 514w"
            sizes="(max-width: 514px) 100vw, 514px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/b72877acb92cee5e0de583874451aa39/dea13/image-20230709011100079.png"
            alt="image-20230709011100079"
            title="image-20230709011100079"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>復号が完了すると、以下のように Flag を取得することができました。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 950px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/3304cf8faa96c4bd578894296701d784/906b5/image-20230709011117849.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 47.91666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABBklEQVQoz7WOaWqEQBCFPY4KKuLuiKKX8AbieTyEC95G/OkdEgiBjHb70l1jJpMFhoGk4KNeVb2qbiUvChR5jiRJkGUZgiCAaRgwTZOwLOuqb3sf6LoOQ/gdx6FaSU4npGkK13URhiGiKKJa4nkefN+nXhxHNI/jmLKceb53PGBSLT+l2LaNsiwxjiP6vscw9KQlbdsKuqM/iDyQ7rrumLXXWvqbpoGiqirqusZfxLIsUDRNQ1VV2PcdjDFi2xhWYrvhey1YN/JuQsuYpunzoAx5VLJuHOdVILLUzy8rnogzXt/YZX54GN/BOaf9eZ5/P8j5Txjbj+WvXPx3Dj4adw8+yr/+8B1c1oOkha60TAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/3304cf8faa96c4bd578894296701d784/8ac56/image-20230709011117849.webp 240w,
/static/3304cf8faa96c4bd578894296701d784/d3be9/image-20230709011117849.webp 480w,
/static/3304cf8faa96c4bd578894296701d784/4a41d/image-20230709011117849.webp 950w"
              sizes="(max-width: 950px) 100vw, 950px"
              type="image/webp"
            />
          <source
            srcset="/static/3304cf8faa96c4bd578894296701d784/8ff5a/image-20230709011117849.png 240w,
/static/3304cf8faa96c4bd578894296701d784/e85cb/image-20230709011117849.png 480w,
/static/3304cf8faa96c4bd578894296701d784/906b5/image-20230709011117849.png 950w"
            sizes="(max-width: 950px) 100vw, 950px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/3304cf8faa96c4bd578894296701d784/906b5/image-20230709011117849.png"
            alt="image-20230709011117849"
            title="image-20230709011117849"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<h2 id="ransomware-traffic-analysis-part-2forensic" style="position:relative;"><a href="#ransomware-traffic-analysis-part-2forensic" aria-label="ransomware traffic analysis part 2forensic permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>RANSOMWARE TRAFFIC ANALYSIS PART 2(Forensic)</h2>
<blockquote>
<p>DISCLAIMER: This might contain real ransomware. DO NOT EXECUTE ANY FILES IN AN UNSAFE ENVIRONMENT. Please use a virtual machine for this challenge.</p>
<p>In the aftermath of the ransomware attack, ARC Industries faces a new challenge. The threat actor has hidden the vital private key required for decryption within their network. As the defender, your mission is to tirelessly locate this elusive key. Analyze network traffic logs, investigate suspicious activities, and unravel the threat actor’s techniques. Time is critical as the financial stability of ARC Industries hangs in the balance. Your expertise is essential to recover the key and restore the remaining files.</p>
<p>Take up the challenge and safeguard the future of the organization. Success relies on your determination and investigative skills. Armed with only the network traffic logs, it’s time for you to showcase your expertise, Defender!! Your colleague who captured the network traffic logs also started gathering the evidence and put this in a fileshare…</p>
</blockquote>
<p>PART 1 は面白かったのですが、正直 PART 2 は意図がよくわかりませんでした。(そして結局 Solver も 1 チームのみという)</p>
<p>PART 1 と同じ pcap から鍵を見つけろという問題でしたが、正直とっかかりがなさすぎて全くわかりませんでした。</p>
<p>どうやら、SMB でやり取りしている eml ファイルに着目する必要があったようです。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/6ee45c2c8f81e3c871e4ce017e489ea7/bb3b7/image-20230709104545133.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 61.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB3ElEQVQoz42R3Y7SUBSF+yoztGUEnT9sBuTORBP1Mbzwfu6MxqjRMf7EGF/JB/BGFDoUQgJt6UxPof8I7XKfUzoZmTHxJF/WWqd7726KpGktHBw0cEg0Ghrq9VvY2amhVrsJuaKgsoEsq1CIUhWlzFXRJ9XrbTSbD9BqPUS7/Qiadh+qeoStrUNsb9++gqIcoVptCVXVpvBc93bv0EJ3Ib17UcPX9/v4crKHz293BR9e3sCbZzJOnsv4+GqTypoif3pd6JPH9/D0WIM0Nb8hDr5jlf5AtuhgReS/fwLLXwX5BugS3FPNqgNkHaHz2QhJpEMyjAkGQwsT08V44sK0GHm29h55D5Y9o8xEHo+Luqnjg7EELovBvATlkQYDA5zh0ICu99Dv65T7InNvGH3iVNTwPBoNadA5PI8hCgOEoY80jZHnOZFBmrk+oigkIsRxQsTCFzm+oiU8h2EoSJIEWZYVG3a7XXB0XUev16OfNIZlWTBN80Jt24ZNnivP5TOeS+VDxUD+0HEc8ab5fA7fDxAEgfCX8X3/wvPazU2Xy2Ux8PzsjD4so8tANPFhvIBrOSRYZ97M7xaLBa47/DtKznQK12WiMU1T/O8p/oS/ERuWq5YX1xX+q7nUy+cPGJkZK6v/AxUAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/6ee45c2c8f81e3c871e4ce017e489ea7/8ac56/image-20230709104545133.webp 240w,
/static/6ee45c2c8f81e3c871e4ce017e489ea7/d3be9/image-20230709104545133.webp 480w,
/static/6ee45c2c8f81e3c871e4ce017e489ea7/e46b2/image-20230709104545133.webp 960w,
/static/6ee45c2c8f81e3c871e4ce017e489ea7/52f78/image-20230709104545133.webp 1211w"
              sizes="(max-width: 960px) 100vw, 960px"
              type="image/webp"
            />
          <source
            srcset="/static/6ee45c2c8f81e3c871e4ce017e489ea7/8ff5a/image-20230709104545133.png 240w,
/static/6ee45c2c8f81e3c871e4ce017e489ea7/e85cb/image-20230709104545133.png 480w,
/static/6ee45c2c8f81e3c871e4ce017e489ea7/d9199/image-20230709104545133.png 960w,
/static/6ee45c2c8f81e3c871e4ce017e489ea7/bb3b7/image-20230709104545133.png 1211w"
            sizes="(max-width: 960px) 100vw, 960px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/6ee45c2c8f81e3c871e4ce017e489ea7/d9199/image-20230709104545133.png"
            alt="image-20230709104545133"
            title="image-20230709104545133"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>このメールには画像が 2 つ添付されているので、まずは画像をロードしました。</p>
<p>これをファイルとして保存してみると、フッターに使用されている jpg ファイルにステガノで Flag が埋め込まれていました。</p>
<p>以下のコマンドで Flag を取得できます。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">steghide extract -sf image.jpg</code></pre></div>
<p>解凍用のパスワードは、HTTP でやり取りしている password.txt に記載されていたものを使用しました。</p>
<h2 id="まとめ" style="position:relative;"><a href="#%E3%81%BE%E3%81%A8%E3%82%81" aria-label="まとめ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>まとめ</h2>
<p>RISC-V の Reversing 問題が解けなかったので、もう少し勉強したら改めて Writeup を書きます。</p></div></div></div><div class="Post-module--post__footer--3WzWU"><div><p class="Meta-module--meta__date--29eD7">Published <!-- -->Jul 12, 2023</p></div><div class="Tags-module--tags--1L_ct"><ul class="Tags-module--tags__list--91FqN"><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/ctf/">CTF</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/rev/">Rev</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/forensic/">Forensic</a></li></ul></div><div class="Author-module--author--2Yefr"><p>リバースエンジニアになりたいCTF Player(Team: 0nePadding)。WinDbgとYARAが好き。OSCP / CISSP / AtCoder 緑 Microsoft Japanに所属してます。発言はすべて個人の見解。<a class="Author-module--author__bio-twitter--n-O9n" href="https://www.twitter.com/kash1064" rel="noopener noreferrer" target="_blank"><strong>かしわば</strong> on Twitter</a></p></div></div><div class="Post-module--post__comments--25y6I"></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/ctf-cybersecurity-rumble-2023";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-299cfcade846097f4d4b.js"],"app":["/app-3c6584a5d7e2e261544c.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-fd4fb51a6fac1c18bdde.js"],"component---src-templates-categories-list-template-js":["/component---src-templates-categories-list-template-js-2181ec47d28e5c35d3e9.js"],"component---src-templates-category-template-js":["/component---src-templates-category-template-js-76f2006942127b3c7274.js"],"component---src-templates-index-template-js":["/component---src-templates-index-template-js-70ba56c0f46525baa629.js"],"component---src-templates-not-found-template-js":["/component---src-templates-not-found-template-js-d19905e5c8fc953958f1.js"],"component---src-templates-page-template-js":["/component---src-templates-page-template-js-6ba68ef37e264f701345.js"],"component---src-templates-post-template-js":["/component---src-templates-post-template-js-381c1b847824134fa4bd.js"],"component---src-templates-tag-template-js":["/component---src-templates-tag-template-js-0faa242d92f89b71e668.js"],"component---src-templates-tags-list-template-js":["/component---src-templates-tags-list-template-js-2d7007993fc2bf0f9caf.js"]};/*]]>*/</script><script src="/polyfill-299cfcade846097f4d4b.js" nomodule=""></script><script src="/component---src-templates-post-template-js-381c1b847824134fa4bd.js" async=""></script><script src="/cd95ea5cbd2c605f26db819f07999610c9ff4310-c2f05dc74373de400085.js" async=""></script><script src="/styles-407fe62976dc5310c43e.js" async=""></script><script src="/app-3c6584a5d7e2e261544c.js" async=""></script><script src="/dc6a8720040df98778fe970bf6c000a41750d3ae-0c55613236457468f588.js" async=""></script><script src="/532a2f07-92db97c0addf07d5cb73.js" async=""></script><script src="/framework-3761df4ab6ee9f056936.js" async=""></script><script src="/webpack-runtime-a3c0f166cb4b802ff58f.js" async=""></script></body></html>