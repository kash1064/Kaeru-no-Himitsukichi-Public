<!DOCTYPE html><html lang="ja"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.e71379dda153709d1a9a.css" id="gatsby-global-css">html{font-size:100}body{margin:0 0 0 calc(100vw - 100%);color:#222;line-height:1.4;font-size:.875rem;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;background-color:#fcfcfc}body,h1,h2,h3,h4,h5,h6{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif}h1,h2,h3,h4,h5,h6{font-weight:600}h1{font-size:1.575rem;line-height:2.25rem;margin-top:5rem;margin-bottom:1.25rem}h2{font-size:1.47656rem;line-height:1.875rem}h2,h3{margin-top:2.5rem;margin-bottom:.625rem}h3{font-size:1.20313rem;line-height:1.25rem}h4{font-size:1.05rem;margin-top:1.875rem}h4,h5{line-height:1.25rem;margin-bottom:.625rem}h5,h6{font-size:.875rem;margin-top:3.125rem}h6{line-height:1.25rem;margin-bottom:.625rem}img{max-width:100%;margin:inherit auto}hr,img{border:0;display:block}hr{color:#222;height:1.625rem;margin:3.25rem auto;background-size:100% 26px;background-image:linear-gradient(180deg,transparent 1px,transparent 11px,#222 0,#222 15px,transparent 0,transparent 26px);width:6.25rem}a{color:#918d40;text-decoration:none}a:active,a:focus,a:hover{color:#a9d159}b,strong{font-weight:600}ul{list-style:square;margin-bottom:1.25rem}ul li{padding:0 .3125rem;margin-bottom:.625rem}p{line-height:1.25rem;margin-bottom:1.25rem}blockquote{font-style:italic;text-align:center;background-color:#f5f5f5;padding:.1875rem .625rem}figure{display:block;width:100%;height:auto}figcaption{line-height:.9375rem;margin-top:.3125rem;color:#222;font-size:.75rem;font-style:italic;margin-bottom:0;text-align:center}.anchor{margin-left:-1.875rem!important;padding-right:.875rem!important}@media screen and (min-width:685px){figure.float-left,figure.float-right{max-width:19.375rem;padding:0 1.25rem}.float-right{float:right}.float-left{float:left}}code[class*=language-],pre[class*=language-]{color:#ccc;background:0 0;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}li>code[class*=language-text],p>code[class*=language-text]{background:#f9f9f9!important;color:#2d2d2d!important}.Author-module--author__photo--36xCH{display:inline-block;margin-bottom:0;border-radius:50%;background-clip:padding-box}.Author-module--author__title--2CaTb{font-size:.98438rem;font-weight:600;line-height:1.40625rem;margin:.625rem 0}.Author-module--author__title-link--Yrism,.Author-module--author__title-link--Yrism:focus,.Author-module--author__title-link--Yrism:hover{color:#222}.Author-module--author__subtitle--cAaEB{color:#888;line-height:1.25rem;margin-bottom:1.25rem}.Icon-module--icon--Gpyvw{display:inline-block;width:1em;height:1em;stroke-width:0;stroke:currentColor;fill:currentColor;font-style:normal;font-weight:400;speak:none;margin-right:.2em;text-align:center;font-variant:normal;text-transform:none;line-height:1em;margin-left:.2em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.Contacts-module--contacts--1rGd1{margin-bottom:1.25rem}.Contacts-module--contacts__list--3OgdW{display:flex;flex-flow:row wrap;flex-grow:0;flex-shrink:0;list-style:none;padding:0;margin:.625rem -.1875rem;width:8.75rem}.Contacts-module--contacts__list-item--16p9q{padding:0;margin:.25rem;display:flex;align-content:center;align-items:center;justify-content:center;height:2.1875rem;width:2.1875rem;line-height:2.1875rem;border-radius:50%;text-align:center;border:1px solid #ebebeb}.Contacts-module--contacts__list-item-link--2MIDn{border:0;display:flex;color:#222}.Contacts-module--contacts__list-item-link--2MIDn:focus,.Contacts-module--contacts__list-item-link--2MIDn:hover{color:#918d40}.Copyright-module--copyright--1ariN{color:#b6b6b6;font-size:.75rem}.Menu-module--menu--Efbin{margin-bottom:1.25rem}.Menu-module--menu__list--31Zeo{list-style:none;padding:0;margin:0}.Menu-module--menu__list-item--1lJ6B{padding:0;margin:.625rem 0}.Menu-module--menu__list-item-link--10Ush{font-size:.875rem;color:#222;font-weight:400;border:0}.Menu-module--menu__list-item-link--10Ush:focus,.Menu-module--menu__list-item-link--10Ush:hover{color:#918d40;border-bottom:1px solid #918d40}.Menu-module--menu__list-item-link--active--2CbUO{color:#222;border-bottom:1px solid #222}.Sidebar-module--sidebar--X4z2p{width:100%}.Sidebar-module--sidebar__inner--Jdc5s{position:relative;padding:1.5625rem 1.25rem 0}.Sidebar-module--headerimage--19Rdy{width:100%;min-height:70px;max-height:120px;margin:0 0 .625rem}.Sidebar-module--logo-image--XDYae{min-height:70px;max-height:120px;margin:0 auto}input{-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:.625rem;margin:.3125rem 0;border:1px solid #999;border-radius:.3125rem}.Sidebar-module--search-container--17C6F{position:relative}.Sidebar-module--search-container-input--27Tw4{width:100%}.Sidebar-module--search-container-submit--WwtLg{position:absolute;width:2.375rem;height:2.375rem;top:calc(50% - 19px);right:0;border:3px solid #999;border-radius:0 .25rem .25rem 0;background:#999}.Sidebar-module--search-container-submit--WwtLg:before{position:absolute;content:"";width:.9375rem;height:.9375rem;top:calc(50% - 9px);left:calc(50% - 9px);border-radius:50%;box-shadow:0 0 0 2px #fff}.Sidebar-module--search-container-submit--WwtLg:after{position:absolute;content:"";width:.5rem;height:.375rem;top:calc(50% + 6px);left:calc(50% + 2px);border-top:2px solid #fff;transform:rotate(45deg)}@media screen and (min-width:685px){.Sidebar-module--sidebar--X4z2p{width:calc(41.625% - 1.09375rem)}.Sidebar-module--sidebar--X4z2p:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--X4z2p:last-child{margin-right:0}.Sidebar-module--sidebar--X4z2p:nth-child(12n){margin-right:0;float:right}.Sidebar-module--sidebar--X4z2p:nth-child(12n+1){clear:both}.Sidebar-module--sidebar__inner--Jdc5s{padding:1.875rem 1.25rem 0}.Sidebar-module--sidebar__inner--Jdc5s:after{background:#e6e6e6;background:linear-gradient(180deg,#e6e6e6 0,#e6e6e6 48%,#fff);position:absolute;content:"";width:.0625rem;height:33.75rem;top:30px;right:-10px;bottom:0}}@media screen and (min-width:960px){.Sidebar-module--sidebar--X4z2p{width:calc(33.3% - 1.25rem)}.Sidebar-module--sidebar--X4z2p:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--X4z2p:last-child{margin-right:0}.Sidebar-module--sidebar--X4z2p:nth-child(3n){margin-right:0;float:right}.Sidebar-module--sidebar--X4z2p:nth-child(3n+1){clear:both}.Sidebar-module--sidebar__inner--Jdc5s{padding:2.5rem}}.Layout-module--layout--3Pyz6{max-width:66.875rem;margin-left:auto;margin-right:auto}.Layout-module--layout--3Pyz6:before{content:"";display:table}.Layout-module--layout--3Pyz6:after{content:"";display:table;clear:both}.Feed-module--feed__item--2D5rE{margin-bottom:1.5625rem}.Feed-module--feed__item--2D5rE:last-child{margin-bottom:.625rem}.Feed-module--feed__item-title--3nigr{font-size:1.47656rem;line-height:1.875rem;margin-top:0;margin-bottom:.625rem}.Feed-module--feed__item-title-link--iFMRs{color:#222}.Feed-module--feed__item-title-link--iFMRs:focus,.Feed-module--feed__item-title-link--iFMRs:hover{color:#222;border-bottom:1px solid #222}.Feed-module--feed__item-description--1uO8e{font-size:.875rem;line-height:1.25rem;margin-bottom:.9375rem}.Feed-module--feed__item-meta-time--3t1fg{font-size:.75rem;color:#222;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-divider--N-Q0A{margin:0 .3125rem}.Feed-module--feed__item-meta-category-link--23f8F{font-size:.75rem;color:#a9d159;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-category-link--23f8F:focus,.Feed-module--feed__item-meta-category-link--23f8F:hover{color:#918d40}.Feed-module--feed__item-readmore--1u6bI{font-size:.875rem;color:#918d40}.Feed-module--feed__item-readmore--1u6bI:focus,.Feed-module--feed__item-readmore--1u6bI:hover{color:#918d40;border-bottom:1px solid #918d40}.Page-module--page--2nMky{margin-bottom:2.5rem}.Page-module--page__inner--2M_vz{padding:1.5625rem 1.25rem}.Page-module--page__title--GPD8L{font-size:1.575rem;font-weight:600;line-height:2.5rem;margin-top:0;margin-bottom:1.8125rem}.Page-module--page__body--Ic6i6{font-size:.875rem;line-height:1.25rem;margin:0 0 1.25rem}@media screen and (min-width:685px){.Page-module--page--2nMky{width:calc(58.275% - .78125rem)}.Page-module--page--2nMky:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--2nMky:last-child{margin-right:0}.Page-module--page--2nMky:nth-child(12n){margin-right:0;float:right}.Page-module--page--2nMky:nth-child(12n+1){clear:both}.Page-module--page__inner--2M_vz{padding:1.875rem 1.25rem}}@media screen and (min-width:960px){.Page-module--page--2nMky{width:calc(66.6% - .625rem)}.Page-module--page--2nMky:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--2nMky:last-child{margin-right:0}.Page-module--page--2nMky:nth-child(3n){margin-right:0;float:right}.Page-module--page--2nMky:nth-child(3n+1){clear:both}.Page-module--page__inner--2M_vz{padding:2.5rem 2.1875rem}}.Pagination-module--pagination--2H3nO{margin-top:2.5rem;display:flex}.Pagination-module--pagination__prev--bet5s{width:50%;text-align:left}.Pagination-module--pagination__prev-link--1Nzs6{color:#a9d159;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__prev-link--1Nzs6:focus,.Pagination-module--pagination__prev-link--1Nzs6:hover{color:#918d40}.Pagination-module--pagination__prev-link--disable--Yklx9{pointer-events:none;color:#bbb}.Pagination-module--pagination__next--3hFiN{width:50%;text-align:right}.Pagination-module--pagination__next-link--3FUtA{color:#a9d159;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__next-link--3FUtA:focus,.Pagination-module--pagination__next-link--3FUtA:hover{color:#918d40}.Pagination-module--pagination__next-link--disable--30UwZ{pointer-events:none;color:#bbb}.Author-module--author--2Yefr{border-top:1px solid #e6e6e6;max-width:43.75rem;padding-top:1.25rem;line-height:1.25rem;margin-top:1.25rem;margin-bottom:2.5rem}.Author-module--author__bio-twitter--n-O9n{display:block;text-decoration:underline}@media screen and (min-width:685px){.Author-module--author--2Yefr{margin-left:auto;margin-right:auto}}.Content-module--content--3p512{max-width:62.8125rem;padding:0 .9375rem;margin:0 auto}.Content-module--content__title--2BDW9{font-size:1.75rem;max-width:43.75rem;font-weight:600;text-align:center;line-height:2.0625rem;margin:1.25rem auto 0}.Content-module--content__body--2TrQ- figure{margin-bottom:1.25rem}.Content-module--content__body--2TrQ- figure blockquote{font-style:italic;text-align:center;margin-top:0;padding:1.25rem 0}.Content-module--content__body--2TrQ- figure blockquote p{max-width:43.75rem;font-size:1.47149rem;margin-top:1.25rem;margin-bottom:1.25rem;line-height:1.875rem}.Content-module--content__body--2TrQ- a{text-decoration:underline}.Content-module--content__body--2TrQ- *{max-width:43.75rem;margin-left:auto;margin-right:auto}.Content-module--content__body--2TrQ- img{max-width:100%;margin-top:.625rem;margin-bottom:.625rem}.Content-module--content__body--2TrQ- li ul{margin-bottom:.625rem}.Content-module--content__body--2TrQ- li p{line-height:1.25rem;margin-bottom:.625rem}.Content-module--content__body--2TrQ- h2{position:relative;padding:1rem 1.5rem;color:#fff;border-radius:.625rem;background:#0c0000}.Content-module--content__body--2TrQ- h2:after{position:absolute;bottom:-9px;left:1rem;width:0;height:0;content:"";border-color:#0c0000 transparent transparent;border-style:solid;border-width:10px 10px 0}.Content-module--content__body--2TrQ- h3{border-bottom:3px dotted #0c0000;padding:1rem 0}@media screen and (min-width:960px){.Content-module--content--3p512{padding:0}.Content-module--content__title--2BDW9{font-size:1.75rem;line-height:2.8125rem;margin-top:2.8125rem;margin-bottom:1.875rem}.Content-module--content__body--2TrQ-,.Content-module--content__body--2TrQ- p{font-size:.98438rem;line-height:1.40625rem;margin-bottom:1.40625rem}.Content-module--content__body--2TrQ- li p{line-height:1.25rem;margin-bottom:.625rem}}.Meta-module--meta__date--29eD7{font-style:italic}.Tags-module--tags--1L_ct{margin-bottom:.625rem}.Tags-module--tags__list--91FqN{list-style:none;margin:0 -.625rem;padding:0}.Tags-module--tags__list-item--1M30P{display:inline-block;margin:.625rem .3125rem}.Tags-module--tags__list-item-link--3SL_8{display:inline-block;height:2.1875rem;padding:0 1.5rem;line-height:2.1875rem;border:1px solid #e6e6e6;text-decoration:none;border-radius:1.25rem;color:#222}.Tags-module--tags__list-item-link--3SL_8:focus,.Tags-module--tags__list-item-link--3SL_8:hover{color:#918d40}.Post-module--post__comments--25y6I,.Post-module--post__footer--3WzWU{max-width:43.75rem;margin:0 auto;padding:0 .9375rem}.Post-module--post__home-button--16Kl0{display:block;max-width:5.625rem;height:2.1875rem;padding:0 1.5rem;line-height:2.1875rem;text-align:center;color:#222;border:1px solid #e6e6e6;border-radius:1.25rem;font-size:.875rem;font-weight:400;margin-left:auto;margin-right:auto;margin-top:1.25rem}.Post-module--post__home-button--16Kl0:focus,.Post-module--post__home-button--16Kl0:hover{color:#918d40}@media screen and (min-width:960px){.Post-module--post__comments--25y6I,.Post-module--post__footer--3WzWU{padding:0}.Post-module--post__home-button--16Kl0{position:fixed;max-width:auto;margin:0;top:30px;left:30px}}</style><meta name="generator" content="Gatsby 2.32.13"/><link rel="alternate" type="application/rss+xml" title="かえるのひみつきち" href="/rss.xml"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-122086587-6"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-122086587-6', {"send_page_view":false});
      }
      </script><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="icon" href="/favicon-32x32.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#F7A046"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><title data-react-helmet="true">Google CTF 2023 Writeup - かえるのひみつきち</title><meta data-react-helmet="true" name="description" content="Google CTF 2023 sの Writeup です。"/><meta data-react-helmet="true" property="og:site_name" content="Google CTF 2023 Writeup - かえるのひみつきち"/><meta data-react-helmet="true" property="og:image" content="https://kashiwaba-yuki.com/static/c7b638e2d319149851871f13c096b89f/ctf-googlectf.png"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:title" content="Google CTF 2023 Writeup - かえるのひみつきち"/><meta data-react-helmet="true" name="twitter:description" content="Google CTF 2023 sの Writeup です。"/><meta data-react-helmet="true" name="twitter:image" content="https://kashiwaba-yuki.com/static/c7b638e2d319149851871f13c096b89f/ctf-googlectf.png"/><link as="script" rel="preload" href="/webpack-runtime-a3c0f166cb4b802ff58f.js"/><link as="script" rel="preload" href="/framework-3761df4ab6ee9f056936.js"/><link as="script" rel="preload" href="/532a2f07-92db97c0addf07d5cb73.js"/><link as="script" rel="preload" href="/dc6a8720040df98778fe970bf6c000a41750d3ae-48010afb2e1fc1dc9086.js"/><link as="script" rel="preload" href="/app-52ce8ec918ec141d95ba.js"/><link as="script" rel="preload" href="/styles-407fe62976dc5310c43e.js"/><link as="script" rel="preload" href="/cd95ea5cbd2c605f26db819f07999610c9ff4310-c2f05dc74373de400085.js"/><link as="script" rel="preload" href="/component---src-templates-post-template-js-381c1b847824134fa4bd.js"/><link as="fetch" rel="preload" href="/page-data/ctf-googlectf/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/251939775.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/401334301.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/825871152.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="Layout-module--layout--3Pyz6"><div><a class="Post-module--post__home-button--16Kl0" href="/">All Articles</a><div><div class="Content-module--content--3p512"><h1 class="Content-module--content__title--2BDW9">Google CTF 2023 Writeup</h1><div class="Content-module--content__body--2TrQ-"><p>6/24 から開催されていた Google CTF 2023 に 0nePadding で参加して 195 位でした。</p>
<p>今回は Rev、Crypto、Misc を 1 問ずつ解きました。</p>
<p>去年と一昨年は参加したものの 1 問も解けずに撤退という感じでスコアボードにすら乗れずに終わっていたので、ちょっとした成長を実感できる機会でした。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 904px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/15e6a3e08247f719837ec5442f53477d/d9217/image-20230626081855374.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 67.91666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACnklEQVQ4y3VTyW4TQRCd/w4HDggU8gPAAaGwJVxyiHIADhARsQiTSHa8tD2ZzbP09Cw9i5eEBB5VbYwSAYfSVNe8fl3LK2swGMBxHIjxGLZ9hiRJUNU1dFWhIqvJb5oGbdtSTCOOYwRBgDAMzXft+75vcFav1zOBiW3DnthI0xQNETV0uSbAmrCuahyffMXh4Xvs7r7CwcEBtre3sbe3Z2x/fx95nsMqyxKpTE1mSRIjyzJMAxtnjmsA6+w428lkYoyTGA6H6Ha76Pf74CpPT0+htYbFBEzGmUkpTUlhHCFJFTJFluWGuCgK8ON8qbrWjusx5rLSVCKY+tS3EiqTVLqA5znUEwexjAhIF6qC/ms0bYWizE2saWu0sxpxEiIvMsznM0RRBCtXFWJfY17/RKmWcMcR4qCAIyLo7NzE2RYNcD4DmvLSnC/I/74AsoRaoq+wXFxShgqWkK/xzt/Asd7CF3UXb0YbeDO8hbdiA51ic2XlJr6RHev7hLmHTr7yT6otfJjewcf0NuK2gyKrYZ3JT/jsPsBQ76CbPsWReIij0SN0k+cYFGwvMChXNtIv0VPP0M/Z34God9Hxn+BEPoZqh8gVD0WWVHKJWXUFrRZwJhE8O0YaasiQeuQXyJMZ/f9hSq3yc7S/y162IIym1iwxn12A52GxVFzXMY1P04Tk0CeBj6nZEZSSkBQrygylLghDg1OpGQL7NQ3KD1zCxCStBtPplAkTeK5nNoP1OBj0MRoJCCEQEoBFz7JYS0ORlFhGfGbZMIlZBtIry87iUXueZwCsu/FY0MZM6NUViO1/hHz2fc8Q3SR0V4QMHlNmgjLk3VzvalEWfxGyoFeEPhKZmGy52psZktKFGJkH+NLa/pXhilBTyQFVI/8Q/gIKMgBzOM6NkwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/15e6a3e08247f719837ec5442f53477d/8ac56/image-20230626081855374.webp 240w,
/static/15e6a3e08247f719837ec5442f53477d/d3be9/image-20230626081855374.webp 480w,
/static/15e6a3e08247f719837ec5442f53477d/82aba/image-20230626081855374.webp 904w"
              sizes="(max-width: 904px) 100vw, 904px"
              type="image/webp"
            />
          <source
            srcset="/static/15e6a3e08247f719837ec5442f53477d/8ff5a/image-20230626081855374.png 240w,
/static/15e6a3e08247f719837ec5442f53477d/e85cb/image-20230626081855374.png 480w,
/static/15e6a3e08247f719837ec5442f53477d/d9217/image-20230626081855374.png 904w"
            sizes="(max-width: 904px) 100vw, 904px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/15e6a3e08247f719837ec5442f53477d/d9217/image-20230626081855374.png"
            alt="image-20230626081855374"
            title="image-20230626081855374"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>また、Crypto の問題は 1 人では解けず、チームメンバーと相談しながら進めたおかげで解けたものだったので、0nePadding のチームとしても去年より活発に動いていることを実感しました。</p>
<p>解けなかった問題は後日復習するとして、とりあえず解けた問題のみまとめておきます。</p>
<!-- omit in toc -->
<h2 id="もくじ" style="position:relative;"><a href="#%E3%82%82%E3%81%8F%E3%81%98" aria-label="もくじ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>もくじ</h2>
<ul>
<li><a href="#zermattrev">ZERMATT(Rev)</a></li>
<li><a href="#least-common-genominatorcrypto">LEAST COMMON GENOMINATOR?(Crypto)</a></li>
<li><a href="#papapapamisc">PAPAPAPA(Misc)</a></li>
<li><a href="#%E3%81%BE%E3%81%A8%E3%82%81">まとめ</a></li>
</ul>
<h2 id="zermattrev" style="position:relative;"><a href="#zermattrev" aria-label="zermattrev permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ZERMATT(Rev)</h2>
<blockquote>
<p>Roblox made lua packing popular, since we’d like to keep hanging out with the cool kids, he’s our take on it.</p>
</blockquote>
<p>問題バイナリとして非常に長い難読化された lua スクリプトファイルが与えられます。</p>
<p>難読化されたスクリプトを整形して表示してみると 3000 行くらいのボリュームになりましたが、以下のように冒頭部分でごちゃごちゃした処理をしていることがわかります。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/89d55cf1ecffc5ab4e00be0c172cb720/00d43/image-20230626232514302.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 106.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsTAAALEwEAmpwYAAACeUlEQVQ4y6VUV47rMBDLQeLEsrrckzjb738sPs44bfGwwJaPgSwpoUhO2dTGYEgDpm7Ax9RgPhyw3++x2+1+FRsjgLHH2HZYpoJumLDXy70C/zQ2TdPAuYgcMvrkkPoRhmfy2q8ArbWojcXSP2EgO9MYiA1/AHQqMfmErvRoU0TgI9VfAHf7HXzjMHYd+jbCUnJVVTejq+qz8Y93Gg/7jXPugl4jhsAs95iGAcEHiL+WFnjX6PcaBvIfY/htea/h9K6u64tkAsrGkaX3Dn2X4Xgu/t4B7e2BbwBSsvWIPlL+HttthW21hsh93F/jS8nCItqoHtYEFknKwpKZle9aV+/WvZ6Z+ssqUMDkEjul4DxFnOeC52PG0yFjaD0L3uMwRMy9BD3uAs+C3smjoqB6SNymIWCg3GXu8XrKeF86vJ1bPM0ZOVqUZFlODl12LKl7yF7uRcFVzdopBCy+kMXA1gt4ObR4XVq8HAtZr2zOBF+mtDIk02VOaLNHCvb2QGDibpKLz5h6Ao4BzzMBTwWnMSmYAJ0Zy5Rx5NmZYCcBv9gg4PJgG51KV8DsMn80klXC26nDOyU/H4t6d2Ssa8ChF5YMlpVYYepVrkZj7gwDszzkjtGwBa1KkRCPpAajb1SSrNGxKpxnza3J0M7Z3b/VQx1f3UjPHF9PKuPKTpiK7BKcJiAQVBjV9X1mfi4bVn2wgSaLRI8PZlkSIqUzdVG9fLmAavkwUYndJGyvSq4D+SbZNZKxqDV3HAtrLDJzawZFtshtH8qm8KxhcQtLw/U/QMMumcqMgdPGckAYtqN4tP7oe6P/CrqRpq85aaYyIsaoo0lAfjoHr6D/AGolVQG7lbvWAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/89d55cf1ecffc5ab4e00be0c172cb720/8ac56/image-20230626232514302.webp 240w,
/static/89d55cf1ecffc5ab4e00be0c172cb720/d3be9/image-20230626232514302.webp 480w,
/static/89d55cf1ecffc5ab4e00be0c172cb720/e46b2/image-20230626232514302.webp 960w,
/static/89d55cf1ecffc5ab4e00be0c172cb720/a5d4d/image-20230626232514302.webp 1000w"
              sizes="(max-width: 960px) 100vw, 960px"
              type="image/webp"
            />
          <source
            srcset="/static/89d55cf1ecffc5ab4e00be0c172cb720/8ff5a/image-20230626232514302.png 240w,
/static/89d55cf1ecffc5ab4e00be0c172cb720/e85cb/image-20230626232514302.png 480w,
/static/89d55cf1ecffc5ab4e00be0c172cb720/d9199/image-20230626232514302.png 960w,
/static/89d55cf1ecffc5ab4e00be0c172cb720/00d43/image-20230626232514302.png 1000w"
            sizes="(max-width: 960px) 100vw, 960px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/89d55cf1ecffc5ab4e00be0c172cb720/d9199/image-20230626232514302.png"
            alt="image-20230626232514302"
            title="image-20230626232514302"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>よく見ると、v7 という関数に 2 つのバイト文字を与えた戻り値を lua のグローバル環境変数 <code class="language-text">_G</code> のキーとして与えています。</p>
<p>ここで、以下のようなスクリプトを使ってそれぞれの処理結果を見てみました。</p>
<div class="gatsby-highlight" data-language="lua"><pre class="language-lua"><code class="language-lua"><span class="token keyword">local</span> v0 <span class="token operator">=</span> string<span class="token punctuation">.</span>char<span class="token punctuation">;</span>
<span class="token keyword">local</span> v1 <span class="token operator">=</span> string<span class="token punctuation">.</span>byte<span class="token punctuation">;</span>
<span class="token keyword">local</span> v2 <span class="token operator">=</span> string<span class="token punctuation">.</span>sub<span class="token punctuation">;</span>
<span class="token keyword">local</span> v3 <span class="token operator">=</span> bit32 <span class="token keyword">or</span> bit<span class="token punctuation">;</span>
<span class="token keyword">local</span> v4 <span class="token operator">=</span> v3<span class="token punctuation">.</span>bxor<span class="token punctuation">;</span>
<span class="token keyword">local</span> v5 <span class="token operator">=</span> table<span class="token punctuation">.</span>concat<span class="token punctuation">;</span>
<span class="token keyword">local</span> v6 <span class="token operator">=</span> table<span class="token punctuation">.</span>insert<span class="token punctuation">;</span>
<span class="token keyword">local</span> <span class="token keyword">function</span> <span class="token function">v7</span><span class="token punctuation">(</span>v24<span class="token punctuation">,</span> v25<span class="token punctuation">)</span>
    <span class="token keyword">local</span> v26 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">local</span> v27<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token keyword">true</span> <span class="token keyword">do</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>v26 <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">then</span>
            <span class="token keyword">return</span> <span class="token function">v5</span><span class="token punctuation">(</span>v27<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>v26 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">then</span>
            v27 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> v44 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">#</span>v24 <span class="token keyword">do</span>
                <span class="token function">v6</span><span class="token punctuation">(</span>v27<span class="token punctuation">,</span> <span class="token function">v0</span><span class="token punctuation">(</span>
                    <span class="token function">v4</span><span class="token punctuation">(</span><span class="token function">v1</span><span class="token punctuation">(</span><span class="token function">v2</span><span class="token punctuation">(</span>v24<span class="token punctuation">,</span> v44<span class="token punctuation">,</span> v44 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">v1</span><span class="token punctuation">(</span><span class="token function">v2</span><span class="token punctuation">(</span>v25<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v44 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token operator">#</span>v25<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v44 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token operator">#</span>v25<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">end</span>
            v26 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">v7</span><span class="token punctuation">(</span><span class="token string">"\79\15\131\30\40\13\20\203"</span><span class="token punctuation">,</span> <span class="token string">"\59\96\237\107\69\111\113\185"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">v7</span><span class="token punctuation">(</span><span class="token string">"\55\2\190\232\63\247"</span><span class="token punctuation">,</span> <span class="token string">"\68\118\204\129\81\144\122"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">v7</span><span class="token punctuation">(</span><span class="token string">"\12\180\100\225"</span><span class="token punctuation">,</span> <span class="token string">"\110\205\16\132\107\85\33\139"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">v7</span><span class="token punctuation">(</span><span class="token string">"\243\205\101\215\89\95"</span><span class="token punctuation">,</span> <span class="token string">"\128\185\23\190\55\56\100"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">v7</span><span class="token punctuation">(</span><span class="token string">"\240\94\174\46"</span><span class="token punctuation">,</span><span class="token string">"\147\54\207\92\126\115\131"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">v7</span><span class="token punctuation">(</span><span class="token string">"\109\25\35\60\115\10"</span><span class="token punctuation">,</span> <span class="token string">"\30\109\81\85\29\109"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">v7</span><span class="token punctuation">(</span><span class="token string">"\239\234\115"</span><span class="token punctuation">,</span> <span class="token string">"\156\159\17\52\214\86\190"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">v7</span><span class="token punctuation">(</span><span class="token string">"\175\186\253\180\178\169"</span><span class="token punctuation">,</span> <span class="token string">"\220\206\143\221"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">v7</span><span class="token punctuation">(</span><span class="token string">"\213\149\104\47"</span><span class="token punctuation">,</span> <span class="token string">"\178\230\29\77\119\184\172"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">v7</span><span class="token punctuation">(</span><span class="token string">"\235\225\172\3\21\112"</span><span class="token punctuation">,</span> <span class="token string">"\152\149\222\106\123\23"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">v7</span><span class="token punctuation">(</span><span class="token string">"\167\216\54"</span><span class="token punctuation">,</span> <span class="token string">"\213\189\70\150\35"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">v7</span><span class="token punctuation">(</span><span class="token string">"\28\78\87\120\13"</span><span class="token punctuation">,</span> <span class="token string">"\104\47\53\20"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">v7</span><span class="token punctuation">(</span><span class="token string">"\12\172\66\130\29\168"</span><span class="token punctuation">,</span> <span class="token string">"\111\195\44\225\124\220"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">v7</span><span class="token punctuation">(</span><span class="token string">"\191\217\68\12\118"</span><span class="token punctuation">,</span> <span class="token string">"\203\184\38\96\19\203"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">v7</span><span class="token punctuation">(</span><span class="token string">"\199\55\96\124\83\218"</span><span class="token punctuation">,</span> <span class="token string">"\174\89\19\25\33"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">v7</span><span class="token punctuation">(</span><span class="token string">"\6\46\6\90"</span><span class="token punctuation">,</span> <span class="token string">"\107\79\114\50\46\151\231"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">v7</span><span class="token punctuation">(</span><span class="token string">"\204\61\163\173\57"</span><span class="token punctuation">,</span> <span class="token string">"\160\89\198\213\73\234\89\215"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">v7</span><span class="token punctuation">(</span><span class="token string">"\194\77\101\178\251\203\94"</span><span class="token punctuation">,</span> <span class="token string">"\165\40\17\212\158"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">v7</span><span class="token punctuation">(</span><span class="token string">"\53\224\205\5\54\50\228\205\9\49\42\224"</span><span class="token punctuation">,</span> <span class="token string">"\70\133\185\104\83"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">v7</span><span class="token punctuation">(</span><span class="token string">"\217\7\68\72\38"</span><span class="token punctuation">,</span> <span class="token string">"\169\100\37\36\74"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">v7</span><span class="token punctuation">(</span><span class="token string">"\67\5\139\167\83\20"</span><span class="token punctuation">,</span> <span class="token string">"\48\96\231\194"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">v7</span><span class="token punctuation">(</span><span class="token string">"\150\198\74\15\46\18"</span><span class="token punctuation">,</span> <span class="token string">"\227\168\58\110\77\121\184\207"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">v7</span><span class="token punctuation">(</span><span class="token string">"\177\122\62\179\69"</span><span class="token punctuation">,</span> <span class="token string">"\197\27\92\223\32\209\187\17"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">v7</span><span class="token punctuation">(</span><span class="token string">"\238\13\79\194\248\8"</span><span class="token punctuation">,</span> <span class="token string">"\155\99\63\163"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">v7</span><span class="token punctuation">(</span><span class="token string">"\144\141\223\180\128\187\129\144"</span><span class="token punctuation">,</span> <span class="token string">"\228\226\177\193\237\217"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div>
<p>これを実行すると以下のような文字列がデコードされます。</p>
<p>これを引数として与えることで、関数を変数に格納しようとしていることがわかります。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/0bbaf3949f2a9cb0c1a1c64cd725166a/1d69c/image-20230626234434239.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 69.58333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABH0lEQVQ4y62TXU/CMBSGezVAQ1iiiVEQmcMYZeu6L3EgjpmhSKJGpsmI0Qv//3947UpcYPiRZbt409PT0yc9b1sS2gHCyxCsQ8H2zkFlDT3ZENIaOh9ZOu81KM9RnMkmjB0LN0d9oXHbRah4GB1YIHH/AXfKAIakgFVUsNrxuqrKRs5Mclya1BHSpWWsVxSQyLkXZFrlxVtdGDnEfhCJB08YH7op8C8oq6nLmI9p7UosgG9XzxvAIiKx94jrpl0ecG5N4e3q5QEX3MOgfSFuqBTgR/CK0b65BswanQv4OVngtjtMIUVgactze4qJOoRdPy0OfHFn8JtO7pZ/e4vk3Y/gtziQf53vxf+Aq/ZkrRIeRs4M5vZJrnaT2mRP9oRfe72JkaGaOQ4AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/0bbaf3949f2a9cb0c1a1c64cd725166a/8ac56/image-20230626234434239.webp 240w,
/static/0bbaf3949f2a9cb0c1a1c64cd725166a/d3be9/image-20230626234434239.webp 480w,
/static/0bbaf3949f2a9cb0c1a1c64cd725166a/08b4d/image-20230626234434239.webp 750w"
              sizes="(max-width: 750px) 100vw, 750px"
              type="image/webp"
            />
          <source
            srcset="/static/0bbaf3949f2a9cb0c1a1c64cd725166a/8ff5a/image-20230626234434239.png 240w,
/static/0bbaf3949f2a9cb0c1a1c64cd725166a/e85cb/image-20230626234434239.png 480w,
/static/0bbaf3949f2a9cb0c1a1c64cd725166a/1d69c/image-20230626234434239.png 750w"
            sizes="(max-width: 750px) 100vw, 750px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/0bbaf3949f2a9cb0c1a1c64cd725166a/1d69c/image-20230626234434239.png"
            alt="image-20230626234434239"
            title="image-20230626234434239"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>この結果を元に難読化されたスクリプトを復元してみると以下のようになりました。</p>
<div class="gatsby-highlight" data-language="lua"><pre class="language-lua"><code class="language-lua"><span class="token keyword">local</span> v8 <span class="token operator">=</span> _G<span class="token punctuation">[</span><span class="token string">"tonumber"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">local</span> v9 <span class="token operator">=</span> _G<span class="token punctuation">[</span><span class="token string">"string"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"byte"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">local</span> v10 <span class="token operator">=</span> _G<span class="token punctuation">[</span><span class="token string">"string"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"char"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">local</span> v11 <span class="token operator">=</span> _G<span class="token punctuation">[</span><span class="token string">"string"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"sub"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">local</span> v12 <span class="token operator">=</span> _G<span class="token punctuation">[</span><span class="token string">"string"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"gsub"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">local</span> v13 <span class="token operator">=</span> _G<span class="token punctuation">[</span><span class="token string">"string"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"rep"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">local</span> v14 <span class="token operator">=</span> _G<span class="token punctuation">[</span><span class="token string">"table"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"concat"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">local</span> v15 <span class="token operator">=</span> _G<span class="token punctuation">[</span><span class="token string">"table"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"insert"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">local</span> v16 <span class="token operator">=</span> _G<span class="token punctuation">[</span><span class="token string">"math"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"ldexp"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">local</span> v17 <span class="token operator">=</span> _G<span class="token punctuation">[</span><span class="token string">"getfenv"</span><span class="token punctuation">]</span> <span class="token keyword">or</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">return</span> _ENV<span class="token punctuation">;</span> <span class="token keyword">end</span><span class="token punctuation">;</span>
<span class="token keyword">local</span> v18 <span class="token operator">=</span> _G<span class="token punctuation">[</span><span class="token string">"setmetatable"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">local</span> v19 <span class="token operator">=</span> _G<span class="token punctuation">[</span><span class="token string">"pcall"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">local</span> v20 <span class="token operator">=</span> _G<span class="token punctuation">[</span><span class="token string">"select"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">local</span> v21 <span class="token operator">=</span> _G<span class="token punctuation">[</span><span class="token string">"unpack"</span><span class="token punctuation">]</span> <span class="token keyword">or</span> _G<span class="token punctuation">[</span><span class="token string">"table"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"unpack"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">local</span> v22 <span class="token operator">=</span> _G<span class="token punctuation">[</span><span class="token string">"tonumber"</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre></div>
<p>ここでは、lua のグローバルテーブルを使用して各関数のアドレスを変数に保存しているようです。</p>
<p>僕の環境の lua5.2 を使用した場合のグローバルテーブルには、以下のような定義が行われていました。</p>
<div class="gatsby-highlight" data-language="lua"><pre class="language-lua"><code class="language-lua"><span class="token keyword">for</span> n <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>_G<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token function">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">end</span>
<span class="token operator">></span>
pairs
loadstring
package
tostring
load
rawlen
_G
setmetatable
assert
require
error
os
unpack
getmetatable
string
dofile
tonumber
_VERSION
rawequal
collectgarbage
bit32
coroutine
debug
table
io
pcall
type
math
xpcall
next
arg
module
rawget
loadfile
print
ipairs
select
rawset</code></pre></div>
<p>参考：<a href="https://www.lua.org/pil/14.html" target="_blank" rel="nofollow noopener noreferrer">Programming in Lua : 14</a></p>
<p>この結果を元に関数が代入された変数を置き換えてあげると、多少コードが読みやすくなります。</p>
<p>そして、さらに問題バイナリを読み解いていくと、かなりの量の不要な処理でコード量のかさ増しが行われていることがわかります。</p>
<p>例えば、以下のようなコードです。</p>
<div class="gatsby-highlight" data-language="lua"><pre class="language-lua"><code class="language-lua"><span class="token keyword">if</span> <span class="token punctuation">(</span>v89 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">then</span>
    <span class="token keyword">local</span> v130 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token keyword">true</span> <span class="token keyword">do</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>v130 <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">then</span>
            v89 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> v130<span class="token punctuation">)</span> <span class="token keyword">then</span>
            v90 <span class="token operator">=</span> <span class="token keyword">nil</span><span class="token punctuation">;</span> 
            <span class="token keyword">if</span> <span class="token keyword">not</span> v87 <span class="token keyword">then</span>
                <span class="token keyword">local</span> v166 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">local</span> v167<span class="token punctuation">;</span>
                <span class="token keyword">while</span> <span class="token keyword">true</span> <span class="token keyword">do</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>v166 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">then</span>
                        v167 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> 
                        <span class="token keyword">while</span> <span class="token keyword">true</span> <span class="token keyword">do</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>v167 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">then</span>
                                v87 <span class="token operator">=</span> <span class="token function">v37</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
                                <span class="token keyword">if</span> <span class="token punctuation">(</span>v87 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span> <span class="token keyword">end</span>
                                <span class="token keyword">break</span><span class="token punctuation">;</span>
                            <span class="token keyword">end</span> 
                        <span class="token keyword">end</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token keyword">end</span> 
                <span class="token keyword">end</span>
            <span class="token keyword">end</span>
            v130 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span></code></pre></div>
<p>よく見てみると、最終的に<code class="language-text">v87 = v37();</code>の定義を行ったのみでループを抜け出しています。</p>
<p>このような構造がスクリプト内にいくつも存在しているため、これらの処理を削除していくことで難読化を解除していくことが可能です。</p>
<p>不要な処理をある程度削ったところでデバッガを駆使しながらプログラムの動作を追っていくと、以下のように正しい Flag を一文字ずつ取得しているコードが見つかります。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/fa0d2a20e7e09585e4ac5e76f8b0bb17/947d2/image-20230625163128387.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 46.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABU0lEQVQoz22SV27EMAxE9xCx100WVd0Db35y/5NNRnJJAuzHgDAlPo5IP7zzaJoGz+czR9UrxhbWGsTgYYyBUOaUiEEYJvg4QKyD1hpKqVsPZwM6pVFVVVYCl2WJvte5OBUkiQg0leI0r1nWet7rs657D+cGaOPoqkbbtrdbrSU7ui7+Qo9GM4HbtsOHITe6wHQY0bM4Qaq6vl3+BYpcOhwKc2lU4zjBMeZGl0NR/CD5mEGHmsCi+LifnOIhOaVhtCVsQfQjaw26LtUmBoHD/Inp9Y2w7BwyuxkLRXepcwiCGDUjxRhPhdBj3Qa8XivGgcuLvMeY8o/AGcY4ZpCWQ4ouLmCGhf/Q4HvMa8S2Lzkfo8nyPgG55TSvqm5QFkVWenLKvX+y5DPLRYYY2didszXZyOFw/YKbd2jChWq74zd4vxRNmOEMZwzTwuWE/JoENjz/AY1a+DecdCDuAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/fa0d2a20e7e09585e4ac5e76f8b0bb17/8ac56/image-20230625163128387.webp 240w,
/static/fa0d2a20e7e09585e4ac5e76f8b0bb17/d3be9/image-20230625163128387.webp 480w,
/static/fa0d2a20e7e09585e4ac5e76f8b0bb17/e46b2/image-20230625163128387.webp 960w,
/static/fa0d2a20e7e09585e4ac5e76f8b0bb17/f992d/image-20230625163128387.webp 1440w,
/static/fa0d2a20e7e09585e4ac5e76f8b0bb17/846bd/image-20230625163128387.webp 1773w"
              sizes="(max-width: 960px) 100vw, 960px"
              type="image/webp"
            />
          <source
            srcset="/static/fa0d2a20e7e09585e4ac5e76f8b0bb17/8ff5a/image-20230625163128387.png 240w,
/static/fa0d2a20e7e09585e4ac5e76f8b0bb17/e85cb/image-20230625163128387.png 480w,
/static/fa0d2a20e7e09585e4ac5e76f8b0bb17/d9199/image-20230625163128387.png 960w,
/static/fa0d2a20e7e09585e4ac5e76f8b0bb17/07a9c/image-20230625163128387.png 1440w,
/static/fa0d2a20e7e09585e4ac5e76f8b0bb17/947d2/image-20230625163128387.png 1773w"
            sizes="(max-width: 960px) 100vw, 960px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/fa0d2a20e7e09585e4ac5e76f8b0bb17/d9199/image-20230625163128387.png"
            alt="image-20230625163128387"
            title="image-20230625163128387"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>これで Flag を取得できました。</p>
<p>正解時のアニメーションがおしゃれでした。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 746px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/f690030d1341bc63218153c21047064e/62de4/image-20230625163221330.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 137.08333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAYAAAB836/YAAAACXBIWXMAAAsTAAALEwEAmpwYAAAD10lEQVRIx51VW08bRxTe/1EpykOlhCZ/on+gTxVV1edUiipVVHlKRCWSqCQKSXoB4VAriJgY1wTwFRLAwcY3fFl7vfaub2uvvbYB8Su+zJl0kmUxUtWHT2f2zM43Z86Z842kKAp8Ph/8fj+Wl5fhdruxv7+PWCyGcrmM0WiEfr/P0ev1zlnDMJBMJrGzs8PXVKtVSN1uF61WC2RN00Sn0+E/W5Z1ztpJ7YS0ltaJsUQRnJ6e4uTkBMPhkGMwGHAiO5kgEiASQWyHRIuJnSIjMiKxEzojdJI7vyWKLBqNIp1O4+zsjJMJ2EkFsTOPzlNIFHqz2eQ5FEehMYGiFtG3221uyS/GdtA6fmSlrCCdSqMkl5GIJ1DIF5HP5zmy2SzH0dERr2apVOL+XC7HrSzL/CbQPzTmRWm262ibdfRHbHeLVYyhYxow2sanSMjSKcjqus6jpjFBVFeMpUraRHrDRD7SRz7aRzbQR0PpwRr2L1TUbsURL1R512VicbKL5VtdrNw24fq+g2zQxPCU5bJjnsupE84NeVEaehOlggpFrkEt66gqdVQUlU+Kwohi2IsgSEW0glTStBqi2xGEIyGEwkEEQwGEwyFkM1leCEI8HketVkMqlfrko0LQdyaTQaFQwOHhIS+aVK/XUSzKrMol7pCZLRaLqFQqF47rjNCZUx4hXeDj42MuAgKiY8SP4/Jnb71znTKujS4rwn8iHNen9kTbo3T6xl6bcc7LSO25GtfL/4vQfrxx4vEvodjls6L0zN4FDXRuPE6VJGvAJkYsdLLDj9YasMWE/uWEQjeFIAtiqduy0FQsdJoWDI3ZhoWW+tln10eh6OJ60XWzXzmak4xGD9VCF3qlC63EoHRQkzvMZ0BXSUVaXE3siiIgdFBcep7DmOxCsPkNgvp3CDcmEahNIqh9i7D+A96nA4gfJJE4TPDWopZLJBK85UjhxTfNEeillN7KD/FH/Au4khO4/89VLGWu4+/cNTzaugbv+guseX147X2FxcUFzM09werqKpaWljA7O4v5+Xl4PCt488bPn+K9vT0mX+XHuLdyBQ+8N/Hb+g082riBe+4J/PTkKmYXfoRr3oPpuw/wcGYOL90rePp0DjMzM5j6ZQrT07/ir99fYOFPN549e/4xwsjRfbxuXYFXv4m1xgReqdfhqX4Fj/Yl1spfYzN9B1vZKQRyP+Nd6iV238XYwj28j8Xxdn8Dm6k7iOTvInawi+3oNqRag70P2haKWhgFLYiiHuIoaAz6FvJ1Pwr1dWZ9kKsHUCtMN9UKQxVqjSlUMwi5sYmKqkDXdHwANyw+DpUXSOEAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/f690030d1341bc63218153c21047064e/8ac56/image-20230625163221330.webp 240w,
/static/f690030d1341bc63218153c21047064e/d3be9/image-20230625163221330.webp 480w,
/static/f690030d1341bc63218153c21047064e/f7ebd/image-20230625163221330.webp 746w"
              sizes="(max-width: 746px) 100vw, 746px"
              type="image/webp"
            />
          <source
            srcset="/static/f690030d1341bc63218153c21047064e/8ff5a/image-20230625163221330.png 240w,
/static/f690030d1341bc63218153c21047064e/e85cb/image-20230625163221330.png 480w,
/static/f690030d1341bc63218153c21047064e/62de4/image-20230625163221330.png 746w"
            sizes="(max-width: 746px) 100vw, 746px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/f690030d1341bc63218153c21047064e/62de4/image-20230625163221330.png"
            alt="image-20230625163221330"
            title="image-20230625163221330"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<h2 id="least-common-genominatorcrypto" style="position:relative;"><a href="#least-common-genominatorcrypto" aria-label="least common genominatorcrypto permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>LEAST COMMON GENOMINATOR?(Crypto)</h2>
<blockquote>
<p>Someone used this program to send me an encrypted message but I can’t read it! It uses something called an LCG, do you know what it is? I dumped the first six consecutive values generated from it but what do I do with it?!</p>
</blockquote>
<p>珍しく Crypto を 1 問解いたので書いておきます。</p>
<p>問題バイナリとして与えられた以下のスクリプトを読みました。</p>
<p>どうやら LCG(Linear Congruential Generator) によって生成された素数を使用して生成した鍵で Flag を暗号化しているようだということがわかります。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> secret <span class="token keyword">import</span> config
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSA
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> bytes_to_long<span class="token punctuation">,</span> isPrime

<span class="token keyword">class</span> <span class="token class-name">LCG</span><span class="token punctuation">:</span>
    lcg_m <span class="token operator">=</span> config<span class="token punctuation">.</span>m
    lcg_c <span class="token operator">=</span> config<span class="token punctuation">.</span>c
    lcg_n <span class="token operator">=</span> config<span class="token punctuation">.</span>n

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> lcg_s<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>state <span class="token operator">=</span> lcg_s

    <span class="token keyword">def</span> <span class="token function">next</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>state <span class="token operator">*</span> self<span class="token punctuation">.</span>lcg_m <span class="token operator">+</span> self<span class="token punctuation">.</span>lcg_c<span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>lcg_n
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>state

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>

    <span class="token keyword">assert</span> <span class="token number">4096</span> <span class="token operator">%</span> config<span class="token punctuation">.</span>it <span class="token operator">==</span> <span class="token number">0</span>
    <span class="token keyword">assert</span> config<span class="token punctuation">.</span>it <span class="token operator">==</span> <span class="token number">8</span>
    <span class="token keyword">assert</span> <span class="token number">4096</span> <span class="token operator">%</span> config<span class="token punctuation">.</span>bits <span class="token operator">==</span> <span class="token number">0</span>
    <span class="token keyword">assert</span> config<span class="token punctuation">.</span>bits <span class="token operator">==</span> <span class="token number">512</span>

    <span class="token comment"># Find prime value of specified bits a specified amount of times</span>
    seed <span class="token operator">=</span> <span class="token number">211286818345627549183608678726370412218029639873054513839005340650674982169404937862395980568550063504804783328450267566224937880641772833325018028629959635</span>
    lcg <span class="token operator">=</span> LCG<span class="token punctuation">(</span>seed<span class="token punctuation">)</span>
    primes_arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    
    dump <span class="token operator">=</span> <span class="token boolean">True</span>
    items <span class="token operator">=</span> <span class="token number">0</span>
    dump_file <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"dump.txt"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span>

    primes_n <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>it<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
                prime_candidate <span class="token operator">=</span> lcg<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> dump<span class="token punctuation">:</span>
                    dump_file<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>prime_candidate<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
                    items <span class="token operator">+=</span> <span class="token number">1</span>
                    <span class="token keyword">if</span> items <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">:</span>
                        dump <span class="token operator">=</span> <span class="token boolean">False</span>
                        dump_file<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token keyword">not</span> isPrime<span class="token punctuation">(</span>prime_candidate<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    <span class="token keyword">continue</span>
                <span class="token keyword">elif</span> prime_candidate<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> config<span class="token punctuation">.</span>bits<span class="token punctuation">:</span>
                    <span class="token keyword">continue</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    primes_n <span class="token operator">*=</span> prime_candidate
                    primes_arr<span class="token punctuation">.</span>append<span class="token punctuation">(</span>prime_candidate<span class="token punctuation">)</span>
                    <span class="token keyword">break</span>
        
        <span class="token comment"># Check bit length</span>
        <span class="token keyword">if</span> primes_n<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">4096</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"bit length"</span><span class="token punctuation">,</span> primes_n<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            primes_arr<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
            primes_n <span class="token operator">=</span> <span class="token number">1</span>
            <span class="token keyword">continue</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">break</span>

    <span class="token comment"># Create public key 'n'</span>
    n <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> primes_arr<span class="token punctuation">:</span>
        n <span class="token operator">*=</span> j
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] Public Key: "</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] size: "</span><span class="token punctuation">,</span> n<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"bits"</span><span class="token punctuation">)</span>

    <span class="token comment"># Calculate totient 'Phi(n)'</span>
    phi <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">for</span> k <span class="token keyword">in</span> primes_arr<span class="token punctuation">:</span>
        phi <span class="token operator">*=</span> <span class="token punctuation">(</span>k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token comment"># Calculate private key 'd'</span>
    d <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>e<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> phi<span class="token punctuation">)</span>

    <span class="token comment"># Generate Flag</span>
    <span class="token keyword">assert</span> config<span class="token punctuation">.</span>flag<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">b"CTF{"</span><span class="token punctuation">)</span>
    <span class="token keyword">assert</span> config<span class="token punctuation">.</span>flag<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">b"}"</span><span class="token punctuation">)</span>
    enc_flag <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>config<span class="token punctuation">.</span>flag<span class="token punctuation">)</span>
    <span class="token keyword">assert</span> enc_flag <span class="token operator">&lt;</span> n

    <span class="token comment"># Encrypt Flag</span>
    _enc <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>enc_flag<span class="token punctuation">,</span> config<span class="token punctuation">.</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>

    <span class="token keyword">with</span> <span class="token builtin">open</span> <span class="token punctuation">(</span><span class="token string">"flag.txt"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> flag_file<span class="token punctuation">:</span>
        flag_file<span class="token punctuation">.</span>write<span class="token punctuation">(</span>_enc<span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span>n<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"little"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># Export RSA Key</span>
    rsa <span class="token operator">=</span> RSA<span class="token punctuation">.</span>construct<span class="token punctuation">(</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> config<span class="token punctuation">.</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span> <span class="token punctuation">(</span><span class="token string">"public.pem"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> pub_file<span class="token punctuation">:</span>
        pub_file<span class="token punctuation">.</span>write<span class="token punctuation">(</span>rsa<span class="token punctuation">.</span>exportKey<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div>
<p>LCG(線形合同法) は <code class="language-text">Xn+1 = (m*Xn + c) mod n</code> の漸化式で生成される一連の乱数です。</p>
<p>初期値である seed は問題スクリプトにハードコードされていましたが、m,c,n の 3 つの値は与えられていません。</p>
<p>ただし、dump.txt として最初の 6 個の乱数が与えられています。</p>
<p>これらの値から何かしらの方法で m,c,n を特定して鍵生成に使用する素数列を特定できそうだったので、チームメンバーと相談しながら調べてみたところ、以下の記事がみつかりました。</p>
<p>参考：<a href="https://satto.hatenadiary.com/entry/solve-LCG#A-multiplier-%E3%81%A8-B--increment-%E3%81%A8-M-modulus-%E3%81%8C%E6%9C%AA%E7%9F%A5%E3%81%A7%E3%81%82%E3%82%8B%E5%A0%B4%E5%90%88" target="_blank" rel="nofollow noopener noreferrer">線形合同法 (Linear Congruential Generators) によって生成される擬似乱数を予測する - s4tt01237’s diary</a></p>
<p>どうやら LCG の使用する設定値は、出力結果の最初のいくつかがわかっていれば、生成された値の最大公約数から特定した法と、法を元にした連立方程式による演算で特定できるようです。</p>
<p>これを利用して、以下のスクリプトで m,c,n の 3 つの値を特定できました。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> inverse<span class="token punctuation">,</span> GCD
<span class="token keyword">from</span> functools <span class="token keyword">import</span> <span class="token builtin">reduce</span>

prime_candidates <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2166771675595184069339107365908377157701164485820981409993925279512199123418374034275465590004848135946671454084220731645099286746251308323653144363063385</span><span class="token punctuation">,</span>
<span class="token number">6729272950467625456298454678219613090467254824679318993052294587570153424935267364971827277137521929202783621553421958533761123653824135472378133765236115</span><span class="token punctuation">,</span>
<span class="token number">2230396903302352921484704122705539403201050490164649102182798059926343096511158288867301614648471516723052092761312105117735046752506523136197227936190287</span><span class="token punctuation">,</span>
<span class="token number">4578847787736143756850823407168519112175260092601476810539830792656568747136604250146858111418705054138266193348169239751046779010474924367072989895377792</span><span class="token punctuation">,</span>
<span class="token number">7578332979479086546637469036948482551151240099803812235949997147892871097982293017256475189504447955147399405791875395450814297264039908361472603256921612</span><span class="token punctuation">,</span>
<span class="token number">2550420443270381003007873520763042837493244197616666667768397146110589301602119884836605418664463550865399026934848289084292975494312467018767881691302197</span><span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">solve_unknown_increment</span><span class="token punctuation">(</span>states<span class="token punctuation">,</span> A<span class="token punctuation">,</span> M<span class="token punctuation">)</span><span class="token punctuation">:</span>
    B <span class="token operator">=</span> <span class="token punctuation">(</span>states<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> A <span class="token operator">*</span> states<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> M
    <span class="token keyword">return</span> B

<span class="token keyword">def</span> <span class="token function">solve_unknown_multiplier</span><span class="token punctuation">(</span>states<span class="token punctuation">,</span> M<span class="token punctuation">)</span><span class="token punctuation">:</span>
    A <span class="token operator">=</span> <span class="token punctuation">(</span>states<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> states<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> inverse<span class="token punctuation">(</span><span class="token punctuation">(</span>states<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> states<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> M<span class="token punctuation">)</span>
    <span class="token keyword">return</span> A

<span class="token keyword">def</span> <span class="token function">solve_unknown_modulus</span><span class="token punctuation">(</span>states<span class="token punctuation">)</span><span class="token punctuation">:</span>
    diffs <span class="token operator">=</span> <span class="token punctuation">[</span>X_1 <span class="token operator">-</span> X_0 <span class="token keyword">for</span> X_0<span class="token punctuation">,</span> X_1 <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>states<span class="token punctuation">,</span> states<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    multiples_of_M <span class="token operator">=</span> <span class="token punctuation">[</span>T_2 <span class="token operator">*</span> T_0 <span class="token operator">-</span> T_1 <span class="token operator">**</span> <span class="token number">2</span> <span class="token keyword">for</span> T_0<span class="token punctuation">,</span> T_1<span class="token punctuation">,</span> T_2<span class="token punctuation">,</span> <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>diffs<span class="token punctuation">,</span> diffs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> diffs<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

    <span class="token comment"># GCD(GCD(multiples_of_M[0],multiples_of_M[1]), multiples_of_M[2])</span>
    M <span class="token operator">=</span> <span class="token builtin">reduce</span><span class="token punctuation">(</span>GCD<span class="token punctuation">,</span> multiples_of_M<span class="token punctuation">)</span>
    <span class="token keyword">return</span> M

<span class="token keyword">def</span> <span class="token function">test_unknown_modulus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    M <span class="token operator">=</span> solve_unknown_modulus<span class="token punctuation">(</span>prime_candidates<span class="token punctuation">)</span>
    M <span class="token operator">=</span> solve_unknown_modulus<span class="token punctuation">(</span>prime_candidates<span class="token punctuation">)</span>
    A <span class="token operator">=</span> solve_unknown_multiplier<span class="token punctuation">(</span>prime_candidates<span class="token punctuation">,</span> M<span class="token punctuation">)</span>
    B <span class="token operator">=</span> solve_unknown_increment<span class="token punctuation">(</span>prime_candidates<span class="token punctuation">,</span> A<span class="token punctuation">,</span> M<span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span>M<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span>

test_unknown_modulus<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div>
<p>これで、あとは e を特定することで Flag の復号に使用する秘密鍵の生成ができます。</p>
<p>e については、問題バイナリとして提供された RSA の公開鍵が 2048 bit RSA のサイズだったので、65537 を決め打ちました。</p>
<p>ここまでで特定した情報を元に以下のスクリプトを作成して Flag を復号できました。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">import</span> struct
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSA
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes<span class="token punctuation">,</span> bytes_to_long<span class="token punctuation">,</span> isPrime

<span class="token keyword">class</span> <span class="token class-name">LCG</span><span class="token punctuation">:</span>
    lcg_m <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">6569199283741144524805092313800498379912765081239722709390321881123001934591054674566684669798886054155292305172680411106681470919005032801138448184653164447435662736622686458913807769346396147888409387744295360132038094168945987371927904880766531430748616858146076625544135687000281908879673294160897281532</span>
    lcg_c <span class="token operator">=</span> <span class="token number">3910539794193409979886870049869456815685040868312878537393070815966881265118275755165613835833103526090552456472867019296386475520134783987251699999776365</span>
    lcg_n <span class="token operator">=</span> <span class="token number">8311271273016946265169120092240227882013893131681882078655426814178920681968884651437107918874328518499850252591810409558783335118823692585959490215446923</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> lcg_s<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>state <span class="token operator">=</span> lcg_s

    <span class="token keyword">def</span> <span class="token function">next</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>state <span class="token operator">*</span> self<span class="token punctuation">.</span>lcg_m <span class="token operator">+</span> self<span class="token punctuation">.</span>lcg_c<span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>lcg_n
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>state


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>

    it <span class="token operator">=</span> <span class="token number">8</span>
    bits <span class="token operator">=</span> <span class="token number">512</span>

    <span class="token comment"># Find prime value of specified bits a specified amount of times</span>
    seed <span class="token operator">=</span> <span class="token number">211286818345627549183608678726370412218029639873054513839005340650674982169404937862395980568550063504804783328450267566224937880641772833325018028629959635</span>
    lcg <span class="token operator">=</span> LCG<span class="token punctuation">(</span>seed<span class="token punctuation">)</span>
    primes_arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    items <span class="token operator">=</span> <span class="token number">0</span>
    primes_n <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
                prime_candidate <span class="token operator">=</span> lcg<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

                <span class="token keyword">if</span> <span class="token keyword">not</span> isPrime<span class="token punctuation">(</span>prime_candidate<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    <span class="token keyword">continue</span>
                <span class="token keyword">elif</span> prime_candidate<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> bits<span class="token punctuation">:</span>
                    <span class="token keyword">continue</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    primes_n <span class="token operator">*=</span> prime_candidate
                    primes_arr<span class="token punctuation">.</span>append<span class="token punctuation">(</span>prime_candidate<span class="token punctuation">)</span>
                    <span class="token keyword">break</span>
        
        <span class="token comment"># Check bit length</span>
        <span class="token keyword">if</span> primes_n<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">4096</span><span class="token punctuation">:</span>
            <span class="token comment"># print("bit length", primes_n.bit_length())</span>
            primes_arr<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
            primes_n <span class="token operator">=</span> <span class="token number">1</span>
            <span class="token keyword">continue</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">break</span>
    
    <span class="token comment"># print(primes_arr)</span>
    <span class="token comment"># print(len(primes_arr))</span>

    <span class="token comment"># Create public key 'n'</span>
    n <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> primes_arr<span class="token punctuation">:</span>
        n <span class="token operator">*=</span> j
    <span class="token comment"># Calculate totient 'Phi(n)'</span>
    phi <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">for</span> k <span class="token keyword">in</span> primes_arr<span class="token punctuation">:</span>
        phi <span class="token operator">*=</span> <span class="token punctuation">(</span>k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token comment"># print("[+] n: ", n)</span>
    <span class="token comment"># print("[+] size: ", n.bit_length(), "bits")</span>
    <span class="token comment"># print("[+] phi: ", phi)</span>

    rsa <span class="token operator">=</span> RSA<span class="token punctuation">.</span>construct<span class="token punctuation">(</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">65537</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    key <span class="token operator">=</span> rsa<span class="token punctuation">.</span>exportKey<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># print(key)</span>

    d <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">65537</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> phi<span class="token punctuation">)</span>
    <span class="token comment"># print("[+] d: ", d)</span>

    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"flag.txt"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        data <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
        c <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token string">"little"</span><span class="token punctuation">)</span>
        <span class="token comment"># print(c)</span>

    <span class="token comment"># print(c)</span>
    m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    flag <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>

    <span class="token comment"># enc_flag = b'L\x13\x17\xea\x9e\x10\x13hy\x90kK\xdb? \xd5z7\t\xeb\xf3n\xf1\xd0\xc1\xad\x15\xf8ZN\x9c\xd9\xef\xbcz\xcc\xed\xd9:p\xf0\x1e\x97%T\xdb\xb0\'I\x17\x83mLi6\x1b\xd8 \x93%\xe9\xcd\x0f*\x9e\x1fJ\xb3\xb4\xeahnT\x92\xea&lt;&lt;\x159\xba\xb9vo\xf3\x9b\x8b\xf3\xe93?p\xad`\xd6\xa6T\x85m\x06\xd6\xb1\xd1\x8djQ\xe4\xf3Z\xf5\x10\xd7)G\x91\x13\x1c\xc6O\x0b8;\xed\x89\'\xf42\x92\x03\xa4\x80)y\x10\xdc\x0b;\x03\xf6\xff\x06C~;\xde\xf4\xf9\xd0\xd1\xcc\xfd\x10\x95\x9a\xa9\\\x91X{\xb6M\xe1d\xf4\xf57\xbd\x8a,\x07K\xd7B\x1c\xe5\xd1p=5\x01\x08\xb3\xafA\x00\xad\x90I\x1b\tdt\x9c\x08\xf2\xd2n\xd8%\x1e\xa4H\xb7G\xb5\xc1\tG$h\xa2\xe7z\xcf\xf9\xba\x17}\'&amp;\x05\x1ecF\xc0\x86\xc7\xd9\xd1\r2!\xe1\xa1Z\xabp\xfe\x14C\xd0.+T\x87\x9dP\x17\xfc\xb6\x94\x98\x90q\xe3P\x1fPn\x07\xf1+;\xcc\xd3/\x0f\xde\x0eZL\xa7\xd5\xce\x1dF\x9c#\xdea\xcc,\xbe\xc0O\xb06\xbdi \xf9w\xa1\xac\x97\xfd\x93\x91c\xf5\xee\xd2U\xe32\xd7\xe8\xed\x90\xa4.Q\xca\xdc\x8btF&lt;\xbb\xfe?\xdf\xf4\xfd\xde\xee^\xf3G\x8a\xb8&lt;\xa0\x04U\xfb1>a:\xaf\xfb+\xf3\x10\x15\x9d\x04Md\x9c^\xda\xd3A\x14\x9eV\x05\xfd\xdcC\xa1\xf8\xb4\xf8\\\xb9\x89Bb?\x13\xf1s3\x98i\xb4e\x15\xa6@\xab\xbbR\x80\x1e\xd9\xb4\xd8U\xd6qC\xff\xff\xa7bFN\t\x0f\xa7|\xa1\x80r\xb6\xa5\xa8!\xbc\xe1\x08\xc2t\xe0\xa1\xc2"4%v\x91\xeeKg\x98E\x0e\xa4z\xb5\x01o\x9d\tS\x92\xf3\x1d\x1e\xa3\xe7\xce\xb99s`\x9ao"\xe2Z\xddg\x902\x12\x15\xd6N&lt;\xebH2;\x93\x81`\xa39\x07\xc6\xc0%Wc\xf6\x82\x819\xe0\x99=\xc5\x9a\x95\x9bR\xf4>|@\xe6)\xf1L\x17\n\n\xa4\xac#d\xd9\x13\'\x16\xf9v\x02'</span>
    <span class="token comment"># print(len(enc_flag))</span>
    

    <span class="token comment"># text = b"myflag"</span>
    <span class="token comment"># enc_flag = bytes_to_long(text)</span>
    <span class="token comment"># _enc = pow(enc_flag, 65537, n)</span>
    <span class="token comment"># with open ("myflag.txt", "wb") as flag_file:</span>
    <span class="token comment">#     flag_file.write(_enc.to_bytes(n.bit_length(), "little"))</span>
    <span class="token comment"># with open("myflag.txt", "rb") as f:</span>
    <span class="token comment">#     data = f.read()</span>
    <span class="token comment">#     number = int.from_bytes(data, "little")</span>
    <span class="token comment">#     print(number)</span>

    <span class="token comment"># m = pow(number, d, n)</span>
    <span class="token comment"># flag = long_to_bytes(m)</span>
    <span class="token comment"># print(flag)</span></code></pre></div>
<h2 id="papapapamisc" style="position:relative;"><a href="#papapapamisc" aria-label="papapapamisc permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>PAPAPAPA(Misc)</h2>
<blockquote>
<p>Is this image really just white?</p>
</blockquote>
<p>問題バイナリとして以下のような真っ白な JPEG が与えられます。</p>
<p>どうやらこの中に Flag が埋め込まれているようです。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 512px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/bd916fa3665f374c62c8132a43a38fe8/36dd4/white.jpg"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAb/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAGgAAAB/8QAFBABAAAAAAAAAAAAAAAAAAAAMP/aAAgBAQABBQIf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAFBABAAAAAAAAAAAAAAAAAAAAMP/aAAgBAQAGPwIf/8QAFBABAAAAAAAAAAAAAAAAAAAAMP/aAAgBAQABPyEf/9oADAMBAAIAAwAAABAAAAD/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAE/EB//2Q=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/bd916fa3665f374c62c8132a43a38fe8/8ac56/white.webp 240w,
/static/bd916fa3665f374c62c8132a43a38fe8/d3be9/white.webp 480w,
/static/bd916fa3665f374c62c8132a43a38fe8/bd5dd/white.webp 512w"
              sizes="(max-width: 512px) 100vw, 512px"
              type="image/webp"
            />
          <source
            srcset="/static/bd916fa3665f374c62c8132a43a38fe8/09b79/white.jpg 240w,
/static/bd916fa3665f374c62c8132a43a38fe8/7cc5e/white.jpg 480w,
/static/bd916fa3665f374c62c8132a43a38fe8/36dd4/white.jpg 512w"
            sizes="(max-width: 512px) 100vw, 512px"
            type="image/jpeg"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/bd916fa3665f374c62c8132a43a38fe8/36dd4/white.jpg"
            alt="white"
            title="white"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>当然ではありますが汎用ツールで解析を行っても Flag は取得できません。</p>
<p>バイトコードを走査してみてもそれらしい情報は見当たりませんでした。</p>
<p>また、このような画像の場合は LSB などが悪用されている場合も多いので以下のスクリプトで全ピクセルの RGB を抽出してみましたが、<code class="language-text">#FFFFFF</code> 以外の色のピクセルは存在していませんでした。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image

<span class="token keyword">def</span> <span class="token function">get_pixel_rgb</span><span class="token punctuation">(</span>image_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    img <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>image_path<span class="token punctuation">)</span>
    pixels <span class="token operator">=</span> img<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token punctuation">)</span>
    width<span class="token punctuation">,</span> height <span class="token operator">=</span> img<span class="token punctuation">.</span>size

    rgb_values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>width<span class="token punctuation">)</span><span class="token punctuation">:</span>
            r<span class="token punctuation">,</span> g<span class="token punctuation">,</span> b <span class="token operator">=</span> pixels<span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span>
            rgb_values<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> g<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> rgb_values

image_path <span class="token operator">=</span> <span class="token string">"white.jpg"</span>
rgb_values <span class="token operator">=</span> get_pixel_rgb<span class="token punctuation">(</span>image_path<span class="token punctuation">)</span>
<span class="token keyword">for</span> rgb <span class="token keyword">in</span> rgb_values<span class="token punctuation">:</span>
    <span class="token keyword">for</span> px <span class="token keyword">in</span> rgb<span class="token punctuation">:</span>
        <span class="token keyword">if</span> px <span class="token operator">!=</span> <span class="token number">255</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>rgb<span class="token punctuation">)</span></code></pre></div>
<p>ここで若干手詰まりしましたが、試しに ImageMagick をかけてみたところ、画像のサイズが 512*512 であるにもかかわらず、sampling-factor が 3x1,3x1,3x1 になっていることに気づきました。</p>
<p>どうやらこの画像ではクロマサブサンプリングが使用されているようです。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">./magick identify -verbose white.jpg
<span class="token operator">></span>
jpeg:colorspace: <span class="token number">2</span>
jpeg:sampling-factor: 3x1,3x1,3x1</code></pre></div>
<p>JPEG は、画像を小さな正方形の単位に分割し、それぞれの正方形の色と明るさを数式化することで圧縮して保存することができる方法です。</p>
<p>この時の正方形は 8*8 ピクセルと既定されています。つまり、本来 JPEG フォーマットの縦横サイズは常に 8 の倍数になります。</p>
<p>JPEG では、画像の解像度を下げてサイズを小さくするために、クロマサブサンプリングという技術を使用する場合があります。</p>
<p>クロマサブサンプリングは、人間の視覚が色よりも明るさに敏感であることを利用します。</p>
<p>具体的には、意図的に「色の情報」を「明るさの情報」よりも少なくすることで、画像の見た目(画質)を維持したまま画像ファイルを小さく(低解像度)に変換することができます。</p>
<p>クロマサブサンプリングは、一般的には 2x2 の比率らしいですが、今回は 3x1 に設定されていました。</p>
<p>JPEG でクロマサブサンプリングが行われている場合、JPEG の 1 ブロックのサイズは、基本の 8*8 に画像成分の中で最大のサンプリングファクタをかけた値になります。</p>
<p>つまり、今回は 24x8 がブロックサイズになるわけです。</p>
<p>参考：<a href="https://simple.wikipedia.org/wiki/JPEG" target="_blank" rel="nofollow noopener noreferrer">JPEG - Simple English Wikipedia, the free encyclopedia</a></p>
<p>参考：<a href="https://en.wikipedia.org/wiki/Chroma_subsampling" target="_blank" rel="nofollow noopener noreferrer">Chroma subsampling - Wikipedia</a></p>
<p>参考：<a href="https://hp.vector.co.jp/authors/VA032610/JPEGFormat/AboutImage.htm" target="_blank" rel="nofollow noopener noreferrer">画像データの構造</a></p>
<p>参考：<a href="http://users.wfu.edu/matthews/misc/jpg_vs_gif/JpgCompTest/JpgChromaSub.html" target="_blank" rel="nofollow noopener noreferrer">Chroma subsampling in JPG compression</a></p>
<p>参考：<a href="https://blog.awm.jp/2016/02/06/ycbcr/" target="_blank" rel="nofollow noopener noreferrer">JPEG の YCbCr について - awm-Tech</a></p>
<p>ここで、512*512 ピクセルの問題画像の幅が 24 の倍数になっていないことに気づきます。</p>
<p>クロマサブサンプリングを行っている画像で画像のサイズがブロックサイズの倍数にならない場合、あふれた部分はパディングとして扱われ、SOF(JPEG ファイルの種類や主要な情報が記録されているセグメント)に書かれる画像サイズはパディングを差し引いた値が強制されます。</p>
<p>これによってパディング部分が実際の表示画像から消えるわけです。</p>
<p>ちなみに、パディング部分に隠されている画像については普通にイメージビューアなどでサイズの拡大を行っても取得できません。</p>
<p>このような場合は、SOF 領域内で JPEG の画像サイズを指定しているバイト列を直接書き換えてあげます。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">modify_sof0_segment</span><span class="token punctuation">(</span>jpeg_path<span class="token punctuation">,</span> new_width<span class="token punctuation">,</span> new_height<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>jpeg_path<span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        jpeg_data <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># SOF0セグメントの位置を検索</span>
    sof0_marker <span class="token operator">=</span> <span class="token string">b'\xff\xc0'</span>
    sof0_start <span class="token operator">=</span> jpeg_data<span class="token punctuation">.</span>find<span class="token punctuation">(</span>sof0_marker<span class="token punctuation">)</span>

    <span class="token comment"># SOF0セグメントのパラメータの位置を検索して表示</span>
    parameter_start <span class="token operator">=</span> sof0_start <span class="token operator">+</span> <span class="token number">5</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Original SOF0 width : {}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>jpeg_data<span class="token punctuation">[</span>parameter_start<span class="token punctuation">:</span>parameter_start <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"big"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Original SOF0 height : {}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>jpeg_data<span class="token punctuation">[</span>parameter_start <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">:</span>parameter_start <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"big"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># 新しい幅と高さをバイト列に変換</span>
    new_width_bytes <span class="token operator">=</span> new_width<span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> byteorder<span class="token operator">=</span><span class="token string">'big'</span><span class="token punctuation">)</span>
    new_height_bytes <span class="token operator">=</span> new_height<span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> byteorder<span class="token operator">=</span><span class="token string">'big'</span><span class="token punctuation">)</span>

    <span class="token comment"># 幅と高さを置き換える</span>
    jpeg_data<span class="token punctuation">[</span>parameter_start<span class="token punctuation">:</span>parameter_start <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> new_width_bytes
    jpeg_data<span class="token punctuation">[</span>parameter_start <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">:</span>parameter_start <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> new_height_bytes

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"New SOF0 width : {}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>jpeg_data<span class="token punctuation">[</span>parameter_start<span class="token punctuation">:</span>parameter_start <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"big"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"New SOF0 height : {}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>jpeg_data<span class="token punctuation">[</span>parameter_start <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">:</span>parameter_start <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"big"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># 変更後のJPEGファイルを保存</span>
    modified_jpeg_path <span class="token operator">=</span> <span class="token string">"modified.jpg"</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>modified_jpeg_path<span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>jpeg_data<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"==> Saved new JPEG"</span><span class="token punctuation">)</span>

<span class="token comment"># 使用例</span>
jpeg_path <span class="token operator">=</span> <span class="token string">"white.jpg"</span>
new_width <span class="token operator">=</span> <span class="token number">512</span>
new_height <span class="token operator">=</span> <span class="token number">528</span>
modify_sof0_segment<span class="token punctuation">(</span>jpeg_path<span class="token punctuation">,</span> new_width<span class="token punctuation">,</span> new_height<span class="token punctuation">)</span></code></pre></div>
<p>最終的に上記の Solver を作成して画像の幅を 528 に変更することで、パディング部分に隠された Flag を取得することができました。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/ad01222a13fe7057ae521222e2f8264e/4b2cc/image-20230627213617828.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 96.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAW0lEQVQ4y+WSuw3AMAhEvf9EuLAxNR3z8IlkKRPkCqRQXfV0PN2oj5eZFRE3q2oNBNDdb2ZmDPBtuPfGAtdaWCD85R86FBEscM6JBZ5zmjvsP+z+Domo+bDNrB6huNuSKiWqKgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/ad01222a13fe7057ae521222e2f8264e/8ac56/image-20230627213617828.webp 240w,
/static/ad01222a13fe7057ae521222e2f8264e/d3be9/image-20230627213617828.webp 480w,
/static/ad01222a13fe7057ae521222e2f8264e/e46b2/image-20230627213617828.webp 960w,
/static/ad01222a13fe7057ae521222e2f8264e/d5002/image-20230627213617828.webp 1013w"
              sizes="(max-width: 960px) 100vw, 960px"
              type="image/webp"
            />
          <source
            srcset="/static/ad01222a13fe7057ae521222e2f8264e/8ff5a/image-20230627213617828.png 240w,
/static/ad01222a13fe7057ae521222e2f8264e/e85cb/image-20230627213617828.png 480w,
/static/ad01222a13fe7057ae521222e2f8264e/d9199/image-20230627213617828.png 960w,
/static/ad01222a13fe7057ae521222e2f8264e/4b2cc/image-20230627213617828.png 1013w"
            sizes="(max-width: 960px) 100vw, 960px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/ad01222a13fe7057ae521222e2f8264e/d9199/image-20230627213617828.png"
            alt="image-20230627213617828"
            title="image-20230627213617828"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<h2 id="まとめ" style="position:relative;"><a href="#%E3%81%BE%E3%81%A8%E3%82%81" aria-label="まとめ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>まとめ</h2>
<p>レベルアップを感じられるいい機会でした。</p>
<p>ただ、まだまだ上位は遠いので引き続き精進します。</p>
<p>Google CTF は公式 Writeup が丁寧でありがたいので、解けなかった問題はまたチャレンジしていきます。</p>
<p>参考：<a href="https://github.com/google/google-ctf/tree/master" target="_blank" rel="nofollow noopener noreferrer">google/google-ctf: Google CTF</a></p></div></div></div><div class="Post-module--post__footer--3WzWU"><div><p class="Meta-module--meta__date--29eD7">Published <!-- -->Jun 27, 2023</p></div><div class="Tags-module--tags--1L_ct"><ul class="Tags-module--tags__list--91FqN"><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/ctf/">CTF</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/rev/">Rev</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/forensic/">Forensic</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/crypto/">Crypto</a></li></ul></div><div class="Author-module--author--2Yefr"><p>リバースエンジニアになりたいCTF Player(Team: 0nePadding)。WinDbgとYARAが好き。OSCP / CISSP / AtCoder 緑 Microsoft Japanに所属してます。発言はすべて個人の見解。<a class="Author-module--author__bio-twitter--n-O9n" href="https://www.twitter.com/kash1064" rel="noopener noreferrer" target="_blank"><strong>かしわば</strong> on Twitter</a></p></div></div><div class="Post-module--post__comments--25y6I"></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/ctf-googlectf";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-299cfcade846097f4d4b.js"],"app":["/app-52ce8ec918ec141d95ba.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-fd4fb51a6fac1c18bdde.js"],"component---src-templates-categories-list-template-js":["/component---src-templates-categories-list-template-js-2181ec47d28e5c35d3e9.js"],"component---src-templates-category-template-js":["/component---src-templates-category-template-js-76f2006942127b3c7274.js"],"component---src-templates-index-template-js":["/component---src-templates-index-template-js-70ba56c0f46525baa629.js"],"component---src-templates-not-found-template-js":["/component---src-templates-not-found-template-js-d19905e5c8fc953958f1.js"],"component---src-templates-page-template-js":["/component---src-templates-page-template-js-6ba68ef37e264f701345.js"],"component---src-templates-post-template-js":["/component---src-templates-post-template-js-381c1b847824134fa4bd.js"],"component---src-templates-tag-template-js":["/component---src-templates-tag-template-js-0faa242d92f89b71e668.js"],"component---src-templates-tags-list-template-js":["/component---src-templates-tags-list-template-js-2d7007993fc2bf0f9caf.js"]};/*]]>*/</script><script src="/polyfill-299cfcade846097f4d4b.js" nomodule=""></script><script src="/component---src-templates-post-template-js-381c1b847824134fa4bd.js" async=""></script><script src="/cd95ea5cbd2c605f26db819f07999610c9ff4310-c2f05dc74373de400085.js" async=""></script><script src="/styles-407fe62976dc5310c43e.js" async=""></script><script src="/app-52ce8ec918ec141d95ba.js" async=""></script><script src="/dc6a8720040df98778fe970bf6c000a41750d3ae-48010afb2e1fc1dc9086.js" async=""></script><script src="/532a2f07-92db97c0addf07d5cb73.js" async=""></script><script src="/framework-3761df4ab6ee9f056936.js" async=""></script><script src="/webpack-runtime-a3c0f166cb4b802ff58f.js" async=""></script></body></html>