<!DOCTYPE html><html lang="ja"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.e71379dda153709d1a9a.css" id="gatsby-global-css">html{font-size:100}body{margin:0 0 0 calc(100vw - 100%);color:#222;line-height:1.4;font-size:.875rem;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;background-color:#fcfcfc}body,h1,h2,h3,h4,h5,h6{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif}h1,h2,h3,h4,h5,h6{font-weight:600}h1{font-size:1.575rem;line-height:2.25rem;margin-top:5rem;margin-bottom:1.25rem}h2{font-size:1.47656rem;line-height:1.875rem}h2,h3{margin-top:2.5rem;margin-bottom:.625rem}h3{font-size:1.20313rem;line-height:1.25rem}h4{font-size:1.05rem;margin-top:1.875rem}h4,h5{line-height:1.25rem;margin-bottom:.625rem}h5,h6{font-size:.875rem;margin-top:3.125rem}h6{line-height:1.25rem;margin-bottom:.625rem}img{max-width:100%;margin:inherit auto}hr,img{border:0;display:block}hr{color:#222;height:1.625rem;margin:3.25rem auto;background-size:100% 26px;background-image:linear-gradient(180deg,transparent 1px,transparent 11px,#222 0,#222 15px,transparent 0,transparent 26px);width:6.25rem}a{color:#918d40;text-decoration:none}a:active,a:focus,a:hover{color:#a9d159}b,strong{font-weight:600}ul{list-style:square;margin-bottom:1.25rem}ul li{padding:0 .3125rem;margin-bottom:.625rem}p{line-height:1.25rem;margin-bottom:1.25rem}blockquote{font-style:italic;text-align:center;background-color:#f5f5f5;padding:.1875rem .625rem}figure{display:block;width:100%;height:auto}figcaption{line-height:.9375rem;margin-top:.3125rem;color:#222;font-size:.75rem;font-style:italic;margin-bottom:0;text-align:center}.anchor{margin-left:-1.875rem!important;padding-right:.875rem!important}@media screen and (min-width:685px){figure.float-left,figure.float-right{max-width:19.375rem;padding:0 1.25rem}.float-right{float:right}.float-left{float:left}}code[class*=language-],pre[class*=language-]{color:#ccc;background:0 0;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}li>code[class*=language-text],p>code[class*=language-text]{background:#f9f9f9!important;color:#2d2d2d!important}.Author-module--author__photo--36xCH{display:inline-block;margin-bottom:0;border-radius:50%;background-clip:padding-box}.Author-module--author__title--2CaTb{font-size:.98438rem;font-weight:600;line-height:1.40625rem;margin:.625rem 0}.Author-module--author__title-link--Yrism,.Author-module--author__title-link--Yrism:focus,.Author-module--author__title-link--Yrism:hover{color:#222}.Author-module--author__subtitle--cAaEB{color:#888;line-height:1.25rem;margin-bottom:1.25rem}.Icon-module--icon--Gpyvw{display:inline-block;width:1em;height:1em;stroke-width:0;stroke:currentColor;fill:currentColor;font-style:normal;font-weight:400;speak:none;margin-right:.2em;text-align:center;font-variant:normal;text-transform:none;line-height:1em;margin-left:.2em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.Contacts-module--contacts--1rGd1{margin-bottom:1.25rem}.Contacts-module--contacts__list--3OgdW{display:flex;flex-flow:row wrap;flex-grow:0;flex-shrink:0;list-style:none;padding:0;margin:.625rem -.1875rem;width:8.75rem}.Contacts-module--contacts__list-item--16p9q{padding:0;margin:.25rem;display:flex;align-content:center;align-items:center;justify-content:center;height:2.1875rem;width:2.1875rem;line-height:2.1875rem;border-radius:50%;text-align:center;border:1px solid #ebebeb}.Contacts-module--contacts__list-item-link--2MIDn{border:0;display:flex;color:#222}.Contacts-module--contacts__list-item-link--2MIDn:focus,.Contacts-module--contacts__list-item-link--2MIDn:hover{color:#918d40}.Copyright-module--copyright--1ariN{color:#b6b6b6;font-size:.75rem}.Menu-module--menu--Efbin{margin-bottom:1.25rem}.Menu-module--menu__list--31Zeo{list-style:none;padding:0;margin:0}.Menu-module--menu__list-item--1lJ6B{padding:0;margin:.625rem 0}.Menu-module--menu__list-item-link--10Ush{font-size:.875rem;color:#222;font-weight:400;border:0}.Menu-module--menu__list-item-link--10Ush:focus,.Menu-module--menu__list-item-link--10Ush:hover{color:#918d40;border-bottom:1px solid #918d40}.Menu-module--menu__list-item-link--active--2CbUO{color:#222;border-bottom:1px solid #222}.Sidebar-module--sidebar--X4z2p{width:100%}.Sidebar-module--sidebar__inner--Jdc5s{position:relative;padding:1.5625rem 1.25rem 0}.Sidebar-module--headerimage--19Rdy{width:100%;min-height:70px;max-height:120px;margin:0 0 .625rem}.Sidebar-module--logo-image--XDYae{min-height:70px;max-height:120px;margin:0 auto}input{-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:.625rem;margin:.3125rem 0;border:1px solid #999;border-radius:.3125rem}.Sidebar-module--search-container--17C6F{position:relative}.Sidebar-module--search-container-input--27Tw4{width:100%}.Sidebar-module--search-container-submit--WwtLg{position:absolute;width:2.375rem;height:2.375rem;top:calc(50% - 19px);right:0;border:3px solid #999;border-radius:0 .25rem .25rem 0;background:#999}.Sidebar-module--search-container-submit--WwtLg:before{position:absolute;content:"";width:.9375rem;height:.9375rem;top:calc(50% - 9px);left:calc(50% - 9px);border-radius:50%;box-shadow:0 0 0 2px #fff}.Sidebar-module--search-container-submit--WwtLg:after{position:absolute;content:"";width:.5rem;height:.375rem;top:calc(50% + 6px);left:calc(50% + 2px);border-top:2px solid #fff;transform:rotate(45deg)}@media screen and (min-width:685px){.Sidebar-module--sidebar--X4z2p{width:calc(41.625% - 1.09375rem)}.Sidebar-module--sidebar--X4z2p:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--X4z2p:last-child{margin-right:0}.Sidebar-module--sidebar--X4z2p:nth-child(12n){margin-right:0;float:right}.Sidebar-module--sidebar--X4z2p:nth-child(12n+1){clear:both}.Sidebar-module--sidebar__inner--Jdc5s{padding:1.875rem 1.25rem 0}.Sidebar-module--sidebar__inner--Jdc5s:after{background:#e6e6e6;background:linear-gradient(180deg,#e6e6e6 0,#e6e6e6 48%,#fff);position:absolute;content:"";width:.0625rem;height:33.75rem;top:30px;right:-10px;bottom:0}}@media screen and (min-width:960px){.Sidebar-module--sidebar--X4z2p{width:calc(33.3% - 1.25rem)}.Sidebar-module--sidebar--X4z2p:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--X4z2p:last-child{margin-right:0}.Sidebar-module--sidebar--X4z2p:nth-child(3n){margin-right:0;float:right}.Sidebar-module--sidebar--X4z2p:nth-child(3n+1){clear:both}.Sidebar-module--sidebar__inner--Jdc5s{padding:2.5rem}}.Layout-module--layout--3Pyz6{max-width:66.875rem;margin-left:auto;margin-right:auto}.Layout-module--layout--3Pyz6:before{content:"";display:table}.Layout-module--layout--3Pyz6:after{content:"";display:table;clear:both}.Feed-module--feed__item--2D5rE{margin-bottom:1.5625rem}.Feed-module--feed__item--2D5rE:last-child{margin-bottom:.625rem}.Feed-module--feed__item-title--3nigr{font-size:1.47656rem;line-height:1.875rem;margin-top:0;margin-bottom:.625rem}.Feed-module--feed__item-title-link--iFMRs{color:#222}.Feed-module--feed__item-title-link--iFMRs:focus,.Feed-module--feed__item-title-link--iFMRs:hover{color:#222;border-bottom:1px solid #222}.Feed-module--feed__item-description--1uO8e{font-size:.875rem;line-height:1.25rem;margin-bottom:.9375rem}.Feed-module--feed__item-meta-time--3t1fg{font-size:.75rem;color:#222;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-divider--N-Q0A{margin:0 .3125rem}.Feed-module--feed__item-meta-category-link--23f8F{font-size:.75rem;color:#a9d159;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-category-link--23f8F:focus,.Feed-module--feed__item-meta-category-link--23f8F:hover{color:#918d40}.Feed-module--feed__item-readmore--1u6bI{font-size:.875rem;color:#918d40}.Feed-module--feed__item-readmore--1u6bI:focus,.Feed-module--feed__item-readmore--1u6bI:hover{color:#918d40;border-bottom:1px solid #918d40}.Page-module--page--2nMky{margin-bottom:2.5rem}.Page-module--page__inner--2M_vz{padding:1.5625rem 1.25rem}.Page-module--page__title--GPD8L{font-size:1.575rem;font-weight:600;line-height:2.5rem;margin-top:0;margin-bottom:1.8125rem}.Page-module--page__body--Ic6i6{font-size:.875rem;line-height:1.25rem;margin:0 0 1.25rem}@media screen and (min-width:685px){.Page-module--page--2nMky{width:calc(58.275% - .78125rem)}.Page-module--page--2nMky:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--2nMky:last-child{margin-right:0}.Page-module--page--2nMky:nth-child(12n){margin-right:0;float:right}.Page-module--page--2nMky:nth-child(12n+1){clear:both}.Page-module--page__inner--2M_vz{padding:1.875rem 1.25rem}}@media screen and (min-width:960px){.Page-module--page--2nMky{width:calc(66.6% - .625rem)}.Page-module--page--2nMky:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--2nMky:last-child{margin-right:0}.Page-module--page--2nMky:nth-child(3n){margin-right:0;float:right}.Page-module--page--2nMky:nth-child(3n+1){clear:both}.Page-module--page__inner--2M_vz{padding:2.5rem 2.1875rem}}.Pagination-module--pagination--2H3nO{margin-top:2.5rem;display:flex}.Pagination-module--pagination__prev--bet5s{width:50%;text-align:left}.Pagination-module--pagination__prev-link--1Nzs6{color:#a9d159;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__prev-link--1Nzs6:focus,.Pagination-module--pagination__prev-link--1Nzs6:hover{color:#918d40}.Pagination-module--pagination__prev-link--disable--Yklx9{pointer-events:none;color:#bbb}.Pagination-module--pagination__next--3hFiN{width:50%;text-align:right}.Pagination-module--pagination__next-link--3FUtA{color:#a9d159;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__next-link--3FUtA:focus,.Pagination-module--pagination__next-link--3FUtA:hover{color:#918d40}.Pagination-module--pagination__next-link--disable--30UwZ{pointer-events:none;color:#bbb}.Author-module--author--2Yefr{border-top:1px solid #e6e6e6;max-width:43.75rem;padding-top:1.25rem;line-height:1.25rem;margin-top:1.25rem;margin-bottom:2.5rem}.Author-module--author__bio-twitter--n-O9n{display:block;text-decoration:underline}@media screen and (min-width:685px){.Author-module--author--2Yefr{margin-left:auto;margin-right:auto}}.Content-module--content--3p512{max-width:62.8125rem;padding:0 .9375rem;margin:0 auto}.Content-module--content__title--2BDW9{font-size:1.75rem;max-width:43.75rem;font-weight:600;text-align:center;line-height:2.0625rem;margin:1.25rem auto 0}.Content-module--content__body--2TrQ- figure{margin-bottom:1.25rem}.Content-module--content__body--2TrQ- figure blockquote{font-style:italic;text-align:center;margin-top:0;padding:1.25rem 0}.Content-module--content__body--2TrQ- figure blockquote p{max-width:43.75rem;font-size:1.47149rem;margin-top:1.25rem;margin-bottom:1.25rem;line-height:1.875rem}.Content-module--content__body--2TrQ- a{text-decoration:underline}.Content-module--content__body--2TrQ- *{max-width:43.75rem;margin-left:auto;margin-right:auto}.Content-module--content__body--2TrQ- img{max-width:100%;margin-top:.625rem;margin-bottom:.625rem}.Content-module--content__body--2TrQ- li ul{margin-bottom:.625rem}.Content-module--content__body--2TrQ- li p{line-height:1.25rem;margin-bottom:.625rem}.Content-module--content__body--2TrQ- h2{position:relative;padding:1rem 1.5rem;color:#fff;border-radius:.625rem;background:#0c0000}.Content-module--content__body--2TrQ- h2:after{position:absolute;bottom:-9px;left:1rem;width:0;height:0;content:"";border-color:#0c0000 transparent transparent;border-style:solid;border-width:10px 10px 0}.Content-module--content__body--2TrQ- h3{border-bottom:3px dotted #0c0000;padding:1rem 0}@media screen and (min-width:960px){.Content-module--content--3p512{padding:0}.Content-module--content__title--2BDW9{font-size:1.75rem;line-height:2.8125rem;margin-top:2.8125rem;margin-bottom:1.875rem}.Content-module--content__body--2TrQ-,.Content-module--content__body--2TrQ- p{font-size:.98438rem;line-height:1.40625rem;margin-bottom:1.40625rem}.Content-module--content__body--2TrQ- li p{line-height:1.25rem;margin-bottom:.625rem}}.Meta-module--meta__date--29eD7{font-style:italic}.Tags-module--tags--1L_ct{margin-bottom:.625rem}.Tags-module--tags__list--91FqN{list-style:none;margin:0 -.625rem;padding:0}.Tags-module--tags__list-item--1M30P{display:inline-block;margin:.625rem .3125rem}.Tags-module--tags__list-item-link--3SL_8{display:inline-block;height:2.1875rem;padding:0 1.5rem;line-height:2.1875rem;border:1px solid #e6e6e6;text-decoration:none;border-radius:1.25rem;color:#222}.Tags-module--tags__list-item-link--3SL_8:focus,.Tags-module--tags__list-item-link--3SL_8:hover{color:#918d40}.Post-module--post__comments--25y6I,.Post-module--post__footer--3WzWU{max-width:43.75rem;margin:0 auto;padding:0 .9375rem}.Post-module--post__home-button--16Kl0{display:block;max-width:5.625rem;height:2.1875rem;padding:0 1.5rem;line-height:2.1875rem;text-align:center;color:#222;border:1px solid #e6e6e6;border-radius:1.25rem;font-size:.875rem;font-weight:400;margin-left:auto;margin-right:auto;margin-top:1.25rem}.Post-module--post__home-button--16Kl0:focus,.Post-module--post__home-button--16Kl0:hover{color:#918d40}@media screen and (min-width:960px){.Post-module--post__comments--25y6I,.Post-module--post__footer--3WzWU{padding:0}.Post-module--post__home-button--16Kl0{position:fixed;max-width:auto;margin:0;top:30px;left:30px}}</style><meta name="generator" content="Gatsby 2.32.13"/><link rel="alternate" type="application/rss+xml" title="かえるのひみつきち" href="/rss.xml"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-122086587-6"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-122086587-6', {"send_page_view":false});
      }
      </script><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="icon" href="/favicon-32x32.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#F7A046"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><title data-react-helmet="true">Wani CTF 2023 Writeup - かえるのひみつきち</title><meta data-react-helmet="true" name="description" content="Wani CTF 2023 Writeup"/><meta data-react-helmet="true" property="og:site_name" content="Wani CTF 2023 Writeup - かえるのひみつきち"/><meta data-react-helmet="true" property="og:image" content="https://kashiwaba-yuki.com/static/cfb330dbf4cc573a235a16bb60c04814/ctf-wanictf-2023.png"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:title" content="Wani CTF 2023 Writeup - かえるのひみつきち"/><meta data-react-helmet="true" name="twitter:description" content="Wani CTF 2023 Writeup"/><meta data-react-helmet="true" name="twitter:image" content="https://kashiwaba-yuki.com/static/cfb330dbf4cc573a235a16bb60c04814/ctf-wanictf-2023.png"/><link as="script" rel="preload" href="/webpack-runtime-a3c0f166cb4b802ff58f.js"/><link as="script" rel="preload" href="/framework-3761df4ab6ee9f056936.js"/><link as="script" rel="preload" href="/532a2f07-92db97c0addf07d5cb73.js"/><link as="script" rel="preload" href="/dc6a8720040df98778fe970bf6c000a41750d3ae-cca4015309d56249d0dd.js"/><link as="script" rel="preload" href="/app-a34cb4a57265a0cdacdf.js"/><link as="script" rel="preload" href="/styles-407fe62976dc5310c43e.js"/><link as="script" rel="preload" href="/cd95ea5cbd2c605f26db819f07999610c9ff4310-c2f05dc74373de400085.js"/><link as="script" rel="preload" href="/component---src-templates-post-template-js-381c1b847824134fa4bd.js"/><link as="fetch" rel="preload" href="/page-data/ctf-wanictf-2023/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/251939775.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/401334301.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/825871152.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="Layout-module--layout--3Pyz6"><div><a class="Post-module--post__home-button--16Kl0" href="/">All Articles</a><div><div class="Content-module--content--3p512"><h1 class="Content-module--content__title--2BDW9">Wani CTF 2023 Writeup</h1><div class="Content-module--content__body--2TrQ-"><p>2023 年 5 月 4 日から開催されていた WaniCTF 2023 に 0nePadding で参加していました。</p>
<p>Rev と Forensic は全完し、最終順位は 39 位 / 1110 チームでした。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/44c0b16fefaba7b0dc5a54f6aaf0381e/42de8/image-20230506151024667.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 49.583333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAACeUlEQVQozz2SS0hUcRTGp0WbNr7GZu7/Pub90mkcHWfUbHybr1BKA5l8RaWLiLKsDEmCMTOlFuUqd+16QqGoYBAmWJt2tSto3cqgQAh+/e8dc/FxLud/z3e+c85nU1UVXdf3oWnafgwEAkSjUWKxmBXL43FCwQBmjflu/ety7dcKIbCZSVXVLei6gcdwYZg5+eh2u/F6vfh8Pvx+Hy6PD0X3WPn/0Ox2dKFgSGKzkc2pCCpjQRKlASorg4RjYUqTURKpuOyYU++RhfbDgu50mJv9CRTNJRt58HjdlE1M4a9vQnc6UKUQm1BUwkc8REI+4r23uNg9QF8sjh4sw9A1DMPA7/OSbxdMZSrYnGskr1hIVRpKoZO6zc+UDJ1DKyxAlc33RlZI3nhCw8Iu62dm+DXSQn9LCcVODbfLkGrcHCxwcPV0nPVsA/mFgpJUgPKOEmpXNomcGbZGtwiF/Ai2ttP64ydHV3d4eXmav0vNvJttxqnkFIb8XibLkjweqmH5bj0HbEU0jVcxutVDzdsPRDIDiLxDe4RFRYQ6T9D8fYeub2ssfhlk52sf75+2o0hC3dAJy5E/tnTy7HwdL+6kmbxexYVHjWTedFH9ao3EtYfE2yblDuVRNFVI5gCdz6e4vTvCxJ9BNn4Pc2U8hd2uyusZROSFt5s7eD1Wbyn8tN1DdrmLzLpUuLJB7f1VGi5tSULTNnLxmlywP6TQNn2M3qXjVGfiqI7cuJocI+Bxs1iTJnsqxexoioX5Os5m03TMN5K494CKsRmSJ+cQUpzN9I6pQlMNnPkCR56CYiqTZBb0XBSmcTXDgqJI3wrpWwlD+tWQRIZUZ3L9Aw8lVbe7qpVvAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/44c0b16fefaba7b0dc5a54f6aaf0381e/8ac56/image-20230506151024667.webp 240w,
/static/44c0b16fefaba7b0dc5a54f6aaf0381e/d3be9/image-20230506151024667.webp 480w,
/static/44c0b16fefaba7b0dc5a54f6aaf0381e/e46b2/image-20230506151024667.webp 960w,
/static/44c0b16fefaba7b0dc5a54f6aaf0381e/de74f/image-20230506151024667.webp 1033w"
              sizes="(max-width: 960px) 100vw, 960px"
              type="image/webp"
            />
          <source
            srcset="/static/44c0b16fefaba7b0dc5a54f6aaf0381e/8ff5a/image-20230506151024667.png 240w,
/static/44c0b16fefaba7b0dc5a54f6aaf0381e/e85cb/image-20230506151024667.png 480w,
/static/44c0b16fefaba7b0dc5a54f6aaf0381e/d9199/image-20230506151024667.png 960w,
/static/44c0b16fefaba7b0dc5a54f6aaf0381e/42de8/image-20230506151024667.png 1033w"
            sizes="(max-width: 960px) 100vw, 960px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/44c0b16fefaba7b0dc5a54f6aaf0381e/d9199/image-20230506151024667.png"
            alt="image-20230506151024667"
            title="image-20230506151024667"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>例によって Reversing に取り組み全完できたので、いくつか Writeup としてまとめておきます。</p>
<!-- omit in toc -->
<h2 id="もくじ" style="position:relative;"><a href="#%E3%82%82%E3%81%8F%E3%81%98" aria-label="もくじ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>もくじ</h2>
<ul>
<li><a href="#javersingrev">javersing(Rev)</a></li>
<li><a href="#luarev">Lua(Rev)</a></li>
<li><a href="#theseusrev">theseus(Rev)</a></li>
<li><a href="#web_assemblyrev">web_assembly(Rev)</a></li>
<li><a href="#lowkey_messedupforensic">lowkey_messedup(Forensic)</a></li>
<li><a href="#web-64bpsweb">web-64bps(Web)</a></li>
<li><a href="#%E3%81%BE%E3%81%A8%E3%82%81">まとめ</a></li>
</ul>
<h2 id="javersingrev" style="position:relative;"><a href="#javersingrev" aria-label="javersingrev permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>javersing(Rev)</h2>
<p>問題バイナリの javersing.jar を jd-gui でデコンパイルすると以下の出力を得られます。</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Scanner</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> javersing <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> paramArrayOfString<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> str1 <span class="token operator">=</span> <span class="token string">"Fcn_yDlvaGpj_Logi}eias{iaeAm_s"</span><span class="token punctuation">;</span>
    <span class="token keyword">boolean</span> bool <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token class-name">Scanner</span> scanner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Input password: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> str2 <span class="token operator">=</span> scanner<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    str2 <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%30s"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> str2 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">byte</span> b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> b <span class="token operator">&lt;</span> <span class="token number">30</span><span class="token punctuation">;</span> b<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>str2<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>b <span class="token operator">*</span> <span class="token number">7</span> <span class="token operator">%</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token operator">!=</span> str1<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
        bool <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span> 
    <span class="token keyword">if</span> <span class="token punctuation">(</span>bool<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Correct!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Incorrect..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> 
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>このコードを読むと、入力した値の<code class="language-text">b * 7 % 30</code>番目の値が str1の b 番目の値と一致するかの検証を行っています。</p>
<p>そこで、str1 の<code class="language-text">b * 7 % 30</code>番目の値を取り出す以下の Solver を作成し、Flag を取得しました。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">base <span class="token operator">=</span> <span class="token string">"Fcn_yDlvaGpj_Logi}eias{iaeAm_s"</span>
flag <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">""</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">30</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    flag<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">7</span><span class="token operator">%</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">=</span> base<span class="token punctuation">[</span>i<span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div>
<h2 id="luarev" style="position:relative;"><a href="#luarev" aria-label="luarev permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Lua(Rev)</h2>
<p>Lua で作成された<a href="https://gist.github.com/kash1064/2b8143043a876f45e1e124c51a91c637" target="_blank" rel="nofollow noopener noreferrer">問題コード</a>が与えられます。</p>
<p>※ 1300 行くらいあるので Gist に分割しました。</p>
<p>コードをざっと眺めると、関数や変数の値は暗号化されてスクリプト内に埋め込まれているようでした。</p>
<p>馬鹿正直にコードを読むのはきつそうだったので、暗号化を解除していそうなところにブレークポイントを設定してみることにしました。</p>
<p>デバッグは VSCode の拡張機能を使用しました。</p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token comment">// Use IntelliSense to learn about possible attributes.</span>
    <span class="token comment">// Hover to view descriptions of existing attributes.</span>
    <span class="token comment">// For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387</span>
    <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"0.2.0"</span><span class="token punctuation">,</span>
    <span class="token property">"configurations"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"lua"</span><span class="token punctuation">,</span>
            <span class="token property">"request"</span><span class="token operator">:</span> <span class="token string">"launch"</span><span class="token punctuation">,</span>
            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Debug"</span><span class="token punctuation">,</span>
            <span class="token property">"program"</span><span class="token operator">:</span> <span class="token string">"${workspaceFolder}/CTF/2023/WaniCTF2023/Rev/Lua/main.lua"</span><span class="token punctuation">,</span>
            <span class="token property">"consoleCoding"</span><span class="token operator">:</span> <span class="token string">"utf8"</span><span class="token punctuation">,</span>
            <span class="token property">"sourceCoding"</span><span class="token operator">:</span> <span class="token string">"utf8"</span><span class="token punctuation">,</span>
            <span class="token property">"luaexe"</span><span class="token operator">:</span> <span class="token string">"/usr/bin/lua5.1"</span><span class="token punctuation">,</span>
            <span class="token property">"outputCapture"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">"print"</span><span class="token punctuation">,</span>
                <span class="token string">"stderr"</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre></div>
<p>今回の問題コードは 5.2 以降の Lua では実行できないようでしたので、<code class="language-text">luaexe</code>にはインストールした<code class="language-text">lua5.1</code>のパスを指定しています。</p>
<p>これで、問題コードの以下の箇所にブレークポイントを設定してみたところ、暗号化解除された Flag 文字を含む Base64 テキストが取得できました。</p>
<div class="gatsby-highlight" data-language="lua"><pre class="language-lua"><code class="language-lua"><span class="token keyword">local</span> CRYPTEDlIIllIII <span class="token operator">=</span> <span class="token string">"NGI2d3Q8YSp3KmsvYWc9K0c6dw=="</span>
<span class="token keyword">local</span> CRYPTEDlIIlIIlI <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
  <span class="token keyword">local</span> c <span class="token operator">=</span> <span class="token function">CRYPTEDlIIlIlIl</span><span class="token punctuation">(</span><span class="token function">CRYPTEDlIIlIllI</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">local</span> d <span class="token operator">=</span> c<span class="token punctuation">[</span><span class="token string">"\99\105\112\104\101\114"</span><span class="token punctuation">]</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token function">CRYPTEDlIIlIllI</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token function">CRYPTEDlIIlIllI</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>
<span class="token keyword">end</span></code></pre></div>
<h2 id="theseusrev" style="position:relative;"><a href="#theseusrev" aria-label="theseusrev permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>theseus(Rev)</h2>
<p>Ghidra でデコンパイルしたところ、<code class="language-text">compare</code>という領域に Flag 文字列を埋め込んだ後に、<code class="language-text">compare</code>関数で入力値と検証を行っていることがわかりました。</p>
<p>そのため、<code class="language-text">compare</code>関数にブレークポイントを設定することで Flag を取得できました。</p>
<h2 id="web_assemblyrev" style="position:relative;"><a href="#web_assemblyrev" aria-label="web_assemblyrev permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>web_assembly(Rev)</h2>
<p>Web Asssembly の問題でした。</p>
<p>とりあえずダウンロードした wasm バイナリを wasm-decompile でデコンパイルするところから始めました。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">./wasm-decompile index.wasm -o decompile.txt</code></pre></div>
<p>出力結果を見ると分割された Flag のような文字列がちりばめられたデータ領域があることがわかりました。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">data d_3rinfinityFebruaryJanuaryJul<span class="token punctuation">(</span>offset: <span class="token number">65536</span><span class="token punctuation">)</span> <span class="token operator">=</span>
  <span class="token string">"3r!}<span class="token entity" title="\00">\00</span>infinity<span class="token entity" title="\00">\00</span>February<span class="token entity" title="\00">\00</span>January<span class="token entity" title="\00">\00</span>July<span class="token entity" title="\00">\00</span>Thursday<span class="token entity" title="\00">\00</span>Tuesday<span class="token entity" title="\00">\00</span>Wed"</span>
  <span class="token string">"nesday<span class="token entity" title="\00">\00</span>Saturday<span class="token entity" title="\00">\00</span>Sunday<span class="token entity" title="\00">\00</span>Monday<span class="token entity" title="\00">\00</span>Friday<span class="token entity" title="\00">\00</span>May<span class="token entity" title="\00">\00</span>%m/%d/%y<span class="token entity" title="\004">\004</span>n_3x<span class="token entity" title="\00">\00</span>"</span>
  <span class="token string">"-+   0X0x<span class="token entity" title="\00">\00</span>-0X+0X 0X-0x+0x 0x<span class="token entity" title="\00">\00</span>Nov<span class="token entity" title="\00">\00</span>Thu<span class="token entity" title="\00">\00</span>unsupported locale for st"</span>
  <span class="token string">"andard input<span class="token entity" title="\00">\00</span>August<span class="token entity" title="\00">\00</span>Oct<span class="token entity" title="\00">\00</span>Sat<span class="token entity" title="\000">\000</span>us<span class="token entity" title="\00">\00</span>Apr<span class="token entity" title="\00">\00</span>vector<span class="token entity" title="\00">\00</span>October<span class="token entity" title="\00">\00</span>Nov"</span>
  <span class="token string">"ember<span class="token entity" title="\00">\00</span>September<span class="token entity" title="\00">\00</span>December<span class="token entity" title="\00">\00</span>ios_base::clear<span class="token entity" title="\00">\00</span>Mar<span class="token entity" title="\00">\00</span>p_0n_Br<span class="token entity" title="\00">\00</span>Sep<span class="token entity" title="\00">\00</span>"</span>
  <span class="token string">"3cut3_Cp<span class="token entity" title="\00">\00</span>%I:%M:%S %p<span class="token entity" title="\00">\00</span>Sun<span class="token entity" title="\00">\00</span>Jun<span class="token entity" title="\00">\00</span>Mon<span class="token entity" title="\00">\00</span>nan<span class="token entity" title="\00">\00</span>Jan<span class="token entity" title="\00">\00</span>Jul<span class="token entity" title="\00">\00</span>ll<span class="token entity" title="\00">\00</span>Apri"</span>
  <span class="token string">"l<span class="token entity" title="\00">\00</span>Fri<span class="token entity" title="\00">\00</span>March<span class="token entity" title="\00">\00</span>Aug<span class="token entity" title="\00">\00</span>basic_string<span class="token entity" title="\00">\00</span>inf<span class="token entity" title="\00">\00</span>%.0Lf<span class="token entity" title="\00">\00</span>%Lf<span class="token entity" title="\00">\00</span>true<span class="token entity" title="\00">\00</span>Tue<span class="token entity" title="\00">\00</span>"</span>
  <span class="token string">"false<span class="token entity" title="\00">\00</span>June<span class="token entity" title="\00">\00</span>Wed<span class="token entity" title="\00">\00</span>Dec<span class="token entity" title="\00">\00</span>Feb<span class="token entity" title="\00">\00</span>Fla<span class="token entity" title="\00">\00</span>ckwajea<span class="token entity" title="\00">\00</span>%a %b %d %H:%M:%S %Y<span class="token entity" title="\00">\00</span>"</span>
  <span class="token string">"POSIX<span class="token entity" title="\00">\00</span>%H:%M:%S<span class="token entity" title="\00">\00</span>NAN<span class="token entity" title="\00">\00</span>PM<span class="token entity" title="\00">\00</span>AM<span class="token entity" title="\00">\00</span>LC_ALL<span class="token entity" title="\00">\00</span>LANG<span class="token entity" title="\00">\00</span>INF<span class="token entity" title="\00">\00</span>g{Y0u_C<span class="token entity" title="\000">\000</span>12"</span>
  <span class="token string">"3456789<span class="token entity" title="\00">\00</span>C.UTF-8<span class="token entity" title="\00">\00</span>.<span class="token entity" title="\00">\00</span>(null)<span class="token entity" title="\00">\00</span>Incorrect!<span class="token entity" title="\00">\00</span>Pure virtual function ca"</span>
  <span class="token string">"lled!<span class="token entity" title="\00">\00</span>Correct!! Flag is here!!<span class="token entity" title="\00">\00</span>feag5gwea1411_efae!!<span class="token entity" title="\00">\00</span>libc++abi: <span class="token entity" title="\00">\00</span>"</span>
  <span class="token string">"Your UserName : <span class="token entity" title="\00">\00</span>Your PassWord : <span class="token entity" title="\00">\00</span><span class="token entity" title="\00">\00</span><span class="token entity" title="\00">\00</span><span class="token entity" title="\00">\00</span><span class="token entity" title="\00">\00</span><span class="token entity" title="\00">\00</span>L<span class="token entity" title="\04">\04</span><span class="token entity" title="\01">\01</span><span class="token entity" title="\00">\00</span><span class="token entity" title="\02">\02</span><span class="token entity" title="\00">\00</span><span class="token entity" title="\00">\00</span>"</span></code></pre></div>
<p>ここからでもある程度 guessing できましたが、最終的には Chrome のデバッグ機能を使って正しいパスワードを入力した場合の処理を追うことにしました。</p>
<p>まず、func13 の $env.prompt_pass 以降が、パスワード入力後の処理であることがわかります。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 258px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/67a79f5bd0c498bc74145cd39cdffbf1/d9489/image-20230505222752374.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 95%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsTAAALEwEAmpwYAAAC80lEQVQ4y3VUV5LbMBTbeyTuTbLVqUL1Ltm72Uxmcv+zII/Plr3F+dBoRiQh4AHgi340kaQFsixHnBXwRIDVeofZYg3t4CHyzhBWA2H3yIO/8IMMb7/e8Xr5hbbrMad9y9X2/rwcdIM2RZBxgihO4biCAdXG/d6BZ9VwjQKRP8AnUFdIdN2ANC1R1w0WywfgYrm5AoZRwoChTOC6PtabPTNUgIHT46SF6PsR5/EVVd0jTTIGmn1h9wCUKeIbQ8v2aFFJXpJkgdC9wDzGmM2XdGDLzNXBxWLDID9nK1pb8bebZJMZJgmBpjl8P7pLPuxdBHYHUyeZw4CirOCLEBnJHc4XJHGMpmlRNQP2B53PvBw0A0EYI4okgiiGTQwfM7ThmhWsI83Wlgi9BkGQYujPuLy+YxgH6EeDHgtrOsOSNWIYkWTFUBJDz1MuX6UdyOWQZmidUnhmDWEOsMMIbuRjv9OZlZL7RbJyWfIMZTIB3iQfXAIqGdA1CzinEg7tFVGAk+FwxCagby5HMmbJHwGVZGG3LNs4kmRnpPX4KpdkB8T2Ww7vktOMTCnugFOwhU05JJYKWLpv9NOMDBopgz2E75Pcr8HWrpIVQxUf2xGfJAdOB9vIIOjtWx0My6cstjTzHJJy+1HyfYYKiJtCb9N0OIfz5VXyNMNU/MZua/J3dXClAFQelwpo89kUFZtYuXwzZWqKpnlUvYolG0dy16Achjl3uCxbtG1HAX/S5al6qin2rSmTZJ+CrUxRnQ6dM3U5pvxdeIYq1P8HlMl1hraLBS3MScJ0OThGzrIVoCcSdNTrthmR5+Vzl7l6N5fde2xW0DUBn8xQoEp6YI80nhz9cEaR15Td7Mn1dXM5pOr5NEt1Oaw/Va9kly2d5mtQr+2AGTbU36qunzCkC1bSnxRDZcojNiueYeiOLLmp3tEWf2hfxaYIL4Tjed9js9dOfAeGoeT78GrKluOx25k8O41mKelmick0lQjH8ejaWuIHPVPlJuB/xcZNI3lGCKAAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/67a79f5bd0c498bc74145cd39cdffbf1/8ac56/image-20230505222752374.webp 240w,
/static/67a79f5bd0c498bc74145cd39cdffbf1/6976b/image-20230505222752374.webp 258w"
              sizes="(max-width: 258px) 100vw, 258px"
              type="image/webp"
            />
          <source
            srcset="/static/67a79f5bd0c498bc74145cd39cdffbf1/8ff5a/image-20230505222752374.png 240w,
/static/67a79f5bd0c498bc74145cd39cdffbf1/d9489/image-20230505222752374.png 258w"
            sizes="(max-width: 258px) 100vw, 258px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/67a79f5bd0c498bc74145cd39cdffbf1/d9489/image-20230505222752374.png"
            alt="image-20230505222752374"
            title="image-20230505222752374"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>続いて、Chrome の Memory Inspector を起動します。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 422px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/6d26f7ac257b548de721bab39341e24d/fa5c1/image-20230505222910904.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 81.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAACn0lEQVQ4y3VUWXbaQBDkIGBASKB93xckIWQTsvzk/mepVI+ME17sj36zqqa6qlurKMkwjDOSrMTucMJur0M7HLHXjGWuL3u79/Vj/7F+2mOsXC+AW01w+zvscoQTJIiSHEGcI0lLJHkNL4iRVy3COENaNIh4FicFMs7lnpxFXKd5hZXtBrCKEXb/A1ZaI4hSxDyQsSg7Aso8Q1V1BKjgeCEsx4dpuQj4kMXvZc+0PdhuSEAe2vUE+3zHKWlQNy2G6RU5mcmZXJSUNMqhGydsNjtsXvZ42e6x5vyF82WtqXGlU6OjEyGYf8Nsbiql+/0Xdb2iHy4qPd0wVRx4d68t+v4bD/2UhsbRwpavGQQ1ohpmkCIqW7h+hCyr0J1HAk8YLldM1xsfyHA82SpliZPpKKDt7vAXUOhuuTD8DEZARhxPTFV0m+cb5tdvaLoBKSvB50Mig/UeAvopoGhkBgRiWGFO/QKENCOnBBIuhZdyOpKRsFImvJvzKaBl+4v1Ra1CnCsI1PcXpWXbDpjmV5rW4XKZmXoM+fZLQHk1Yt1l1E9GKY266XGd3wg4c7wpLc/9hJFVUNUt2maATabb/eEZcENTFEMCxTQiplYnvlwQXEzpqF/T9ortME7c62nQFQkb4EuGMgrgAlrCCxPkZaPMGOlwSUZd+4Zz+x1NfaOu1Uc5/QeoFjudbVQohimLOi1rNRdgx8v5oMc7JjTNh2FELGJNffeIB+iS8mYLi9QTmiCGSP8KmLDLqwYxW/I63VSaXT+g7c6qFgXgUdgfDE3Lge7ECMoBPsskySXlgoUds7ALtmCpnA3jFGVzhsc6XK93H6223uyfGToue7ma4Qw/YXqxYigaBvFS3PLzOJr28kOwl972KYOYKD+LLM+fGP4BFqbslxZ4sL4AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/6d26f7ac257b548de721bab39341e24d/8ac56/image-20230505222910904.webp 240w,
/static/6d26f7ac257b548de721bab39341e24d/fc0b3/image-20230505222910904.webp 422w"
              sizes="(max-width: 422px) 100vw, 422px"
              type="image/webp"
            />
          <source
            srcset="/static/6d26f7ac257b548de721bab39341e24d/8ff5a/image-20230505222910904.png 240w,
/static/6d26f7ac257b548de721bab39341e24d/fa5c1/image-20230505222910904.png 422w"
            sizes="(max-width: 422px) 100vw, 422px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/6d26f7ac257b548de721bab39341e24d/fa5c1/image-20230505222910904.png"
            alt="image-20230505222910904"
            title="image-20230505222910904"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>そこから、例えば以下のように、任意の文字列の格納されるアドレスを特定できます。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 725px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/1c272d021b62ef9fd8038b5d000eea88/a0209/image-20230505223141904.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 42.083333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABLklEQVQoz3VRWXaEMAzjKEMgG0uAAKHQmdfe/1Kq7QAzP/3Qkx1Hiu0UqjJQlUX6OrCmAzk3eJS1oFQaD0L5gf9y5kIbh1o7VLUl9sJsqI0XLslUfeBRVndcnlDqzUWMC0ZCHyaM04phiAiEtB1o2wFOG3TWojUGtmZoyRudY6mbXHdUL6aJDAldN5DRTPGMlmI2bNogJo3JosvA63zGOdfZjB9gLjYSLuuOKa6IcwLn3OF+vDBT7k+D4OwtlA7N2/iagLlIaZdu5iXRp+xYlk1W8Hz9YhypW+pscAwnIs6DzZAHCNG725Q6zIY8apw36Wogo+/nD0KIcrGji/0pYGaM9Iijkf25Q2ZT0S/3/SgjMnf9JOybXkx5h4ZETROoEwtNAhYx8y65doEN+fwPvI7t3j0Ml2AAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/1c272d021b62ef9fd8038b5d000eea88/8ac56/image-20230505223141904.webp 240w,
/static/1c272d021b62ef9fd8038b5d000eea88/d3be9/image-20230505223141904.webp 480w,
/static/1c272d021b62ef9fd8038b5d000eea88/92338/image-20230505223141904.webp 725w"
              sizes="(max-width: 725px) 100vw, 725px"
              type="image/webp"
            />
          <source
            srcset="/static/1c272d021b62ef9fd8038b5d000eea88/8ff5a/image-20230505223141904.png 240w,
/static/1c272d021b62ef9fd8038b5d000eea88/e85cb/image-20230505223141904.png 480w,
/static/1c272d021b62ef9fd8038b5d000eea88/a0209/image-20230505223141904.png 725w"
            sizes="(max-width: 725px) 100vw, 725px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/1c272d021b62ef9fd8038b5d000eea88/a0209/image-20230505223141904.png"
            alt="image-20230505223141904"
            title="image-20230505223141904"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>この中から Flag として使用されていそうな文字列のアドレスを逆引きしたところ、func13 でこれらの文字列が以下の順序で参照されていることがわかりました。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">i32.const <span class="token number">65948</span>
i32.const <span class="token number">66022</span>
i32.const <span class="token number">65642</span>
i32.const <span class="token number">65821</span>
i32.const <span class="token number">65809</span>
i32.const <span class="token number">65738</span>
i32.const <span class="token number">65536</span></code></pre></div>
<p>Memory Inspector に各アドレスを順番に入力した結果 Flag を取得できました。</p>
<h2 id="lowkey_messedupforensic" style="position:relative;"><a href="#lowkey_messedupforensic" aria-label="lowkey_messedupforensic permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>lowkey_messedup(Forensic)</h2>
<p>問題バイナリとして与えられた pcap ファイルを展開すると、以下のように <code class="language-text">Leftcver Capture Data</code>を含む一連の USB パケットであることがわかります。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 952px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/97442ef3488f000067c29e1a6615ce03/7e4a6/image-20230509221131962.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 50.83333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABxklEQVQoz2VSyZLTQAz1/38Df8CVI1UcGZjUEDLYjrcY744dr/GeiR+SBsIEVKVSt1p6epJaCcMIvu9j9/yMNE1h2zbiOIZpmmIdx5F313XlfjgcoGmq+LM8x+l0ulNlnmY65NhsNui6DnmWiT0ej5imCRnd2fb9AJY0SfD49Qv2ex3zvGC9XnF9o8qyLKjrCrqmU+KM4lRgHEbkVJ3fyrKkxBnjOAogs2CGnufhcnnBv6JwcHc+w7EdSazrGhMlV1WF12I1WQacJKEsCmEXBAEuL6+A67reVOF2CgoyDVOSmMEwDMKQC/CdLftYeCTb7TciYN8Y3gEyCAepqnoD6vteZvcHUGb4G5D9u91WlrMsF0a7B+S2mqaRAK7Yti3Zi/g44Ezj4GGzj6WqaliWQRuPsOJ/UZhBHEXUsoGMNhvSbI70fcIwFOZB4Iuft95SkSwOoVE3lmUhp1xeWlUWqEnZKo7r4WmnwXB+QrMO0Em3P3Sohi3nve2SJd0b+K4Z+PCgw3Rc+LTlKE6QRAE+Ptl498nC+88OlLLt4WUNkrJDWo+IizO8tBQthivqGaJ52SDKSjwGA/r57+zoI6JfVhT0qxqK+wVYrfKqdwGc+QAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/97442ef3488f000067c29e1a6615ce03/8ac56/image-20230509221131962.webp 240w,
/static/97442ef3488f000067c29e1a6615ce03/d3be9/image-20230509221131962.webp 480w,
/static/97442ef3488f000067c29e1a6615ce03/60b07/image-20230509221131962.webp 952w"
              sizes="(max-width: 952px) 100vw, 952px"
              type="image/webp"
            />
          <source
            srcset="/static/97442ef3488f000067c29e1a6615ce03/8ff5a/image-20230509221131962.png 240w,
/static/97442ef3488f000067c29e1a6615ce03/e85cb/image-20230509221131962.png 480w,
/static/97442ef3488f000067c29e1a6615ce03/7e4a6/image-20230509221131962.png 952w"
            sizes="(max-width: 952px) 100vw, 952px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/97442ef3488f000067c29e1a6615ce03/7e4a6/image-20230509221131962.png"
            alt="image-20230509221131962"
            title="image-20230509221131962"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>このような通信は、以下の HackTricks にあるような USB Keystrokes に該当することがわかります。</p>
<p>参考：<a href="https://book.hacktricks.xyz/generic-methodologies-and-resources/basic-forensic-methodology/pcap-inspection/usb-keystrokes" target="_blank" rel="nofollow noopener noreferrer">USB Keystrokes - HackTricks</a></p>
<p>キーストロークを抽出するため、以下のコマンドを実行しました。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token comment"># usb.capdata の抽出</span>
tshark -r ./chall.pcap -Y <span class="token string">'usb.capdata &amp;&amp; usb.data_len == 8'</span> -T fields -e usb.capdata <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'s/../:&amp;/g2'</span> <span class="token operator">></span> keystrokes.txt

<span class="token comment"># keystrokes.txt からキー入力を解析</span>
python3 solver.py ./keystrokes.txt</code></pre></div>
<p>上記を実行すると<code class="language-text">FLAG{Big_br0ther_is_watching_y0ur_keyboard⌫⌫⌫⌫0ard}</code>を取得できました。</p>
<p>間に BackSpace が存在していたので、実際の Flag 入力が<code class="language-text">FLAG{Big_br0ther_is_watching_y0ur_keyb0ard}</code>であることがわかりました。</p>
<p>solver.py は以下を使用しました。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token comment">#!/usr/bin/python</span>
<span class="token comment"># -*- coding: utf-8 -*-</span>

<span class="token keyword">import</span> sys

<span class="token comment">#More symbols in https://www.fileformat.info/search/google.htm?q=capslock+symbol&amp;domains=www.fileformat.info&amp;sitesearch=www.fileformat.info&amp;client=pub-6975096118196151&amp;forid=1&amp;channel=1657057343&amp;ie=UTF-8&amp;oe=UTF-8&amp;cof=GALT%3A%23008000%3BGL%3A1%3BDIV%3A%23336699%3BVLC%3A663399%3BAH%3Acenter%3BBGC%3AFFFFFF%3BLBGC%3A336699%3BALC%3A0000FF%3BLC%3A0000FF%3BT%3A000000%3BGFNT%3A0000FF%3BGIMP%3A0000FF%3BFORID%3A11&amp;hl=en</span>
KEY_CODES <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token number">0x04</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x05</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x06</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x07</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'D'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x08</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'e'</span><span class="token punctuation">,</span> <span class="token string">'E'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x09</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'f'</span><span class="token punctuation">,</span> <span class="token string">'F'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x0A</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'g'</span><span class="token punctuation">,</span> <span class="token string">'G'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x0B</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'h'</span><span class="token punctuation">,</span> <span class="token string">'H'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x0C</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'i'</span><span class="token punctuation">,</span> <span class="token string">'I'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x0D</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'j'</span><span class="token punctuation">,</span> <span class="token string">'J'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x0E</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'k'</span><span class="token punctuation">,</span> <span class="token string">'K'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x0F</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'l'</span><span class="token punctuation">,</span> <span class="token string">'L'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x10</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token string">'M'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x11</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'n'</span><span class="token punctuation">,</span> <span class="token string">'N'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x12</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'o'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x13</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'p'</span><span class="token punctuation">,</span> <span class="token string">'P'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x14</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'q'</span><span class="token punctuation">,</span> <span class="token string">'Q'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x15</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'r'</span><span class="token punctuation">,</span> <span class="token string">'R'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x16</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'s'</span><span class="token punctuation">,</span> <span class="token string">'S'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x17</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'t'</span><span class="token punctuation">,</span> <span class="token string">'T'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x18</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'u'</span><span class="token punctuation">,</span> <span class="token string">'U'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x19</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'v'</span><span class="token punctuation">,</span> <span class="token string">'V'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x1A</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'w'</span><span class="token punctuation">,</span> <span class="token string">'W'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x1B</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token string">'X'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x1C</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'y'</span><span class="token punctuation">,</span> <span class="token string">'Y'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x1D</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'z'</span><span class="token punctuation">,</span> <span class="token string">'Z'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x1E</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'!'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x1F</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token string">'@'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x20</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token string">'#'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x21</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'4'</span><span class="token punctuation">,</span> <span class="token string">'$'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x22</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'5'</span><span class="token punctuation">,</span> <span class="token string">'%'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x23</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'6'</span><span class="token punctuation">,</span> <span class="token string">'^'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x24</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'7'</span><span class="token punctuation">,</span> <span class="token string">'&amp;'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x25</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'8'</span><span class="token punctuation">,</span> <span class="token string">'*'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x26</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'9'</span><span class="token punctuation">,</span> <span class="token string">'('</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x27</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'0'</span><span class="token punctuation">,</span> <span class="token string">')'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x28</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'\n'</span><span class="token punctuation">,</span><span class="token string">'\n'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x29</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'␛'</span><span class="token punctuation">,</span><span class="token string">'␛'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x2a</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'⌫'</span><span class="token punctuation">,</span> <span class="token string">'⌫'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x2b</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'\t'</span><span class="token punctuation">,</span><span class="token string">'\t'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x2C</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x2D</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'-'</span><span class="token punctuation">,</span> <span class="token string">'_'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x2E</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'='</span><span class="token punctuation">,</span> <span class="token string">'+'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x2F</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'['</span><span class="token punctuation">,</span> <span class="token string">'{'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x30</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">']'</span><span class="token punctuation">,</span> <span class="token string">'}'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x32</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'#'</span><span class="token punctuation">,</span><span class="token string">'~'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x33</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">';'</span><span class="token punctuation">,</span> <span class="token string">':'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x34</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'\''</span><span class="token punctuation">,</span> <span class="token string">'"'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x36</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">','</span><span class="token punctuation">,</span> <span class="token string">'&lt;'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x37</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'.'</span><span class="token punctuation">,</span> <span class="token string">'>'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x38</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">'?'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x39</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'⇪'</span><span class="token punctuation">,</span><span class="token string">'⇪'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x4f</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">u'→'</span><span class="token punctuation">,</span><span class="token string">u'→'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x50</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">u'←'</span><span class="token punctuation">,</span><span class="token string">u'←'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x51</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">u'↓'</span><span class="token punctuation">,</span><span class="token string">u'↓'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">0x52</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">u'↑'</span><span class="token punctuation">,</span><span class="token string">u'↑'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>


<span class="token comment">#tshark -r ./usb.pcap -Y 'usb.capdata &amp;&amp; usb.data_len == 8' -T fields -e usb.capdata | sed 's/../:&amp;/g2' > keyboards.txt</span>
<span class="token keyword">def</span> <span class="token function">read_use</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        datas <span class="token operator">=</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    datas <span class="token operator">=</span> <span class="token punctuation">[</span>d<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> d <span class="token keyword">in</span> datas <span class="token keyword">if</span> d<span class="token punctuation">]</span> 
    cursor_x <span class="token operator">=</span> <span class="token number">0</span>
    cursor_y <span class="token operator">=</span> <span class="token number">0</span>
    lines <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    output <span class="token operator">=</span> <span class="token string">''</span>
    skip_next <span class="token operator">=</span> <span class="token boolean">False</span>
    lines<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>
    
    <span class="token keyword">for</span> data <span class="token keyword">in</span> datas<span class="token punctuation">:</span>
        shift <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token comment"># 0x2 is left shift 0x20 is right shift</span>
        key <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> skip_next<span class="token punctuation">:</span>
            skip_next <span class="token operator">=</span> <span class="token boolean">False</span>
            <span class="token keyword">continue</span>
        
        <span class="token keyword">if</span> key <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">or</span> <span class="token builtin">int</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>
        
        <span class="token comment">#If you don't like output get a more verbose output here (maybe you need to map new rekeys or remap some of them)</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> key <span class="token keyword">in</span> KEY_CODES<span class="token punctuation">:</span>
            <span class="token comment">#print("Not found: "+str(key))</span>
            <span class="token keyword">continue</span>
        
        <span class="token keyword">if</span> shift <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
            shift<span class="token operator">=</span><span class="token number">1</span>
            skip_next <span class="token operator">=</span> <span class="token boolean">True</span>

        <span class="token keyword">if</span> KEY_CODES<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">[</span>shift<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">u'↑'</span><span class="token punctuation">:</span>
            lines<span class="token punctuation">[</span>cursor_y<span class="token punctuation">]</span> <span class="token operator">+=</span> output
            output <span class="token operator">=</span> <span class="token string">''</span>
            cursor_y <span class="token operator">-=</span> <span class="token number">1</span>
        
        <span class="token keyword">elif</span> KEY_CODES<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">[</span>shift<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">u'↓'</span><span class="token punctuation">:</span>
            lines<span class="token punctuation">[</span>cursor_y<span class="token punctuation">]</span> <span class="token operator">+=</span> output
            output <span class="token operator">=</span> <span class="token string">''</span>
            cursor_y <span class="token operator">+=</span> <span class="token number">1</span>

        <span class="token keyword">elif</span> KEY_CODES<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">[</span>shift<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">u'→'</span><span class="token punctuation">:</span>
            cursor_x <span class="token operator">+=</span> <span class="token number">1</span>

        <span class="token keyword">elif</span> KEY_CODES<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">[</span>shift<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">u'←'</span><span class="token punctuation">:</span>
            cursor_x <span class="token operator">-=</span> <span class="token number">1</span>

        <span class="token keyword">elif</span> KEY_CODES<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">[</span>shift<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\n'</span><span class="token punctuation">:</span>
            lines<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>
            lines<span class="token punctuation">[</span>cursor_y<span class="token punctuation">]</span> <span class="token operator">+=</span> output
            cursor_x <span class="token operator">=</span> <span class="token number">0</span>
            cursor_y <span class="token operator">+=</span> <span class="token number">1</span>
            output <span class="token operator">=</span> <span class="token string">''</span>

        <span class="token keyword">elif</span> KEY_CODES<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">[</span>shift<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'[BACKSPACE]'</span><span class="token punctuation">:</span>
            output <span class="token operator">=</span> output<span class="token punctuation">[</span><span class="token punctuation">:</span>cursor_x<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> output<span class="token punctuation">[</span>cursor_x<span class="token punctuation">:</span><span class="token punctuation">]</span>
            cursor_x <span class="token operator">-=</span> <span class="token number">1</span>
        
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            output <span class="token operator">=</span> output<span class="token punctuation">[</span><span class="token punctuation">:</span>cursor_x<span class="token punctuation">]</span> <span class="token operator">+</span> KEY_CODES<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">[</span>shift<span class="token punctuation">]</span> <span class="token operator">+</span> output<span class="token punctuation">[</span>cursor_x<span class="token punctuation">:</span><span class="token punctuation">]</span>
            cursor_x <span class="token operator">+=</span> <span class="token number">1</span>
    
    <span class="token keyword">if</span> lines <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token string">""</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        lines<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> output
    
    <span class="token keyword">if</span> output <span class="token operator">!=</span> <span class="token string">''</span> <span class="token keyword">and</span> output <span class="token keyword">not</span> <span class="token keyword">in</span> lines<span class="token punctuation">:</span>
        lines<span class="token punctuation">[</span>cursor_y<span class="token punctuation">]</span> <span class="token operator">+=</span> output
    
    <span class="token keyword">return</span> <span class="token string">'\n'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>lines<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Missing file to read...'</span><span class="token punctuation">)</span>
        exit<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>write<span class="token punctuation">(</span>read_use<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div>
<h2 id="web-64bpsweb" style="position:relative;"><a href="#web-64bpsweb" aria-label="web 64bpsweb permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>web-64bps(Web)</h2>
<p>かなり久しぶりに Web の問題を解きました。</p>
<p>問題サーバは、以下の Dockerfile と nginx.conf で構成されているサーバです。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">FROM nginx:1.23.3-alpine-slim

COPY nginx.conf /etc/nginx/nginx.conf
COPY flag.txt /usr/share/nginx/html/flag.txt

RUN <span class="token builtin class-name">cd</span> /usr/share/nginx/html <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
    <span class="token function">dd</span> <span class="token assign-left variable">if</span><span class="token operator">=</span>/dev/random <span class="token assign-left variable">of</span><span class="token operator">=</span>2gb.txt <span class="token assign-left variable">bs</span><span class="token operator">=</span>1M <span class="token assign-left variable">count</span><span class="token operator">=</span><span class="token number">2048</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
    <span class="token function">cat</span> flag.txt <span class="token operator">>></span> 2gb.txt <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
    <span class="token function">rm</span> flag.txt</code></pre></div>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">user  nginx<span class="token punctuation">;</span>
worker_processes  auto<span class="token punctuation">;</span>

error_log  /var/log/nginx/error.log notice<span class="token punctuation">;</span>
pid        /var/run/nginx.pid<span class="token punctuation">;</span>


events <span class="token punctuation">{</span>
    worker_connections  <span class="token number">1024</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


http <span class="token punctuation">{</span>
    include       /etc/nginx/mime.types<span class="token punctuation">;</span>
    default_type  application/octet-stream<span class="token punctuation">;</span>

    keepalive_timeout  <span class="token number">65</span><span class="token punctuation">;</span>
    <span class="token function">gzip</span>               off<span class="token punctuation">;</span>
    limit_rate         <span class="token number">8</span><span class="token punctuation">;</span> <span class="token comment"># 8 bytes/s = 64 bps</span>

    server <span class="token punctuation">{</span>
        listen       <span class="token number">80</span><span class="token punctuation">;</span>
        listen  <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:80<span class="token punctuation">;</span>
        server_name  localhost<span class="token punctuation">;</span>

        location / <span class="token punctuation">{</span>
            root   /usr/share/nginx/html<span class="token punctuation">;</span>
            index  index.html index.htm<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Flag テキストは 2 GB のランダムなバイナリの末尾に結合されており、Nginx 側の limit_rate が極めて小さく設定されているために、実質的にダウンロードが不可能な状況でした。</p>
<p>そのため、HTTP リクエストで<code class="language-text">Content-Range</code>と<code class="language-text">Content-Length</code>を指定することで、任意のオフセットのバイトデータのみを抽出することにしました。</p>
<p>参考：<a href="https://stackoverflow.com/questions/3203217/read-file-from-server-with-some-offset" target="_blank" rel="nofollow noopener noreferrer">python - read file from server with some offset - Stack Overflow</a></p>
<p>このようなリクエストは curl の -r オプションを使用することでも発行できます。</p>
<p>今回は、以下のように 2147483603 から 2147483793 までのおよそ 200 バイト分くらいを取得するコマンドで Flag を取得できました。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">curl</span> -r <span class="token number">2147483603</span>-2147483793 <span class="token string">"https://64bps-web.wanictf.org/2gb.txt"</span> -o flag.txt</code></pre></div>
<h2 id="まとめ" style="position:relative;"><a href="#%E3%81%BE%E3%81%A8%E3%82%81" aria-label="まとめ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>まとめ</h2>
<p>序盤は 10 位以内に入れるいいペースだったのですが、途中から解ける問題がなくなり頭打ちになりました。</p>
<p>Misc の競プロ問は実装力不足で解けなかったので悔しいです。</p>
<p>競プロ再開した方がいいんだろうか。。</p></div></div></div><div class="Post-module--post__footer--3WzWU"><div><p class="Meta-module--meta__date--29eD7">Published <!-- -->May 6, 2023</p></div><div class="Tags-module--tags--1L_ct"><ul class="Tags-module--tags__list--91FqN"><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/ctf/">CTF</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/rev/">Rev</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/forensic/">Forensic</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/web/">Web</a></li></ul></div><div class="Author-module--author--2Yefr"><p>リバースエンジニアになりたいCTF Player(Team: 0nePadding)。WinDbgとYARAが好き。OSCP / CISSP / AtCoder 緑 Microsoft Japanに所属してます。発言はすべて個人の見解。<a class="Author-module--author__bio-twitter--n-O9n" href="https://www.twitter.com/kash1064" rel="noopener noreferrer" target="_blank"><strong>かしわば</strong> on Twitter</a></p></div></div><div class="Post-module--post__comments--25y6I"></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/ctf-wanictf-2023";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-299cfcade846097f4d4b.js"],"app":["/app-a34cb4a57265a0cdacdf.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-fd4fb51a6fac1c18bdde.js"],"component---src-templates-categories-list-template-js":["/component---src-templates-categories-list-template-js-2181ec47d28e5c35d3e9.js"],"component---src-templates-category-template-js":["/component---src-templates-category-template-js-76f2006942127b3c7274.js"],"component---src-templates-index-template-js":["/component---src-templates-index-template-js-70ba56c0f46525baa629.js"],"component---src-templates-not-found-template-js":["/component---src-templates-not-found-template-js-d19905e5c8fc953958f1.js"],"component---src-templates-page-template-js":["/component---src-templates-page-template-js-6ba68ef37e264f701345.js"],"component---src-templates-post-template-js":["/component---src-templates-post-template-js-381c1b847824134fa4bd.js"],"component---src-templates-tag-template-js":["/component---src-templates-tag-template-js-0faa242d92f89b71e668.js"],"component---src-templates-tags-list-template-js":["/component---src-templates-tags-list-template-js-2d7007993fc2bf0f9caf.js"]};/*]]>*/</script><script src="/polyfill-299cfcade846097f4d4b.js" nomodule=""></script><script src="/component---src-templates-post-template-js-381c1b847824134fa4bd.js" async=""></script><script src="/cd95ea5cbd2c605f26db819f07999610c9ff4310-c2f05dc74373de400085.js" async=""></script><script src="/styles-407fe62976dc5310c43e.js" async=""></script><script src="/app-a34cb4a57265a0cdacdf.js" async=""></script><script src="/dc6a8720040df98778fe970bf6c000a41750d3ae-cca4015309d56249d0dd.js" async=""></script><script src="/532a2f07-92db97c0addf07d5cb73.js" async=""></script><script src="/framework-3761df4ab6ee9f056936.js" async=""></script><script src="/webpack-runtime-a3c0f166cb4b802ff58f.js" async=""></script></body></html>