<!DOCTYPE html><html lang="ja"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.e71379dda153709d1a9a.css" id="gatsby-global-css">html{font-size:100}body{margin:0 0 0 calc(100vw - 100%);color:#222;line-height:1.4;font-size:.875rem;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;background-color:#fcfcfc}body,h1,h2,h3,h4,h5,h6{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif}h1,h2,h3,h4,h5,h6{font-weight:600}h1{font-size:1.575rem;line-height:2.25rem;margin-top:5rem;margin-bottom:1.25rem}h2{font-size:1.47656rem;line-height:1.875rem}h2,h3{margin-top:2.5rem;margin-bottom:.625rem}h3{font-size:1.20313rem;line-height:1.25rem}h4{font-size:1.05rem;margin-top:1.875rem}h4,h5{line-height:1.25rem;margin-bottom:.625rem}h5,h6{font-size:.875rem;margin-top:3.125rem}h6{line-height:1.25rem;margin-bottom:.625rem}img{max-width:100%;margin:inherit auto}hr,img{border:0;display:block}hr{color:#222;height:1.625rem;margin:3.25rem auto;background-size:100% 26px;background-image:linear-gradient(180deg,transparent 1px,transparent 11px,#222 0,#222 15px,transparent 0,transparent 26px);width:6.25rem}a{color:#918d40;text-decoration:none}a:active,a:focus,a:hover{color:#a9d159}b,strong{font-weight:600}ul{list-style:square;margin-bottom:1.25rem}ul li{padding:0 .3125rem;margin-bottom:.625rem}p{line-height:1.25rem;margin-bottom:1.25rem}blockquote{font-style:italic;text-align:center;background-color:#f5f5f5;padding:.1875rem .625rem}figure{display:block;width:100%;height:auto}figcaption{line-height:.9375rem;margin-top:.3125rem;color:#222;font-size:.75rem;font-style:italic;margin-bottom:0;text-align:center}.anchor{margin-left:-1.875rem!important;padding-right:.875rem!important}@media screen and (min-width:685px){figure.float-left,figure.float-right{max-width:19.375rem;padding:0 1.25rem}.float-right{float:right}.float-left{float:left}}code[class*=language-],pre[class*=language-]{color:#ccc;background:0 0;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}li>code[class*=language-text],p>code[class*=language-text]{background:#f9f9f9!important;color:#2d2d2d!important}.Author-module--author__photo--36xCH{display:inline-block;margin-bottom:0;border-radius:50%;background-clip:padding-box}.Author-module--author__title--2CaTb{font-size:.98438rem;font-weight:600;line-height:1.40625rem;margin:.625rem 0}.Author-module--author__title-link--Yrism,.Author-module--author__title-link--Yrism:focus,.Author-module--author__title-link--Yrism:hover{color:#222}.Author-module--author__subtitle--cAaEB{color:#888;line-height:1.25rem;margin-bottom:1.25rem}.Icon-module--icon--Gpyvw{display:inline-block;width:1em;height:1em;stroke-width:0;stroke:currentColor;fill:currentColor;font-style:normal;font-weight:400;speak:none;margin-right:.2em;text-align:center;font-variant:normal;text-transform:none;line-height:1em;margin-left:.2em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.Contacts-module--contacts--1rGd1{margin-bottom:1.25rem}.Contacts-module--contacts__list--3OgdW{display:flex;flex-flow:row wrap;flex-grow:0;flex-shrink:0;list-style:none;padding:0;margin:.625rem -.1875rem;width:8.75rem}.Contacts-module--contacts__list-item--16p9q{padding:0;margin:.25rem;display:flex;align-content:center;align-items:center;justify-content:center;height:2.1875rem;width:2.1875rem;line-height:2.1875rem;border-radius:50%;text-align:center;border:1px solid #ebebeb}.Contacts-module--contacts__list-item-link--2MIDn{border:0;display:flex;color:#222}.Contacts-module--contacts__list-item-link--2MIDn:focus,.Contacts-module--contacts__list-item-link--2MIDn:hover{color:#918d40}.Copyright-module--copyright--1ariN{color:#b6b6b6;font-size:.75rem}.Menu-module--menu--Efbin{margin-bottom:1.25rem}.Menu-module--menu__list--31Zeo{list-style:none;padding:0;margin:0}.Menu-module--menu__list-item--1lJ6B{padding:0;margin:.625rem 0}.Menu-module--menu__list-item-link--10Ush{font-size:.875rem;color:#222;font-weight:400;border:0}.Menu-module--menu__list-item-link--10Ush:focus,.Menu-module--menu__list-item-link--10Ush:hover{color:#918d40;border-bottom:1px solid #918d40}.Menu-module--menu__list-item-link--active--2CbUO{color:#222;border-bottom:1px solid #222}.Sidebar-module--sidebar--X4z2p{width:100%}.Sidebar-module--sidebar__inner--Jdc5s{position:relative;padding:1.5625rem 1.25rem 0}.Sidebar-module--headerimage--19Rdy{width:100%;min-height:70px;max-height:120px;margin:0 0 .625rem}.Sidebar-module--logo-image--XDYae{min-height:70px;max-height:120px;margin:0 auto}input{-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:.625rem;margin:.3125rem 0;border:1px solid #999;border-radius:.3125rem}.Sidebar-module--search-container--17C6F{position:relative}.Sidebar-module--search-container-input--27Tw4{width:100%}.Sidebar-module--search-container-submit--WwtLg{position:absolute;width:2.375rem;height:2.375rem;top:calc(50% - 19px);right:0;border:3px solid #999;border-radius:0 .25rem .25rem 0;background:#999}.Sidebar-module--search-container-submit--WwtLg:before{position:absolute;content:"";width:.9375rem;height:.9375rem;top:calc(50% - 9px);left:calc(50% - 9px);border-radius:50%;box-shadow:0 0 0 2px #fff}.Sidebar-module--search-container-submit--WwtLg:after{position:absolute;content:"";width:.5rem;height:.375rem;top:calc(50% + 6px);left:calc(50% + 2px);border-top:2px solid #fff;transform:rotate(45deg)}@media screen and (min-width:685px){.Sidebar-module--sidebar--X4z2p{width:calc(41.625% - 1.09375rem)}.Sidebar-module--sidebar--X4z2p:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--X4z2p:last-child{margin-right:0}.Sidebar-module--sidebar--X4z2p:nth-child(12n){margin-right:0;float:right}.Sidebar-module--sidebar--X4z2p:nth-child(12n+1){clear:both}.Sidebar-module--sidebar__inner--Jdc5s{padding:1.875rem 1.25rem 0}.Sidebar-module--sidebar__inner--Jdc5s:after{background:#e6e6e6;background:linear-gradient(180deg,#e6e6e6 0,#e6e6e6 48%,#fff);position:absolute;content:"";width:.0625rem;height:33.75rem;top:30px;right:-10px;bottom:0}}@media screen and (min-width:960px){.Sidebar-module--sidebar--X4z2p{width:calc(33.3% - 1.25rem)}.Sidebar-module--sidebar--X4z2p:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--X4z2p:last-child{margin-right:0}.Sidebar-module--sidebar--X4z2p:nth-child(3n){margin-right:0;float:right}.Sidebar-module--sidebar--X4z2p:nth-child(3n+1){clear:both}.Sidebar-module--sidebar__inner--Jdc5s{padding:2.5rem}}.Layout-module--layout--3Pyz6{max-width:66.875rem;margin-left:auto;margin-right:auto}.Layout-module--layout--3Pyz6:before{content:"";display:table}.Layout-module--layout--3Pyz6:after{content:"";display:table;clear:both}.Feed-module--feed__item--2D5rE{margin-bottom:1.5625rem}.Feed-module--feed__item--2D5rE:last-child{margin-bottom:.625rem}.Feed-module--feed__item-title--3nigr{font-size:1.47656rem;line-height:1.875rem;margin-top:0;margin-bottom:.625rem}.Feed-module--feed__item-title-link--iFMRs{color:#222}.Feed-module--feed__item-title-link--iFMRs:focus,.Feed-module--feed__item-title-link--iFMRs:hover{color:#222;border-bottom:1px solid #222}.Feed-module--feed__item-description--1uO8e{font-size:.875rem;line-height:1.25rem;margin-bottom:.9375rem}.Feed-module--feed__item-meta-time--3t1fg{font-size:.75rem;color:#222;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-divider--N-Q0A{margin:0 .3125rem}.Feed-module--feed__item-meta-category-link--23f8F{font-size:.75rem;color:#a9d159;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-category-link--23f8F:focus,.Feed-module--feed__item-meta-category-link--23f8F:hover{color:#918d40}.Feed-module--feed__item-readmore--1u6bI{font-size:.875rem;color:#918d40}.Feed-module--feed__item-readmore--1u6bI:focus,.Feed-module--feed__item-readmore--1u6bI:hover{color:#918d40;border-bottom:1px solid #918d40}.Page-module--page--2nMky{margin-bottom:2.5rem}.Page-module--page__inner--2M_vz{padding:1.5625rem 1.25rem}.Page-module--page__title--GPD8L{font-size:1.575rem;font-weight:600;line-height:2.5rem;margin-top:0;margin-bottom:1.8125rem}.Page-module--page__body--Ic6i6{font-size:.875rem;line-height:1.25rem;margin:0 0 1.25rem}@media screen and (min-width:685px){.Page-module--page--2nMky{width:calc(58.275% - .78125rem)}.Page-module--page--2nMky:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--2nMky:last-child{margin-right:0}.Page-module--page--2nMky:nth-child(12n){margin-right:0;float:right}.Page-module--page--2nMky:nth-child(12n+1){clear:both}.Page-module--page__inner--2M_vz{padding:1.875rem 1.25rem}}@media screen and (min-width:960px){.Page-module--page--2nMky{width:calc(66.6% - .625rem)}.Page-module--page--2nMky:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--2nMky:last-child{margin-right:0}.Page-module--page--2nMky:nth-child(3n){margin-right:0;float:right}.Page-module--page--2nMky:nth-child(3n+1){clear:both}.Page-module--page__inner--2M_vz{padding:2.5rem 2.1875rem}}.Pagination-module--pagination--2H3nO{margin-top:2.5rem;display:flex}.Pagination-module--pagination__prev--bet5s{width:50%;text-align:left}.Pagination-module--pagination__prev-link--1Nzs6{color:#a9d159;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__prev-link--1Nzs6:focus,.Pagination-module--pagination__prev-link--1Nzs6:hover{color:#918d40}.Pagination-module--pagination__prev-link--disable--Yklx9{pointer-events:none;color:#bbb}.Pagination-module--pagination__next--3hFiN{width:50%;text-align:right}.Pagination-module--pagination__next-link--3FUtA{color:#a9d159;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__next-link--3FUtA:focus,.Pagination-module--pagination__next-link--3FUtA:hover{color:#918d40}.Pagination-module--pagination__next-link--disable--30UwZ{pointer-events:none;color:#bbb}.Author-module--author--2Yefr{border-top:1px solid #e6e6e6;max-width:43.75rem;padding-top:1.25rem;line-height:1.25rem;margin-top:1.25rem;margin-bottom:2.5rem}.Author-module--author__bio-twitter--n-O9n{display:block;text-decoration:underline}@media screen and (min-width:685px){.Author-module--author--2Yefr{margin-left:auto;margin-right:auto}}.Content-module--content--3p512{max-width:62.8125rem;padding:0 .9375rem;margin:0 auto}.Content-module--content__title--2BDW9{font-size:1.75rem;max-width:43.75rem;font-weight:600;text-align:center;line-height:2.0625rem;margin:1.25rem auto 0}.Content-module--content__body--2TrQ- figure{margin-bottom:1.25rem}.Content-module--content__body--2TrQ- figure blockquote{font-style:italic;text-align:center;margin-top:0;padding:1.25rem 0}.Content-module--content__body--2TrQ- figure blockquote p{max-width:43.75rem;font-size:1.47149rem;margin-top:1.25rem;margin-bottom:1.25rem;line-height:1.875rem}.Content-module--content__body--2TrQ- a{text-decoration:underline}.Content-module--content__body--2TrQ- *{max-width:43.75rem;margin-left:auto;margin-right:auto}.Content-module--content__body--2TrQ- img{max-width:100%;margin-top:.625rem;margin-bottom:.625rem}.Content-module--content__body--2TrQ- li ul{margin-bottom:.625rem}.Content-module--content__body--2TrQ- li p{line-height:1.25rem;margin-bottom:.625rem}.Content-module--content__body--2TrQ- h2{position:relative;padding:1rem 1.5rem;color:#fff;border-radius:.625rem;background:#0c0000}.Content-module--content__body--2TrQ- h2:after{position:absolute;bottom:-9px;left:1rem;width:0;height:0;content:"";border-color:#0c0000 transparent transparent;border-style:solid;border-width:10px 10px 0}.Content-module--content__body--2TrQ- h3{border-bottom:3px dotted #0c0000;padding:1rem 0}@media screen and (min-width:960px){.Content-module--content--3p512{padding:0}.Content-module--content__title--2BDW9{font-size:1.75rem;line-height:2.8125rem;margin-top:2.8125rem;margin-bottom:1.875rem}.Content-module--content__body--2TrQ-,.Content-module--content__body--2TrQ- p{font-size:.98438rem;line-height:1.40625rem;margin-bottom:1.40625rem}.Content-module--content__body--2TrQ- li p{line-height:1.25rem;margin-bottom:.625rem}}.Meta-module--meta__date--29eD7{font-style:italic}.Tags-module--tags--1L_ct{margin-bottom:.625rem}.Tags-module--tags__list--91FqN{list-style:none;margin:0 -.625rem;padding:0}.Tags-module--tags__list-item--1M30P{display:inline-block;margin:.625rem .3125rem}.Tags-module--tags__list-item-link--3SL_8{display:inline-block;height:2.1875rem;padding:0 1.5rem;line-height:2.1875rem;border:1px solid #e6e6e6;text-decoration:none;border-radius:1.25rem;color:#222}.Tags-module--tags__list-item-link--3SL_8:focus,.Tags-module--tags__list-item-link--3SL_8:hover{color:#918d40}.Post-module--post__comments--25y6I,.Post-module--post__footer--3WzWU{max-width:43.75rem;margin:0 auto;padding:0 .9375rem}.Post-module--post__home-button--16Kl0{display:block;max-width:5.625rem;height:2.1875rem;padding:0 1.5rem;line-height:2.1875rem;text-align:center;color:#222;border:1px solid #e6e6e6;border-radius:1.25rem;font-size:.875rem;font-weight:400;margin-left:auto;margin-right:auto;margin-top:1.25rem}.Post-module--post__home-button--16Kl0:focus,.Post-module--post__home-button--16Kl0:hover{color:#918d40}@media screen and (min-width:960px){.Post-module--post__comments--25y6I,.Post-module--post__footer--3WzWU{padding:0}.Post-module--post__home-button--16Kl0{position:fixed;max-width:auto;margin:0;top:30px;left:30px}}</style><meta name="generator" content="Gatsby 2.32.13"/><link rel="alternate" type="application/rss+xml" title="かえるのひみつきち" href="/rss.xml"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-122086587-6"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-122086587-6', {"send_page_view":false});
      }
      </script><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="icon" href="/favicon-32x32.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#F7A046"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><title data-react-helmet="true">Android のネイティブライブラリ関数解析と RC4 と AES の復号を行う【WMCTF 2023】 - かえるのひみつきち</title><meta data-react-helmet="true" name="description" content="WMCTF 2023 の Writeup です。"/><meta data-react-helmet="true" property="og:site_name" content="Android のネイティブライブラリ関数解析と RC4 と AES の復号を行う【WMCTF 2023】 - かえるのひみつきち"/><meta data-react-helmet="true" property="og:image" content="https://kashiwaba-yuki.com/static/191686352ab9b0e45c949d9ff85efde7/ctf-wmctf-2023.png"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:title" content="Android のネイティブライブラリ関数解析と RC4 と AES の復号を行う【WMCTF 2023】 - かえるのひみつきち"/><meta data-react-helmet="true" name="twitter:description" content="WMCTF 2023 の Writeup です。"/><meta data-react-helmet="true" name="twitter:image" content="https://kashiwaba-yuki.com/static/191686352ab9b0e45c949d9ff85efde7/ctf-wmctf-2023.png"/><link as="script" rel="preload" href="/webpack-runtime-a3c0f166cb4b802ff58f.js"/><link as="script" rel="preload" href="/framework-3761df4ab6ee9f056936.js"/><link as="script" rel="preload" href="/532a2f07-92db97c0addf07d5cb73.js"/><link as="script" rel="preload" href="/dc6a8720040df98778fe970bf6c000a41750d3ae-46fc1da9fa41dea5027d.js"/><link as="script" rel="preload" href="/app-4527e0a718e3bd88d288.js"/><link as="script" rel="preload" href="/styles-407fe62976dc5310c43e.js"/><link as="script" rel="preload" href="/cd95ea5cbd2c605f26db819f07999610c9ff4310-c2f05dc74373de400085.js"/><link as="script" rel="preload" href="/component---src-templates-post-template-js-381c1b847824134fa4bd.js"/><link as="fetch" rel="preload" href="/page-data/ctf-wmctf-2023/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/251939775.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/401334301.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/825871152.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="Layout-module--layout--3Pyz6"><div><a class="Post-module--post__home-button--16Kl0" href="/">All Articles</a><div><div class="Content-module--content--3p512"><h1 class="Content-module--content__title--2BDW9">Android のネイティブライブラリ関数解析と RC4 と AES の復号を行う【WMCTF 2023】</h1><div class="Content-module--content__body--2TrQ-"><!-- omit in toc -->
<h2 id="もくじ" style="position:relative;"><a href="#%E3%82%82%E3%81%8F%E3%81%98" aria-label="もくじ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>もくじ</h2>
<ul>
<li>
<p><a href="#ezandroidrev">ezAndroid(Rev)</a></p>
<ul>
<li><a href="#%E3%83%8D%E3%82%A4%E3%83%86%E3%82%A3%E3%83%96%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E9%96%A2%E6%95%B0%E3%81%AE%E3%82%AA%E3%83%95%E3%82%BB%E3%83%83%E3%83%88%E3%82%92%E7%89%B9%E5%AE%9A%E3%81%99%E3%82%8B">ネイティブライブラリ関数のオフセットを特定する</a></li>
<li><a href="#checkusername-%E3%82%92%E8%A7%A3%E6%9E%90%E3%81%99%E3%82%8B">CheckUserName を解析する</a></li>
<li><a href="#check2-%E3%82%92%E8%A7%A3%E6%9E%90%E3%81%99%E3%82%8B">check2 を解析する</a></li>
</ul>
</li>
<li><a href="#%E3%81%BE%E3%81%A8%E3%82%81">まとめ</a></li>
</ul>
<h2 id="ezandroidrev" style="position:relative;"><a href="#ezandroidrev" aria-label="ezandroidrev permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ezAndroid(Rev)</h2>
<blockquote>
<p>search patiently</p>
</blockquote>
<p>問題バイナリとして与えられた apk ファイルをエミュレータで起動すると、以下のようなユーザ名とパスワードの検証を行うアプリケーションでした。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 511px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/5d7daa17efda18c96768863c291f5e95/92e00/image-20230819104025590.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 202.08333333333331%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAYAAAD+MdrbAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGbUlEQVRIx61WaWxUVRR+pQsUS9haulgIZTojyGbttNMi8YdKTAwGMUYTEpaC4vJPA4LGmLhCxbYIiCDKohESWxKEqMS4gZYIUou20nb2mU47S/vmvXlvptN2pv08977OwFjBYHzJ13vud+797jnnLlNhadkSlBSWQTdpA/TZm1GavRGlkzToszdh3sQNY1jPW+7PriF/Dc1h2IiijJUoLizBXeXlEBYtLMPsjDWYlWOEadJxrC5pxmOGc1hbdgH3ZH0Do3AWlYQK4WsO4xgqCeWEJ+78CTXlrTDO3Qz9/HkQFhoqYEx7H/OF57BcOIMVaRewIv0nrMxpxgMTzuM+4dxN8UDGj1iVcwWmnFro5heToP5urMm6glfmAFuKFbw4N4Sts0PYlCZhoyDhSWo3CTfGRqEfm4U4VmQeQ8mCIkrZYMQTE3/FS3oVW3UithskvKiTUCOIWEuD1/0L1gp+Eh7G/elHNUFjeSXOfPQn2r4CLp8aQMupKFq+iOL3rwfx+9lBrb0JWr+MwHYeaHj1BIqKCyGYqkxw91qhfaO49S/O/57+8iTy85mgqQpdnWZOxobjGImN3hKGBmN8bmNjE/ILSLCqqhoWi4WTIyMjGB0dvSXEYprgyZNNKCy6HUJ19f8nWKq/Y7zgrX7XC+oNC1IF4/E4QqEQJEmCKIq8ZX1ZllOQ4CKRCJ/DvqamJsyeMzdVkK3W2dmJ5uZmtLa2wmw2w263w2azjQOb4/V6UwRn5RekbgoTZPbFi5fgcDjgdrnhdDrHweVy8YX8fn+KIN/l1AjjPI3o4ADCYRWqqhDUfwQfF42mCBYUFv1NMD4Ml60HV1u60XXFA6etGx5PN7q7x6O9vY2nnNjIG0QYg7nTipZLbej60w5LF9XLaoP1elg0fPftD7DbHPzoJAVZDVME6aYEusPwuRQOr1OBx6Kgh8GqwedkUBFwRyAFUlNOCprNmmCoL4Y3KhRsnRPCdl0IL+sV1N6rYudyFW9Xq3jTpGLbPOINCp4vkHG4Jpy8y/8oqIox1D8k47UKCW9WS3h7uYS9q0PY/bCMhpUy971hkvDWPRJeXSrhxAvqNcHGxmvHJiEYlmL4aL2K3SsVElKwZ5WC98g+uEbF/sfH+EcU7HtUQd2DCk6/Hrm5oOwbxpY5QTyVKeLZHBFPT6Z2ShAvz5eIl/B0tohnbtO4DfQA71kVSgo2kmD+3w/2yEgcg5E4omoqwkE6n3IqN6DEMTw4QpsSSwrOGi/43x+HxsbPbyJ4/cM9eoN27BtJHptkhFXo6Ojk5ODQEF27IQwND/OWYXBoOIVL9DlHdjgywOd+dvz4tWNz7vzP8PYFYXHQY9DdC5uLrpfXD6fHix5/HxzEuXt9HMzu8QXIp3FWpxtiKIy9+w+gkN3lZcuW4fsffoS/Pwizw8UF7O4e+GgBb0CkVkRvoB/uHh+37W4P8f0UgMgFXT1eBIIhHDz0sfY4mEwmtPz2GwYofFFWEAypkAjM7pdCHJIS5nzCz1pRDnGbBcKqeOToJ/Q4UMqVlZUk2ApXr5+nYXN5eJQdFjuPikXAS0G+LruT0u2DxxvgJTGzPo2Vw1EcOfaJtilM8HJLK1+1l5wMbFUP1SkgSugLylyU9RnPwErBfKwUrAz0a4rDR49dE7x06Vf6naAUg5pAIlVmMyTSZ5MTfGIxVs9+WcWhjw9rgqyGbJf/aO8gQZmnx6Jhu8dSYxvEUmdo77LwVDvpHbQ6u9FhtfNS/HKlDR8c/FCrodFYgYuXWyCpEVpR4imxKLTCK8mNCIbG+tdtGI9elPk5PEIp583Kh1BuNOLnC79oxeZ1kvhx6LQ60GVzjsExBifMFJWFbHYWZUr7bMdV7GprwXsHDqCApcwE2zu6EKHXmiFKFVaiQ/CRsI9WZ/DTOWNgdh9lIIpBujnaHb7g9WCf24JDn36KfBbh4sVLsG37S9i9Zy9qd72LXXX1HO/WNxDqUdfQgB2173Afs+vIV0++HTt2YufOWtQRv3/vPqxftw63F8+GYDDQ/yOCkITBYMDk7OxxXG5ubgpXUVEBnU7H7aysLN7qaZywaNFiZGRkIC0tjSMzMxPp6encnjBhAh84ZcoUZI8tkuDYAlOnTuU2m8/8C+5cCOGuu8tRUlLCB8ycORMzZszgLevn5uYhLy8vyTGb8aydNm0apk+fzm0GXWkpliwtw1/36ohcEFHunwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/5d7daa17efda18c96768863c291f5e95/8ac56/image-20230819104025590.webp 240w,
/static/5d7daa17efda18c96768863c291f5e95/d3be9/image-20230819104025590.webp 480w,
/static/5d7daa17efda18c96768863c291f5e95/4719d/image-20230819104025590.webp 511w"
              sizes="(max-width: 511px) 100vw, 511px"
              type="image/webp"
            />
          <source
            srcset="/static/5d7daa17efda18c96768863c291f5e95/8ff5a/image-20230819104025590.png 240w,
/static/5d7daa17efda18c96768863c291f5e95/e85cb/image-20230819104025590.png 480w,
/static/5d7daa17efda18c96768863c291f5e95/92e00/image-20230819104025590.png 511w"
            sizes="(max-width: 511px) 100vw, 511px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/5d7daa17efda18c96768863c291f5e95/92e00/image-20230819104025590.png"
            alt="image-20230819104025590"
            title="image-20230819104025590"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>とりあえず apktool で apk ファイルを展開し、Manifest を参照したところ、デバッグは有効化されていることがわかりました。</p>
<div class="gatsby-highlight" data-language="xml"><pre class="language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8" standalone="no"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>manifest</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res/android<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">android:</span>compileSdkVersion</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>33<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">android:</span>compileSdkVersionCodename</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>13<span class="token punctuation">"</span></span> <span class="token attr-name">package</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.wmctf.ezandroid<span class="token punctuation">"</span></span> <span class="token attr-name">platformBuildVersionCode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>33<span class="token punctuation">"</span></span> <span class="token attr-name">platformBuildVersionName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>13<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.wmctf.ezandroid.DYNAMIC_RECEIVER_NOT_EXPORTED_PERMISSION<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">android:</span>protectionLevel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>signature<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.wmctf.ezandroid.DYNAMIC_RECEIVER_NOT_EXPORTED_PERMISSION<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>application</span> <span class="token attr-name"><span class="token namespace">android:</span>allowBackup</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">android:</span>appComponentFactory</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>androidx.core.app.CoreComponentFactory<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">android:</span>dataExtractionRules</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@xml/data_extraction_rules<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">android:</span>debuggable</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">android:</span>fullBackupContent</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@xml/backup_rules<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">android:</span>icon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@mipmap/ic_launcher<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">android:</span>label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@string/app_name<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">android:</span>supportsRtl</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">android:</span>theme</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@style/Theme.EzAndroid<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>activity</span> <span class="token attr-name"><span class="token namespace">android:</span>exported</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.wmctf.ezandroid.MainActivity<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>intent-filter</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>action</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>android.intent.action.MAIN<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>category</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>android.intent.category.LAUNCHER<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>intent-filter</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>activity</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>provider</span> <span class="token attr-name"><span class="token namespace">android:</span>authorities</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.wmctf.ezandroid.androidx-startup<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">android:</span>exported</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>androidx.startup.InitializationProvider<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta-data</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>androidx.emoji2.text.EmojiCompatInitializer<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">android:</span>value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>androidx.startup<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta-data</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>androidx.lifecycle.ProcessLifecycleInitializer<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">android:</span>value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>androidx.startup<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>provider</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>application</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>manifest</span><span class="token punctuation">></span></span></code></pre></div>
<p>続いて、<code class="language-text">com.wmctf.ezandroid.MainActivity</code> の smali ファイルを <a href="https://github.com/AlexeySoshin/smali2java" target="_blank" rel="nofollow noopener noreferrer">smali2java</a> を使用して Java ソースにデコンパイルします。</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>wmctf<span class="token punctuation">.</span>ezandroid<span class="token punctuation">.</span></span>MainActivity</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token namespace">androidx<span class="token punctuation">.</span>appcompat<span class="token punctuation">.</span>app<span class="token punctuation">.</span></span>AppCompatActivity</span> <span class="token punctuation">{</span>
	 <span class="token comment">/* .source "MainActivity.java" */</span>
	 <span class="token comment">/* # static fields */</span>
	 <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>String</span> x<span class="token punctuation">;</span>
	 <span class="token comment">/* # instance fields */</span>
	 <span class="token class-name"><span class="token namespace">android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span></span>Button</span> checkoutButton<span class="token punctuation">;</span>
	 <span class="token class-name"><span class="token namespace">android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span></span>Button</span> exitButton<span class="token punctuation">;</span>
	 <span class="token class-name"><span class="token namespace">android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span></span>EditText</span> passwordInput<span class="token punctuation">;</span>
	 <span class="token class-name"><span class="token namespace">android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span></span>EditText</span> usernameInput<span class="token punctuation">;</span>
	 <span class="token comment">/* # direct methods */</span>
	 <span class="token keyword">static</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>wmctf<span class="token punctuation">.</span>ezandroid<span class="token punctuation">.</span></span>MainActivity</span> <span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
		 <span class="token comment">/* .locals 1 */</span>
		 <span class="token comment">/* .line 22 */</span>
		 <span class="token keyword">final</span> <span class="token class-name">String</span> v0 <span class="token operator">=</span> <span class="token string">"ezandroid"</span><span class="token punctuation">;</span> <span class="token comment">// const-string v0, "ezandroid"</span>
		 <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>System</span> <span class="token punctuation">.</span>loadLibrary <span class="token punctuation">(</span> v0 <span class="token punctuation">)</span><span class="token punctuation">;</span>
		 <span class="token comment">/* .line 23 */</span>
		 <span class="token keyword">return</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span> <span class="token comment">// .end method</span>
	 <span class="token keyword">public</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>wmctf<span class="token punctuation">.</span>ezandroid<span class="token punctuation">.</span></span>MainActivity</span> <span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
		 <span class="token comment">/* .locals 0 */</span>
		 <span class="token comment">/* .line 15 */</span>
		 <span class="token comment">/* invoke-direct {p0}, Landroidx/appcompat/app/AppCompatActivity;->&lt;init>()V */</span>
		 <span class="token keyword">return</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span> <span class="token comment">// .end method</span>
	 <span class="token keyword">static</span> <span class="token keyword">void</span> lambda$messageBox$<span class="token number">0</span> <span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">android<span class="token punctuation">.</span>content<span class="token punctuation">.</span></span>DialogInterface</span> p0<span class="token punctuation">,</span> <span class="token class-name">Integer</span> p1 <span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//synthethic</span>
		 <span class="token comment">/* .locals 0 */</span>
		 <span class="token comment">/* .param p0, "dialogInterface" # Landroid/content/DialogInterface; */</span>
		 <span class="token comment">/* .param p1, "i" # I */</span>
		 <span class="token comment">/* .line 28 */</span>
		 <span class="token keyword">return</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span> <span class="token comment">// .end method</span>
	 <span class="token comment">/* # virtual methods */</span>
	 <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">CheckOutClick</span> <span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">android<span class="token punctuation">.</span>view<span class="token punctuation">.</span></span>View</span> p0 <span class="token punctuation">)</span> <span class="token punctuation">{</span>
		 <span class="token comment">/* .locals 6 */</span>
		 <span class="token comment">/* .param p1, "view" # Landroid/view/View; */</span>
		 <span class="token comment">/* .line 32 */</span>
		 v0 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>usernameInput<span class="token punctuation">;</span>
		 <span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span></span>EditText</span> <span class="token punctuation">)</span> v0 <span class="token punctuation">)</span><span class="token punctuation">.</span>getText <span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {v0}, Landroid/widget/EditText;->getText()Landroid/text/Editable;</span>
		 <span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Object</span> <span class="token punctuation">)</span> v0 <span class="token punctuation">)</span><span class="token punctuation">.</span>toString <span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {v0}, Ljava/lang/Object;->toString()Ljava/lang/String;</span>
		 <span class="token comment">/* .line 33 */</span>
		 <span class="token comment">/* .local v0, "username":Ljava/lang/String; */</span>
		 v1 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>passwordInput<span class="token punctuation">;</span>
		 <span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span></span>EditText</span> <span class="token punctuation">)</span> v1 <span class="token punctuation">)</span><span class="token punctuation">.</span>getText <span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {v1}, Landroid/widget/EditText;->getText()Landroid/text/Editable;</span>
		 <span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Object</span> <span class="token punctuation">)</span> v1 <span class="token punctuation">)</span><span class="token punctuation">.</span>toString <span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {v1}, Ljava/lang/Object;->toString()Ljava/lang/String;</span>
		 <span class="token comment">/* .line 34 */</span>
		 <span class="token comment">/* .local v1, "password":Ljava/lang/String; */</span>
		 <span class="token keyword">final</span> <span class="token class-name">String</span> v2 <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span> <span class="token comment">// const-string v2, ""</span>
		 v3 <span class="token operator">=</span> 		 <span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>String</span> <span class="token punctuation">)</span> v0 <span class="token punctuation">)</span><span class="token punctuation">.</span>equals <span class="token punctuation">(</span> v2 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {v0, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z</span>
		 <span class="token comment">/* if-nez v3, :cond_3 */</span>
		 v2 <span class="token operator">=</span> 		 <span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>String</span> <span class="token punctuation">)</span> v1 <span class="token punctuation">)</span><span class="token punctuation">.</span>equals <span class="token punctuation">(</span> v2 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {v1, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z</span>
		 <span class="token keyword">if</span> <span class="token punctuation">(</span> v2 <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// if-eqz v2, :cond_0</span>
			 <span class="token comment">/* .line 37 */</span>
		 <span class="token punctuation">}</span> <span class="token comment">// :cond_0</span>
		 v2 <span class="token operator">=</span> 		 <span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>wmctf<span class="token punctuation">.</span>ezandroid<span class="token punctuation">.</span></span>MainActivity</span> <span class="token punctuation">)</span> p0 <span class="token punctuation">)</span><span class="token punctuation">.</span>CheckUsername <span class="token punctuation">(</span> v0 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {p0, v0}, Lcom/wmctf/ezandroid/MainActivity;->CheckUsername(Ljava/lang/String;)I</span>
		 <span class="token keyword">final</span> <span class="token class-name">String</span> v3 <span class="token operator">=</span> <span class="token string">"failed login"</span><span class="token punctuation">;</span> <span class="token comment">// const-string v3, "failed login"</span>
		 <span class="token keyword">int</span> v4 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// const/4 v4, 0x1</span>
		 <span class="token comment">/* if-eq v2, v4, :cond_1 */</span>
		 <span class="token comment">/* .line 38 */</span>
		 <span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>wmctf<span class="token punctuation">.</span>ezandroid<span class="token punctuation">.</span></span>MainActivity</span> <span class="token punctuation">)</span> p0 <span class="token punctuation">)</span><span class="token punctuation">.</span>messageBox <span class="token punctuation">(</span> v3 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {p0, v3}, Lcom/wmctf/ezandroid/MainActivity;->messageBox(Ljava/lang/String;)V</span>
		 <span class="token comment">/* .line 40 */</span>
	 <span class="token punctuation">}</span> <span class="token comment">// :cond_1</span>
	 <span class="token comment">/* new-instance v2, Ljava/lang/StringBuilder; */</span>
	 <span class="token comment">/* invoke-direct {v2}, Ljava/lang/StringBuilder;->&lt;init>()V */</span>
	 <span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>StringBuilder</span> <span class="token punctuation">)</span> v2 <span class="token punctuation">)</span><span class="token punctuation">.</span>append <span class="token punctuation">(</span> v0 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;</span>
	 <span class="token keyword">final</span> <span class="token class-name">String</span> v5 <span class="token operator">=</span> <span class="token string">"123456"</span><span class="token punctuation">;</span> <span class="token comment">// const-string v5, "123456"</span>
	 <span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>StringBuilder</span> <span class="token punctuation">)</span> v2 <span class="token punctuation">)</span><span class="token punctuation">.</span>append <span class="token punctuation">(</span> v5 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {v2, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;</span>
	 <span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>StringBuilder</span> <span class="token punctuation">)</span> v2 <span class="token punctuation">)</span><span class="token punctuation">.</span>toString <span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;</span>
	 <span class="token comment">/* .line 41 */</span>
	 v2 <span class="token operator">=</span> 	 <span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>wmctf<span class="token punctuation">.</span>ezandroid<span class="token punctuation">.</span></span>MainActivity</span> <span class="token punctuation">)</span> p0 <span class="token punctuation">)</span><span class="token punctuation">.</span>check2 <span class="token punctuation">(</span> v1 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {p0, v1}, Lcom/wmctf/ezandroid/MainActivity;->check2(Ljava/lang/String;)I</span>
	 <span class="token comment">/* if-eq v2, v4, :cond_2 */</span>
	 <span class="token comment">/* .line 42 */</span>
	 <span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>wmctf<span class="token punctuation">.</span>ezandroid<span class="token punctuation">.</span></span>MainActivity</span> <span class="token punctuation">)</span> p0 <span class="token punctuation">)</span><span class="token punctuation">.</span>messageBox <span class="token punctuation">(</span> v3 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {p0, v3}, Lcom/wmctf/ezandroid/MainActivity;->messageBox(Ljava/lang/String;)V</span>
	 <span class="token comment">/* .line 44 */</span>
<span class="token punctuation">}</span> <span class="token comment">// :cond_2</span>
<span class="token comment">/* new-instance v2, Ljava/lang/StringBuilder; */</span>
<span class="token comment">/* invoke-direct {v2}, Ljava/lang/StringBuilder;->&lt;init>()V */</span>
<span class="token keyword">final</span> <span class="token class-name">String</span> v3 <span class="token operator">=</span> <span class="token string">"WMCTF{"</span><span class="token punctuation">;</span> <span class="token comment">// const-string v3, "WMCTF{"</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>StringBuilder</span> <span class="token punctuation">)</span> v2 <span class="token punctuation">)</span><span class="token punctuation">.</span>append <span class="token punctuation">(</span> v3 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>StringBuilder</span> <span class="token punctuation">)</span> v2 <span class="token punctuation">)</span><span class="token punctuation">.</span>append <span class="token punctuation">(</span> v0 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>StringBuilder</span> <span class="token punctuation">)</span> v2 <span class="token punctuation">)</span><span class="token punctuation">.</span>append <span class="token punctuation">(</span> v1 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;</span>
<span class="token comment">/* const-string/jumbo v3, "}" */</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>StringBuilder</span> <span class="token punctuation">)</span> v2 <span class="token punctuation">)</span><span class="token punctuation">.</span>append <span class="token punctuation">(</span> v3 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>StringBuilder</span> <span class="token punctuation">)</span> v2 <span class="token punctuation">)</span><span class="token punctuation">.</span>toString <span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;</span>
<span class="token comment">/* .line 45 */</span>
<span class="token comment">/* .local v2, "flag":Ljava/lang/String; */</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>wmctf<span class="token punctuation">.</span>ezandroid<span class="token punctuation">.</span></span>MainActivity</span> <span class="token punctuation">)</span> p0 <span class="token punctuation">)</span><span class="token punctuation">.</span>messageBox <span class="token punctuation">(</span> v2 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {p0, v2}, Lcom/wmctf/ezandroid/MainActivity;->messageBox(Ljava/lang/String;)V</span>
<span class="token comment">/* .line 35 */</span>
<span class="token punctuation">}</span> <span class="token comment">// .end local v2 # "flag":Ljava/lang/String;</span>
<span class="token punctuation">}</span> <span class="token comment">// :cond_3</span>
<span class="token punctuation">}</span> <span class="token comment">// :goto_0</span>
<span class="token comment">/* const-string/jumbo v2, "username or password is empty!" */</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>wmctf<span class="token punctuation">.</span>ezandroid<span class="token punctuation">.</span></span>MainActivity</span> <span class="token punctuation">)</span> p0 <span class="token punctuation">)</span><span class="token punctuation">.</span>messageBox <span class="token punctuation">(</span> v2 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {p0, v2}, Lcom/wmctf/ezandroid/MainActivity;->messageBox(Ljava/lang/String;)V</span>
<span class="token comment">/* .line 50 */</span>
<span class="token punctuation">}</span> <span class="token comment">// :goto_1</span>
<span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token comment">// .end method</span>
<span class="token keyword">public</span> <span class="token keyword">native</span> <span class="token class-name">Integer</span> <span class="token class-name">CheckUsername</span> <span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>String</span> p0 <span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span> <span class="token comment">// .end method</span>
<span class="token keyword">public</span> <span class="token keyword">native</span> <span class="token class-name">Integer</span> check2 <span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>String</span> p0 <span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span> <span class="token comment">// .end method</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> messageBox <span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>String</span> p0 <span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">/* .locals 3 */</span>
<span class="token comment">/* .param p1, "title" # Ljava/lang/String; */</span>
<span class="token comment">/* .line 26 */</span>
<span class="token comment">/* new-instance v0, Landroid/app/AlertDialog$Builder; */</span>
<span class="token comment">/* invoke-direct {v0, p0}, Landroid/app/AlertDialog$Builder;->&lt;init>(Landroid/content/Context;)V */</span>
<span class="token comment">/* .line 27 */</span>
<span class="token comment">/* .local v0, "dialog":Landroid/app/AlertDialog$Builder; */</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">android<span class="token punctuation">.</span>app<span class="token punctuation">.</span></span>AlertDialog</span>$<span class="token class-name">Builder</span> <span class="token punctuation">)</span> v0 <span class="token punctuation">)</span><span class="token punctuation">.</span>setMessage <span class="token punctuation">(</span> p1 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {v0, p1}, Landroid/app/AlertDialog$Builder;->setMessage(Ljava/lang/CharSequence;)Landroid/app/AlertDialog$Builder;</span>
<span class="token comment">/* .line 28 */</span>
<span class="token comment">/* new-instance v1, Lcom/wmctf/ezandroid/MainActivity$$ExternalSyntheticLambda0; */</span>
<span class="token comment">/* invoke-direct {v1}, Lcom/wmctf/ezandroid/MainActivity$$ExternalSyntheticLambda0;->&lt;init>()V */</span>
<span class="token keyword">final</span> <span class="token class-name">String</span> v2 <span class="token operator">=</span> <span class="token string">"OK"</span><span class="token punctuation">;</span> <span class="token comment">// const-string v2, "OK"</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">android<span class="token punctuation">.</span>app<span class="token punctuation">.</span></span>AlertDialog</span>$<span class="token class-name">Builder</span> <span class="token punctuation">)</span> v0 <span class="token punctuation">)</span><span class="token punctuation">.</span>setPositiveButton <span class="token punctuation">(</span> v2<span class="token punctuation">,</span> v1 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {v0, v2, v1}, Landroid/app/AlertDialog$Builder;->setPositiveButton(Ljava/lang/CharSequence;Landroid/content/DialogInterface$OnClickListener;)Landroid/app/AlertDialog$Builder;</span>
<span class="token comment">/* .line 29 */</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">android<span class="token punctuation">.</span>app<span class="token punctuation">.</span></span>AlertDialog</span>$<span class="token class-name">Builder</span> <span class="token punctuation">)</span> v0 <span class="token punctuation">)</span><span class="token punctuation">.</span>show <span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {v0}, Landroid/app/AlertDialog$Builder;->show()Landroid/app/AlertDialog;</span>
<span class="token comment">/* .line 30 */</span>
<span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token comment">// .end method</span>
<span class="token keyword">protected</span> <span class="token keyword">void</span> onCreate <span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">android<span class="token punctuation">.</span>os<span class="token punctuation">.</span></span>Bundle</span> p0 <span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">/* .locals 2 */</span>
<span class="token comment">/* .param p1, "savedInstanceState" # Landroid/os/Bundle; */</span>
<span class="token comment">/* .line 54 */</span>
<span class="token comment">/* invoke-super {p0, p1}, Landroidx/appcompat/app/AppCompatActivity;->onCreate(Landroid/os/Bundle;)V */</span>
<span class="token comment">/* .line 55 */</span>
<span class="token comment">/* const v0, 0x7f0b001c */</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>wmctf<span class="token punctuation">.</span>ezandroid<span class="token punctuation">.</span></span>MainActivity</span> <span class="token punctuation">)</span> p0 <span class="token punctuation">)</span><span class="token punctuation">.</span>setContentView <span class="token punctuation">(</span> v0 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {p0, v0}, Lcom/wmctf/ezandroid/MainActivity;->setContentView(I)V</span>
<span class="token comment">/* .line 56 */</span>
<span class="token comment">/* const v0, 0x7f0801de */</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>wmctf<span class="token punctuation">.</span>ezandroid<span class="token punctuation">.</span></span>MainActivity</span> <span class="token punctuation">)</span> p0 <span class="token punctuation">)</span><span class="token punctuation">.</span>findViewById <span class="token punctuation">(</span> v0 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {p0, v0}, Lcom/wmctf/ezandroid/MainActivity;->findViewById(I)Landroid/view/View;</span>
<span class="token comment">/* check-cast v0, Landroid/widget/EditText; */</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>usernameInput <span class="token operator">=</span> v0<span class="token punctuation">;</span>
<span class="token comment">/* .line 57 */</span>
<span class="token comment">/* const v0, 0x7f08014a */</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>wmctf<span class="token punctuation">.</span>ezandroid<span class="token punctuation">.</span></span>MainActivity</span> <span class="token punctuation">)</span> p0 <span class="token punctuation">)</span><span class="token punctuation">.</span>findViewById <span class="token punctuation">(</span> v0 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {p0, v0}, Lcom/wmctf/ezandroid/MainActivity;->findViewById(I)Landroid/view/View;</span>
<span class="token comment">/* check-cast v0, Landroid/widget/EditText; */</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>passwordInput <span class="token operator">=</span> v0<span class="token punctuation">;</span>
<span class="token comment">/* .line 58 */</span>
<span class="token comment">/* const v0, 0x7f08006f */</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>wmctf<span class="token punctuation">.</span>ezandroid<span class="token punctuation">.</span></span>MainActivity</span> <span class="token punctuation">)</span> p0 <span class="token punctuation">)</span><span class="token punctuation">.</span>findViewById <span class="token punctuation">(</span> v0 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {p0, v0}, Lcom/wmctf/ezandroid/MainActivity;->findViewById(I)Landroid/view/View;</span>
<span class="token comment">/* check-cast v0, Landroid/widget/Button; */</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>checkoutButton <span class="token operator">=</span> v0<span class="token punctuation">;</span>
<span class="token comment">/* .line 59 */</span>
<span class="token comment">/* const v0, 0x7f0800b3 */</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>wmctf<span class="token punctuation">.</span>ezandroid<span class="token punctuation">.</span></span>MainActivity</span> <span class="token punctuation">)</span> p0 <span class="token punctuation">)</span><span class="token punctuation">.</span>findViewById <span class="token punctuation">(</span> v0 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {p0, v0}, Lcom/wmctf/ezandroid/MainActivity;->findViewById(I)Landroid/view/View;</span>
<span class="token comment">/* check-cast v0, Landroid/widget/Button; */</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>exitButton <span class="token operator">=</span> v0<span class="token punctuation">;</span>
<span class="token comment">/* .line 60 */</span>
v0 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>checkoutButton<span class="token punctuation">;</span>
<span class="token comment">/* new-instance v1, Lcom/wmctf/ezandroid/MainActivity$1; */</span>
<span class="token comment">/* invoke-direct {v1, p0}, Lcom/wmctf/ezandroid/MainActivity$1;->&lt;init>(Lcom/wmctf/ezandroid/MainActivity;)V */</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span></span>Button</span> <span class="token punctuation">)</span> v0 <span class="token punctuation">)</span><span class="token punctuation">.</span>setOnClickListener <span class="token punctuation">(</span> v1 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {v0, v1}, Landroid/widget/Button;->setOnClickListener(Landroid/view/View$OnClickListener;)V</span>
<span class="token comment">/* .line 66 */</span>
v0 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>exitButton<span class="token punctuation">;</span>
<span class="token comment">/* new-instance v1, Lcom/wmctf/ezandroid/MainActivity$2; */</span>
<span class="token comment">/* invoke-direct {v1, p0}, Lcom/wmctf/ezandroid/MainActivity$2;->&lt;init>(Lcom/wmctf/ezandroid/MainActivity;)V */</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token namespace">android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span></span>Button</span> <span class="token punctuation">)</span> v0 <span class="token punctuation">)</span><span class="token punctuation">.</span>setOnClickListener <span class="token punctuation">(</span> v1 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// invoke-virtual {v0, v1}, Landroid/widget/Button;->setOnClickListener(Landroid/view/View$OnClickListener;)V</span>
<span class="token comment">/* .line 72 */</span>
<span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token comment">// .end method</span></code></pre></div>
<p>まず、ネイティブライブラリ関数 CheckUsername と check2 が宣言されていることに着目します。</p>
<p>アプリ側で検証ボタンをクリックすると、入力したユーザ名が CheckUsername 関数に、パスワードが check2 関数に与えられ、検証を実施していることがわかります。</p>
<p>そこで、Ghidra と Android Studio を駆使して検証箇所の特定までは進めたものの、残念ながらネイティブライブラリ関数内の処理を追い切れず、断念しました。</p>
<p>以降は、公式の Writeup を参考にしつつ問題を解き進めていきます。</p>
<p>参考：<a href="https://github.com/wm-team/WMCTF-2023/tree/main" target="_blank" rel="nofollow noopener noreferrer">wm-team/WMCTF-2023</a></p>
<h3 id="ネイティブライブラリ関数のオフセットを特定する" style="position:relative;"><a href="#%E3%83%8D%E3%82%A4%E3%83%86%E3%82%A3%E3%83%96%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E9%96%A2%E6%95%B0%E3%81%AE%E3%82%AA%E3%83%95%E3%82%BB%E3%83%83%E3%83%88%E3%82%92%E7%89%B9%E5%AE%9A%E3%81%99%E3%82%8B" aria-label="ネイティブライブラリ関数のオフセットを特定する permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ネイティブライブラリ関数のオフセットを特定する</h3>
<p>解析のためにはまず、ネイティブライブラリ内の CheckUsername と check2 の関数のオフセットの特定が必要です。</p>
<p>今回のバイナリでは、ネイティブライブラリのエクスポートテーブルには関数が登録されていませんでした。</p>
<p>そのため、自力で調査した際には Ghidra で見つけたそれっぽい関数にいくつかブレークポイントを設定して Android Studio のデバッガで関数を特定しました。</p>
<p>Writeup を見ると、このようなエクスポートテーブルに関数が登録されていないネイティブライブラリは JNI_onload 関数による dynamic registration(?) の仕組みによって実現しており、スマートに関数アドレスを特定するには RegisterNatives メソッドに Frida hook を仕掛けるのが有効なようです。</p>
<p>参考：<a href="https://stackoverflow.com/questions/1010645/what-does-the-registernatives-method-do" target="_blank" rel="nofollow noopener noreferrer">java - What does the registerNatives() method do? - Stack Overflow</a></p>
<p>そこで、<a href="/ctf-android-apk-debug-tutorial#frida-hook-%E3%81%A7%E5%8B%95%E7%9A%84%E8%A7%A3%E6%9E%90%E3%82%92%E8%A1%8C%E3%81%86">Android アプリの解析問題に負けないために学んだ 5 つのテクニック</a> の内容を思い出しつつ、問題の apk を Android Studio にロードしてエミュレータを起動して Frida hook の準備をしていきます。</p>
<p>まずは以下のコマンドを順に実行してエミュレータで Frida サーバを起動します。</p>
<div class="gatsby-highlight" data-language="powe"><pre class="language-powe"><code class="language-powe">adb root
adb.exe install ezAndroid.apk
ren frida-server-16.1.3-android-x86 frida-server
adb push frida-server /data/local/tmp
adb shell chmod +x /data/local/tmp/frida-server
adb shell /data/local/tmp/frida-server</code></pre></div>
<p>続いて、RegisterNatives をフックする以下の Javascript コードを payload.js として保存します。</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">hook_RegisterNatives</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> symbols <span class="token operator">=</span> Process<span class="token punctuation">.</span><span class="token function">getModuleByName</span><span class="token punctuation">(</span><span class="token string">'libart.so'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">enumerateSymbols</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> RegisterNatives_addr <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> symbols<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> symbol <span class="token operator">=</span> symbols<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>symbol<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"RegisterNatives"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> symbol<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"CheckJNI"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            RegisterNatives_addr <span class="token operator">=</span> symbol<span class="token punctuation">.</span>address<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"RegisterNatives_addr: "</span><span class="token punctuation">,</span> RegisterNatives_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Interceptor<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span>RegisterNatives_addr<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">onEnter</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> env <span class="token operator">=</span> Java<span class="token punctuation">.</span>vm<span class="token punctuation">.</span><span class="token function">tryGetEnv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> className <span class="token operator">=</span> env<span class="token punctuation">.</span><span class="token function">getClassName</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> methodCount <span class="token operator">=</span> args<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">toInt32</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> methodCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">var</span> methodName <span class="token operator">=</span> args<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>Process<span class="token punctuation">.</span>pointerSize <span class="token operator">*</span> <span class="token number">3</span> <span class="token operator">*</span> i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>Process<span class="token punctuation">.</span>pointerSize <span class="token operator">*</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readPointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readCString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> signature <span class="token operator">=</span> args<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>Process<span class="token punctuation">.</span>pointerSize <span class="token operator">*</span> <span class="token number">3</span> <span class="token operator">*</span> i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>Process<span class="token punctuation">.</span>pointerSize <span class="token operator">*</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readPointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readCString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> fnPtr <span class="token operator">=</span>
                    args<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>Process<span class="token punctuation">.</span>pointerSize <span class="token operator">*</span> <span class="token number">3</span> <span class="token operator">*</span> i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>Process<span class="token punctuation">.</span>pointerSize <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readPointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> module <span class="token operator">=</span> Process<span class="token punctuation">.</span><span class="token function">findModuleByAddress</span><span class="token punctuation">(</span>fnPtr<span class="token punctuation">)</span><span class="token punctuation">;</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>className<span class="token punctuation">,</span> methodName<span class="token punctuation">,</span> signature<span class="token punctuation">,</span> fnPtr<span class="token punctuation">,</span> module<span class="token punctuation">.</span>name<span class="token punctuation">,</span> fnPtr<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>base<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token function-variable function">onLeave</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">retval</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">hook_RegisterNatives</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>上記の payload.js を使用して Frida hook を試してみたところ、CheckUsername のオフセットが 0x28c0 であり、check2 が 0x2d20 であることがわかりました。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">frida.exe -U -l payload.js -f com.wmctf.ezandroid
<span class="token operator">></span>
com.wmctf.ezandroid.MainActivity CheckUsername <span class="token punctuation">(</span>Ljava/lang/String<span class="token punctuation">;</span><span class="token punctuation">)</span>I 0xbc3ed8c0 libezandroid.so 0x28c0
com.wmctf.ezandroid.MainActivity check2 <span class="token punctuation">(</span>Ljava/lang/String<span class="token punctuation">;</span><span class="token punctuation">)</span>I 0xbc3edd20 libezandroid.so 0x2d20</code></pre></div>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/2424c449db350059fb674905c18dc88b/289dd/image-20230823230030015.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 29.583333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAxUlEQVQY042QSwuDMBCEc/X9fpuA1NaKiJf2//+0aWYhpQcpHj5Gs5vZzaimaWCMgdYafd+jbVthGAb553nXdQjDEEEQiP5DZVmGqqrkYlEUX2PC8yRJxOiKmRh6nocoimQLmozjKN8kTVOpOcMrqNs84/544LmuWC3c0D27rmvkeS6mjjiOZeszZV29jwOvfce+bWK6LAtmO2SaJtmSGxNmSuWQsixlEJUxOaWx0rbRWLRtZmbMlM0uE079zYjP8n3/FNY+mpKSpte3RQoAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/2424c449db350059fb674905c18dc88b/8ac56/image-20230823230030015.webp 240w,
/static/2424c449db350059fb674905c18dc88b/d3be9/image-20230823230030015.webp 480w,
/static/2424c449db350059fb674905c18dc88b/e46b2/image-20230823230030015.webp 960w,
/static/2424c449db350059fb674905c18dc88b/a92ed/image-20230823230030015.webp 1409w"
              sizes="(max-width: 960px) 100vw, 960px"
              type="image/webp"
            />
          <source
            srcset="/static/2424c449db350059fb674905c18dc88b/8ff5a/image-20230823230030015.png 240w,
/static/2424c449db350059fb674905c18dc88b/e85cb/image-20230823230030015.png 480w,
/static/2424c449db350059fb674905c18dc88b/d9199/image-20230823230030015.png 960w,
/static/2424c449db350059fb674905c18dc88b/289dd/image-20230823230030015.png 1409w"
            sizes="(max-width: 960px) 100vw, 960px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/2424c449db350059fb674905c18dc88b/d9199/image-20230823230030015.png"
            alt="image-20230823230030015"
            title="image-20230823230030015"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>しかし、何らかの理由で Frida のプロセスが終了します。</p>
<p>これはどうやら Frida Defection による Anti Debug による問題のようです。</p>
<p>そのため、一旦静的解析のアプローチでこれらの関数の解析を進めていくことにします。</p>
<h3 id="checkusername-を解析する" style="position:relative;"><a href="#checkusername-%E3%82%92%E8%A7%A3%E6%9E%90%E3%81%99%E3%82%8B" aria-label="checkusername を解析する permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CheckUserName を解析する</h3>
<p>まずは  CheckUserName 関数から解析を進めていきます。</p>
<p>Ghidra のデコンパイル結果より IDA のデコンパイル結果の方がかなり読みやすかったので、以下に記載します。</p>
<div class="gatsby-highlight" data-language="c"><pre class="language-c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">sub_28C0</span><span class="token punctuation">(</span><span class="token keyword">int</span> a1<span class="token punctuation">,</span> <span class="token keyword">int</span> a2<span class="token punctuation">,</span> <span class="token keyword">int</span> a3<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">int</span> v4<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">int</span> v6<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">int</span> v7<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [esp+44h] [ebp-68h]</span>
  <span class="token keyword">int</span> v10<span class="token punctuation">;</span> <span class="token comment">// [esp+48h] [ebp-64h]</span>
  <span class="token keyword">int</span> v11<span class="token punctuation">;</span> <span class="token comment">// [esp+4Ch] [ebp-60h]</span>
  <span class="token keyword">int</span> v12<span class="token punctuation">;</span> <span class="token comment">// [esp+50h] [ebp-5Ch]</span>
  BOOL v13<span class="token punctuation">;</span> <span class="token comment">// [esp+54h] [ebp-58h]</span>
  _DWORD v14<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+8Fh] [ebp-1Dh] BYREF</span>
  <span class="token keyword">char</span> v15<span class="token punctuation">;</span> <span class="token comment">// [esp+97h] [ebp-15h]</span>
  <span class="token keyword">int</span> v16<span class="token punctuation">;</span> <span class="token comment">// [esp+98h] [ebp-14h]</span>

  v12 <span class="token operator">=</span> <span class="token function">sub_2CA0</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> a3<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v3 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span>
  v11 <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>v3<span class="token punctuation">)</span><span class="token punctuation">;</span>
  v10 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1175022871</span><span class="token punctuation">;</span> <span class="token punctuation">;</span> i <span class="token operator">=</span> v4 <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">while</span> <span class="token punctuation">(</span> i <span class="token operator">>=</span> <span class="token number">196966936</span> <span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        v13 <span class="token operator">=</span> i <span class="token operator">>=</span> <span class="token number">712737466</span> <span class="token operator">&amp;&amp;</span> i <span class="token operator">&lt;</span> <span class="token number">1618600811</span><span class="token punctuation">;</span>
        i <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">449433691</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> i <span class="token operator">>=</span> <span class="token operator">-</span><span class="token number">1175022871</span> <span class="token punctuation">)</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token function">sub_4BC0</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>unk_9228<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>unk_6650 <span class="token operator">+</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      v14<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>off_8FBC <span class="token operator">+</span> <span class="token number">155</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      v14<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>off_8FBC <span class="token operator">+</span> <span class="token number">156</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      v15 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>off_8FBC <span class="token operator">+</span> <span class="token number">628</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      v5 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>v14<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">sub_5810</span><span class="token punctuation">(</span>v12<span class="token punctuation">,</span> v11<span class="token punctuation">,</span> v10<span class="token punctuation">,</span> v14<span class="token punctuation">,</span> v5<span class="token punctuation">)</span><span class="token punctuation">;</span>
      v6 <span class="token operator">=</span> <span class="token function">memcmp</span><span class="token punctuation">(</span>v11<span class="token punctuation">,</span> <span class="token operator">&amp;</span>byte_9138<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      v7 <span class="token operator">=</span> <span class="token number">1618600811</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>v6 <span class="token punctuation">)</span>
        v7 <span class="token operator">=</span> <span class="token number">712737466</span><span class="token punctuation">;</span>
      i <span class="token operator">=</span> v7<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> i <span class="token operator">>=</span> <span class="token operator">-</span><span class="token number">449433691</span> <span class="token punctuation">)</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    v4 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1711309751</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> v10 <span class="token operator">!=</span> <span class="token number">10</span> <span class="token punctuation">)</span>
      v4 <span class="token operator">=</span> <span class="token number">196966936</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>off_8FBC <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-></span>d_tag <span class="token operator">==</span> v16 <span class="token punctuation">)</span>
    <span class="token keyword">return</span> v13<span class="token punctuation">;</span>
  <span class="token keyword">else</span>
    <span class="token keyword">return</span> <span class="token function">sub_2CA0</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> a2<span class="token punctuation">,</span> a3<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>上から見ていくと、以下の行で v10 に何かの長さが格納されることがわかります。</p>
<p>こちらですが、Android Studio のデバッガで確認してみたところ v12 が入力したユーザ名の文字列で、v10 がその長さになっていました。</p>
<div class="gatsby-highlight" data-language="c"><pre class="language-c"><code class="language-c">v12 <span class="token operator">=</span> <span class="token function">sub_2CA0</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> a3<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
v3 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span>
v11 <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>v3<span class="token punctuation">)</span><span class="token punctuation">;</span>
v10 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>というわけで、v12 と v10 をそれぞれリネームします。</p>
<p>続いて for と while 文の中の処理を見ていきます。</p>
<p>まず、i の初期値が -1175022871 であることから、1 回目のループでは確実に以下の箇所に最初に到達することがわかります。</p>
<p>v4 には for ループ内における次の i の値が格納されます。</p>
<div class="gatsby-highlight" data-language="c"><pre class="language-c"><code class="language-c">v4 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1711309751</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span> user_name_len <span class="token operator">!=</span> <span class="token number">10</span> <span class="token punctuation">)</span> v4 <span class="token operator">=</span> <span class="token number">196966936</span><span class="token punctuation">;</span></code></pre></div>
<p>ここで、v4 に -1711309751 が格納されたままだと以降の処理に進めなくなるため、ユーザ名は 10 文字である必要があることがわかります。</p>
<p>10 文字のユーザ名が入力されると、次に以下の処理が呼び出されます。</p>
<div class="gatsby-highlight" data-language="c"><pre class="language-c"><code class="language-c"><span class="token function">sub_4BC0</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>unk_9228<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>unk_6650 <span class="token operator">+</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
v14<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>off_8FBC <span class="token operator">+</span> <span class="token number">155</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
v14<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>off_8FBC <span class="token operator">+</span> <span class="token number">156</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
v15 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>off_8FBC <span class="token operator">+</span> <span class="token number">628</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
v5 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>v14<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">sub_5810</span><span class="token punctuation">(</span>user_name<span class="token punctuation">,</span> user_name_heap_ptr<span class="token punctuation">,</span> user_name_len<span class="token punctuation">,</span> v14<span class="token punctuation">,</span> v5<span class="token punctuation">)</span><span class="token punctuation">;</span>
v6 <span class="token operator">=</span> <span class="token function">memcmp</span><span class="token punctuation">(</span>user_name_heap_ptr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>byte_9138<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
v7 <span class="token operator">=</span> <span class="token number">1618600811</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>v6 <span class="token punctuation">)</span> v7 <span class="token operator">=</span> <span class="token number">712737466</span><span class="token punctuation">;</span>
i <span class="token operator">=</span> v7<span class="token punctuation">;</span></code></pre></div>
<p>結論から見ていくと、user<em>name</em>heap<em>ptr のアドレスに格納されている 10 バイト分のバイト列がハードコードされた &#x26;byte</em>9138 と一致する場合にユーザ名の検証をパスできるようです。</p>
<p>そこで、このメモリ領域に何らかの値を埋め込んでいると思しき sub_5810 関数を見ていきます。</p>
<p>以下が、IDA でデコンパイルした sub_5810 の結果です。</p>
<div class="gatsby-highlight" data-language="c"><pre class="language-c"><code class="language-c">Elf32_Dyn <span class="token operator">*</span><span class="token operator">*</span>__cdecl <span class="token function">sub_5810</span><span class="token punctuation">(</span><span class="token keyword">int</span> a1<span class="token punctuation">,</span> <span class="token keyword">int</span> a2<span class="token punctuation">,</span> <span class="token keyword">int</span> a3<span class="token punctuation">,</span> <span class="token keyword">int</span> a4<span class="token punctuation">,</span> <span class="token keyword">int</span> a5<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">int</span> v6<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">int</span> v7<span class="token punctuation">;</span> <span class="token comment">// esi</span>
  Elf32_Dyn <span class="token operator">*</span><span class="token operator">*</span>result<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [esp+1Ch] [ebp-230h]</span>
  <span class="token keyword">int</span> v10<span class="token punctuation">;</span> <span class="token comment">// [esp+20h] [ebp-22Ch]</span>
  <span class="token keyword">int</span> v11<span class="token punctuation">;</span> <span class="token comment">// [esp+24h] [ebp-228h]</span>
  <span class="token keyword">int</span> v12<span class="token punctuation">;</span> <span class="token comment">// [esp+30h] [ebp-21Ch]</span>
  _BYTE v13<span class="token punctuation">[</span><span class="token number">512</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+38h] [ebp-214h] BYREF</span>
  <span class="token keyword">int</span> v14<span class="token punctuation">;</span> <span class="token comment">// [esp+238h] [ebp-14h]</span>

  v11 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  v10 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  v12 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">1757399473</span><span class="token punctuation">;</span> <span class="token punctuation">;</span> i <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">901255010</span> <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span> i <span class="token operator">>=</span> <span class="token operator">-</span><span class="token number">368149380</span> <span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span> i <span class="token operator">&lt;</span> <span class="token number">1654659448</span> <span class="token punctuation">)</span>
          <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span> i <span class="token operator">&lt;</span> <span class="token number">703941909</span> <span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
              v7 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">417153812</span><span class="token punctuation">;</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span> v10 <span class="token operator">&lt;</span> a3 <span class="token punctuation">)</span>
                v7 <span class="token operator">=</span> <span class="token number">703941909</span><span class="token punctuation">;</span>
              i <span class="token operator">=</span> v7<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> i <span class="token operator">>=</span> <span class="token number">836230828</span> <span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
              v6 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1661826464</span><span class="token punctuation">;</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span> v12 <span class="token operator">&lt;</span> <span class="token number">256</span> <span class="token punctuation">)</span>
                v6 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1347250435</span><span class="token punctuation">;</span>
              i <span class="token operator">=</span> v6<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{</span>
              v12 <span class="token operator">=</span> <span class="token punctuation">(</span>v12 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">;</span>
              v11 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8<span class="token punctuation">)</span>v13<span class="token punctuation">[</span>v12 <span class="token operator">+</span> <span class="token number">256</span><span class="token punctuation">]</span> <span class="token operator">+</span> v11<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">;</span>
              <span class="token function">sub_57D0</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v13<span class="token punctuation">[</span>v12 <span class="token operator">+</span> <span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>v13<span class="token punctuation">[</span>v11 <span class="token operator">+</span> <span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a2 <span class="token operator">+</span> v10<span class="token punctuation">)</span> <span class="token operator">=</span> v10 <span class="token operator">^</span> v13<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8<span class="token punctuation">)</span>v13<span class="token punctuation">[</span>v11 <span class="token operator">+</span> <span class="token number">256</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8<span class="token punctuation">)</span>v13<span class="token punctuation">[</span>v12 <span class="token operator">+</span> <span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>
                                             <span class="token operator">+</span> <span class="token number">256</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> v10<span class="token punctuation">)</span><span class="token punctuation">;</span>
              i <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1903061274</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> i <span class="token operator">&lt;</span> <span class="token number">1718231927</span> <span class="token punctuation">)</span>
          <span class="token punctuation">{</span>
            <span class="token operator">++</span>v12<span class="token punctuation">;</span>
            i <span class="token operator">=</span> <span class="token number">836230828</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> i <span class="token operator">>=</span> <span class="token number">1757399473</span> <span class="token punctuation">)</span>
          <span class="token punctuation">{</span>
            v5 <span class="token operator">=</span> <span class="token number">1718231927</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span> v12 <span class="token operator">&lt;</span> <span class="token number">256</span> <span class="token punctuation">)</span>
              v5 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">567528547</span><span class="token punctuation">;</span>
            i <span class="token operator">=</span> v5<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">else</span>
          <span class="token punctuation">{</span>
            v12 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            i <span class="token operator">=</span> <span class="token number">836230828</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> i <span class="token operator">>=</span> <span class="token operator">-</span><span class="token number">901255010</span> <span class="token punctuation">)</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> i <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">1661826464</span> <span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
          <span class="token operator">++</span>v10<span class="token punctuation">;</span>
          i <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">368149380</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> i <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">1347250435</span> <span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
          v11 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
          v12 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
          v10 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
          i <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">368149380</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{</span>
          v11 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8<span class="token punctuation">)</span>v13<span class="token punctuation">[</span>v12<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8<span class="token punctuation">)</span>v13<span class="token punctuation">[</span>v12 <span class="token operator">+</span> <span class="token number">256</span><span class="token punctuation">]</span> <span class="token operator">+</span> v11<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">;</span>
          <span class="token function">sub_57D0</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v13<span class="token punctuation">[</span>v12 <span class="token operator">+</span> <span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>v13<span class="token punctuation">[</span>v11 <span class="token operator">+</span> <span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          i <span class="token operator">=</span> <span class="token number">1654659448</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> i <span class="token operator">>=</span> <span class="token operator">-</span><span class="token number">567528547</span> <span class="token punctuation">)</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token operator">++</span>v12<span class="token punctuation">;</span>
      i <span class="token operator">=</span> <span class="token number">1757399473</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> i <span class="token operator">>=</span> <span class="token operator">-</span><span class="token number">417153812</span> <span class="token punctuation">)</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    v13<span class="token punctuation">[</span>v12 <span class="token operator">+</span> <span class="token number">256</span><span class="token punctuation">]</span> <span class="token operator">=</span> v12<span class="token punctuation">;</span>
    v13<span class="token punctuation">[</span>v12<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a4 <span class="token operator">+</span> v12 <span class="token operator">%</span> a5<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  result <span class="token operator">=</span> <span class="token operator">&amp;</span>off_8FBC<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> _stack_chk_guard <span class="token operator">!=</span> v14 <span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>Elf32_Dyn <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">sub_5CB0</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>問題やってた当時はここで詰んだのですが、どうやらこの関数は RC4 で暗号化をしているらしいです。</p>
<p>確かに、XOR の感じとかが RC4 っぽいと言われればそんな気もしてきますが、正直今の僕のレベルだとこの関数を RC4 だと見抜くのは結構厳しいかなぁという感じでした。</p>
<p>というわけで、RC4 だと見抜けなくても解ける方法を模索していきます。</p>
<p>上記の関数を BingAI に突っ込んだところ、RC4 とは見抜けませんでしたが、「疑似暗号生成器で生成した鍵を用いて暗号化を行う関数である」というかなり惜しいところまで教えてくれました。</p>
<p>疑似暗号生成器で生成した鍵を使った暗号化処理ということは、暗号化と復号に同じ鍵とロジック使用する対象暗号である可能性が考えられます。</p>
<p>つまり、この何だかよくわからない sub<em>5810 の関数に入力文字列ではなく、ハードコードされた暗号化文字列 &#x26;byte</em>9138 を突っ込むと、出力結果が正しい入力値の平文になる(可能性がある)というわけです。</p>
<p>暗号化処理の実装が対象暗号かどうかを推測する方法はテクニックとして有効なように思いました。</p>
<p>Frida Detection のバイパス方法は Writeup を見てもよくわからなかったので、普通に Android エミュレータの lldb を使用しました。</p>
<p>イメージベースがアプリの起動ごとに変化するのが少々面倒ですが、こちらは面倒なバイパスなどは不要でした。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">image list
<span class="token operator">></span>
<span class="token punctuation">[</span><span class="token number">272</span><span class="token punctuation">]</span> 4E68710A-7885-E1FA-9BEB-555E9FB7D0ED-B7357321 0xc2299000 C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>kash1064<span class="token punctuation">\</span>.lldb<span class="token punctuation">\</span>module_cache<span class="token punctuation">\</span>remote-android<span class="token punctuation">\</span>.cache<span class="token punctuation">\</span>4E68710A-7885-E1FA-9BEB-555E9FB7D0ED-B7357321<span class="token punctuation">\</span>libezandroid.so 

<span class="token comment"># 0xc2299000 + 0x2bcf</span>
b *0xc229bbcf

<span class="token comment"># 0xc2299000+0x9138 = bss_start</span>
memory <span class="token builtin class-name">read</span> --size <span class="token number">8</span> --format x --count <span class="token number">1</span> 0xc2299000+0x9138

<span class="token comment"># esp = 0xffb357a0</span>
memory <span class="token builtin class-name">read</span> --size <span class="token number">4</span> --format x --count <span class="token number">4</span> esp
memory <span class="token function">write</span> 0xbd1d7b70 -s <span class="token number">8</span> 0xc1bdeb7ee66497e9
memory <span class="token function">write</span> 0xbd1d7b70+0x8 -s <span class="token number">2</span> 0x43ab</code></pre></div>
<p>上記のコマンドで、sub_5810 関数の呼び出し位置にブレークポイントを仕掛けた後、スタックから 4 つの引数をすべて抜き出します。</p>
<p>第 1 引数には入力値が格納されているので、そのアドレスのメモリを &#x26;byte_9138 の値に置き換えます。</p>
<p>最後に、関数の次の行に進めて暗号化処理後のバイト列が格納されるアドレスを確認したところ、正しいユーザ名の平文を取得できました。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 651px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/d1d6f864a3a15619ca43b826ce80e3e5/1ac66/image-20230824215627455.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 28.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA5klEQVQY02VRW3KEMAzjOBQISwDnRWC3vf+dVMtZOtP2QyPHdhRp0rkw46gXQojKJ0S5HBX7LqjnE7kcCDHaTkwZ9Xopnth0PgwfGMfxF7oleiQunhden1/Ytg3eexXc4ZcF67rqY8GYYN+5CX3fq+DwD10+MnIuiOqCTniZl4IIRIJC2ln7bSaWhr1FH7xBI9M0oZMsFivlbExhLhNcEhNu51vc3GuKeZ5NZFQ451pkKaKRC4qKUfBeptgNRv1b//Te7le9Yw6rfkROCfvbTdKaLlNq8e+6MWfJmK75sFdh8uPR3H4DZbzAdQ1+PVcAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/d1d6f864a3a15619ca43b826ce80e3e5/8ac56/image-20230824215627455.webp 240w,
/static/d1d6f864a3a15619ca43b826ce80e3e5/d3be9/image-20230824215627455.webp 480w,
/static/d1d6f864a3a15619ca43b826ce80e3e5/be1d0/image-20230824215627455.webp 651w"
              sizes="(max-width: 651px) 100vw, 651px"
              type="image/webp"
            />
          <source
            srcset="/static/d1d6f864a3a15619ca43b826ce80e3e5/8ff5a/image-20230824215627455.png 240w,
/static/d1d6f864a3a15619ca43b826ce80e3e5/e85cb/image-20230824215627455.png 480w,
/static/d1d6f864a3a15619ca43b826ce80e3e5/1ac66/image-20230824215627455.png 651w"
            sizes="(max-width: 651px) 100vw, 651px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/d1d6f864a3a15619ca43b826ce80e3e5/1ac66/image-20230824215627455.png"
            alt="image-20230824215627455"
            title="image-20230824215627455"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>これでユーザ名が<code class="language-text">Re_1s_eaSy</code>であることを特定できました。</p>
<h3 id="check2-を解析する" style="position:relative;"><a href="#check2-%E3%82%92%E8%A7%A3%E6%9E%90%E3%81%99%E3%82%8B" aria-label="check2 を解析する permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>check2 を解析する</h3>
<p>ユーザ名を特定できたので、次はパスワードの検証を行う関数 check2 を見ていきます。</p>
<p>こちらもデコンパイル結果は IDA の方が読みやすかったので IDA の結果を以下に記載します。</p>
<div class="gatsby-highlight" data-language="c"><pre class="language-c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">sub_2D20</span><span class="token punctuation">(</span><span class="token keyword">int</span> a1<span class="token punctuation">,</span> <span class="token keyword">int</span> a2<span class="token punctuation">,</span> <span class="token keyword">int</span> a3<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">int</span> v4<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  <span class="token keyword">int</span> v6<span class="token punctuation">;</span> <span class="token comment">// ebx</span>
  <span class="token keyword">int</span> v8<span class="token punctuation">;</span> <span class="token comment">// [esp+24h] [ebp-68h]</span>
  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [esp+40h] [ebp-4Ch]</span>
  __m128i <span class="token operator">*</span>v10<span class="token punctuation">;</span> <span class="token comment">// [esp+44h] [ebp-48h]</span>
  <span class="token keyword">int</span> v11<span class="token punctuation">;</span> <span class="token comment">// [esp+48h] [ebp-44h]</span>
  <span class="token keyword">int</span> v12<span class="token punctuation">;</span> <span class="token comment">// [esp+58h] [ebp-34h]</span>
  <span class="token keyword">int</span> v13<span class="token punctuation">;</span> <span class="token comment">// [esp+74h] [ebp-18h]</span>
  <span class="token keyword">int</span> v14<span class="token punctuation">;</span> <span class="token comment">// [esp+78h] [ebp-14h]</span>

  <span class="token function">sub_4D40</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>unk_9238<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>unk_6650 <span class="token operator">+</span> <span class="token number">79</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v8 <span class="token operator">=</span> <span class="token function">sub_30F0</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> <span class="token operator">&amp;</span>unk_9238<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">sub_4EC0</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>off_8FBC<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>off_8FBC <span class="token operator">-</span> <span class="token number">2612</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">sub_5040</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>unk_9268<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>unk_6650 <span class="token operator">+</span> <span class="token number">195</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v3 <span class="token operator">=</span> <span class="token function">sub_3140</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> v8<span class="token punctuation">,</span> <span class="token operator">&amp;</span>unk_9260<span class="token punctuation">,</span> <span class="token operator">&amp;</span>unk_9268<span class="token punctuation">)</span><span class="token punctuation">;</span>
  v4 <span class="token operator">=</span> <span class="token function">sub_31D0</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> v8<span class="token punctuation">,</span> v3<span class="token punctuation">)</span><span class="token punctuation">;</span>
  v11 <span class="token operator">=</span> <span class="token function">sub_2CA0</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> v4<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v10 <span class="token operator">=</span> <span class="token punctuation">(</span>__m128i <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">sub_2CA0</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> a3<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v13 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>v10<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">1959410021</span><span class="token punctuation">;</span> <span class="token punctuation">;</span> i <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">19509138</span> <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">while</span> <span class="token punctuation">(</span> i <span class="token operator">>=</span> <span class="token number">74238448</span> <span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> i <span class="token operator">&lt;</span> <span class="token number">746085184</span> <span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
          v12 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
          i <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">19509138</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> i <span class="token operator">>=</span> <span class="token number">1959410021</span> <span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
          v5 <span class="token operator">=</span> <span class="token number">746085184</span><span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span> v13 <span class="token operator">!=</span> <span class="token number">16</span> <span class="token punctuation">)</span>
            v5 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">23033666</span><span class="token punctuation">;</span>
          i <span class="token operator">=</span> v5<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{</span>
          <span class="token function">sub_7B0</span><span class="token punctuation">(</span>v10<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> v11<span class="token punctuation">)</span><span class="token punctuation">;</span>
          v6 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1371855156</span><span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">_mm_movemask_epi8</span><span class="token punctuation">(</span><span class="token function">_mm_cmpeq_epi8</span><span class="token punctuation">(</span>byte_9158<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">*</span>v10<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0xFFFF</span> <span class="token punctuation">)</span>
            v6 <span class="token operator">=</span> <span class="token number">74238448</span><span class="token punctuation">;</span>
          i <span class="token operator">=</span> v6<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> i <span class="token operator">>=</span> <span class="token operator">-</span><span class="token number">23033666</span> <span class="token punctuation">)</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      v12 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      i <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">19509138</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> i <span class="token operator">>=</span> <span class="token operator">-</span><span class="token number">19509138</span> <span class="token punctuation">)</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    v12 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>off_8FBC <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-></span>d_tag <span class="token operator">==</span> v14 <span class="token punctuation">)</span>
    <span class="token keyword">return</span> v12<span class="token punctuation">;</span>
  <span class="token keyword">else</span>
    <span class="token keyword">return</span> <span class="token function">sub_30F0</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> a2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>まず気になるのは最初の以下の行です。</p>
<div class="gatsby-highlight" data-language="c"><pre class="language-c"><code class="language-c">v10 <span class="token operator">=</span> <span class="token punctuation">(</span>__m128i <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">sub_2CA0</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> a3<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
v13 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>v10<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>ここにブレークポイントを仕掛けてメモリを確認したところ、v10 には入力したパスワード文字列、v13 にはその長さが格納されていました。</p>
<p>そして、ユーザ名の検証と同じく以降のループ開始時の i の値は 1959410021 に固定のため、最初のループでは必ず以下の処理が呼び出されることがわかります。</p>
<div class="gatsby-highlight" data-language="c"><pre class="language-c"><code class="language-c"><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> i <span class="token operator">>=</span> <span class="token number">1959410021</span> <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  v5 <span class="token operator">=</span> <span class="token number">746085184</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> v13 <span class="token operator">!=</span> <span class="token number">16</span> <span class="token punctuation">)</span> v5 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">23033666</span><span class="token punctuation">;</span>
  i <span class="token operator">=</span> v5<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>つまり、正しいパスワードの文字数は 16 文字であることが特定できました。</p>
<p>次に着目すべき点は恐らく以下になると思います。</p>
<div class="gatsby-highlight" data-language="c"><pre class="language-c"><code class="language-c"><span class="token function">sub_7B0</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> v11<span class="token punctuation">)</span><span class="token punctuation">;</span>
v6 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1371855156</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">_mm_movemask_epi8</span><span class="token punctuation">(</span><span class="token function">_mm_cmpeq_epi8</span><span class="token punctuation">(</span>byte_9158<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">*</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0xFFFF</span> <span class="token punctuation">)</span> v6 <span class="token operator">=</span> <span class="token number">74238448</span><span class="token punctuation">;</span>
i <span class="token operator">=</span> v6<span class="token punctuation">;</span></code></pre></div>
<p><code class="language-text">_mm_movemask_epi8(_mm_cmpeq_epi8(byte_9158[0], *password)</code> は、入力したパスワード文字列のアドレスと、ハードコードされたバイト列 byte_9158 を比較しているように見えます。</p>
<p>つまり、先ほどと同じく sub_7B0 で何らかの形で暗号化されたパスワードがハードコードされた値と一致するかを確認する処理であることが推測できます。</p>
<p>実際に、パスワードに 16 文字の文字列を入力した状態で、sub_7B0 の呼び出し位置にブレークポイントを仕掛けてみました。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 694px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/09a89fd7c100d042ef93405512b0e43b/31198/image-20230824225645435.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 39.166666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABAElEQVQoz11SWbKEMAj0PGr21STOc+rN/a/EQBSX+ehqgtBpgoNwEmLM4LwH6xz4EHtMHFMGYyyEmDAXIOUFIkIIAeM4PjBNU+fBVw/ra4P3/we27d3FlmWBlBJehKJx5xBCzymtT4ETN9EhYhEVexRy6JBgrb1iYj4j87d09FG/Uuom2BKs6wv+0F2trQtT4Y4r9n5nmsAY00WklJ2FmC/BlNM+3jEiCbLobxyOsz2d+t6jlLwEQ41QSoOGLkup52g8MoGfg5ndMeb55jCXjEsouMEMGcEj8iJIhJ0/Xfs+WWvt+YYat6aPG7VW/X0ox/wLaqZ6ciWlQnF3/kYk+AXX0/4bpr2cigAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/09a89fd7c100d042ef93405512b0e43b/8ac56/image-20230824225645435.webp 240w,
/static/09a89fd7c100d042ef93405512b0e43b/d3be9/image-20230824225645435.webp 480w,
/static/09a89fd7c100d042ef93405512b0e43b/181fb/image-20230824225645435.webp 694w"
              sizes="(max-width: 694px) 100vw, 694px"
              type="image/webp"
            />
          <source
            srcset="/static/09a89fd7c100d042ef93405512b0e43b/8ff5a/image-20230824225645435.png 240w,
/static/09a89fd7c100d042ef93405512b0e43b/e85cb/image-20230824225645435.png 480w,
/static/09a89fd7c100d042ef93405512b0e43b/31198/image-20230824225645435.png 694w"
            sizes="(max-width: 694px) 100vw, 694px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/09a89fd7c100d042ef93405512b0e43b/31198/image-20230824225645435.png"
            alt="image-20230824225645435"
            title="image-20230824225645435"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>呼び出し時のスタックを確認すると、第 3 引数の v11 は、正しいユーザ名に 123456 という文字列を追加した値であることがわかります。</p>
<p>パスワードの文字列と文字数を合わせているあたり、何かしらの XOR などの処理を行うのかもしれません。</p>
<p>一旦 sub_7B0 の関数を実行させてみたところ、パスワードが格納されていたメモリ領域の値が暗号化されたようなバイト列に変化していました。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 646px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/3cd3fb65876544ce612f919e0182cf10/27524/image-20230824225939774.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 13.750000000000002%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAd0lEQVQI14WPWQ7DMAhEfZ3WK5DWu3L/U01jqiTqVz9GMzwBAvOQJ17vjNoGWp8gYlhr4Zz7q7PPe39lM/cdc07kUjDGQM4ZrTVVOVit9cq9d61XXoyZVbJtCCFARGCYRWGMESkldSK6xV9PiX74mllL9Nrzo8M/yl9e2Aty850AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/3cd3fb65876544ce612f919e0182cf10/8ac56/image-20230824225939774.webp 240w,
/static/3cd3fb65876544ce612f919e0182cf10/d3be9/image-20230824225939774.webp 480w,
/static/3cd3fb65876544ce612f919e0182cf10/8c2f2/image-20230824225939774.webp 646w"
              sizes="(max-width: 646px) 100vw, 646px"
              type="image/webp"
            />
          <source
            srcset="/static/3cd3fb65876544ce612f919e0182cf10/8ff5a/image-20230824225939774.png 240w,
/static/3cd3fb65876544ce612f919e0182cf10/e85cb/image-20230824225939774.png 480w,
/static/3cd3fb65876544ce612f919e0182cf10/27524/image-20230824225939774.png 646w"
            sizes="(max-width: 646px) 100vw, 646px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/3cd3fb65876544ce612f919e0182cf10/27524/image-20230824225939774.png"
            alt="image-20230824225939774"
            title="image-20230824225939774"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>恐らくここの値が、ハードコードされたバイト列 byte_9158 に一致するような入力値を特定できれば、正しいパスワードを取得できそうです。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/74af303327fe137418ccb257279aa70e/f058b/image-20230824230105773.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 12.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAeUlEQVQI122PSQ7DMAwD/R5viBvLWor0/79iLafOqYcBRQqgoNBeJ1hsohB9o5SClBJyzg/u/7F3McbHh+v6QFXBzDCzhXtHZiYi85As1ak8dYyxMFO01lBrxXEc6EQIXtT7CeoEohvP9uyM4fAqIRq//C71Mv9q8wXIiV+ELvhlJQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/74af303327fe137418ccb257279aa70e/8ac56/image-20230824230105773.webp 240w,
/static/74af303327fe137418ccb257279aa70e/d3be9/image-20230824230105773.webp 480w,
/static/74af303327fe137418ccb257279aa70e/8aab1/image-20230824230105773.webp 630w"
              sizes="(max-width: 630px) 100vw, 630px"
              type="image/webp"
            />
          <source
            srcset="/static/74af303327fe137418ccb257279aa70e/8ff5a/image-20230824230105773.png 240w,
/static/74af303327fe137418ccb257279aa70e/e85cb/image-20230824230105773.png 480w,
/static/74af303327fe137418ccb257279aa70e/f058b/image-20230824230105773.png 630w"
            sizes="(max-width: 630px) 100vw, 630px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/74af303327fe137418ccb257279aa70e/f058b/image-20230824230105773.png"
            alt="image-20230824230105773"
            title="image-20230824230105773"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>sub_7B0 のデコンパイル結果は以下でした。</p>
<div class="gatsby-highlight" data-language="c"><pre class="language-c"><code class="language-c">Elf32_Dyn <span class="token operator">*</span><span class="token operator">*</span>__cdecl <span class="token function">sub_7B0</span><span class="token punctuation">(</span><span class="token keyword">int</span> a1<span class="token punctuation">,</span> <span class="token keyword">int</span> a2<span class="token punctuation">,</span> <span class="token keyword">int</span> a3<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment">// esi</span>
  <span class="token keyword">int</span> v4<span class="token punctuation">;</span> <span class="token comment">// edx</span>
  Elf32_Dyn <span class="token operator">*</span><span class="token operator">*</span>result<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">int</span> v6<span class="token punctuation">;</span> <span class="token comment">// [esp+30h] [ebp-7Ch]</span>
  <span class="token keyword">int</span> v7<span class="token punctuation">;</span> <span class="token comment">// [esp+34h] [ebp-78h]</span>
  <span class="token keyword">int</span> v8<span class="token punctuation">;</span> <span class="token comment">// [esp+38h] [ebp-74h]</span>
  <span class="token keyword">int</span> v9<span class="token punctuation">;</span> <span class="token comment">// [esp+50h] [ebp-5Ch] BYREF</span>
  <span class="token keyword">int</span> v10<span class="token punctuation">;</span> <span class="token comment">// [esp+54h] [ebp-58h]</span>
  _DWORD v11<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+58h] [ebp-54h] BYREF</span>

  v10 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">970393338</span><span class="token punctuation">;</span>
  <span class="token function">strlen</span><span class="token punctuation">(</span>a3<span class="token punctuation">)</span><span class="token punctuation">;</span>
  v9 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1522528529</span><span class="token punctuation">;</span>
  <span class="token function">sub_C40</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v9<span class="token punctuation">,</span> a3<span class="token punctuation">)</span><span class="token punctuation">;</span>
  v8 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  v6 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1028578145</span><span class="token punctuation">;</span>
  <span class="token keyword">do</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span> v6 <span class="token operator">>=</span> <span class="token operator">-</span><span class="token number">304130802</span> <span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span> v6 <span class="token operator">&lt;</span> <span class="token number">703599849</span> <span class="token punctuation">)</span>
          <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span> v6 <span class="token operator">&lt;</span> <span class="token number">90447858</span> <span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span> v6 <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">304130802</span> <span class="token punctuation">)</span>
              <span class="token punctuation">{</span>
                v4 <span class="token operator">=</span> v10 <span class="token operator">-</span> <span class="token number">1292562961</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span> v7 <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token punctuation">)</span>
                  v4 <span class="token operator">=</span> v10 <span class="token operator">+</span> <span class="token number">1060841196</span><span class="token punctuation">;</span>
                v6 <span class="token operator">=</span> v4<span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> v6 <span class="token operator">==</span> <span class="token number">90447858</span> <span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
              v9 <span class="token operator">=</span> v10 <span class="token operator">+</span> <span class="token number">1871195796</span><span class="token punctuation">;</span>
              <span class="token function">sub_15A0</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v9<span class="token punctuation">,</span> v11<span class="token punctuation">)</span><span class="token punctuation">;</span>
              v9 <span class="token operator">=</span> v10 <span class="token operator">+</span> <span class="token number">41419369</span><span class="token punctuation">;</span>
              <span class="token function">sub_1840</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v9<span class="token punctuation">,</span> v11<span class="token punctuation">)</span><span class="token punctuation">;</span>
              v9 <span class="token operator">=</span> v10 <span class="token operator">+</span> <span class="token number">475928445</span><span class="token punctuation">;</span>
              <span class="token function">sub_1B90</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v9<span class="token punctuation">,</span> v11<span class="token punctuation">)</span><span class="token punctuation">;</span>
              v9 <span class="token operator">=</span> v10 <span class="token operator">-</span> <span class="token number">878836549</span><span class="token punctuation">;</span>
              <span class="token function">sub_12E0</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v9<span class="token punctuation">,</span> v11<span class="token punctuation">,</span> v7<span class="token punctuation">)</span><span class="token punctuation">;</span>
              v6 <span class="token operator">=</span> v10 <span class="token operator">+</span> <span class="token number">154390384</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> v6 <span class="token operator">&lt;</span> <span class="token number">2032010997</span> <span class="token punctuation">)</span>
          <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span> v6 <span class="token operator">==</span> <span class="token number">703599849</span> <span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
              v8 <span class="token operator">+=</span> <span class="token number">16</span><span class="token punctuation">;</span>
              v6 <span class="token operator">=</span> v10 <span class="token operator">-</span> <span class="token number">58184807</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> v6 <span class="token operator">==</span> <span class="token number">2032010997</span> <span class="token punctuation">)</span>
          <span class="token punctuation">{</span>
            v9 <span class="token operator">=</span> v10 <span class="token operator">+</span> <span class="token number">1871195796</span><span class="token punctuation">;</span>
            <span class="token function">sub_15A0</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v9<span class="token punctuation">,</span> v11<span class="token punctuation">)</span><span class="token punctuation">;</span>
            v9 <span class="token operator">=</span> v10 <span class="token operator">+</span> <span class="token number">41419369</span><span class="token punctuation">;</span>
            <span class="token function">sub_1840</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v9<span class="token punctuation">,</span> v11<span class="token punctuation">)</span><span class="token punctuation">;</span>
            v9 <span class="token operator">=</span> v10 <span class="token operator">-</span> <span class="token number">878836549</span><span class="token punctuation">;</span>
            <span class="token function">sub_12E0</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v9<span class="token punctuation">,</span> v11<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            v9 <span class="token operator">=</span> v10 <span class="token operator">+</span> <span class="token number">1852563524</span><span class="token punctuation">;</span>
            <span class="token function">sub_2140</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v9<span class="token punctuation">,</span> v11<span class="token punctuation">,</span> v8 <span class="token operator">+</span> a1<span class="token punctuation">)</span><span class="token punctuation">;</span>
            v6 <span class="token operator">=</span> v10 <span class="token operator">+</span> <span class="token number">1673993187</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> v6 <span class="token operator">>=</span> <span class="token operator">-</span><span class="token number">582053114</span> <span class="token punctuation">)</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> v6 <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">816002954</span> <span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span> v6 <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1028578145</span> <span class="token punctuation">)</span>
          <span class="token punctuation">{</span>
            v3 <span class="token operator">=</span> v10 <span class="token operator">+</span> <span class="token number">388340224</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span> v8 <span class="token operator">&lt;</span> a2 <span class="token punctuation">)</span>
              v3 <span class="token operator">=</span> v10 <span class="token operator">+</span> <span class="token number">643763145</span><span class="token punctuation">;</span>
            v6 <span class="token operator">=</span> v3<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> v6 <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">816002954</span> <span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
          <span class="token operator">++</span>v7<span class="token punctuation">;</span>
          v6 <span class="token operator">=</span> v10 <span class="token operator">+</span> <span class="token number">666262536</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> v6 <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">326630193</span> <span class="token punctuation">)</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> v6 <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">326630193</span> <span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        v9 <span class="token operator">=</span> v10 <span class="token operator">+</span> <span class="token number">478257682</span><span class="token punctuation">;</span>
        <span class="token function">sub_1030</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v9<span class="token punctuation">,</span> v8 <span class="token operator">+</span> a1<span class="token punctuation">,</span> v11<span class="token punctuation">)</span><span class="token punctuation">;</span>
        v9 <span class="token operator">=</span> v10 <span class="token operator">-</span> <span class="token number">878836549</span><span class="token punctuation">;</span>
        <span class="token function">sub_12E0</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v9<span class="token punctuation">,</span> v11<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        v7 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        v6 <span class="token operator">=</span> v10 <span class="token operator">+</span> <span class="token number">666262536</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span> v6 <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">582053114</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
  result <span class="token operator">=</span> <span class="token operator">&amp;</span>off_8FBC<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> _stack_chk_guard <span class="token operator">!=</span> v11<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>Elf32_Dyn <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">sub_C40</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> a2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>相変わらず僕のレベルでは何が書いてあるのかさっぱりわかりません。</p>
<p>ただ、<a href="https://github.com/TorgoTorgo/ghidra-findcrypt" target="_blank" rel="nofollow noopener noreferrer">ghidra-findcrypt</a> を使用してラベリングを行ったところ、以下の通り AES の SBox と思われるデータが定義されていることを確認しました。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 836px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/ab414a9addd4d0e16ed3e243486ef151/27b8e/image-20230824233754518.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 48.75000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABnUlEQVQoz5WS227bMAyG/f5P0SfYXW8H5LrDhgVFlm5dbMc6+ZRkiV1bkuV/pFwXHbCLzQBBmSI/8qedPHx6wn6f4XAocDwKSCmx2+0wDANG66DOHuY6Q/8K0avzhLxyECcfz+I0vd2xT+7uNri/3+LzlwxpKpDmGb5utxhX4GUBmmuIpi8TUjPipxoW0yMkgd+AMn/AS3/D+0cIib7vCegpmSahRB0NZHM0cwWqbrEVxvFEqic8Zy2KskN7GzG4gKIoInAYHeTJIit7fEsb/BADNZhJssU+u5B/QU51vJbytqhInvMtPmwe8fHRYLOvcKh7aCXRdR2897DOYSSwUgZ10yLMMxzFq6pGWdbQ2tC+LWZSFkKc8Duu59Mfko/HZUIGOgYOtCehUBHA+wmeYkoqGFNSc00N7VJIzZIVwvQphHheJb8HikLC6JJgPsaF4D9CE1jThOMr7xUYCMQvbH8DWmvjNCyTJ5ymiaatYqymGN//J9DRvio0dRuBnN/SPrkBe77/d6B3cUcsjT+AI8mc39RNbGAotu6Q638Dl5P7elAAsJIAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/ab414a9addd4d0e16ed3e243486ef151/8ac56/image-20230824233754518.webp 240w,
/static/ab414a9addd4d0e16ed3e243486ef151/d3be9/image-20230824233754518.webp 480w,
/static/ab414a9addd4d0e16ed3e243486ef151/05152/image-20230824233754518.webp 836w"
              sizes="(max-width: 836px) 100vw, 836px"
              type="image/webp"
            />
          <source
            srcset="/static/ab414a9addd4d0e16ed3e243486ef151/8ff5a/image-20230824233754518.png 240w,
/static/ab414a9addd4d0e16ed3e243486ef151/e85cb/image-20230824233754518.png 480w,
/static/ab414a9addd4d0e16ed3e243486ef151/27b8e/image-20230824233754518.png 836w"
            sizes="(max-width: 836px) 100vw, 836px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/ab414a9addd4d0e16ed3e243486ef151/27b8e/image-20230824233754518.png"
            alt="image-20230824233754518"
            title="image-20230824233754518"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>ただし、この SBox はどこかの処理でスワッピングされるようで、そのまま使用することができません。</p>
<p>関数 sub_7B0 を呼び出した後のタイミングで SBox のメモリ領域をダンプすると、以下の通り復号に使用できる SBox を取得できました。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token punctuation">(</span>lldb<span class="token punctuation">)</span> memory <span class="token builtin class-name">read</span> --size <span class="token number">1</span> --format x --count <span class="token number">256</span> 0xc1ffc000
<span class="token operator">></span>
0xc1ffc000: 0x29 0x40 0x57 0x6e 0x85 0x9c 0xb3 0xca
0xc1ffc008: 0xe1 0xf8 0x0f 0x26 0x3d 0x54 0x6b 0x82
0xc1ffc010: 0x99 0xb0 0xc7 0xde 0xf5 0x0c 0x23 0x3a
0xc1ffc018: 0x51 0x68 0x7f 0x96 0xad 0xc4 0xdb 0xf2
0xc1ffc020: 0x09 0x20 0x37 0x4e 0x65 0x7c 0x93 0xaa
0xc1ffc028: 0xc1 0xd8 0xef 0x06 0x1d 0x34 0x4b 0x62
0xc1ffc030: 0x79 0x90 0xa7 0xbe 0xd5 0xec 0x03 0x1a
0xc1ffc038: 0x31 0x48 0x5f 0x76 0x8d 0xa4 0xbb 0xd2
0xc1ffc040: 0xe9 0x00 0x17 0x2e 0x45 0x5c 0x73 0x8a
0xc1ffc048: 0xa1 0xb8 0xcf 0xe6 0xfd 0x14 0x2b 0x42
0xc1ffc050: 0x59 0x70 0x87 0x9e 0xb5 0xcc 0xe3 0xfa
0xc1ffc058: 0x11 0x28 0x3f 0x56 0x6d 0x84 0x9b 0xb2
0xc1ffc060: 0xc9 0xe0 0xf7 0x0e 0x25 0x3c 0x53 0x6a
0xc1ffc068: 0x81 0x98 0xaf 0xc6 0xdd 0xf4 0x0b 0x22
0xc1ffc070: 0x39 0x50 0x67 0x7e 0x95 0xac 0xc3 0xda
0xc1ffc078: 0xf1 0x08 0x1f 0x36 0x4d 0x64 0x7b 0x92
0xc1ffc080: 0xa9 0xc0 0xd7 0xee 0x05 0x1c 0x33 0x4a
0xc1ffc088: 0x61 0x78 0x8f 0xa6 0xbd 0xd4 0xeb 0x02
0xc1ffc090: 0x19 0x30 0x47 0x5e 0x75 0x8c 0xa3 0xba
0xc1ffc098: 0xd1 0xe8 0xff 0x16 0x2d 0x44 0x5b 0x72
0xc1ffc0a0: 0x89 0xa0 0xb7 0xce 0xe5 0xfc 0x13 0x2a
0xc1ffc0a8: 0x41 0x58 0x6f 0x86 0x9d 0xb4 0xcb 0xe2
0xc1ffc0b0: 0xf9 0x10 0x27 0x3e 0x55 0x6c 0x83 0x9a
0xc1ffc0b8: 0xb1 0xc8 0xdf 0xf6 0x0d 0x24 0x3b 0x52
0xc1ffc0c0: 0x69 0x80 0x97 0xae 0xc5 0xdc 0xf3 0x0a
0xc1ffc0c8: 0x21 0x38 0x4f 0x66 0x7d 0x94 0xab 0xc2
0xc1ffc0d0: 0xd9 0xf0 0x07 0x1e 0x35 0x4c 0x63 0x7a
0xc1ffc0d8: 0x91 0xa8 0xbf 0xd6 0xed 0x04 0x1b 0x32
0xc1ffc0e0: 0x49 0x60 0x77 0x8e 0xa5 0xbc 0xd3 0xea
0xc1ffc0e8: 0x01 0x18 0x2f 0x46 0x5d 0x74 0x8b 0xa2
0xc1ffc0f0: 0xb9 0xd0 0xe7 0xfe 0x15 0x2c 0x43 0x5a
0xc1ffc0f8: 0x71 0x88 0x9f 0xb6 0xcd 0xe4 0xfb 0x12</code></pre></div>
<p>続いて、以下の Python スクリプトで SBox の各値の 上位 8 bit と下位 8bit の和をインデックスとする配列に、SBox のインデックスを代入します。</p>
<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python">new_s_box <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">0x29</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0x6E</span><span class="token punctuation">,</span> <span class="token number">0x85</span><span class="token punctuation">,</span> <span class="token number">0x9C</span><span class="token punctuation">,</span> <span class="token number">0xB3</span><span class="token punctuation">,</span> <span class="token number">0xCA</span><span class="token punctuation">,</span> <span class="token number">0xE1</span><span class="token punctuation">,</span> <span class="token number">0xF8</span><span class="token punctuation">,</span>
    <span class="token number">0x0F</span><span class="token punctuation">,</span> <span class="token number">0x26</span><span class="token punctuation">,</span> <span class="token number">0x3D</span><span class="token punctuation">,</span> <span class="token number">0x54</span><span class="token punctuation">,</span> <span class="token number">0x6B</span><span class="token punctuation">,</span> <span class="token number">0x82</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0xB0</span><span class="token punctuation">,</span> <span class="token number">0xC7</span><span class="token punctuation">,</span> <span class="token number">0xDE</span><span class="token punctuation">,</span>
    <span class="token number">0xF5</span><span class="token punctuation">,</span> <span class="token number">0x0C</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span> <span class="token number">0x3A</span><span class="token punctuation">,</span> <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x7F</span><span class="token punctuation">,</span> <span class="token number">0x96</span><span class="token punctuation">,</span> <span class="token number">0xAD</span><span class="token punctuation">,</span> <span class="token number">0xC4</span><span class="token punctuation">,</span>
    <span class="token number">0xDB</span><span class="token punctuation">,</span> <span class="token number">0xF2</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x37</span><span class="token punctuation">,</span> <span class="token number">0x4E</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0x7C</span><span class="token punctuation">,</span> <span class="token number">0x93</span><span class="token punctuation">,</span> <span class="token number">0xAA</span><span class="token punctuation">,</span>
    <span class="token number">0xC1</span><span class="token punctuation">,</span> <span class="token number">0xD8</span><span class="token punctuation">,</span> <span class="token number">0xEF</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span> <span class="token number">0x1D</span><span class="token punctuation">,</span> <span class="token number">0x34</span><span class="token punctuation">,</span> <span class="token number">0x4B</span><span class="token punctuation">,</span> <span class="token number">0x62</span><span class="token punctuation">,</span> <span class="token number">0x79</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span>
    <span class="token number">0xA7</span><span class="token punctuation">,</span> <span class="token number">0xBE</span><span class="token punctuation">,</span> <span class="token number">0xD5</span><span class="token punctuation">,</span> <span class="token number">0xEC</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0x1A</span><span class="token punctuation">,</span> <span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token number">0x48</span><span class="token punctuation">,</span> <span class="token number">0x5F</span><span class="token punctuation">,</span> <span class="token number">0x76</span><span class="token punctuation">,</span>
    <span class="token number">0x8D</span><span class="token punctuation">,</span> <span class="token number">0xA4</span><span class="token punctuation">,</span> <span class="token number">0xBB</span><span class="token punctuation">,</span> <span class="token number">0xD2</span><span class="token punctuation">,</span> <span class="token number">0xE9</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x17</span><span class="token punctuation">,</span> <span class="token number">0x2E</span><span class="token punctuation">,</span> <span class="token number">0x45</span><span class="token punctuation">,</span> <span class="token number">0x5C</span><span class="token punctuation">,</span>
    <span class="token number">0x73</span><span class="token punctuation">,</span> <span class="token number">0x8A</span><span class="token punctuation">,</span> <span class="token number">0xA1</span><span class="token punctuation">,</span> <span class="token number">0xB8</span><span class="token punctuation">,</span> <span class="token number">0xCF</span><span class="token punctuation">,</span> <span class="token number">0xE6</span><span class="token punctuation">,</span> <span class="token number">0xFD</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0x2B</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span>
    <span class="token number">0x59</span><span class="token punctuation">,</span> <span class="token number">0x70</span><span class="token punctuation">,</span> <span class="token number">0x87</span><span class="token punctuation">,</span> <span class="token number">0x9E</span><span class="token punctuation">,</span> <span class="token number">0xB5</span><span class="token punctuation">,</span> <span class="token number">0xCC</span><span class="token punctuation">,</span> <span class="token number">0xE3</span><span class="token punctuation">,</span> <span class="token number">0xFA</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">,</span>
    <span class="token number">0x3F</span><span class="token punctuation">,</span> <span class="token number">0x56</span><span class="token punctuation">,</span> <span class="token number">0x6D</span><span class="token punctuation">,</span> <span class="token number">0x84</span><span class="token punctuation">,</span> <span class="token number">0x9B</span><span class="token punctuation">,</span> <span class="token number">0xB2</span><span class="token punctuation">,</span> <span class="token number">0xC9</span><span class="token punctuation">,</span> <span class="token number">0xE0</span><span class="token punctuation">,</span> <span class="token number">0xF7</span><span class="token punctuation">,</span> <span class="token number">0x0E</span><span class="token punctuation">,</span>
    <span class="token number">0x25</span><span class="token punctuation">,</span> <span class="token number">0x3C</span><span class="token punctuation">,</span> <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0x6A</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0x98</span><span class="token punctuation">,</span> <span class="token number">0xAF</span><span class="token punctuation">,</span> <span class="token number">0xC6</span><span class="token punctuation">,</span> <span class="token number">0xDD</span><span class="token punctuation">,</span> <span class="token number">0xF4</span><span class="token punctuation">,</span>
    <span class="token number">0x0B</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0x7E</span><span class="token punctuation">,</span> <span class="token number">0x95</span><span class="token punctuation">,</span> <span class="token number">0xAC</span><span class="token punctuation">,</span> <span class="token number">0xC3</span><span class="token punctuation">,</span> <span class="token number">0xDA</span><span class="token punctuation">,</span>
    <span class="token number">0xF1</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x1F</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0x4D</span><span class="token punctuation">,</span> <span class="token number">0x64</span><span class="token punctuation">,</span> <span class="token number">0x7B</span><span class="token punctuation">,</span> <span class="token number">0x92</span><span class="token punctuation">,</span> <span class="token number">0xA9</span><span class="token punctuation">,</span> <span class="token number">0xC0</span><span class="token punctuation">,</span>
    <span class="token number">0xD7</span><span class="token punctuation">,</span> <span class="token number">0xEE</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">0x1C</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x4A</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0x78</span><span class="token punctuation">,</span> <span class="token number">0x8F</span><span class="token punctuation">,</span> <span class="token number">0xA6</span><span class="token punctuation">,</span>
    <span class="token number">0xBD</span><span class="token punctuation">,</span> <span class="token number">0xD4</span><span class="token punctuation">,</span> <span class="token number">0xEB</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0x47</span><span class="token punctuation">,</span> <span class="token number">0x5E</span><span class="token punctuation">,</span> <span class="token number">0x75</span><span class="token punctuation">,</span> <span class="token number">0x8C</span><span class="token punctuation">,</span>
    <span class="token number">0xA3</span><span class="token punctuation">,</span> <span class="token number">0xBA</span><span class="token punctuation">,</span> <span class="token number">0xD1</span><span class="token punctuation">,</span> <span class="token number">0xE8</span><span class="token punctuation">,</span> <span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0x16</span><span class="token punctuation">,</span> <span class="token number">0x2D</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0x5B</span><span class="token punctuation">,</span> <span class="token number">0x72</span><span class="token punctuation">,</span>
    <span class="token number">0x89</span><span class="token punctuation">,</span> <span class="token number">0xA0</span><span class="token punctuation">,</span> <span class="token number">0xB7</span><span class="token punctuation">,</span> <span class="token number">0xCE</span><span class="token punctuation">,</span> <span class="token number">0xE5</span><span class="token punctuation">,</span> <span class="token number">0xFC</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0x2A</span><span class="token punctuation">,</span> <span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0x58</span><span class="token punctuation">,</span>
    <span class="token number">0x6F</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0x9D</span><span class="token punctuation">,</span> <span class="token number">0xB4</span><span class="token punctuation">,</span> <span class="token number">0xCB</span><span class="token punctuation">,</span> <span class="token number">0xE2</span><span class="token punctuation">,</span> <span class="token number">0xF9</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">,</span> <span class="token number">0x3E</span><span class="token punctuation">,</span>
    <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0x6C</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x9A</span><span class="token punctuation">,</span> <span class="token number">0xB1</span><span class="token punctuation">,</span> <span class="token number">0xC8</span><span class="token punctuation">,</span> <span class="token number">0xDF</span><span class="token punctuation">,</span> <span class="token number">0xF6</span><span class="token punctuation">,</span> <span class="token number">0x0D</span><span class="token punctuation">,</span> <span class="token number">0x24</span><span class="token punctuation">,</span>
    <span class="token number">0x3B</span><span class="token punctuation">,</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x69</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0xAE</span><span class="token punctuation">,</span> <span class="token number">0xC5</span><span class="token punctuation">,</span> <span class="token number">0xDC</span><span class="token punctuation">,</span> <span class="token number">0xF3</span><span class="token punctuation">,</span> <span class="token number">0x0A</span><span class="token punctuation">,</span>
    <span class="token number">0x21</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0x4F</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x7D</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0xAB</span><span class="token punctuation">,</span> <span class="token number">0xC2</span><span class="token punctuation">,</span> <span class="token number">0xD9</span><span class="token punctuation">,</span> <span class="token number">0xF0</span><span class="token punctuation">,</span>
    <span class="token number">0x07</span><span class="token punctuation">,</span> <span class="token number">0x1E</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x4C</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0x7A</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0xA8</span><span class="token punctuation">,</span> <span class="token number">0xBF</span><span class="token punctuation">,</span> <span class="token number">0xD6</span><span class="token punctuation">,</span>
    <span class="token number">0xED</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0x1B</span><span class="token punctuation">,</span> <span class="token number">0x32</span><span class="token punctuation">,</span> <span class="token number">0x49</span><span class="token punctuation">,</span> <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">0x77</span><span class="token punctuation">,</span> <span class="token number">0x8E</span><span class="token punctuation">,</span> <span class="token number">0xA5</span><span class="token punctuation">,</span> <span class="token number">0xBC</span><span class="token punctuation">,</span>
    <span class="token number">0xD3</span><span class="token punctuation">,</span> <span class="token number">0xEA</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x18</span><span class="token punctuation">,</span> <span class="token number">0x2F</span><span class="token punctuation">,</span> <span class="token number">0x46</span><span class="token punctuation">,</span> <span class="token number">0x5D</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0x8B</span><span class="token punctuation">,</span> <span class="token number">0xA2</span><span class="token punctuation">,</span>
    <span class="token number">0xB9</span><span class="token punctuation">,</span> <span class="token number">0xD0</span><span class="token punctuation">,</span> <span class="token number">0xE7</span><span class="token punctuation">,</span> <span class="token number">0xFE</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span> <span class="token number">0x2C</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x5A</span><span class="token punctuation">,</span> <span class="token number">0x71</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span>
    <span class="token number">0x9F</span><span class="token punctuation">,</span> <span class="token number">0xB6</span><span class="token punctuation">,</span> <span class="token number">0xCD</span><span class="token punctuation">,</span> <span class="token number">0xE4</span><span class="token punctuation">,</span> <span class="token number">0xFB</span><span class="token punctuation">,</span> <span class="token number">0x12</span>
<span class="token punctuation">]</span>
new_contrary_sbox <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">256</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    line <span class="token operator">=</span> <span class="token punctuation">(</span>new_s_box<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xf0</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">4</span>
    rol <span class="token operator">=</span> new_s_box<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xf</span>
    new_contrary_sbox<span class="token punctuation">[</span><span class="token punctuation">(</span>line <span class="token operator">*</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">+</span> rol<span class="token punctuation">]</span> <span class="token operator">=</span> i

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>new_contrary_sbox<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">16</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"0x%02X"</span><span class="token operator">%</span>new_contrary_sbox<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">","</span><span class="token punctuation">)</span></code></pre></div>
<p>正直上記の処理で生成される S2 の配列の用途については全く理解に至っていないですが、恐らく AES 復号の典型なのだと思うので後日改めて勉強します。</p>
<p>この SBox と、Key として受け渡しているユーザ名+123456の文字列、そしてハードコードされた暗号化バイト列の 3 つを利用して、以下の Solver を実行しました。</p>
<div class="gatsby-highlight" data-language="c"><pre class="language-c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>


<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> S<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> 
<span class="token number">0x29</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span><span class="token number">0x57</span><span class="token punctuation">,</span><span class="token number">0x6e</span><span class="token punctuation">,</span><span class="token number">0x85</span><span class="token punctuation">,</span><span class="token number">0x9c</span><span class="token punctuation">,</span><span class="token number">0xb3</span><span class="token punctuation">,</span><span class="token number">0xca</span><span class="token punctuation">,</span>
<span class="token number">0xe1</span><span class="token punctuation">,</span><span class="token number">0xf8</span><span class="token punctuation">,</span><span class="token number">0x0f</span><span class="token punctuation">,</span><span class="token number">0x26</span><span class="token punctuation">,</span><span class="token number">0x3d</span><span class="token punctuation">,</span><span class="token number">0x54</span><span class="token punctuation">,</span><span class="token number">0x6b</span><span class="token punctuation">,</span><span class="token number">0x82</span><span class="token punctuation">,</span>
<span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0xb0</span><span class="token punctuation">,</span><span class="token number">0xc7</span><span class="token punctuation">,</span><span class="token number">0xde</span><span class="token punctuation">,</span><span class="token number">0xf5</span><span class="token punctuation">,</span><span class="token number">0x0c</span><span class="token punctuation">,</span><span class="token number">0x23</span><span class="token punctuation">,</span><span class="token number">0x3a</span><span class="token punctuation">,</span>
<span class="token number">0x51</span><span class="token punctuation">,</span><span class="token number">0x68</span><span class="token punctuation">,</span><span class="token number">0x7f</span><span class="token punctuation">,</span><span class="token number">0x96</span><span class="token punctuation">,</span><span class="token number">0xad</span><span class="token punctuation">,</span><span class="token number">0xc4</span><span class="token punctuation">,</span><span class="token number">0xdb</span><span class="token punctuation">,</span><span class="token number">0xf2</span><span class="token punctuation">,</span>
<span class="token number">0x09</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token number">0x37</span><span class="token punctuation">,</span><span class="token number">0x4e</span><span class="token punctuation">,</span><span class="token number">0x65</span><span class="token punctuation">,</span><span class="token number">0x7c</span><span class="token punctuation">,</span><span class="token number">0x93</span><span class="token punctuation">,</span><span class="token number">0xaa</span><span class="token punctuation">,</span>
<span class="token number">0xc1</span><span class="token punctuation">,</span><span class="token number">0xd8</span><span class="token punctuation">,</span><span class="token number">0xef</span><span class="token punctuation">,</span><span class="token number">0x06</span><span class="token punctuation">,</span><span class="token number">0x1d</span><span class="token punctuation">,</span><span class="token number">0x34</span><span class="token punctuation">,</span><span class="token number">0x4b</span><span class="token punctuation">,</span><span class="token number">0x62</span><span class="token punctuation">,</span>
<span class="token number">0x79</span><span class="token punctuation">,</span><span class="token number">0x90</span><span class="token punctuation">,</span><span class="token number">0xa7</span><span class="token punctuation">,</span><span class="token number">0xbe</span><span class="token punctuation">,</span><span class="token number">0xd5</span><span class="token punctuation">,</span><span class="token number">0xec</span><span class="token punctuation">,</span><span class="token number">0x03</span><span class="token punctuation">,</span><span class="token number">0x1a</span><span class="token punctuation">,</span>
<span class="token number">0x31</span><span class="token punctuation">,</span><span class="token number">0x48</span><span class="token punctuation">,</span><span class="token number">0x5f</span><span class="token punctuation">,</span><span class="token number">0x76</span><span class="token punctuation">,</span><span class="token number">0x8d</span><span class="token punctuation">,</span><span class="token number">0xa4</span><span class="token punctuation">,</span><span class="token number">0xbb</span><span class="token punctuation">,</span><span class="token number">0xd2</span><span class="token punctuation">,</span>
<span class="token number">0xe9</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x17</span><span class="token punctuation">,</span><span class="token number">0x2e</span><span class="token punctuation">,</span><span class="token number">0x45</span><span class="token punctuation">,</span><span class="token number">0x5c</span><span class="token punctuation">,</span><span class="token number">0x73</span><span class="token punctuation">,</span><span class="token number">0x8a</span><span class="token punctuation">,</span>
<span class="token number">0xa1</span><span class="token punctuation">,</span><span class="token number">0xb8</span><span class="token punctuation">,</span><span class="token number">0xcf</span><span class="token punctuation">,</span><span class="token number">0xe6</span><span class="token punctuation">,</span><span class="token number">0xfd</span><span class="token punctuation">,</span><span class="token number">0x14</span><span class="token punctuation">,</span><span class="token number">0x2b</span><span class="token punctuation">,</span><span class="token number">0x42</span><span class="token punctuation">,</span>
<span class="token number">0x59</span><span class="token punctuation">,</span><span class="token number">0x70</span><span class="token punctuation">,</span><span class="token number">0x87</span><span class="token punctuation">,</span><span class="token number">0x9e</span><span class="token punctuation">,</span><span class="token number">0xb5</span><span class="token punctuation">,</span><span class="token number">0xcc</span><span class="token punctuation">,</span><span class="token number">0xe3</span><span class="token punctuation">,</span><span class="token number">0xfa</span><span class="token punctuation">,</span>
<span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0x28</span><span class="token punctuation">,</span><span class="token number">0x3f</span><span class="token punctuation">,</span><span class="token number">0x56</span><span class="token punctuation">,</span><span class="token number">0x6d</span><span class="token punctuation">,</span><span class="token number">0x84</span><span class="token punctuation">,</span><span class="token number">0x9b</span><span class="token punctuation">,</span><span class="token number">0xb2</span><span class="token punctuation">,</span>
<span class="token number">0xc9</span><span class="token punctuation">,</span><span class="token number">0xe0</span><span class="token punctuation">,</span><span class="token number">0xf7</span><span class="token punctuation">,</span><span class="token number">0x0e</span><span class="token punctuation">,</span><span class="token number">0x25</span><span class="token punctuation">,</span><span class="token number">0x3c</span><span class="token punctuation">,</span><span class="token number">0x53</span><span class="token punctuation">,</span><span class="token number">0x6a</span><span class="token punctuation">,</span>
<span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0x98</span><span class="token punctuation">,</span><span class="token number">0xaf</span><span class="token punctuation">,</span><span class="token number">0xc6</span><span class="token punctuation">,</span><span class="token number">0xdd</span><span class="token punctuation">,</span><span class="token number">0xf4</span><span class="token punctuation">,</span><span class="token number">0x0b</span><span class="token punctuation">,</span><span class="token number">0x22</span><span class="token punctuation">,</span>
<span class="token number">0x39</span><span class="token punctuation">,</span><span class="token number">0x50</span><span class="token punctuation">,</span><span class="token number">0x67</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token number">0x95</span><span class="token punctuation">,</span><span class="token number">0xac</span><span class="token punctuation">,</span><span class="token number">0xc3</span><span class="token punctuation">,</span><span class="token number">0xda</span><span class="token punctuation">,</span>
<span class="token number">0xf1</span><span class="token punctuation">,</span><span class="token number">0x08</span><span class="token punctuation">,</span><span class="token number">0x1f</span><span class="token punctuation">,</span><span class="token number">0x36</span><span class="token punctuation">,</span><span class="token number">0x4d</span><span class="token punctuation">,</span><span class="token number">0x64</span><span class="token punctuation">,</span><span class="token number">0x7b</span><span class="token punctuation">,</span><span class="token number">0x92</span><span class="token punctuation">,</span>
<span class="token number">0xa9</span><span class="token punctuation">,</span><span class="token number">0xc0</span><span class="token punctuation">,</span><span class="token number">0xd7</span><span class="token punctuation">,</span><span class="token number">0xee</span><span class="token punctuation">,</span><span class="token number">0x05</span><span class="token punctuation">,</span><span class="token number">0x1c</span><span class="token punctuation">,</span><span class="token number">0x33</span><span class="token punctuation">,</span><span class="token number">0x4a</span><span class="token punctuation">,</span>
<span class="token number">0x61</span><span class="token punctuation">,</span><span class="token number">0x78</span><span class="token punctuation">,</span><span class="token number">0x8f</span><span class="token punctuation">,</span><span class="token number">0xa6</span><span class="token punctuation">,</span><span class="token number">0xbd</span><span class="token punctuation">,</span><span class="token number">0xd4</span><span class="token punctuation">,</span><span class="token number">0xeb</span><span class="token punctuation">,</span><span class="token number">0x02</span><span class="token punctuation">,</span>
<span class="token number">0x19</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x47</span><span class="token punctuation">,</span><span class="token number">0x5e</span><span class="token punctuation">,</span><span class="token number">0x75</span><span class="token punctuation">,</span><span class="token number">0x8c</span><span class="token punctuation">,</span><span class="token number">0xa3</span><span class="token punctuation">,</span><span class="token number">0xba</span><span class="token punctuation">,</span>
<span class="token number">0xd1</span><span class="token punctuation">,</span><span class="token number">0xe8</span><span class="token punctuation">,</span><span class="token number">0xff</span><span class="token punctuation">,</span><span class="token number">0x16</span><span class="token punctuation">,</span><span class="token number">0x2d</span><span class="token punctuation">,</span><span class="token number">0x44</span><span class="token punctuation">,</span><span class="token number">0x5b</span><span class="token punctuation">,</span><span class="token number">0x72</span><span class="token punctuation">,</span>
<span class="token number">0x89</span><span class="token punctuation">,</span><span class="token number">0xa0</span><span class="token punctuation">,</span><span class="token number">0xb7</span><span class="token punctuation">,</span><span class="token number">0xce</span><span class="token punctuation">,</span><span class="token number">0xe5</span><span class="token punctuation">,</span><span class="token number">0xfc</span><span class="token punctuation">,</span><span class="token number">0x13</span><span class="token punctuation">,</span><span class="token number">0x2a</span><span class="token punctuation">,</span>
<span class="token number">0x41</span><span class="token punctuation">,</span><span class="token number">0x58</span><span class="token punctuation">,</span><span class="token number">0x6f</span><span class="token punctuation">,</span><span class="token number">0x86</span><span class="token punctuation">,</span><span class="token number">0x9d</span><span class="token punctuation">,</span><span class="token number">0xb4</span><span class="token punctuation">,</span><span class="token number">0xcb</span><span class="token punctuation">,</span><span class="token number">0xe2</span><span class="token punctuation">,</span>
<span class="token number">0xf9</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x27</span><span class="token punctuation">,</span><span class="token number">0x3e</span><span class="token punctuation">,</span><span class="token number">0x55</span><span class="token punctuation">,</span><span class="token number">0x6c</span><span class="token punctuation">,</span><span class="token number">0x83</span><span class="token punctuation">,</span><span class="token number">0x9a</span><span class="token punctuation">,</span>
<span class="token number">0xb1</span><span class="token punctuation">,</span><span class="token number">0xc8</span><span class="token punctuation">,</span><span class="token number">0xdf</span><span class="token punctuation">,</span><span class="token number">0xf6</span><span class="token punctuation">,</span><span class="token number">0x0d</span><span class="token punctuation">,</span><span class="token number">0x24</span><span class="token punctuation">,</span><span class="token number">0x3b</span><span class="token punctuation">,</span><span class="token number">0x52</span><span class="token punctuation">,</span>
<span class="token number">0x69</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0x97</span><span class="token punctuation">,</span><span class="token number">0xae</span><span class="token punctuation">,</span><span class="token number">0xc5</span><span class="token punctuation">,</span><span class="token number">0xdc</span><span class="token punctuation">,</span><span class="token number">0xf3</span><span class="token punctuation">,</span><span class="token number">0x0a</span><span class="token punctuation">,</span>
<span class="token number">0x21</span><span class="token punctuation">,</span><span class="token number">0x38</span><span class="token punctuation">,</span><span class="token number">0x4f</span><span class="token punctuation">,</span><span class="token number">0x66</span><span class="token punctuation">,</span><span class="token number">0x7d</span><span class="token punctuation">,</span><span class="token number">0x94</span><span class="token punctuation">,</span><span class="token number">0xab</span><span class="token punctuation">,</span><span class="token number">0xc2</span><span class="token punctuation">,</span>
<span class="token number">0xd9</span><span class="token punctuation">,</span><span class="token number">0xf0</span><span class="token punctuation">,</span><span class="token number">0x07</span><span class="token punctuation">,</span><span class="token number">0x1e</span><span class="token punctuation">,</span><span class="token number">0x35</span><span class="token punctuation">,</span><span class="token number">0x4c</span><span class="token punctuation">,</span><span class="token number">0x63</span><span class="token punctuation">,</span><span class="token number">0x7a</span><span class="token punctuation">,</span>
<span class="token number">0x91</span><span class="token punctuation">,</span><span class="token number">0xa8</span><span class="token punctuation">,</span><span class="token number">0xbf</span><span class="token punctuation">,</span><span class="token number">0xd6</span><span class="token punctuation">,</span><span class="token number">0xed</span><span class="token punctuation">,</span><span class="token number">0x04</span><span class="token punctuation">,</span><span class="token number">0x1b</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">,</span>
<span class="token number">0x49</span><span class="token punctuation">,</span><span class="token number">0x60</span><span class="token punctuation">,</span><span class="token number">0x77</span><span class="token punctuation">,</span><span class="token number">0x8e</span><span class="token punctuation">,</span><span class="token number">0xa5</span><span class="token punctuation">,</span><span class="token number">0xbc</span><span class="token punctuation">,</span><span class="token number">0xd3</span><span class="token punctuation">,</span><span class="token number">0xea</span><span class="token punctuation">,</span>
<span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token number">0x2f</span><span class="token punctuation">,</span><span class="token number">0x46</span><span class="token punctuation">,</span><span class="token number">0x5d</span><span class="token punctuation">,</span><span class="token number">0x74</span><span class="token punctuation">,</span><span class="token number">0x8b</span><span class="token punctuation">,</span><span class="token number">0xa2</span><span class="token punctuation">,</span>
<span class="token number">0xb9</span><span class="token punctuation">,</span><span class="token number">0xd0</span><span class="token punctuation">,</span><span class="token number">0xe7</span><span class="token punctuation">,</span><span class="token number">0xfe</span><span class="token punctuation">,</span><span class="token number">0x15</span><span class="token punctuation">,</span><span class="token number">0x2c</span><span class="token punctuation">,</span><span class="token number">0x43</span><span class="token punctuation">,</span><span class="token number">0x5a</span><span class="token punctuation">,</span>
<span class="token number">0x71</span><span class="token punctuation">,</span><span class="token number">0x88</span><span class="token punctuation">,</span><span class="token number">0x9f</span><span class="token punctuation">,</span><span class="token number">0xb6</span><span class="token punctuation">,</span><span class="token number">0xcd</span><span class="token punctuation">,</span><span class="token number">0xe4</span><span class="token punctuation">,</span><span class="token number">0xfb</span><span class="token punctuation">,</span><span class="token number">0x12</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> S2<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
<span class="token number">0x41</span><span class="token punctuation">,</span><span class="token number">0xE8</span><span class="token punctuation">,</span><span class="token number">0x8F</span><span class="token punctuation">,</span><span class="token number">0x36</span><span class="token punctuation">,</span><span class="token number">0xDD</span><span class="token punctuation">,</span><span class="token number">0x84</span><span class="token punctuation">,</span><span class="token number">0x2B</span><span class="token punctuation">,</span><span class="token number">0xD2</span><span class="token punctuation">,</span>
<span class="token number">0x79</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token number">0xC7</span><span class="token punctuation">,</span><span class="token number">0x6E</span><span class="token punctuation">,</span><span class="token number">0x15</span><span class="token punctuation">,</span><span class="token number">0xBC</span><span class="token punctuation">,</span><span class="token number">0x63</span><span class="token punctuation">,</span><span class="token number">0x0A</span><span class="token punctuation">,</span>
<span class="token number">0xB1</span><span class="token punctuation">,</span><span class="token number">0x58</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xA6</span><span class="token punctuation">,</span><span class="token number">0x4D</span><span class="token punctuation">,</span><span class="token number">0xF4</span><span class="token punctuation">,</span><span class="token number">0x9B</span><span class="token punctuation">,</span><span class="token number">0x42</span><span class="token punctuation">,</span>
<span class="token number">0xE9</span><span class="token punctuation">,</span><span class="token number">0x90</span><span class="token punctuation">,</span><span class="token number">0x37</span><span class="token punctuation">,</span><span class="token number">0xDE</span><span class="token punctuation">,</span><span class="token number">0x85</span><span class="token punctuation">,</span><span class="token number">0x2C</span><span class="token punctuation">,</span><span class="token number">0xD3</span><span class="token punctuation">,</span><span class="token number">0x7A</span><span class="token punctuation">,</span>
<span class="token number">0x21</span><span class="token punctuation">,</span><span class="token number">0xC8</span><span class="token punctuation">,</span><span class="token number">0x6F</span><span class="token punctuation">,</span><span class="token number">0x16</span><span class="token punctuation">,</span><span class="token number">0xBD</span><span class="token punctuation">,</span><span class="token number">0x64</span><span class="token punctuation">,</span><span class="token number">0x0B</span><span class="token punctuation">,</span><span class="token number">0xB2</span><span class="token punctuation">,</span>
<span class="token number">0x59</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0xA7</span><span class="token punctuation">,</span><span class="token number">0x4E</span><span class="token punctuation">,</span><span class="token number">0xF5</span><span class="token punctuation">,</span><span class="token number">0x9C</span><span class="token punctuation">,</span><span class="token number">0x43</span><span class="token punctuation">,</span><span class="token number">0xEA</span><span class="token punctuation">,</span>
<span class="token number">0x91</span><span class="token punctuation">,</span><span class="token number">0x38</span><span class="token punctuation">,</span><span class="token number">0xDF</span><span class="token punctuation">,</span><span class="token number">0x86</span><span class="token punctuation">,</span><span class="token number">0x2D</span><span class="token punctuation">,</span><span class="token number">0xD4</span><span class="token punctuation">,</span><span class="token number">0x7B</span><span class="token punctuation">,</span><span class="token number">0x22</span><span class="token punctuation">,</span>
<span class="token number">0xC9</span><span class="token punctuation">,</span><span class="token number">0x70</span><span class="token punctuation">,</span><span class="token number">0x17</span><span class="token punctuation">,</span><span class="token number">0xBE</span><span class="token punctuation">,</span><span class="token number">0x65</span><span class="token punctuation">,</span><span class="token number">0x0C</span><span class="token punctuation">,</span><span class="token number">0xB3</span><span class="token punctuation">,</span><span class="token number">0x5A</span><span class="token punctuation">,</span>
<span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0xA8</span><span class="token punctuation">,</span><span class="token number">0x4F</span><span class="token punctuation">,</span><span class="token number">0xF6</span><span class="token punctuation">,</span><span class="token number">0x9D</span><span class="token punctuation">,</span><span class="token number">0x44</span><span class="token punctuation">,</span><span class="token number">0xEB</span><span class="token punctuation">,</span><span class="token number">0x92</span><span class="token punctuation">,</span>
<span class="token number">0x39</span><span class="token punctuation">,</span><span class="token number">0xE0</span><span class="token punctuation">,</span><span class="token number">0x87</span><span class="token punctuation">,</span><span class="token number">0x2E</span><span class="token punctuation">,</span><span class="token number">0xD5</span><span class="token punctuation">,</span><span class="token number">0x7C</span><span class="token punctuation">,</span><span class="token number">0x23</span><span class="token punctuation">,</span><span class="token number">0xCA</span><span class="token punctuation">,</span>
<span class="token number">0x71</span><span class="token punctuation">,</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token number">0xBF</span><span class="token punctuation">,</span><span class="token number">0x66</span><span class="token punctuation">,</span><span class="token number">0x0D</span><span class="token punctuation">,</span><span class="token number">0xB4</span><span class="token punctuation">,</span><span class="token number">0x5B</span><span class="token punctuation">,</span><span class="token number">0x02</span><span class="token punctuation">,</span>
<span class="token number">0xA9</span><span class="token punctuation">,</span><span class="token number">0x50</span><span class="token punctuation">,</span><span class="token number">0xF7</span><span class="token punctuation">,</span><span class="token number">0x9E</span><span class="token punctuation">,</span><span class="token number">0x45</span><span class="token punctuation">,</span><span class="token number">0xEC</span><span class="token punctuation">,</span><span class="token number">0x93</span><span class="token punctuation">,</span><span class="token number">0x3A</span><span class="token punctuation">,</span>
<span class="token number">0xE1</span><span class="token punctuation">,</span><span class="token number">0x88</span><span class="token punctuation">,</span><span class="token number">0x2F</span><span class="token punctuation">,</span><span class="token number">0xD6</span><span class="token punctuation">,</span><span class="token number">0x7D</span><span class="token punctuation">,</span><span class="token number">0x24</span><span class="token punctuation">,</span><span class="token number">0xCB</span><span class="token punctuation">,</span><span class="token number">0x72</span><span class="token punctuation">,</span>
<span class="token number">0x19</span><span class="token punctuation">,</span><span class="token number">0xC0</span><span class="token punctuation">,</span><span class="token number">0x67</span><span class="token punctuation">,</span><span class="token number">0x0E</span><span class="token punctuation">,</span><span class="token number">0xB5</span><span class="token punctuation">,</span><span class="token number">0x5C</span><span class="token punctuation">,</span><span class="token number">0x03</span><span class="token punctuation">,</span><span class="token number">0xAA</span><span class="token punctuation">,</span>
<span class="token number">0x51</span><span class="token punctuation">,</span><span class="token number">0xF8</span><span class="token punctuation">,</span><span class="token number">0x9F</span><span class="token punctuation">,</span><span class="token number">0x46</span><span class="token punctuation">,</span><span class="token number">0xED</span><span class="token punctuation">,</span><span class="token number">0x94</span><span class="token punctuation">,</span><span class="token number">0x3B</span><span class="token punctuation">,</span><span class="token number">0xE2</span><span class="token punctuation">,</span>
<span class="token number">0x89</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0xD7</span><span class="token punctuation">,</span><span class="token number">0x7E</span><span class="token punctuation">,</span><span class="token number">0x25</span><span class="token punctuation">,</span><span class="token number">0xCC</span><span class="token punctuation">,</span><span class="token number">0x73</span><span class="token punctuation">,</span><span class="token number">0x1A</span><span class="token punctuation">,</span>
<span class="token number">0xC1</span><span class="token punctuation">,</span><span class="token number">0x68</span><span class="token punctuation">,</span><span class="token number">0x0F</span><span class="token punctuation">,</span><span class="token number">0xB6</span><span class="token punctuation">,</span><span class="token number">0x5D</span><span class="token punctuation">,</span><span class="token number">0x04</span><span class="token punctuation">,</span><span class="token number">0xAB</span><span class="token punctuation">,</span><span class="token number">0x52</span><span class="token punctuation">,</span>
<span class="token number">0xF9</span><span class="token punctuation">,</span><span class="token number">0xA0</span><span class="token punctuation">,</span><span class="token number">0x47</span><span class="token punctuation">,</span><span class="token number">0xEE</span><span class="token punctuation">,</span><span class="token number">0x95</span><span class="token punctuation">,</span><span class="token number">0x3C</span><span class="token punctuation">,</span><span class="token number">0xE3</span><span class="token punctuation">,</span><span class="token number">0x8A</span><span class="token punctuation">,</span>
<span class="token number">0x31</span><span class="token punctuation">,</span><span class="token number">0xD8</span><span class="token punctuation">,</span><span class="token number">0x7F</span><span class="token punctuation">,</span><span class="token number">0x26</span><span class="token punctuation">,</span><span class="token number">0xCD</span><span class="token punctuation">,</span><span class="token number">0x74</span><span class="token punctuation">,</span><span class="token number">0x1B</span><span class="token punctuation">,</span><span class="token number">0xC2</span><span class="token punctuation">,</span>
<span class="token number">0x69</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0xB7</span><span class="token punctuation">,</span><span class="token number">0x5E</span><span class="token punctuation">,</span><span class="token number">0x05</span><span class="token punctuation">,</span><span class="token number">0xAC</span><span class="token punctuation">,</span><span class="token number">0x53</span><span class="token punctuation">,</span><span class="token number">0xFA</span><span class="token punctuation">,</span>
<span class="token number">0xA1</span><span class="token punctuation">,</span><span class="token number">0x48</span><span class="token punctuation">,</span><span class="token number">0xEF</span><span class="token punctuation">,</span><span class="token number">0x96</span><span class="token punctuation">,</span><span class="token number">0x3D</span><span class="token punctuation">,</span><span class="token number">0xE4</span><span class="token punctuation">,</span><span class="token number">0x8B</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">,</span>
<span class="token number">0xD9</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0x27</span><span class="token punctuation">,</span><span class="token number">0xCE</span><span class="token punctuation">,</span><span class="token number">0x75</span><span class="token punctuation">,</span><span class="token number">0x1C</span><span class="token punctuation">,</span><span class="token number">0xC3</span><span class="token punctuation">,</span><span class="token number">0x6A</span><span class="token punctuation">,</span>
<span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0xB8</span><span class="token punctuation">,</span><span class="token number">0x5F</span><span class="token punctuation">,</span><span class="token number">0x06</span><span class="token punctuation">,</span><span class="token number">0xAD</span><span class="token punctuation">,</span><span class="token number">0x54</span><span class="token punctuation">,</span><span class="token number">0xFB</span><span class="token punctuation">,</span><span class="token number">0xA2</span><span class="token punctuation">,</span>
<span class="token number">0x49</span><span class="token punctuation">,</span><span class="token number">0xF0</span><span class="token punctuation">,</span><span class="token number">0x97</span><span class="token punctuation">,</span><span class="token number">0x3E</span><span class="token punctuation">,</span><span class="token number">0xE5</span><span class="token punctuation">,</span><span class="token number">0x8C</span><span class="token punctuation">,</span><span class="token number">0x33</span><span class="token punctuation">,</span><span class="token number">0xDA</span><span class="token punctuation">,</span>
<span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0x28</span><span class="token punctuation">,</span><span class="token number">0xCF</span><span class="token punctuation">,</span><span class="token number">0x76</span><span class="token punctuation">,</span><span class="token number">0x1D</span><span class="token punctuation">,</span><span class="token number">0xC4</span><span class="token punctuation">,</span><span class="token number">0x6B</span><span class="token punctuation">,</span><span class="token number">0x12</span><span class="token punctuation">,</span>
<span class="token number">0xB9</span><span class="token punctuation">,</span><span class="token number">0x60</span><span class="token punctuation">,</span><span class="token number">0x07</span><span class="token punctuation">,</span><span class="token number">0xAE</span><span class="token punctuation">,</span><span class="token number">0x55</span><span class="token punctuation">,</span><span class="token number">0xFC</span><span class="token punctuation">,</span><span class="token number">0xA3</span><span class="token punctuation">,</span><span class="token number">0x4A</span><span class="token punctuation">,</span>
<span class="token number">0xF1</span><span class="token punctuation">,</span><span class="token number">0x98</span><span class="token punctuation">,</span><span class="token number">0x3F</span><span class="token punctuation">,</span><span class="token number">0xE6</span><span class="token punctuation">,</span><span class="token number">0x8D</span><span class="token punctuation">,</span><span class="token number">0x34</span><span class="token punctuation">,</span><span class="token number">0xDB</span><span class="token punctuation">,</span><span class="token number">0x82</span><span class="token punctuation">,</span>
<span class="token number">0x29</span><span class="token punctuation">,</span><span class="token number">0xD0</span><span class="token punctuation">,</span><span class="token number">0x77</span><span class="token punctuation">,</span><span class="token number">0x1E</span><span class="token punctuation">,</span><span class="token number">0xC5</span><span class="token punctuation">,</span><span class="token number">0x6C</span><span class="token punctuation">,</span><span class="token number">0x13</span><span class="token punctuation">,</span><span class="token number">0xBA</span><span class="token punctuation">,</span>
<span class="token number">0x61</span><span class="token punctuation">,</span><span class="token number">0x08</span><span class="token punctuation">,</span><span class="token number">0xAF</span><span class="token punctuation">,</span><span class="token number">0x56</span><span class="token punctuation">,</span><span class="token number">0xFD</span><span class="token punctuation">,</span><span class="token number">0xA4</span><span class="token punctuation">,</span><span class="token number">0x4B</span><span class="token punctuation">,</span><span class="token number">0xF2</span><span class="token punctuation">,</span>
<span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span><span class="token number">0xE7</span><span class="token punctuation">,</span><span class="token number">0x8E</span><span class="token punctuation">,</span><span class="token number">0x35</span><span class="token punctuation">,</span><span class="token number">0xDC</span><span class="token punctuation">,</span><span class="token number">0x83</span><span class="token punctuation">,</span><span class="token number">0x2A</span><span class="token punctuation">,</span>
<span class="token number">0xD1</span><span class="token punctuation">,</span><span class="token number">0x78</span><span class="token punctuation">,</span><span class="token number">0x1F</span><span class="token punctuation">,</span><span class="token number">0xC6</span><span class="token punctuation">,</span><span class="token number">0x6D</span><span class="token punctuation">,</span><span class="token number">0x14</span><span class="token punctuation">,</span><span class="token number">0xBB</span><span class="token punctuation">,</span><span class="token number">0x62</span><span class="token punctuation">,</span>
<span class="token number">0x09</span><span class="token punctuation">,</span><span class="token number">0xB0</span><span class="token punctuation">,</span><span class="token number">0x57</span><span class="token punctuation">,</span><span class="token number">0xFE</span><span class="token punctuation">,</span><span class="token number">0xA5</span><span class="token punctuation">,</span><span class="token number">0x4C</span><span class="token punctuation">,</span><span class="token number">0xF3</span><span class="token punctuation">,</span><span class="token number">0x9A</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getLeft4Bit</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> left <span class="token operator">=</span> num <span class="token operator">&amp;</span> <span class="token number">0x000000f0</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> left <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getRight4Bit</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> num <span class="token operator">&amp;</span> <span class="token number">0x0000000f</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getNumFromSBox</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token function">getLeft4Bit</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> col <span class="token operator">=</span> <span class="token function">getRight4Bit</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> S<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getIntFromChar</span><span class="token punctuation">(</span><span class="token keyword">char</span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>c<span class="token punctuation">;</span>
    <span class="token keyword">return</span> result <span class="token operator">&amp;</span> <span class="token number">0x000000ff</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">convertToIntArray</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">,</span> <span class="token keyword">int</span> pa<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            pa<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getIntFromChar</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            k<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getWordFromStr</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> one<span class="token punctuation">,</span> two<span class="token punctuation">,</span> three<span class="token punctuation">,</span> four<span class="token punctuation">;</span>
    one <span class="token operator">=</span> <span class="token function">getIntFromChar</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    one <span class="token operator">=</span> one <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">;</span>
    two <span class="token operator">=</span> <span class="token function">getIntFromChar</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    two <span class="token operator">=</span> two <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span>
    three <span class="token operator">=</span> <span class="token function">getIntFromChar</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    three <span class="token operator">=</span> three <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span>
    four <span class="token operator">=</span> <span class="token function">getIntFromChar</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> one <span class="token operator">|</span> two <span class="token operator">|</span> three <span class="token operator">|</span> four<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">splitIntToArray</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">,</span> <span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> one<span class="token punctuation">,</span> two<span class="token punctuation">,</span> three<span class="token punctuation">;</span>
    one <span class="token operator">=</span> num <span class="token operator">>></span> <span class="token number">24</span><span class="token punctuation">;</span>
    array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> one <span class="token operator">&amp;</span> <span class="token number">0x000000ff</span><span class="token punctuation">;</span>
    two <span class="token operator">=</span> num <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">;</span>
    array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> two <span class="token operator">&amp;</span> <span class="token number">0x000000ff</span><span class="token punctuation">;</span>
    three <span class="token operator">=</span> num <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">;</span>
    array<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> three <span class="token operator">&amp;</span> <span class="token number">0x000000ff</span><span class="token punctuation">;</span>
    array<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> num <span class="token operator">&amp;</span> <span class="token number">0x000000ff</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">leftLoop4int</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> step<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> temp<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
    <span class="token keyword">int</span> index<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

    index <span class="token operator">=</span> step <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> step <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        array<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
        index<span class="token operator">++</span><span class="token punctuation">;</span>
        index <span class="token operator">=</span> index <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">mergeArrayToInt</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> one <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> two <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> three <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> four <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> one <span class="token operator">|</span> two <span class="token operator">|</span> three <span class="token operator">|</span> four<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> Rcon<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0x01000000</span><span class="token punctuation">,</span> <span class="token number">0x02000000</span><span class="token punctuation">,</span>
    <span class="token number">0x04000000</span><span class="token punctuation">,</span> <span class="token number">0x08000000</span><span class="token punctuation">,</span>
    <span class="token number">0x10000000</span><span class="token punctuation">,</span> <span class="token number">0x20000000</span><span class="token punctuation">,</span>
    <span class="token number">0x40000000</span><span class="token punctuation">,</span> <span class="token number">0x80000000</span><span class="token punctuation">,</span>
    <span class="token number">0x1b000000</span><span class="token punctuation">,</span> <span class="token number">0x36000000</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">,</span> <span class="token keyword">int</span> round<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> numArray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
    <span class="token keyword">int</span> result<span class="token punctuation">;</span>
    <span class="token function">splitIntToArray</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> numArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">leftLoop4int</span><span class="token punctuation">(</span>numArray<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        numArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getNumFromSBox</span><span class="token punctuation">(</span>numArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    result <span class="token operator">=</span> <span class="token function">mergeArrayToInt</span><span class="token punctuation">(</span>numArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result <span class="token operator">^</span> Rcon<span class="token punctuation">[</span>round<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">static</span> <span class="token keyword">int</span> w<span class="token punctuation">[</span><span class="token number">44</span><span class="token punctuation">]</span><span class="token punctuation">;</span>


<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">extendKey</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        w<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getWordFromStr</span><span class="token punctuation">(</span>key <span class="token operator">+</span> i <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">44</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            w<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> w<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token function">T</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span>
            j<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            w<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> w<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> w<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>


<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">addRoundKey</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> round<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> warray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token function">splitIntToArray</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>round <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> i<span class="token punctuation">]</span><span class="token punctuation">,</span> warray<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            array<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> warray<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul2</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> result <span class="token operator">=</span> s <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> a7 <span class="token operator">=</span> result <span class="token operator">&amp;</span> <span class="token number">0x00000100</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>a7 <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        result <span class="token operator">=</span> result <span class="token operator">&amp;</span> <span class="token number">0x000000ff</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> result <span class="token operator">^</span> <span class="token number">0x1b</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul3</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">GFMul2</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">^</span> s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul4</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">GFMul2</span><span class="token punctuation">(</span><span class="token function">GFMul2</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul8</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">GFMul2</span><span class="token punctuation">(</span><span class="token function">GFMul4</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul9</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">GFMul8</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">^</span> s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul11</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">GFMul9</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">GFMul2</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul12</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">GFMul8</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">GFMul4</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul13</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">GFMul12</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">^</span> s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul14</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">GFMul12</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">GFMul2</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GFMul</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> result<span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
        result <span class="token operator">=</span> s<span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>
        result <span class="token operator">=</span> <span class="token function">GFMul2</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span>
        result <span class="token operator">=</span> <span class="token function">GFMul3</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0x9</span><span class="token punctuation">)</span>
        result <span class="token operator">=</span> <span class="token function">GFMul9</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0xb</span><span class="token punctuation">)</span><span class="token comment">//11</span>
        result <span class="token operator">=</span> <span class="token function">GFMul11</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0xd</span><span class="token punctuation">)</span><span class="token comment">//13</span>
        result <span class="token operator">=</span> <span class="token function">GFMul13</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0xe</span><span class="token punctuation">)</span><span class="token comment">//14</span>
        result <span class="token operator">=</span> <span class="token function">GFMul14</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">convertArrayToStr</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token operator">*</span>str<span class="token operator">++</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span>array<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getNumFromS1Box</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token function">getLeft4Bit</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> col <span class="token operator">=</span> <span class="token function">getRight4Bit</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> S2<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">deSubBytes</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getNumFromS1Box</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">rightLoop4int</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> step<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> temp<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
    <span class="token keyword">int</span> index<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

    index <span class="token operator">=</span> step <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> step <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">;</span>
    index <span class="token operator">=</span> <span class="token number">3</span> <span class="token operator">-</span> index<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        array<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
        index<span class="token operator">--</span><span class="token punctuation">;</span>
        index <span class="token operator">=</span> index <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">?</span> <span class="token number">3</span> <span class="token operator">:</span> index<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">deShiftRows</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> rowTwo<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rowThree<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rowFour<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        rowTwo<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        rowThree<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        rowFour<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">rightLoop4int</span><span class="token punctuation">(</span>rowTwo<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">rightLoop4int</span><span class="token punctuation">(</span>rowThree<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">rightLoop4int</span><span class="token punctuation">(</span>rowFour<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> rowTwo<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        array<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> rowThree<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        array<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> rowFour<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> deColM<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0xe</span><span class="token punctuation">,</span> <span class="token number">0xb</span><span class="token punctuation">,</span> <span class="token number">0xd</span><span class="token punctuation">,</span> <span class="token number">0x9</span><span class="token punctuation">,</span>
    <span class="token number">0x9</span><span class="token punctuation">,</span> <span class="token number">0xe</span><span class="token punctuation">,</span> <span class="token number">0xb</span><span class="token punctuation">,</span> <span class="token number">0xd</span><span class="token punctuation">,</span>
    <span class="token number">0xd</span><span class="token punctuation">,</span> <span class="token number">0x9</span><span class="token punctuation">,</span> <span class="token number">0xe</span><span class="token punctuation">,</span> <span class="token number">0xb</span><span class="token punctuation">,</span>
    <span class="token number">0xb</span><span class="token punctuation">,</span> <span class="token number">0xd</span><span class="token punctuation">,</span> <span class="token number">0x9</span><span class="token punctuation">,</span> <span class="token number">0xe</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">deMixColumns</span><span class="token punctuation">(</span><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> tempArray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            tempArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">GFMul</span><span class="token punctuation">(</span>deColM<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> tempArray<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">GFMul</span><span class="token punctuation">(</span>deColM<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> tempArray<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
                <span class="token operator">^</span> <span class="token function">GFMul</span><span class="token punctuation">(</span>deColM<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> tempArray<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">GFMul</span><span class="token punctuation">(</span>deColM<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> tempArray<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">addRoundTowArray</span><span class="token punctuation">(</span><span class="token keyword">int</span> aArray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> bArray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            aArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> aArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">^</span> bArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">getArrayFrom4W</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> index<span class="token punctuation">,</span> j<span class="token punctuation">;</span>
    <span class="token keyword">int</span> colOne<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> colTwo<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> colThree<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> colFour<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    index <span class="token operator">=</span> i <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token function">splitIntToArray</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> colOne<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">splitIntToArray</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> colTwo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">splitIntToArray</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>index <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> colThree<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">splitIntToArray</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>index <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> colFour<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        array<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> colOne<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        array<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> colTwo<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        array<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> colThree<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        array<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> colFour<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>


<span class="token keyword">void</span> <span class="token function">deAes</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> c<span class="token punctuation">,</span> <span class="token keyword">int</span> clen<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">int</span> cArray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> keylen<span class="token punctuation">,</span> k<span class="token punctuation">;</span>
    keylen <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>clen <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> clen <span class="token operator">%</span> <span class="token number">16</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Clen: %d\n"</span><span class="token punctuation">,</span> clen<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">extendKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> clen<span class="token punctuation">;</span> k <span class="token operator">+=</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> i<span class="token punctuation">;</span>
        <span class="token keyword">int</span> wArray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token function">convertToIntArray</span><span class="token punctuation">(</span>c <span class="token operator">+</span> k<span class="token punctuation">,</span> cArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addRoundKey</span><span class="token punctuation">(</span>cArray<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">deSubBytes</span><span class="token punctuation">(</span>cArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">deShiftRows</span><span class="token punctuation">(</span>cArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">deMixColumns</span><span class="token punctuation">(</span>cArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">getArrayFrom4W</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> wArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">deMixColumns</span><span class="token punctuation">(</span>wArray<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token function">addRoundTowArray</span><span class="token punctuation">(</span>cArray<span class="token punctuation">,</span> wArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">deSubBytes</span><span class="token punctuation">(</span>cArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">deShiftRows</span><span class="token punctuation">(</span>cArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addRoundKey</span><span class="token punctuation">(</span>cArray<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">convertArrayToStr</span><span class="token punctuation">(</span>cArray<span class="token punctuation">,</span> c <span class="token operator">+</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 暗号化後のバイト列</span>
    <span class="token keyword">char</span> encodebuffer<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0x2B</span><span class="token punctuation">,</span> <span class="token number">0xC8</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x8B</span><span class="token punctuation">,</span> <span class="token number">0x5C</span><span class="token punctuation">,</span> <span class="token number">0xD</span><span class="token punctuation">,</span> <span class="token number">0xA7</span><span class="token punctuation">,</span> <span class="token number">0x9B</span><span class="token punctuation">,</span> <span class="token number">0x2A</span><span class="token punctuation">,</span> <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0x3A</span><span class="token punctuation">,</span> <span class="token number">0xD2</span><span class="token punctuation">,</span> <span class="token number">0x71</span><span class="token punctuation">,</span> <span class="token number">0x71</span><span class="token punctuation">,</span> <span class="token number">0xCA</span><span class="token punctuation">,</span> <span class="token number">0x50</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    
    <span class="token keyword">char</span><span class="token operator">*</span> key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token string">"Re_1s_eaSy123456"</span><span class="token punctuation">;</span>

    <span class="token function">deAes</span><span class="token punctuation">(</span>encodebuffer<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> encodebuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>上記を実行して正しいパスワードを得ることで、以下の通り正しい Flag を取得することに成功しました。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 575px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/7badca019508755957a3ca04d7a83968/59415/image-20230825002938293.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 80.41666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAACHklEQVQ4y52TyW4aQRCGeSUOrEfAcyBiEesAA2MY9uXmXHkBBA+ADDgvwSokHgexb3LC4vyZKkIUHJPEHulTVdd0/13dVa0xmc2QolHI8j1isvwhorEYlGQSpKUxmUxIqoNMJvOLbJbIXsX+RiqVQqlUAmmxoKIoSKfTLBxVs41EIkxM3Zmg2C0SiQSvKxQKZ0Gj0Xgl6PV64XQ64XK54Ha74fP5EAqFIIoi29+hWDwe5wxvCgaDQfj9fgQCAXg8HvYvGb8mHA5zhjcF6YeiJHhM0AZkadFbXOa8eWQqQjqdQliUIPqiKhIiIYnvSZKiP63EkE/Z0WkuBS0Wi9dFkWMyT3I4HLBZBZU7CHeqtdkgCAIsFisE6ye+V8Jut6sxC98jbZLL5c6CBoOBs2u32xiNRuj1emh32uj1e+h0Ouh2uxwj2+30MBgM0O/32RLD4ZBtuVyGTqeDRq/X8/lPpxNWqxXG4zEWiwVmsxn2+z02mw2WyyV2u53qr3kOQf5iscRsOgN9tVoNWq32LJjP53nher1mIfKn0ym22y1bYj6f83+yk8mE563WS+ZwOKBSqVwL0uL3fodn4Osa+I6XPwWPx+O7BV++AfvN2a9Wq2dBKgqVvl6vo9VqodFooNls/pNGo4nWUxNPX5p4fGzg4fPDuSjUh9SkEbVlXj+t/0KkJxjkTqHkNEaTGfJ9HMkUPb3Uh0goanNnczCoyf0AD6okeircBxwAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/7badca019508755957a3ca04d7a83968/8ac56/image-20230825002938293.webp 240w,
/static/7badca019508755957a3ca04d7a83968/d3be9/image-20230825002938293.webp 480w,
/static/7badca019508755957a3ca04d7a83968/039fe/image-20230825002938293.webp 575w"
              sizes="(max-width: 575px) 100vw, 575px"
              type="image/webp"
            />
          <source
            srcset="/static/7badca019508755957a3ca04d7a83968/8ff5a/image-20230825002938293.png 240w,
/static/7badca019508755957a3ca04d7a83968/e85cb/image-20230825002938293.png 480w,
/static/7badca019508755957a3ca04d7a83968/59415/image-20230825002938293.png 575w"
            sizes="(max-width: 575px) 100vw, 575px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/7badca019508755957a3ca04d7a83968/59415/image-20230825002938293.png"
            alt="image-20230825002938293"
            title="image-20230825002938293"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<h2 id="まとめ" style="position:relative;"><a href="#%E3%81%BE%E3%81%A8%E3%82%81" aria-label="まとめ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>まとめ</h2>
<p>これ Easy 問扱いなのまじなんだろうか？？</p>
<p>Crypto も勉強しないとだめですね。。</p></div></div></div><div class="Post-module--post__footer--3WzWU"><div><p class="Meta-module--meta__date--29eD7">Published <!-- -->Aug 25, 2023</p></div><div class="Tags-module--tags--1L_ct"><ul class="Tags-module--tags__list--91FqN"><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/ctf/">CTF</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/rev/">Rev</a></li></ul></div><div class="Author-module--author--2Yefr"><p>リバースエンジニアになりたいCTF Player(Team: 0nePadding)。WinDbgとYARAが好き。OSCP / CISSP / AtCoder 緑 Microsoft Japanに所属してます。発言はすべて個人の見解。<a class="Author-module--author__bio-twitter--n-O9n" href="https://www.twitter.com/kash1064" rel="noopener noreferrer" target="_blank"><strong>かしわば</strong> on Twitter</a></p></div></div><div class="Post-module--post__comments--25y6I"></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/ctf-wmctf-2023";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-299cfcade846097f4d4b.js"],"app":["/app-4527e0a718e3bd88d288.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-fd4fb51a6fac1c18bdde.js"],"component---src-templates-categories-list-template-js":["/component---src-templates-categories-list-template-js-2181ec47d28e5c35d3e9.js"],"component---src-templates-category-template-js":["/component---src-templates-category-template-js-76f2006942127b3c7274.js"],"component---src-templates-index-template-js":["/component---src-templates-index-template-js-70ba56c0f46525baa629.js"],"component---src-templates-not-found-template-js":["/component---src-templates-not-found-template-js-d19905e5c8fc953958f1.js"],"component---src-templates-page-template-js":["/component---src-templates-page-template-js-6ba68ef37e264f701345.js"],"component---src-templates-post-template-js":["/component---src-templates-post-template-js-381c1b847824134fa4bd.js"],"component---src-templates-tag-template-js":["/component---src-templates-tag-template-js-0faa242d92f89b71e668.js"],"component---src-templates-tags-list-template-js":["/component---src-templates-tags-list-template-js-2d7007993fc2bf0f9caf.js"]};/*]]>*/</script><script src="/polyfill-299cfcade846097f4d4b.js" nomodule=""></script><script src="/component---src-templates-post-template-js-381c1b847824134fa4bd.js" async=""></script><script src="/cd95ea5cbd2c605f26db819f07999610c9ff4310-c2f05dc74373de400085.js" async=""></script><script src="/styles-407fe62976dc5310c43e.js" async=""></script><script src="/app-4527e0a718e3bd88d288.js" async=""></script><script src="/dc6a8720040df98778fe970bf6c000a41750d3ae-46fc1da9fa41dea5027d.js" async=""></script><script src="/532a2f07-92db97c0addf07d5cb73.js" async=""></script><script src="/framework-3761df4ab6ee9f056936.js" async=""></script><script src="/webpack-runtime-a3c0f166cb4b802ff58f.js" async=""></script></body></html>