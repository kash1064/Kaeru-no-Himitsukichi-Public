{"componentChunkName":"component---src-templates-post-template-js","path":"/ctf-angstromctf-2023","result":{"data":{"markdownRemark":{"id":"72fdbc35-dfe8-54a6-9c79-5e4c3dbef241","html":"<p>4 月に開催されていた ångstrom CTF 2023 にチーム 0nePadding で参加しました。</p>\n<p>得点は 920 点で、最終順位は 151 位 / 1429 チームでした。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 863px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bd39d9b5770714eaa6151c583c7d45ba/ee455/image-20230429174138393.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.083333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA60lEQVQI1w3O206DMAAAUH5LuZTSlpaNwujKTZ0+LGYXNzZEhiEjZCMzzgejzjd/VpLzAUf5Esl+4HWBbHmQqWClGktVn11pC8OcAfioG3MTPiG06kFrg/AzoS82PcZJJ0PlL558hunPzeTsiQazPWY1tncWrl2/9keVy5uxbGV0kGEzdFvudX5wGonLdHq5f1B+RdpxcR5HbyLcQVIAlAMrM+CW0A1lOXXW0MqglSNS2vSVOfVg2Lj8/fbuI06Vb5H04aMvKsJyHWa6udbA4loruVdHceH5cwMsgdmftwgXNi4prZjTJclJhv84vlRQuKsQtAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/bd39d9b5770714eaa6151c583c7d45ba/8ac56/image-20230429174138393.webp 240w,\n/static/bd39d9b5770714eaa6151c583c7d45ba/d3be9/image-20230429174138393.webp 480w,\n/static/bd39d9b5770714eaa6151c583c7d45ba/8e594/image-20230429174138393.webp 863w\"\n              sizes=\"(max-width: 863px) 100vw, 863px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/bd39d9b5770714eaa6151c583c7d45ba/8ff5a/image-20230429174138393.png 240w,\n/static/bd39d9b5770714eaa6151c583c7d45ba/e85cb/image-20230429174138393.png 480w,\n/static/bd39d9b5770714eaa6151c583c7d45ba/ee455/image-20230429174138393.png 863w\"\n            sizes=\"(max-width: 863px) 100vw, 863px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/bd39d9b5770714eaa6151c583c7d45ba/ee455/image-20230429174138393.png\"\n            alt=\"image-20230429174138393\"\n            title=\"image-20230429174138393\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>今回も Rev 問をいくつか解いたので、簡単に Writeup としてまとめていきます。</p>\n<!-- omit in toc -->\n<h2 id=\"もくじ\" style=\"position:relative;\"><a href=\"#%E3%82%82%E3%81%8F%E3%81%98\" aria-label=\"もくじ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>もくじ</h2>\n<ul>\n<li><a href=\"#zazarev\">zaza(Rev)</a></li>\n<li><a href=\"#bananasrev\">Bananas(Rev)</a></li>\n<li><a href=\"#moonrev\">moon(Rev)</a></li>\n<li><a href=\"#physics-hwmisc\">Physics HW(Misc)</a></li>\n<li><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\">まとめ</a></li>\n</ul>\n<h2 id=\"zazarev\" style=\"position:relative;\"><a href=\"#zazarev\" aria-label=\"zazarev permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>zaza(Rev)</h2>\n<p>Ghidra でデコンパイルすると、以下のようなシンプルなコードを取得できました。</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">int</span> iVar1<span class=\"token punctuation\">;</span>\n  <span class=\"token class-name\">size_t</span> sVar2<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">long</span> in_FS_OFFSET<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">int</span> local_60<span class=\"token punctuation\">;</span>\n  uint local_5c<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">char</span> local_58 <span class=\"token punctuation\">[</span><span class=\"token number\">72</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">long</span> local_10<span class=\"token punctuation\">;</span>\n  \n  local_10 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>in_FS_OFFSET <span class=\"token operator\">+</span> <span class=\"token number\">0x28</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">setbuf</span><span class=\"token punctuation\">(</span><span class=\"token constant\">stdout</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token number\">0x0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  local_60 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  local_5c <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"I\\'m going to sleep. Count me some sheep: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">__isoc99_scanf</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>DAT_00102092<span class=\"token punctuation\">,</span><span class=\"token operator\">&amp;</span>local_60<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>local_60 <span class=\"token operator\">!=</span> <span class=\"token number\">0x1337</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"That\\'s not enough sheep!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token comment\">/* WARNING: Subroutine does not return */</span>\n    <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Nice, now reset it. Bet you can\\'t: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">__isoc99_scanf</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>DAT_00102092<span class=\"token punctuation\">,</span><span class=\"token operator\">&amp;</span>local_5c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>local_5c <span class=\"token operator\">*</span> local_60 <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d %d\"</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span>ulong<span class=\"token punctuation\">)</span>local_5c<span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span>ulong<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>local_60 <span class=\"token operator\">+</span> local_5c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Not good enough for me.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token comment\">/* WARNING: Subroutine does not return */</span>\n    <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Okay, what\\'s the magic word?\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">getchar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>local_58<span class=\"token punctuation\">,</span><span class=\"token number\">0x40</span><span class=\"token punctuation\">,</span><span class=\"token constant\">stdin</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  sVar2 <span class=\"token operator\">=</span> <span class=\"token function\">strcspn</span><span class=\"token punctuation\">(</span>local_58<span class=\"token punctuation\">,</span><span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  local_58<span class=\"token punctuation\">[</span>sVar2<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token char\">'\\0'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">xor_</span><span class=\"token punctuation\">(</span>local_58<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  iVar1 <span class=\"token operator\">=</span> <span class=\"token function\">strncmp</span><span class=\"token punctuation\">(</span>local_58<span class=\"token punctuation\">,</span><span class=\"token string\">\"2&amp; =$!-( &lt;*+*( ?!&amp;$$6,. )\\' $19 , #9=!1 &lt;*=6 &lt;6;66#\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>iVar1 <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Nope\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token comment\">/* WARNING: Subroutine does not return */</span>\n    <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">win</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>local_10 <span class=\"token operator\">!=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>in_FS_OFFSET <span class=\"token operator\">+</span> <span class=\"token number\">0x28</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token comment\">/* WARNING: Subroutine does not return */</span>\n    <span class=\"token function\">__stack_chk_fail</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>以下の箇所に着目しました。</p>\n<p>ユーザ入力を 0x40 バイト分受け取り、<code class=\"language-text\">xor_</code>関数に与え、結果が<code class=\"language-text\">2&amp; =$!-( &lt;*+*( ?!&amp;$$6,. )\\' $19 , #9=!1 &lt;*=6 &lt;6;66#</code>に一致する場合には Flag を表示します。</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Okay, what\\'s the magic word?\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">getchar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>local_58<span class=\"token punctuation\">,</span><span class=\"token number\">0x40</span><span class=\"token punctuation\">,</span><span class=\"token constant\">stdin</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nsVar2 <span class=\"token operator\">=</span> <span class=\"token function\">strcspn</span><span class=\"token punctuation\">(</span>local_58<span class=\"token punctuation\">,</span><span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nlocal_58<span class=\"token punctuation\">[</span>sVar2<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token char\">'\\0'</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">xor_</span><span class=\"token punctuation\">(</span>local_58<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\niVar1 <span class=\"token operator\">=</span> <span class=\"token function\">strncmp</span><span class=\"token punctuation\">(</span>local_58<span class=\"token punctuation\">,</span><span class=\"token string\">\"2&amp; =$!-( &lt;*+*( ?!&amp;$$6,. )\\' $19 , #9=!1 &lt;*=6 &lt;6;66#\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>iVar1 <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Nope\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token comment\">/* WARNING: Subroutine does not return */</span>\n<span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">win</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-text\">xor_</code>関数は以下のような実装になっていました。</p>\n<p>入力値の文字列の長さが<code class=\"language-text\">anextremelycomplicatedkeythatisdefinitelyuselessss</code>と一致するかを調べた後、入力値の各文字と XOR を行っています。</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token keyword\">void</span> <span class=\"token function\">xor_</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> param_1<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token class-name\">size_t</span> sVar1<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">int</span> local_24<span class=\"token punctuation\">;</span>\n  \n  local_24 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span> true <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    sVar1 <span class=\"token operator\">=</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"anextremelycomplicatedkeythatisdefinitelyuselessss\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>sVar1 <span class=\"token operator\">&lt;=</span> <span class=\"token punctuation\">(</span>ulong<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span><span class=\"token punctuation\">)</span>local_24<span class=\"token punctuation\">)</span> <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>byte <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>param_1 <span class=\"token operator\">+</span> local_24<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span>\n         <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>byte <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>param_1 <span class=\"token operator\">+</span> local_24<span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span>\n         <span class=\"token string\">\"anextremelycomplicatedkeythatisdefinitelyuselessss\"</span><span class=\"token punctuation\">[</span>local_24<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    local_24 <span class=\"token operator\">=</span> local_24 <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>というわけで、<code class=\"language-text\">anextremelycomplicatedkeythatisdefinitelyuselessss</code>と<code class=\"language-text\">2&amp; =$!-( &lt;*+*( ?!&amp;$$6,. )\\' $19 , #9=!1 &lt;*=6 &lt;6;66#</code>を XOR してあげると、Flag を取得するために必要なキーが<code class=\"language-text\">SHEEPSHEEPSHEEPSHEEPSHEEP(OAPXJDIFJWTUTLE_NSLYEHEEB</code>であると特定できました。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 813px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/fa70c83954163a18f6488d3bb8368a2d/baaa6/image-20230429175845337.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.583333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA7ElEQVQY001QaW/DIAzl//+xfag0dWt2pLeWkAsMJRwmy5LMpWq3pyfrPWyMDavrJsY43IGI2902z3MppZAihPBIxeGv7GbZW/XC7bkwR2JpTrw/HbqP92LN4cv2FjHS/d6YIcaA6L2n7s45OpymiTWWS99qFOA74avSnFvLTQRwLaV/EsZxfOibpTjPM+tM06hKeyCCb2tTVlDaQUvXKqXoESr9/gca+CHYc/G06VavzepTZDuV7fVmf8lytS70kZccQNGE/g7SmCwNT02ZCh0kKq81wgWlJkbRo07reXeFTfG6akg709cty/ILHZNTCFyUZxcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/fa70c83954163a18f6488d3bb8368a2d/8ac56/image-20230429175845337.webp 240w,\n/static/fa70c83954163a18f6488d3bb8368a2d/d3be9/image-20230429175845337.webp 480w,\n/static/fa70c83954163a18f6488d3bb8368a2d/90602/image-20230429175845337.webp 813w\"\n              sizes=\"(max-width: 813px) 100vw, 813px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/fa70c83954163a18f6488d3bb8368a2d/8ff5a/image-20230429175845337.png 240w,\n/static/fa70c83954163a18f6488d3bb8368a2d/e85cb/image-20230429175845337.png 480w,\n/static/fa70c83954163a18f6488d3bb8368a2d/baaa6/image-20230429175845337.png 813w\"\n            sizes=\"(max-width: 813px) 100vw, 813px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/fa70c83954163a18f6488d3bb8368a2d/baaa6/image-20230429175845337.png\"\n            alt=\"image-20230429175845337\"\n            title=\"image-20230429175845337\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>これを問題サーバに送ることで Flag を取得できました。</p>\n<h2 id=\"bananasrev\" style=\"position:relative;\"><a href=\"#bananasrev\" aria-label=\"bananasrev permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bananas(Rev)</h2>\n<p>問題バイナリとして与えられた<code class=\"language-text\">Elixir.Bananas.beam</code>は、Elixir によって開発されたものであることがわかります。</p>\n<p>デコンパイルには以下のツールを使用しました。</p>\n<p>参考：<a href=\"https://github.com/michalmuskala/decompile\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GitHub - michalmuskala/decompile</a></p>\n<p>ツールを使用するためには、端末に Elixir をインストールして mix コマンドを使用できるようにしておく必要があります。</p>\n<p>デコンパイルには以下の通り複数のオプションを指定できますが、今回は expanded が一番直感的に読める形式で出力してくれたのでこれを使用しました。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">mix decompile ElixirModule --to expanded\nmix decompile ElixirModule --to erlang\nmix decompile ElixirModule --to asm\nmix decompile ElixirModule --to core</code></pre></div>\n<p>出力結果は以下です。</p>\n<div class=\"gatsby-highlight\" data-language=\"elixir\"><pre class=\"language-elixir\"><code class=\"language-elixir\"><span class=\"token keyword\">defmodule</span> <span class=\"token module class-name\">Bananas</span> <span class=\"token keyword\">do</span>\n  <span class=\"token keyword\">defp</span> <span class=\"token function\">to_integer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>num<span class=\"token punctuation\">,</span> string<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span>\n    <span class=\"token punctuation\">[</span><span class=\"token atom symbol\">:erlang</span><span class=\"token punctuation\">.</span><span class=\"token function\">binary_to_integer</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> string<span class=\"token punctuation\">]</span>\n  <span class=\"token keyword\">end</span>\n\n  <span class=\"token keyword\">defp</span> <span class=\"token function\">to_integer</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span>\n    list\n  <span class=\"token keyword\">end</span>\n\n  <span class=\"token keyword\">defp</span> <span class=\"token function\">print_flag</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span>\n    <span class=\"token module class-name\">IO</span><span class=\"token punctuation\">.</span><span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Nope\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">end</span>\n\n  <span class=\"token keyword\">defp</span> <span class=\"token function\">print_flag</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span>\n    <span class=\"token module class-name\">IO</span><span class=\"token punctuation\">.</span><span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token module class-name\">File</span><span class=\"token punctuation\">.</span><span class=\"token function\">read!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"flag.txt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">end</span>\n\n  <span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span>\n    <span class=\"token function\">print_flag</span><span class=\"token punctuation\">(</span><span class=\"token function\">check</span><span class=\"token punctuation\">(</span><span class=\"token function\">convert_input</span><span class=\"token punctuation\">(</span><span class=\"token module class-name\">IO</span><span class=\"token punctuation\">.</span><span class=\"token function\">gets</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"How many bananas do I have?\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">end</span>\n\n  <span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span>\n    <span class=\"token function\">super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">end</span>\n\n  <span class=\"token keyword\">defp</span> <span class=\"token function\">convert_input</span><span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span>\n    <span class=\"token function\">to_integer</span><span class=\"token punctuation\">(</span><span class=\"token module class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token module class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token function\">trim</span><span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">end</span>\n\n  <span class=\"token keyword\">defp</span> <span class=\"token function\">check</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>num<span class=\"token punctuation\">,</span> <span class=\"token string\">\"bananas\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span>\n    <span class=\"token atom symbol\">:erlang</span><span class=\"token punctuation\">.</span><span class=\"token operator\">==</span><span class=\"token punctuation\">(</span><span class=\"token atom symbol\">:erlang</span><span class=\"token punctuation\">.</span><span class=\"token operator\">-</span><span class=\"token punctuation\">(</span><span class=\"token atom symbol\">:erlang</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token atom symbol\">:erlang</span><span class=\"token punctuation\">.</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">971</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">end</span>\n\n  <span class=\"token keyword\">defp</span> <span class=\"token function\">check</span><span class=\"token punctuation\">(</span>_asdf<span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span>\n    <span class=\"token boolean\">false</span>\n  <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span></code></pre></div>\n<p>このコード自体は一部を改変すればそのまま AtCoder などのオンラインサービスで実行できたので、動作確認は非常に簡単でした。</p>\n<p>見てわかる通り、<code class=\"language-text\">数値 banana</code>のフォーマットで入力を行った場合のみ、<code class=\"language-text\">check</code>関数による検証に進みます。</p>\n<p>そして、入力値が<code class=\"language-text\">(数値 + 5) * 9 - 1 = 971</code>の式を満たす値である 103 が正解となります。</p>\n<p>最終的に、<code class=\"language-text\">103 banana</code>を問題サーバに送ることで Flag を取得できました。</p>\n<h2 id=\"moonrev\" style=\"position:relative;\"><a href=\"#moonrev\" aria-label=\"moonrev permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>moon(Rev)</h2>\n<p>問題文を読むと、バイナリへの正しい入力値が Flag になるようです。</p>\n<blockquote>\n<p>To the moon! The correct sequence of inputs is the flag in ASCII.</p>\n</blockquote>\n<p>バイナリを解析すると、func0 から func1292 までの 1293 個の関数が定義されていることがわかります。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 184px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/66616a3dbdc09da9d8188f795a776682/5a64f/image-20230429182044810.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 236.9565217391304%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAvCAIAAABsVn00AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFOUlEQVRIx4VWWY/bVBSeX8IP4MfwC5AQL33ghVKEeAAJEA8UJCSQgCIqlVa0AqmIlmEqZmCmaTLJLIkncTJZvMTxFi/xGideb2JfTpxKTNsZ58pyZOd+9zvLd87xlm3bsmJp7J2T3evtyt9v/66/dpN9/euRaCGMcZrhgrXl+747DTXhX7L6jSHQN/eNa3+o1x5pur9YgQvRW+ufdJnB3kRGk39seMy4DJ9iXMdYy/++4oStLFv9k8TxzPc9hTGYdhDNEivJxCxV0sRLNoNtxxnypjz4rvbnG6XHD5gRs1/Z77Jd280NybIisxeLRZIknmsMBmfRNJx2XT/0YzNOvTQLsiwsBKdpCvgwiBhBjLXYrsyfe17FmMXYudzzi2AUhiEvGrZ2KPRv9xplWZE5gbMca0ANICmv2v8/GCEUR5Giubr0jNj/kCHLqqK1SVJTteFwGARBEXiBUBSFgmwZcql/8hVR3hF4AWCGYYiiCEcX+Yxy8Fh1JnK1XfuSpxqWadM0beRrgRavuv1CwILAF8eOxj08efLWydOdEc91u11N0+Ae+MEGnxFKbHdu690+cddUpYmgM8yK2Z7aKEEY4Sy9Agx5zhOO5j5iRCOdpeZ2niIe4zOMWxgPMJ69kLOXwXCHwI5VfW5zKlXSVWFuziItivTIUR1rYmUX/H4ZDKbPZjOWU02l0qu9e/jkZ5ZlCZJodVrciCNJEkJTAF4zW67RZsh7TBdibpmGCZeqqJPJ5GLYLmOez3nJsJTaeeUGUXoI2W63251Oh+M4SZI2gP3A13THmRA08T15vL8mhKWqqqIosLPIZ5CxIBmmcnJe/aRb39M0HaTCMIwsy6PRqChVecDmnKDZ6jFd/6JeeiyJzxcgKYoqZl4FTNFsSyM61c/Z7hGEChQOSF3XwfKLIruE2ZvN6KFiK1WO+LS6+2DIsv1+fzAYAC2kqihgcIeq1g3XNUGkP42opuu6QAgBsyxrHe0ieU6n0z4tQ2EOah9Udu7SFN1qtYAT+JvNZpHZcI+iyJ36rnnePb3FMySc5TgO8MN4APJCZgTMHjBPpFLv8Pqzx7eBmTgjgBOydXZ2VhTtlc9R7rPRoZp3eJr08gX84DbU9qZoex5E25DL7dI7x3v3h+yw0WgAM8gTsl0sz+d5didNtnWLah8bhrmWJyiM5/kNzFAYI0G3tfrg9LNm5ZEoiFAVvV4PwKDTYjAw+5ICPfTg/PCj5tGBoowhvZIoQXkBOF2mG1JlOb6l1juVj3tEWR5J1IBihoxqqyNpVBTtOI7Xb8IQ9RltGS+dfXf1DLO2g7GCMYNX0zctBCdJLI3HKEBuw4W+lTppBv6qGVYxHoIeNjBHfXqIgsR+upqyKwwQcvn1FGN6AzMaq7nZx3kDBtshx2Z+Clg+vQK8TgaErU9zSZC4tdxnHeOj3GAub+PGZWDArN+shp4koxCZB+aqV5t594fmKWPcxti6QiTLRbxAEZgtyGqGspAKVzus/PuGz8HN3JCXBp3vzylW1fmdTvn9ys49lmEaRGOsj6GYYBJsGu5xpE+m0Dc7R9/KXBdqE6TlTT0opiS+8FmUXTZigbnPqLrwd7v03tHer9Bw6/VTWZYIgoBS28AMwjAsD4TZq/+oSszUnUKXh0qGvrmOyCXfYbCWyyWA53NgVibibrd842j3Pki6VqvxvAA+wxFrjuzCesHsnHkGlcyQv4z5gefNYMhBeV/JPJ/7cME+OBsmS6PJsue/1bbf3Hv4w+lpY3v7L5Js7x8cjMcKCBaGyXr/+voPr+RLYNHPO90AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/66616a3dbdc09da9d8188f795a776682/e26c4/image-20230429182044810.webp 184w\"\n              sizes=\"(max-width: 184px) 100vw, 184px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/66616a3dbdc09da9d8188f795a776682/5a64f/image-20230429182044810.png 184w\"\n            sizes=\"(max-width: 184px) 100vw, 184px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/66616a3dbdc09da9d8188f795a776682/5a64f/image-20230429182044810.png\"\n            alt=\"image-20230429182044810\"\n            title=\"image-20230429182044810\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>各関数はどれも同じフォーマットになっており、データ部に確保されている check という<code class=\"language-text\">8バイト * 1293</code>の領域の先頭から 8 バイトずつに値を足す処理を行っています。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 272px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3680dbbc3c3a70401b1fe822e90156f3/2aae8/image-20230429182346601.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 106.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAIAAADJt1n/AAAACXBIWXMAAAsTAAALEwEAmpwYAAACYElEQVQ4y4WTy5KbMBRE/e3Z54/yEdmkMosxg548hJ5XEhAbyMVgM3alJioWlErN6b5qTuzHd6q/teoXLRdCZsFiXV3LcgTIy7LM8/LFOhnyM42/h8EnWCAufX8Zhhlgulyuy//WyUG6ETbEAZofz33d9/Ftfz9Vsp7n6eWTX7s9yBHAjuO7c01OABi4ts7lGFVKuFmnFOK2acd+VFEX9p05Hvu8i8043M5llAnBjbU5pTbuYue94MwYM/Z/VOwKd658fb1OD/G4nfM+CM61NkPuuxgLlEG0IdRVpZQahtEmRx1pg8KxTtP0JA4BBJdN0wDuxkQByhB0zl2jJBed1kMe9QovmBcppz0zQtqMti0pKUIixJgzA6ABTM6SCSkr42yfB5MM8aUGs0x32+d1YGtmzrhSLazgjGQCoFNC2zgzbUyP5KRZoB+G9ONw2G5uAyuL8i5ebZONLKTgwthdfMaBe9EP/W77QRZMoG3UInm1Dau4lnVdNw9y6T+U1/M0v2R2jNJuJaP2EFeYuJLa2G1gTWpEkNjnJ9vOOUpI+y/bUgpzJ5/dhwJ9vV4/iZFst8zqRSwYF0JieVZx1KUrhavwz3nKfCOjbYWRP4srjr7rh5gHRgOHHI/MaNtjmWTVtu2qvWfGq9JK4W3hwDAz3jP1lGK9N/GR2XtO+UtmbFhT15Wo9sxR00Cka47MzyVRryVZp13tVxU7AbLx6nK5fLKdVzJjtOu2zLttm/saf/q6MtYNaz018eSw3fXDm7EyJax+cT4jBMNDSkXwZ+9VjIwQSqnquj4NCtrSl4UjkOJf3oChQs8HDwUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/3680dbbc3c3a70401b1fe822e90156f3/8ac56/image-20230429182346601.webp 240w,\n/static/3680dbbc3c3a70401b1fe822e90156f3/542bb/image-20230429182346601.webp 272w\"\n              sizes=\"(max-width: 272px) 100vw, 272px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/3680dbbc3c3a70401b1fe822e90156f3/8ff5a/image-20230429182346601.png 240w,\n/static/3680dbbc3c3a70401b1fe822e90156f3/2aae8/image-20230429182346601.png 272w\"\n            sizes=\"(max-width: 272px) 100vw, 272px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/3680dbbc3c3a70401b1fe822e90156f3/2aae8/image-20230429182346601.png\"\n            alt=\"image-20230429182346601\"\n            title=\"image-20230429182346601\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>そして、入力値の検証を行う処理を読むと、<code class=\"language-text\">needed</code>の値と<code class=\"language-text\">check</code>の値が一致するか否かを確認しているようでした。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4a15ee11a63eec32e6029f7ff358ffae/a6d36/image-20230429183003795.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABmElEQVQY01WNa2vbMBiF/f//wQprS262kzh2JNnpksbJWloYg3Y0H+bA2HKvc3MbR7ZsWdI7M9hg8PBw4HA4mhRSCaUEgAIa8+OelQYlpRCyUKWVEFC2ApI8eWcnAKA5LQMXXJstf/5ar1dbfmJ5Kthsc4wzlorzPt5tT/uIRpTHZ5rQNEkVYyrLVJ7KLJWMyUzTp5XGrNNcPTr7u342Npe9fjEaMO8mRDdh38sGvhwN5HAgR34+HorRrRyV9sW4DNrl/OP1ol7Z9PXIs3NcDS0kMcrN2uq6uqgZh4pz1ttHoxVZvbceLjAGhBVCEiFAWm1TrYemeeh3c9cD0tg53QK7EjmZ1c7bXd51FSHCcwuCgRD1H1r9tVaOjcNtM/qEuGfsHKI8wtt4b/XWXofaqEC4QETi8pZI4oLrqj+Aq10sPlwsri7DXu0dtQr7amdaYDdZvbXW0ZY0YkNP9TY3O8I0WKNZtGzodP6i+fOhP7+/f/3xlAQBfH/YPQcw/Uaf/Plnf/nwNf4y4c8vdPKSTAIVTGEaQPCP36jvkB5l1FHtAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4a15ee11a63eec32e6029f7ff358ffae/8ac56/image-20230429183003795.webp 240w,\n/static/4a15ee11a63eec32e6029f7ff358ffae/d3be9/image-20230429183003795.webp 480w,\n/static/4a15ee11a63eec32e6029f7ff358ffae/c1dc5/image-20230429183003795.webp 650w\"\n              sizes=\"(max-width: 650px) 100vw, 650px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4a15ee11a63eec32e6029f7ff358ffae/8ff5a/image-20230429183003795.png 240w,\n/static/4a15ee11a63eec32e6029f7ff358ffae/e85cb/image-20230429183003795.png 480w,\n/static/4a15ee11a63eec32e6029f7ff358ffae/a6d36/image-20230429183003795.png 650w\"\n            sizes=\"(max-width: 650px) 100vw, 650px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4a15ee11a63eec32e6029f7ff358ffae/a6d36/image-20230429183003795.png\"\n            alt=\"image-20230429183003795\"\n            title=\"image-20230429183003795\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>この<code class=\"language-text\">needed</code>も<code class=\"language-text\">check</code>と同じく<code class=\"language-text\">8バイト * 1293</code>の領域ですが、こちらには値がハードコードされています。</p>\n<p>また、入力値については最大で 1293 個の数値を受け付け、各桁の数値の回数だけ関数が呼び出されます。</p>\n<p>(入力値が 123… の場合、func0 が 1 回、func1 が 2 回、func2 が 3 回実行される。)</p>\n<p>そのため、最終的に<code class=\"language-text\">needed</code>と<code class=\"language-text\">check</code>の値が完全に一致するように 1293 個の関数を実行するような入力値を特定する必要があります。</p>\n<p>しかし、ここまで特定したものの、肝心の Solver のアルゴリズムが思いつかず、Flag 取得に至りませんでした。</p>\n<p>冷静に考えてみると、各関数の実行回数を x,y,z… とした場合には 1293 個の変数を持つ多項式が 1293 個作成されるため、連立方程式ですべての値を特定できることがわかります。</p>\n<p>どうしても頭が凝り固まると Solver のアルゴリズムが思いつかないので、もっと柔軟に考えたいですね。</p>\n<p>最終的な Solver は以下を参考にしました。</p>\n<p>参考：<a href=\"https://fazect.github.io/angstrom2023-rev/#moon\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ångstromCTF 2023 - Reverse Engineering Writeups - FazeCT Blogs</a></p>\n<p>まず、pwntools を使って<code class=\"language-text\">needed</code>に埋め込まれている 1293 個の値を取得します。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\ne <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">'./moon'</span><span class=\"token punctuation\">,</span>checksec<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n\nneeded <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1293</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    data <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>sym<span class=\"token punctuation\">[</span><span class=\"token string\">'needed'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span>i<span class=\"token operator\">*</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span>\n    data <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">.</span>from_bytes<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span><span class=\"token string\">'little'</span><span class=\"token punctuation\">)</span>\n    needed<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>needed<span class=\"token punctuation\">)</span></code></pre></div>\n<p>ここで取得した値を元に連立方程式を構成するためにも、各 func 関数で追加している値を取得します。</p>\n<p>この値を取得するために pwntools の ELF モジュールを使用しますが、実行時間には結構な時間を要します。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sage<span class=\"token punctuation\">.</span><span class=\"token builtin\">all</span> <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n\nmat <span class=\"token operator\">=</span> Matrix<span class=\"token punctuation\">(</span>check<span class=\"token punctuation\">)</span>\nmat <span class=\"token operator\">=</span> mat<span class=\"token punctuation\">.</span>T\nneeded <span class=\"token operator\">=</span> vector<span class=\"token punctuation\">(</span>needed<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>mat<span class=\"token punctuation\">.</span>solve_right<span class=\"token punctuation\">(</span>needed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>最終的に、取得した<code class=\"language-text\">needed</code>の値と取得した各関数の加算値を連立方程式で解決し、Flag が取得できます。</p>\n<h2 id=\"physics-hwmisc\" style=\"position:relative;\"><a href=\"#physics-hwmisc\" aria-label=\"physics hwmisc permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Physics HW(Misc)</h2>\n<p>問題バイナリとして提供された pcap ファイルを解析すると、破損した ZIP ファイルを送信していると思われるデータを確認できます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/595e5c66d4300872172e16d1ff8c9e30/d004c/image-20230422205325945.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB7UlEQVQoz3VTa3PaMBD0//8xnX7MhIRXbIxfNUlJgwME+SVZNikQCCUzwPYkXEo6U8/s3OlOWq3uzobjBbhpteEGIVgSYzx9RjQekc+QpDEynkFIThBnywv+CSrOixy5yGDcNHx8+dqB1bTxOghReB6E64L3HRSuB+n5KP0AZRDQ2tW+9H1U4YAQohoMUH4LaZ+H+WQKg7Ecz5MEk+8/wC0T2d3d/9Htnv3ctD6ts04X8ukJBurvTUok7TYlT6S810NuWX9hmshVjIjSTkdbHaNcqoiJsIwiGIfDAUciXHCuk8JxIPp9cNuGsMmSn1s9TaZiao++tCZTpGrNyfLHRxjH41ErXBaFVqUIOREJx9UHNInafElomvWzzZMAQkEXJw8Pl4TidLAm0DUyL5TURCr/L3SeLmDUnDPhzyzD7Poa7PZW21mjoRG3moibTSStlq5dSnVWSGrLaM/L1RViOjOlKTg3ZaWebPf0aPxRo2uqVPRONVSQakzoadVwiDmhvL+HrMcnV13e7/c4kMrX+RzpjEEWEqvFAm/LJaqyREHNWq9WeN9ssFmvsd1usfv4wG63w68ayn+neJoLGBG1ejSKEEUjCCFQkFJJIySJTCjVFFN+SajoUpWfjMdgjCGOY8xIREJ/2GT6gnA4wm9bRQzqZ9XymQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/595e5c66d4300872172e16d1ff8c9e30/8ac56/image-20230422205325945.webp 240w,\n/static/595e5c66d4300872172e16d1ff8c9e30/d3be9/image-20230422205325945.webp 480w,\n/static/595e5c66d4300872172e16d1ff8c9e30/e46b2/image-20230422205325945.webp 960w,\n/static/595e5c66d4300872172e16d1ff8c9e30/f992d/image-20230422205325945.webp 1440w,\n/static/595e5c66d4300872172e16d1ff8c9e30/6eb7d/image-20230422205325945.webp 1611w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/595e5c66d4300872172e16d1ff8c9e30/8ff5a/image-20230422205325945.png 240w,\n/static/595e5c66d4300872172e16d1ff8c9e30/e85cb/image-20230422205325945.png 480w,\n/static/595e5c66d4300872172e16d1ff8c9e30/d9199/image-20230422205325945.png 960w,\n/static/595e5c66d4300872172e16d1ff8c9e30/07a9c/image-20230422205325945.png 1440w,\n/static/595e5c66d4300872172e16d1ff8c9e30/d004c/image-20230422205325945.png 1611w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/595e5c66d4300872172e16d1ff8c9e30/d9199/image-20230422205325945.png\"\n            alt=\"image-20230422205325945\"\n            title=\"image-20230422205325945\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>pcap から WireShark で出力したファイルを 7-zip で解凍すると中のファイルを確認できます。</p>\n<p>解凍したファイルから Flag が取得できました。</p>\n<h2 id=\"まとめ\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>moon はもうちょいで解けそうだと思ったものの頭が固くて Solver を思いつきませんでした。</p>\n<p>3年くらい言ってる気がしますが精進が必要ですね。。</p>","fields":{"slug":"/ctf-angstromctf-2023","tagSlugs":["/tag/ctf/","/tag/rev/"]},"frontmatter":{"date":"2023-04-29","description":"ångstrom CTF 2023 Writeup","tags":["CTF","Rev"],"title":"ångstrom CTF 2023 Writeup","socialImage":{"publicURL":"/static/aa817d213fbbbbe145c5236516851875/ctf-angstromctf-2023.png"}}}},"pageContext":{"slug":"/ctf-angstromctf-2023"}},"staticQueryHashes":["251939775","401334301","825871152"]}