{"componentChunkName":"component---src-templates-post-template-js","path":"/ctf-seccon-ctf-2023","result":{"data":{"markdownRemark":{"id":"59219acb-e483-557b-8431-ca6914f61095","html":"<p>9/16 から 17 にかけて開催されていた SECCON CTF 2023 の予選に 0nePadding として参加しました。</p>\n<p>個人では Rev の問題を 2 問解き、最終順位は国内 35 位、全体で 87 位でした。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 956px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/51c092ab690900c94d15f611ecea31f0/7b1dc/image-20230917221935162.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.583333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAxElEQVQY05WR6wrCMAyF9/6vNkUEUeZl07mJc/6dbXo7pnEbIkP0wEdo054maZIXJ6w3GbJsh9l8idV6hzRdYLvPYZ1DVAjhZ5LrtcG5qrE/HHEscuTZDFXJsShhjMG/Srqug9aEhyJYqxF0yyWRJL33cI7h6H0Y1xIniPsJUTTqW+vhu5L0IYxGWmuu2EpbfnzgEzas6gtu7R3RWGkFpZS0SobkwKCmaVHwvL9JZkhkxECwVqqw9oXjTxkgzsfRvO9N8QQ8oNRLVTywgAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/51c092ab690900c94d15f611ecea31f0/8ac56/image-20230917221935162.webp 240w,\n/static/51c092ab690900c94d15f611ecea31f0/d3be9/image-20230917221935162.webp 480w,\n/static/51c092ab690900c94d15f611ecea31f0/409e5/image-20230917221935162.webp 956w\"\n              sizes=\"(max-width: 956px) 100vw, 956px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/51c092ab690900c94d15f611ecea31f0/8ff5a/image-20230917221935162.png 240w,\n/static/51c092ab690900c94d15f611ecea31f0/e85cb/image-20230917221935162.png 480w,\n/static/51c092ab690900c94d15f611ecea31f0/7b1dc/image-20230917221935162.png 956w\"\n            sizes=\"(max-width: 956px) 100vw, 956px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/51c092ab690900c94d15f611ecea31f0/7b1dc/image-20230917221935162.png\"\n            alt=\"image-20230917221935162\"\n            title=\"image-20230917221935162\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>SECCON の国内本選の参加ラインである国内順位での上位 10 チームまではまだまだ壁が厚いですが、引き続き精進していこうと思います。</p>\n<p>解いてない問題の復習には時間がかかりそうなので、とりあえず解けた問題の Writeup を書きます。</p>\n<!-- omit in toc -->\n<h2 id=\"もくじ\" style=\"position:relative;\"><a href=\"#%E3%82%82%E3%81%8F%E3%81%98\" aria-label=\"もくじ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>もくじ</h2>\n<ul>\n<li><a href=\"#jumpoutrev\">jumpout(Rev)</a></li>\n<li><a href=\"#sicklerev\">Sickle(Rev)</a></li>\n<li><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\">まとめ</a></li>\n</ul>\n<h2 id=\"jumpoutrev\" style=\"position:relative;\"><a href=\"#jumpoutrev\" aria-label=\"jumpoutrev permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>jumpout(Rev)</h2>\n<blockquote>\n<p>Sequential execution</p>\n</blockquote>\n<p>今回の Rev の Warmup 問です。</p>\n<p>Flag 取得の難易度的には簡単でしたが、Writer の方がバイナリやデバッガに精通しているんだろうなということを強く感じる非常に興味深い問題でした。(この問題どうやって作ってるのか、ソースコードがあれば見たい、、、)</p>\n<p>バイナリ自体は入力値として受け取った Flag を検証するだけのシンプルなプログラムのようでしたので、Ghidra で解析していきます。</p>\n<p>いつも通りバイナリを entry から解析し、main 関数を特定したところ、<code class=\"language-text\">FLAG:</code> というテキストを用いて何かしらの処理を呼び出しているようですが、Listing ウインドウの結果が壊れているせいか上手く処理をデコンパイルできていません。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b6732f4040c49a6403ed3af9a7e83a0a/20c85/image-20230917223341237.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 86.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACFElEQVQ4y61T666jIBjs+z/g/jh7TnqvVqu1AgJymR2otrrZTc4mS/IFgzDMzDdsRjvC2oBxBISwUIofCAjRswLScM7hcDhBDWlvzAVERE4xxlzz2FyvFYpCouvA0lDSQkqJXhr48AY8Hk+4dwqD7gng8voMNgOmeVNXNcpS4fF4AlrrcW9rNM0DxmoyN7Ckv98fcblqNG2FYah52ZvVDJYZVmRYXRWBAK1HAnjI4U4QA+dd3ugcAbdbCDLXOlW6WHGds7MvazJDrU1mlUYCTN8u+NXtSfJut0ff1/S5pB0drBFUIKA5jwl0smcjJX2h2YmxMS4zNNyA+JZhjcb28ycZCkglMdKK6fxC88TwWla43dTEJOSbOspa+uK9J8Md2tbS6wEP8UVbSjj+9pQbmYiI2cMqNeAJmNh5H9AblX1ZAe4P6O6KjTujrn+guR0glGD1ZN3Du5BVsikJcFgBPgiYIjMDpqbsPj94cKQ99JpF++CUx5hKs3FcC36KTdvMkn2WPDPEJMPT093XBxviuCfl7v1vZWKSfDhVODOH7Af6gZExAaVg9/hghjGyAMWf50uB+Or++pUsi02p6clTco4MJbeDyAdCeFpt+TyL0/kVjd9fx3JMHk6Sk4dZspzj/8phURQrwL+NFeCyy0sW/wVwedDxLRfn0/cAl8F+xUb/AfDyTcDm1jKwevVSpB3WgP8g+Rew0TIRHDF1yAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b6732f4040c49a6403ed3af9a7e83a0a/8ac56/image-20230917223341237.webp 240w,\n/static/b6732f4040c49a6403ed3af9a7e83a0a/d3be9/image-20230917223341237.webp 480w,\n/static/b6732f4040c49a6403ed3af9a7e83a0a/e46b2/image-20230917223341237.webp 960w,\n/static/b6732f4040c49a6403ed3af9a7e83a0a/5375e/image-20230917223341237.webp 999w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b6732f4040c49a6403ed3af9a7e83a0a/8ff5a/image-20230917223341237.png 240w,\n/static/b6732f4040c49a6403ed3af9a7e83a0a/e85cb/image-20230917223341237.png 480w,\n/static/b6732f4040c49a6403ed3af9a7e83a0a/d9199/image-20230917223341237.png 960w,\n/static/b6732f4040c49a6403ed3af9a7e83a0a/20c85/image-20230917223341237.png 999w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b6732f4040c49a6403ed3af9a7e83a0a/d9199/image-20230917223341237.png\"\n            alt=\"image-20230917223341237\"\n            title=\"image-20230917223341237\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>ただし、main 関数で参照している 0x1011d0 の関数を参照すると、上手くデコンパイルできてはいないものの、スタック内の(おそらく)入力文字を check 関数に与えていることがわかります。(check 関数は自分で rename した関数)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ee646fff513f0fc4d8302bece38d923d/d7e70/image-20230917224759189.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAABAklEQVQY00XJXU+CYACGYf7/H+io1sxa67Cj5himAga+YH6gxssroeHc1PIj0dJ1R3XQwbV7ex5tHK+YJOvciuUsY7/Zs1tnrBcb3uYLXNendFdFL1mUDZt7w6LhCHyvSdN/pNVs0W516La7BN0ArbPsMchSgo0ieJeooyI6DolJSA8TlBrSDwOeVB/5HCGTiGgkf8kkzLc/4Y84RDsZn3I2v6WwuuFqe03h9ZzLbZHi4QIjKyPjHk5i4IxN7IFDPRTUZSPn8aA8nJHAfRF5PdxUoOmTCs62g7vzaezzc2chPgXelyD8CGnHAXpqYc5qmNNqrkZtWqE6NbHmNtbin537BqsZGDYjRT9AAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ee646fff513f0fc4d8302bece38d923d/8ac56/image-20230917224759189.webp 240w,\n/static/ee646fff513f0fc4d8302bece38d923d/d3be9/image-20230917224759189.webp 480w,\n/static/ee646fff513f0fc4d8302bece38d923d/e46b2/image-20230917224759189.webp 960w,\n/static/ee646fff513f0fc4d8302bece38d923d/3cc91/image-20230917224759189.webp 1286w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ee646fff513f0fc4d8302bece38d923d/8ff5a/image-20230917224759189.png 240w,\n/static/ee646fff513f0fc4d8302bece38d923d/e85cb/image-20230917224759189.png 480w,\n/static/ee646fff513f0fc4d8302bece38d923d/d9199/image-20230917224759189.png 960w,\n/static/ee646fff513f0fc4d8302bece38d923d/d7e70/image-20230917224759189.png 1286w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ee646fff513f0fc4d8302bece38d923d/d9199/image-20230917224759189.png\"\n            alt=\"image-20230917224759189\"\n            title=\"image-20230917224759189\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>check 関数は以下のような関数でした。</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">undefined8 <span class=\"token function\">check</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>param_1<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">long</span> lVar1<span class=\"token punctuation\">;</span>\n  <span class=\"token class-name\">size_t</span> sVar2<span class=\"token punctuation\">;</span>\n  ulong uVar3<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">long</span> in_FS_OFFSET<span class=\"token punctuation\">;</span>\n  \n  lVar1 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>in_FS_OFFSET <span class=\"token operator\">+</span> <span class=\"token number\">0x28</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  sVar2 <span class=\"token operator\">=</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>param_1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>sVar2 <span class=\"token operator\">==</span> <span class=\"token number\">0x1d</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">do</span> <span class=\"token punctuation\">{</span>\n      uVar3 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">do</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">FUN_00101360</span><span class=\"token punctuation\">(</span>param_1<span class=\"token punctuation\">[</span>uVar3<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>uVar3 <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xffffffff</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        uVar3 <span class=\"token operator\">=</span> uVar3 <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>uVar3 <span class=\"token operator\">!=</span> <span class=\"token number\">0x1d</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span> true <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>lVar1 <span class=\"token operator\">!=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>in_FS_OFFSET <span class=\"token operator\">+</span> <span class=\"token number\">0x28</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token comment\">/* WARNING: Subroutine does not return */</span>\n    <span class=\"token function\">__stack_chk_fail</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>この処理から、Flag の正しい文字数は 0x1d であることがわかります。</p>\n<p>また、入力値の 1 文字とインデックスを引数として、 FUN_00101360 という関数を呼び出していることがわかります。</p>\n<p>FUN<em>00101360 は以下のような関数で、入力値の 1 文字とインデックス、0x55 と (&#x26;DAT</em>00104010)[インデックス] の 4 つを XOR した値を返します。</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">uint <span class=\"token function\">FUN_00101360</span><span class=\"token punctuation\">(</span>uint param_1<span class=\"token punctuation\">,</span>uint param_2<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">long</span> in_FS_OFFSET<span class=\"token punctuation\">;</span>\n  \n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>in_FS_OFFSET <span class=\"token operator\">+</span> <span class=\"token number\">0x28</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>in_FS_OFFSET <span class=\"token operator\">+</span> <span class=\"token number\">0x28</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token comment\">/* WARNING: Subroutine does not return */</span>\n    <span class=\"token function\">__stack_chk_fail</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span>param_2<span class=\"token punctuation\">,</span>param_2<span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> param_1 <span class=\"token operator\">^</span> param_2 <span class=\"token operator\">^</span> <span class=\"token number\">0x55</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span>uint<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>byte<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>DAT_00104010<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span>param_2<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>しかし、先ほど確認した check 関数のデコンパイル結果を見てわかる通り、デコンパイル結果内には FUN_00101360 の戻り値を扱う処理が見当たりません。</p>\n<p>恐らく返された値を何らかのハードコードされた値と比較することで検証しそうだという予想が立ちますが、こちらの関数もデコンパイル結果が壊れているようで、正しい処理を参照できる状態になっていないようでした。</p>\n<p>仕方がないので check 関数のアセンブリを読んでみると、DAT_00104030 のデータをロードしており、あとで使用しようとしている可能性が高いことがわかりました。</p>\n<p>若干 guess が入っていますが、このデータを比較対象として以下の Solver を作成したところ Flag を取得することができました。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">d <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span> <span class=\"token number\">0xf6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xf5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x31</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xc8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x81</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x68</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xf6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x35</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xe5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3e</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x82</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x09</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xca</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xf1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x8a</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xa9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xdf</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xdf</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x33</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x2a</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6d</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x81</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xf5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xa6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x85</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xdf</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x17</span> <span class=\"token punctuation\">]</span>\n\ne <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span> <span class=\"token number\">0xf0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xe4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x25</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xdd</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x9f</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0b</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3c</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x50</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xde</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x04</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xca</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x3f</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xaf</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xf3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xc7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xaa</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xb2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xfd</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xef</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x57</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xb4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xd0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x8f</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xb8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xf4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x23</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span> <span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x1d</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x55</span><span class=\"token operator\">^</span> i <span class=\"token operator\">^</span> d<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">^</span> e<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> end<span class=\"token operator\">=</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>コンテスト中は上記の Solver までスムーズに到達したのですが、あとから見返してみるとかなり読みづらいバイナリで、動的解析が前提になっていそうでした。</p>\n<p>とはいえ大筋は変わらないので、check 関数まで特定した後でデバッガで詳細な挙動を追っていけば同じ結論に到達します。</p>\n<h2 id=\"sicklerev\" style=\"position:relative;\"><a href=\"#sicklerev\" aria-label=\"sicklerev permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Sickle(Rev)</h2>\n<blockquote>\n<p>Pickle infected with COVID-19</p>\n</blockquote>\n<p>実力不足なのでこの問題のような気合いで読む系の Rev 問を解くのに時間がかかり、結局コンテストの終了ギリギリでようやく Flag を通すことができました。</p>\n<p>問題バイナリとして以下のスクリプトが与えられました。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pickle<span class=\"token punctuation\">,</span> io\n\npayload <span class=\"token operator\">=</span> <span class=\"token string\">b'\\x8c\\x08builtins\\x8c\\x07getattr\\x93\\x942\\x8c\\x08builtins\\x8c\\x05input\\x93\\x8c\\x06FLAG> \\x85R\\x8c\\x06encode\\x86R)R\\x940g0\\n\\x8c\\x08builtins\\x8c\\x04dict\\x93\\x8c\\x03get\\x86R\\x8c\\x08builtins\\x8c\\x07globals\\x93)R\\x8c\\x01f\\x86R\\x8c\\x04seek\\x86R\\x94g0\\n\\x8c\\x08builtins\\x8c\\x03int\\x93\\x8c\\x07__add__\\x86R\\x940g0\\n\\x8c\\x08builtins\\x8c\\x03int\\x93\\x8c\\x07__mul__\\x86R\\x940g0\\n\\x8c\\x08builtins\\x8c\\x03int\\x93\\x8c\\x06__eq__\\x86R\\x940g3\\ng5\\n\\x8c\\x08builtins\\x8c\\x03len\\x93g1\\n\\x85RM@\\x00\\x86RM\\x05\\x01\\x86R\\x85R.0g0\\ng1\\n\\x8c\\x0b__getitem__\\x86R\\x940M\\x00\\x00\\x940g2\\ng3\\ng0\\ng6\\ng7\\n\\x85R\\x8c\\x06__le__\\x86RM\\x7f\\x00\\x85RMJ\\x01\\x86R\\x85R.0g2\\ng3\\ng4\\ng5\\ng3\\ng7\\nM\\x01\\x00\\x86Rp7\\nM@\\x00\\x86RMU\\x00\\x86RM\"\\x01\\x86R\\x85R0g0\\ng0\\n]\\x94\\x8c\\x06append\\x86R\\x940g8\\n\\x8c\\x0b__getitem__\\x86R\\x940g0\\n\\x8c\\x08builtins\\x8c\\x03int\\x93\\x8c\\nfrom_bytes\\x86R\\x940M\\x00\\x00p7\\n0g9\\ng11\\ng6\\n\\x8c\\x08builtins\\x8c\\x05slice\\x93g4\\ng7\\nM\\x08\\x00\\x86Rg4\\ng3\\ng7\\nM\\x01\\x00\\x86RM\\x08\\x00\\x86R\\x86R\\x85R\\x8c\\x06little\\x86R\\x85R0g2\\ng3\\ng4\\ng5\\ng3\\ng7\\nM\\x01\\x00\\x86Rp7\\nM\\x08\\x00\\x86RMw\\x00\\x86RM\\xc9\\x01\\x86R\\x85R0g0\\n]\\x94\\x8c\\x06append\\x86R\\x940g0\\ng12\\n\\x8c\\x0b__getitem__\\x86R\\x940g0\\n\\x8c\\x08builtins\\x8c\\x03int\\x93\\x8c\\x07__xor__\\x86R\\x940I1244422970072434993\\n\\x940M\\x00\\x00p7\\n0g13\\n\\x8c\\x08builtins\\x8c\\x03pow\\x93g15\\ng10\\ng7\\n\\x85Rg16\\n\\x86RI65537\\nI18446744073709551557\\n\\x87R\\x85R0g14\\ng7\\n\\x85Rp16\\n0g2\\ng3\\ng4\\ng5\\ng3\\ng7\\nM\\x01\\x00\\x86Rp7\\nM\\x08\\x00\\x86RM\\x83\\x00\\x86RM\\xa7\\x02\\x86R\\x85R0g0\\ng12\\n\\x8c\\x06__eq__\\x86R(I8215359690687096682\\nI1862662588367509514\\nI8350772864914849965\\nI11616510986494699232\\nI3711648467207374797\\nI9722127090168848805\\nI16780197523811627561\\nI18138828537077112905\\nl\\x85R.'</span>\nf <span class=\"token operator\">=</span> io<span class=\"token punctuation\">.</span>BytesIO<span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span>\nres <span class=\"token operator\">=</span> pickle<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token builtin\">isinstance</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">,</span> <span class=\"token builtin\">bool</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">and</span> res<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Congratulations!!\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Nope\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>これを実行すると、ハードコードされたバイナリが <code class=\"language-text\">pickle.load(f)</code> でデシリアライズされる際に実行され、Flag 文字列の要求と検証が行われることがわかりました。</p>\n<p>pickle というライブラリは初めて使ったのですが、Python オブジェクトのシリアライズとデシリアライズが可能なモジュールのようです。</p>\n<p>また、pickle の load メソッドでデシリアライズを行う場合は、実際のところ内部で VM として処理されるため、任意のコード実行が可能な機能を持っているそうです。</p>\n<p>この問題でも、payload として定義された一連のバイナリデータがロードされることで、Flag の入力を受け取って検証する処理が実行されます。</p>\n<p>参考：<a href=\"https://docs.juliahub.com/Pickle/LAUNc/0.1.0/opcode/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">OpCodes · Pickle.jl</a></p>\n<p>参考：<a href=\"https://docs.python.org/ja/3/library/pickle.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">pickle --- Python オブジェクトの直列化 — Python 3.11.5 ドキュメント</a></p>\n<p>解析のためにはまず payload のディスアセンブルを行う必要があります。</p>\n<p>ディスアセンブルは <code class=\"language-text\">pickletools.dis()</code> を使用することで行うことができます。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pickletools\n\npayload <span class=\"token operator\">=</span> <span class=\"token string\">b'\\x8c\\x08builtins\\x8c\\x07getattr\\x93\\x942\\x8c\\x08builtins\\x8c\\x05input\\x93\\x8c\\x06FLAG> \\x85R\\x8c\\x06encode\\x86R)R\\x940g0\\n\\x8c\\x08builtins\\x8c\\x04dict\\x93\\x8c\\x03get\\x86R\\x8c\\x08builtins\\x8c\\x07globals\\x93)R\\x8c\\x01f\\x86R\\x8c\\x04seek\\x86R\\x94g0\\n\\x8c\\x08builtins\\x8c\\x03int\\x93\\x8c\\x07__add__\\x86R\\x940g0\\n\\x8c\\x08builtins\\x8c\\x03int\\x93\\x8c\\x07__mul__\\x86R\\x940g0\\n\\x8c\\x08builtins\\x8c\\x03int\\x93\\x8c\\x06__eq__\\x86R\\x940g3\\ng5\\n\\x8c\\x08builtins\\x8c\\x03len\\x93g1\\n\\x85RM@\\x00\\x86RM\\x05\\x01\\x86R\\x85R.0g0\\ng1\\n\\x8c\\x0b__getitem__\\x86R\\x940M\\x00\\x00\\x940g2\\ng3\\ng0\\ng6\\ng7\\n\\x85R\\x8c\\x06__le__\\x86RM\\x7f\\x00\\x85RMJ\\x01\\x86R\\x85R.0g2\\ng3\\ng4\\ng5\\ng3\\ng7\\nM\\x01\\x00\\x86Rp7\\nM@\\x00\\x86RMU\\x00\\x86RM\"\\x01\\x86R\\x85R0g0\\ng0\\n]\\x94\\x8c\\x06append\\x86R\\x940g8\\n\\x8c\\x0b__getitem__\\x86R\\x940g0\\n\\x8c\\x08builtins\\x8c\\x03int\\x93\\x8c\\nfrom_bytes\\x86R\\x940M\\x00\\x00p7\\n0g9\\ng11\\ng6\\n\\x8c\\x08builtins\\x8c\\x05slice\\x93g4\\ng7\\nM\\x08\\x00\\x86Rg4\\ng3\\ng7\\nM\\x01\\x00\\x86RM\\x08\\x00\\x86R\\x86R\\x85R\\x8c\\x06little\\x86R\\x85R0g2\\ng3\\ng4\\ng5\\ng3\\ng7\\nM\\x01\\x00\\x86Rp7\\nM\\x08\\x00\\x86RMw\\x00\\x86RM\\xc9\\x01\\x86R\\x85R0g0\\n]\\x94\\x8c\\x06append\\x86R\\x940g0\\ng12\\n\\x8c\\x0b__getitem__\\x86R\\x940g0\\n\\x8c\\x08builtins\\x8c\\x03int\\x93\\x8c\\x07__xor__\\x86R\\x940I1244422970072434993\\n\\x940M\\x00\\x00p7\\n0g13\\n\\x8c\\x08builtins\\x8c\\x03pow\\x93g15\\ng10\\ng7\\n\\x85Rg16\\n\\x86RI65537\\nI18446744073709551557\\n\\x87R\\x85R0g14\\ng7\\n\\x85Rp16\\n0g2\\ng3\\ng4\\ng5\\ng3\\ng7\\nM\\x01\\x00\\x86Rp7\\nM\\x08\\x00\\x86RM\\x83\\x00\\x86RM\\xa7\\x02\\x86R\\x85R0g0\\ng12\\n\\x8c\\x06__eq__\\x86R(I8215359690687096682\\nI1862662588367509514\\nI8350772864914849965\\nI11616510986494699232\\nI3711648467207374797\\nI9722127090168848805\\nI16780197523811627561\\nI18138828537077112905\\nl\\x85R.'</span>\n\npickletools<span class=\"token punctuation\">.</span>dis<span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">,</span> annotate<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>参考：<a href=\"https://docs.python.org/ja/3/library/pickletools.html?highlight=pickletool#module-pickletools\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">pickletools --- pickle 開発者のためのツール群 — Python 3.11.5 ドキュメント</a></p>\n<p>しかし、途中で STOP 命令が記述されているせいで、pickletools ではオフセット 0x105 までしか読み取ることができません。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4b8487a5dc0bf9ab570cedd61839a104/46e51/image-20230917233959543.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.83333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABHUlEQVQY0y2QWXOCUAyFeXK6amc6fah2Exe04sImggJaZREVBVptp+3//xmn94Y+nEnu3OTkS4RksEIkufiaHrBmcXjegHrVRr9Uh1NVkakRUjXE0dwi0yLw+ncjJsVdD3HHQ6qE1KtXOhD2Qx9vzyZOVsIK5tDKErRriQxn9wo15toap8muMGUDjuYOSX+FZX2CsDXDtrdA1HZg3srMkE0M2ePTTmiacdOFXu4UhMwwVQIcRkFBpccF4X/0GzZ80SbSoDklGGEnL7ESLWa4pwJJqGFwJkIuvcCtakTG9e1k+BhviJCb/7g5nYLnv15OW1h3AwicbPE0xuZ1Qavz3HvQC9JKl+7ISeePBtyaRn/8VvzWXKOLJkm5bJH+AEXzpBBUp9xSAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4b8487a5dc0bf9ab570cedd61839a104/8ac56/image-20230917233959543.webp 240w,\n/static/4b8487a5dc0bf9ab570cedd61839a104/d3be9/image-20230917233959543.webp 480w,\n/static/4b8487a5dc0bf9ab570cedd61839a104/e46b2/image-20230917233959543.webp 960w,\n/static/4b8487a5dc0bf9ab570cedd61839a104/2f8da/image-20230917233959543.webp 1003w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4b8487a5dc0bf9ab570cedd61839a104/8ff5a/image-20230917233959543.png 240w,\n/static/4b8487a5dc0bf9ab570cedd61839a104/e85cb/image-20230917233959543.png 480w,\n/static/4b8487a5dc0bf9ab570cedd61839a104/d9199/image-20230917233959543.png 960w,\n/static/4b8487a5dc0bf9ab570cedd61839a104/46e51/image-20230917233959543.png 1003w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4b8487a5dc0bf9ab570cedd61839a104/d9199/image-20230917233959543.png\"\n            alt=\"image-20230917233959543\"\n            title=\"image-20230917233959543\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>しかも、payload の範囲を Slice で指定しても、POP や GET の命令を pickletools 側で解釈できなくなってしまうためにエラーが発生してディスアセンブルに失敗します。</p>\n<p>そこで、この payload をディスアセンブルできる他のツールを探したところ、r2pickledec という radare2 のプラグインを見つけました。</p>\n<p>参考：<a href=\"https://github.com/doyensec/r2pickledec\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">doyensec/r2pickledec: Pickle decompiler plugin for Radare2</a></p>\n<p>このツールは不具合が多くインストール時やインストール後も様々な問題が発生しましたが、とりあえず最新の radare2 をソースコードからビルドした後にプラグインをインストールすることで、payload の全文をディスアセンブルすることに成功しました。</p>\n<p>ここでディスアセンブルした結果に解析コメントを付けたものは以下の通りです。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">0x000      8c086275696c.  short_binunicode <span class=\"token string\">\"builtins\"</span> <span class=\"token punctuation\">;</span> 0x2\n0x00a      8c0767657461.  short_binunicode <span class=\"token string\">\"getattr\"</span>  <span class=\"token punctuation\">;</span> 0xc\n0x013      <span class=\"token number\">93</span>             stack_global\n0x014      <span class=\"token number\">94</span>             memoize\n0x015      <span class=\"token number\">32</span>             dup\n\nmemo0: getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n0x016      8c086275696c.  short_binunicode <span class=\"token string\">\"builtins\"</span> <span class=\"token punctuation\">;</span> 0x18\n0x020      8c05696e7075.  short_binunicode <span class=\"token string\">\"input\"</span>    <span class=\"token punctuation\">;</span> 0x22 <span class=\"token punctuation\">;</span> <span class=\"token number\">2</span><span class=\"token string\">'\"'</span>\n0x027      <span class=\"token number\">93</span>             stack_global\n0x028      8c06464c4147.  short_binunicode <span class=\"token string\">\"FLAG> \"</span>   <span class=\"token punctuation\">;</span> 0x2a <span class=\"token punctuation\">;</span> <span class=\"token number\">2</span><span class=\"token string\">'*'</span>\n0x030      <span class=\"token number\">85</span>             tuple1\n0x031      <span class=\"token number\">52</span>             reduce\n// getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// input<span class=\"token punctuation\">(</span><span class=\"token string\">\"FLAG> \"</span><span class=\"token punctuation\">)</span>\n\n0x032      8c06656e636f.  short_binunicode <span class=\"token string\">\"encode\"</span>   <span class=\"token punctuation\">;</span> 0x34 <span class=\"token punctuation\">;</span> <span class=\"token number\">2</span><span class=\"token string\">'4'</span>\n0x03a      <span class=\"token number\">86</span>             tuple2\n0x03b      <span class=\"token number\">52</span>             reduce\n0x03c      <span class=\"token number\">29</span>             empty_tuple\n0x03d      <span class=\"token number\">52</span>             reduce\n0x03e      <span class=\"token number\">94</span>             memoize\n0x03f      <span class=\"token number\">30</span>             pop\n\nmemo0: getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo1: Flag\n\n0x040      67300a         get <span class=\"token string\">\"0\"</span>                     <span class=\"token punctuation\">;</span> 0x41 <span class=\"token punctuation\">;</span> <span class=\"token number\">2</span><span class=\"token string\">'A'</span>\n0x043      8c086275696c.  short_binunicode <span class=\"token string\">\"builtins\"</span> <span class=\"token punctuation\">;</span> 0x45 <span class=\"token punctuation\">;</span> <span class=\"token number\">2</span><span class=\"token string\">'E'</span>\n0x04d      8c0464696374   short_binunicode <span class=\"token string\">\"dict\"</span>     <span class=\"token punctuation\">;</span> 0x4f <span class=\"token punctuation\">;</span> <span class=\"token number\">2</span><span class=\"token string\">'O'</span>\n0x053      <span class=\"token number\">93</span>             stack_global\n0x054      8c03676574     short_binunicode <span class=\"token string\">\"get\"</span>      <span class=\"token punctuation\">;</span> 0x56 <span class=\"token punctuation\">;</span> <span class=\"token number\">2</span><span class=\"token string\">'V'</span>\n0x059      <span class=\"token number\">86</span>             tuple2\n0x05a      <span class=\"token number\">52</span>             reduce\n0x05b      8c086275696c.  short_binunicode <span class=\"token string\">\"builtins\"</span> <span class=\"token punctuation\">;</span> 0x5d <span class=\"token punctuation\">;</span> <span class=\"token number\">2</span><span class=\"token string\">']'</span>\n0x065      8c07676c6f62.  short_binunicode <span class=\"token string\">\"globals\"</span>  <span class=\"token punctuation\">;</span> 0x67 <span class=\"token punctuation\">;</span> <span class=\"token number\">2</span><span class=\"token string\">'g'</span>\n0x06e      <span class=\"token number\">93</span>             stack_global\n0x06f      <span class=\"token number\">29</span>             empty_tuple\n0x070      <span class=\"token number\">52</span>             reduce\n0x071      8c0166         short_binunicode <span class=\"token string\">\"f\"</span>        <span class=\"token punctuation\">;</span> 0x73 <span class=\"token punctuation\">;</span> <span class=\"token number\">2</span><span class=\"token string\">'s'</span>\n0x074      <span class=\"token number\">86</span>             tuple2\n0x075      <span class=\"token number\">52</span>             reduce\n\n\n0x076      8c047365656b   short_binunicode <span class=\"token string\">\"seek\"</span>     <span class=\"token punctuation\">;</span> 0x78 <span class=\"token punctuation\">;</span> <span class=\"token number\">2</span><span class=\"token string\">'x'</span>\n0x07c      <span class=\"token number\">86</span>             tuple2\n0x07d      <span class=\"token number\">52</span>             reduce\n// dict.get<span class=\"token punctuation\">(</span>builtins.globals<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>, f<span class=\"token punctuation\">)</span>.seek<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n0x07e      <span class=\"token number\">94</span>             memoize\n\nmemo0: getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo1: Flag\nmemo2: dict.get<span class=\"token punctuation\">(</span>builtins.globals<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>, f<span class=\"token punctuation\">)</span>.seek<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n0x07f      67300a         get <span class=\"token string\">\"0\"</span>                     <span class=\"token punctuation\">;</span> 0x80\n0x082      8c086275696c.  short_binunicode <span class=\"token string\">\"builtins\"</span> <span class=\"token punctuation\">;</span> 0x84\n0x08c      8c03696e74     short_binunicode <span class=\"token string\">\"int\"</span>      <span class=\"token punctuation\">;</span> 0x8e\n0x091      <span class=\"token number\">93</span>             stack_global\n\n// getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// builtins.int<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// __add__\n\n0x092      8c075f5f6164.  short_binunicode <span class=\"token string\">\"__add__\"</span>  <span class=\"token punctuation\">;</span> 0x94\n0x09b      <span class=\"token number\">86</span>             tuple2\n// getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// <span class=\"token punctuation\">(</span>builtins.int<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>, __add__<span class=\"token punctuation\">)</span>\n0x09c      <span class=\"token number\">52</span>             reduce\n0x09d      <span class=\"token number\">94</span>             memoize\n0x09e      <span class=\"token number\">30</span>             pop\nmemo0: getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo1: Flag\nmemo2: dict.get<span class=\"token punctuation\">(</span>builtins.globals<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>, f<span class=\"token punctuation\">)</span>.seek<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo3: add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n0x09f      67300a         get <span class=\"token string\">\"0\"</span>                     <span class=\"token punctuation\">;</span> 0xa0\n0x0a2      8c086275696c.  short_binunicode <span class=\"token string\">\"builtins\"</span> <span class=\"token punctuation\">;</span> 0xa4\n0x0ac      8c03696e74     short_binunicode <span class=\"token string\">\"int\"</span>      <span class=\"token punctuation\">;</span> 0xae\n0x0b1      <span class=\"token number\">93</span>             stack_global\n0x0b2      8c075f5f6d75.  short_binunicode <span class=\"token string\">\"__mul__\"</span>  <span class=\"token punctuation\">;</span> 0xb4\n0x0bb      <span class=\"token number\">86</span>             tuple2\n0x0bc      <span class=\"token number\">52</span>             reduce\n0x0bd      <span class=\"token number\">94</span>             memoize\n0x0be      <span class=\"token number\">30</span>             pop\nmemo0: getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo1: Flag\nmemo2: dict.get<span class=\"token punctuation\">(</span>builtins.globals<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>, f<span class=\"token punctuation\">)</span>.seek<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo3: add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo4: mul<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n0x0bf      67300a         get <span class=\"token string\">\"0\"</span>                     <span class=\"token punctuation\">;</span> 0xc0\n0x0c2      8c086275696c.  short_binunicode <span class=\"token string\">\"builtins\"</span> <span class=\"token punctuation\">;</span> 0xc4\n0x0cc      8c03696e74     short_binunicode <span class=\"token string\">\"int\"</span>      <span class=\"token punctuation\">;</span> 0xce\n0x0d1      <span class=\"token number\">93</span>             stack_global\n0x0d2      8c065f5f6571.  short_binunicode <span class=\"token string\">\"__eq__\"</span>   <span class=\"token punctuation\">;</span> 0xd4\n0x0da      <span class=\"token number\">86</span>             tuple2\n0x0db      <span class=\"token number\">52</span>             reduce\n0x0dc      <span class=\"token number\">94</span>             memoize\n0x0dd      <span class=\"token number\">30</span>             pop\nmemo0: getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo1: Flag\nmemo2: dict.get<span class=\"token punctuation\">(</span>builtins.globals<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>, f<span class=\"token punctuation\">)</span>.seek<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> -<span class=\"token operator\">></span> jmp\nmemo3: add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo4: mul<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo5: eq<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n0x0de      67330a         get <span class=\"token string\">\"3\"</span>                     <span class=\"token punctuation\">;</span> 0xdf\n0x0e1      67350a         get <span class=\"token string\">\"5\"</span>                     <span class=\"token punctuation\">;</span> 0xe2\n0x0e4      8c086275696c.  short_binunicode <span class=\"token string\">\"builtins\"</span> <span class=\"token punctuation\">;</span> 0xe6\n0x0ee      8c036c656e     short_binunicode <span class=\"token string\">\"len\"</span>      <span class=\"token punctuation\">;</span> 0xf0\n0x0f3      <span class=\"token number\">93</span>             stack_global\n0x0f4      67310a         get <span class=\"token string\">\"1\"</span>                     <span class=\"token punctuation\">;</span> 0xf5\n0x0f7      <span class=\"token number\">85</span>             tuple1\n0x0f8      <span class=\"token number\">52</span>             reduce\n// add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// eq<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// builtins.len<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span>\n\n0x0f9      4d4000         binint2 0x40                <span class=\"token punctuation\">;</span> <span class=\"token string\">'@'</span>\n0x0fc      <span class=\"token number\">86</span>             tuple2\n\n// add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// eq<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// <span class=\"token punctuation\">(</span>builtins.len<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span>, 0x40<span class=\"token punctuation\">)</span>\n\n0x0fd      <span class=\"token number\">52</span>             reduce\n0x0fe      4d0501         binint2 0x105\n0x101      <span class=\"token number\">86</span>             tuple2\n// add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// <span class=\"token punctuation\">(</span>bool, 0x015<span class=\"token punctuation\">)</span>\n\n0x102      <span class=\"token number\">52</span>             reduce\n// add<span class=\"token punctuation\">(</span>bool, 0x105<span class=\"token punctuation\">)</span>\n\n0x103      <span class=\"token number\">85</span>             tuple1\n// jmp\n// 0x106\n\n0x104      <span class=\"token number\">52</span>             reduce\n0x105      2e             stop -<span class=\"token operator\">></span> Fail\n\n\nmemo0: getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo1: Flag\nmemo2: dict.get<span class=\"token punctuation\">(</span>builtins.globals<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>, f<span class=\"token punctuation\">)</span>.seek<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> -<span class=\"token operator\">></span> jmp\nmemo3: add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo4: mul<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo5: eq<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n0x106      <span class=\"token number\">30</span>             pop\n0x107      67300a         get <span class=\"token string\">\"0\"</span>                     <span class=\"token punctuation\">;</span> 0x108\n0x10a      67310a         get <span class=\"token string\">\"1\"</span>                     <span class=\"token punctuation\">;</span> 0x10b\n0x10d      8c0b5f5f6765.  short_binunicode <span class=\"token string\">\"__getitem__\"</span> <span class=\"token punctuation\">;</span> 0x10f\n// getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// Flag\n// __getitem__\n\n0x11a      <span class=\"token number\">86</span>             tuple2\n0x11b      <span class=\"token number\">52</span>             reduce\n// getattr<span class=\"token punctuation\">(</span>Flag, __getitem__<span class=\"token punctuation\">)</span>\n0x11c      <span class=\"token number\">94</span>             memoize\n0x11d      <span class=\"token number\">30</span>             pop\n0x11e      4d0000         binint2 0x0\n0x121      <span class=\"token number\">94</span>             memoize\n\n\n<span class=\"token comment\"># loop 開始</span>\n0x122      <span class=\"token number\">30</span>             pop\n\nmemo0: getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo1: Flag\nmemo2: dict.get<span class=\"token punctuation\">(</span>builtins.globals<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>, f<span class=\"token punctuation\">)</span>.seek<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> -<span class=\"token operator\">></span> jmp\nmemo3: add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo4: mul<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo5: eq<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo6: getattr<span class=\"token punctuation\">(</span>Flag, __getitem__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span> -<span class=\"token operator\">></span> 多分入力値の取得\nmemo7: i <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n\n0x123      67320a         get <span class=\"token string\">\"2\"</span>                     <span class=\"token punctuation\">;</span> 0x124\n0x126      67330a         get <span class=\"token string\">\"3\"</span>                     <span class=\"token punctuation\">;</span> 0x127\n0x129      67300a         get <span class=\"token string\">\"0\"</span>                     <span class=\"token punctuation\">;</span> 0x12a\n0x12c      67360a         get <span class=\"token string\">\"6\"</span>                     <span class=\"token punctuation\">;</span> 0x12d\n0x12f      67370a         get <span class=\"token string\">\"7\"</span>                     <span class=\"token punctuation\">;</span> 0x130\n// jmp\n// add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\n0x132      <span class=\"token number\">85</span>             tuple1\n0x133      <span class=\"token number\">52</span>             reduce\n// jmp\n// add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// Flag<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>, __le__\n\n0x134      8c065f5f6c65.  short_binunicode <span class=\"token string\">\"__le__\"</span>   <span class=\"token punctuation\">;</span> 0x136\n0x13c      <span class=\"token number\">86</span>             tuple2\n0x13d      <span class=\"token number\">52</span>             reduce\n// jmp\n// add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// getattr<span class=\"token variable\"><span class=\"token punctuation\">((</span>Flag[<span class=\"token number\">0</span>]<span class=\"token punctuation\">,</span> __le__<span class=\"token punctuation\">))</span></span>\n\n0x13e      4d7f00         binint2 0x7f                <span class=\"token punctuation\">;</span> <span class=\"token string\">'\\x7f'</span>\n0x141      <span class=\"token number\">85</span>             tuple1\n0x142      <span class=\"token number\">52</span>             reduce\n// jmp\n// add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// <span class=\"token punctuation\">(</span>Flag<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;=</span> 0x7f<span class=\"token punctuation\">)</span>\n// 0x14a\n\n0x143      4d4a01         binint2 0x14a\n0x146      <span class=\"token number\">86</span>             tuple2\n0x147      <span class=\"token number\">52</span>             reduce\n0x148      <span class=\"token number\">85</span>             tuple1\n0x149      <span class=\"token number\">52</span>             reduce\n0x14a      2e             stop\n// jmp\n// add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// <span class=\"token punctuation\">(</span>Flag<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;=</span> 0x7f<span class=\"token punctuation\">)</span>\n// 0x14a\n\n0x14b      <span class=\"token number\">30</span>             pop\n\n\nmemo0: getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo1: Flag\nmemo2: dict.get<span class=\"token punctuation\">(</span>builtins.globals<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>, f<span class=\"token punctuation\">)</span>.seek<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> -<span class=\"token operator\">></span> jmp\nmemo3: add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo4: mul<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo5: eq<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo6: getattr<span class=\"token punctuation\">(</span>Flag, __getitem__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span> -<span class=\"token operator\">></span> 多分入力値の取得\nmemo7: i <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n\n0x14c      67320a         get <span class=\"token string\">\"2\"</span>                     <span class=\"token punctuation\">;</span> 0x14d\n0x14f      67330a         get <span class=\"token string\">\"3\"</span>                     <span class=\"token punctuation\">;</span> 0x150\n0x152      67340a         get <span class=\"token string\">\"4\"</span>                     <span class=\"token punctuation\">;</span> 0x153\n0x155      67350a         get <span class=\"token string\">\"5\"</span>                     <span class=\"token punctuation\">;</span> 0x156\n0x158      67330a         get <span class=\"token string\">\"3\"</span>                     <span class=\"token punctuation\">;</span> 0x159\n0x15b      67370a         get <span class=\"token string\">\"7\"</span>                     <span class=\"token punctuation\">;</span> 0x15c\n0x15e      4d0100         binint2 0x1\n0x161      <span class=\"token number\">86</span>             tuple2\n0x162      <span class=\"token number\">52</span>             reduce\n0x163      70370a         put <span class=\"token string\">\"7\"</span>                     <span class=\"token punctuation\">;</span> 0x164\n// jmp\n// add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// mul<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// eq<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// <span class=\"token number\">1</span>\n\nmemo0: getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo1: Flag\nmemo2: dict.get<span class=\"token punctuation\">(</span>builtins.globals<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>, f<span class=\"token punctuation\">)</span>.seek<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> -<span class=\"token operator\">></span> jmp\nmemo3: add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo4: mul<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo5: eq<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo6: getattr<span class=\"token punctuation\">(</span>Flag, __getitem__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span> -<span class=\"token operator\">></span> 多分入力値の取得\nmemo7: i <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n\n0x166      4d4000         binint2 0x40                <span class=\"token punctuation\">;</span> <span class=\"token string\">'@'</span>\n0x169      <span class=\"token number\">86</span>             tuple2\n// jmp\n// add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// mul<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// eq<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// <span class=\"token punctuation\">(</span><span class=\"token number\">1</span>, 0x40<span class=\"token punctuation\">)</span>\n\n0x16a      <span class=\"token number\">52</span>             reduce\n0x16b      4d5500         binint2 0x55                <span class=\"token punctuation\">;</span> <span class=\"token string\">'U'</span>\n0x16e      <span class=\"token number\">86</span>             tuple2\n0x16f      <span class=\"token number\">52</span>             reduce\n// jmp\n// add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// mul<span class=\"token variable\"><span class=\"token punctuation\">((</span>eq<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x40</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x55</span><span class=\"token punctuation\">))</span></span>\n\n0x170      4d2201         binint2 0x122\n0x173      <span class=\"token number\">86</span>             tuple2\n// jmp\n// add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// <span class=\"token punctuation\">(</span>mul<span class=\"token variable\"><span class=\"token punctuation\">((</span>eq<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x40</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x55</span><span class=\"token punctuation\">))</span></span>, 0x122<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># i が 0x40 になるまでループ</span>\n<span class=\"token comment\"># すべての文字が ASCII 空間にあることを確認</span>\n0x174      <span class=\"token number\">52</span>             reduce\n0x175      <span class=\"token number\">85</span>             tuple1\n0x176      <span class=\"token number\">52</span>             reduce\n// jmp\n// <span class=\"token function\">add</span><span class=\"token variable\"><span class=\"token punctuation\">((</span>mul<span class=\"token punctuation\">((</span>eq<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x40</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x55</span><span class=\"token punctuation\">))</span></span>, 0x122<span class=\"token punctuation\">))</span>\n\n\nmemo0: getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo1: Flag\nmemo2: dict.get<span class=\"token punctuation\">(</span>builtins.globals<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>, f<span class=\"token punctuation\">)</span>.seek<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> -<span class=\"token operator\">></span> jmp\nmemo3: add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo4: mul<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo5: eq<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo6: getattr<span class=\"token punctuation\">(</span>Flag, __getitem__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span> -<span class=\"token operator\">></span> 多分入力値の取得\nmemo7: i <span class=\"token operator\">=</span> 0x40\n\n0x177      <span class=\"token number\">30</span>             pop\n0x178      67300a         get <span class=\"token string\">\"0\"</span>                     <span class=\"token punctuation\">;</span> 0x179\n0x17b      67300a         get <span class=\"token string\">\"0\"</span>                     <span class=\"token punctuation\">;</span> 0x17c\n0x17e      5d             empty_list\n0x17f      <span class=\"token number\">94</span>             memoize\n// getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// empty_list\n\nmemo0: getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo1: Flag\nmemo2: dict.get<span class=\"token punctuation\">(</span>builtins.globals<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>, f<span class=\"token punctuation\">)</span>.seek<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> -<span class=\"token operator\">></span> jmp\nmemo3: add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo4: mul<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo5: eq<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo6: getattr<span class=\"token punctuation\">(</span>Flag, __getitem__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span> -<span class=\"token operator\">></span> 多分入力値の取得\nmemo7: i <span class=\"token operator\">=</span> 0x40\nmemo8: <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n0x180      8c0661707065.  short_binunicode <span class=\"token string\">\"append\"</span>   <span class=\"token punctuation\">;</span> 0x182\n0x188      <span class=\"token number\">86</span>             tuple2\n0x189      <span class=\"token number\">52</span>             reduce\n// getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// getattr<span class=\"token variable\"><span class=\"token punctuation\">((</span>empty_list<span class=\"token punctuation\">,</span> append<span class=\"token punctuation\">))</span></span>\n\n0x18a      <span class=\"token number\">94</span>             memoize\n\nmemo0: getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo1: Flag\nmemo2: dict.get<span class=\"token punctuation\">(</span>builtins.globals<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>, f<span class=\"token punctuation\">)</span>.seek<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> -<span class=\"token operator\">></span> jmp\nmemo3: add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo4: mul<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo5: eq<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo6: getattr<span class=\"token punctuation\">(</span>Flag, __getitem__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span> -<span class=\"token operator\">></span> 多分入力値の取得\nmemo7: i <span class=\"token operator\">=</span> 0x40\nmemo8: <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\nmemo9: memo8 への append\n\n0x18b      <span class=\"token number\">30</span>             pop\n// getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n0x18c      67380a         get <span class=\"token string\">\"8\"</span>                     <span class=\"token punctuation\">;</span> 0x18d\n0x18f      8c0b5f5f6765.  short_binunicode <span class=\"token string\">\"__getitem__\"</span> <span class=\"token punctuation\">;</span> 0x191\n0x19c      <span class=\"token number\">86</span>             tuple2\n0x19d      <span class=\"token number\">52</span>             reduce\n0x19e      <span class=\"token number\">94</span>             memoize\n// getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>, __getitem__<span class=\"token punctuation\">)</span>\n\nmemo0: getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo1: Flag\nmemo2: dict.get<span class=\"token punctuation\">(</span>builtins.globals<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>, f<span class=\"token punctuation\">)</span>.seek<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> -<span class=\"token operator\">></span> jmp\nmemo3: add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo4: mul<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo5: eq<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo6: getattr<span class=\"token punctuation\">(</span>Flag, __getitem__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span> -<span class=\"token operator\">></span> 多分入力値の取得\nmemo7: i <span class=\"token operator\">=</span> 0x40\nmemo8: <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\nmemo9: memo8 への append\nmemo10: index を指定して memo8 から値を取得\n\n0x19f      <span class=\"token number\">30</span>             pop\n\n0x1a0      67300a         get <span class=\"token string\">\"0\"</span>                     <span class=\"token punctuation\">;</span> 0x1a1\n0x1a3      8c086275696c.  short_binunicode <span class=\"token string\">\"builtins\"</span> <span class=\"token punctuation\">;</span> 0x1a5\n0x1ad      8c03696e74     short_binunicode <span class=\"token string\">\"int\"</span>      <span class=\"token punctuation\">;</span> 0x1af\n0x1b2      <span class=\"token number\">93</span>             stack_global\n0x1b3      8c0a66726f6d.  short_binunicode <span class=\"token string\">\"from_bytes\"</span> <span class=\"token punctuation\">;</span> 0x1b5\n0x1bf      <span class=\"token number\">86</span>             tuple2\n0x1c0      <span class=\"token number\">52</span>             reduce\n// getattr<span class=\"token punctuation\">(</span>int, from_bytes<span class=\"token punctuation\">)</span>\n\n0x1c1      <span class=\"token number\">94</span>             memoize\n0x1c2      <span class=\"token number\">30</span>             pop\n\nmemo0: getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo1: Flag\nmemo2: dict.get<span class=\"token punctuation\">(</span>builtins.globals<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>, f<span class=\"token punctuation\">)</span>.seek<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> -<span class=\"token operator\">></span> jmp\nmemo3: add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo4: mul<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo5: eq<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo6: getattr<span class=\"token punctuation\">(</span>Flag, __getitem__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span> -<span class=\"token operator\">></span> 多分入力値の取得\nmemo7: i <span class=\"token operator\">=</span> 0x40\nmemo8: <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\nmemo9: memo8 への append\nmemo10: index を指定して memo8 から値を取得\nmemo11: int.from_bytes<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n0x1c3      4d0000         binint2 0x0\n0x1c6      70370a         put <span class=\"token string\">\"7\"</span>                     <span class=\"token punctuation\">;</span> 0x1c7\n\n\n<span class=\"token comment\"># ループ</span>\n0x1c9      <span class=\"token number\">30</span>             pop\n\nmemo0: getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo1: Flag\nmemo2: dict.get<span class=\"token punctuation\">(</span>builtins.globals<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>, f<span class=\"token punctuation\">)</span>.seek<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> -<span class=\"token operator\">></span> jmp\nmemo3: add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo4: mul<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo5: eq<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo6: getattr<span class=\"token punctuation\">(</span>Flag, __getitem__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span> -<span class=\"token operator\">></span> 多分入力値の取得\nmemo7: i <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\nmemo8: <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\nmemo9: memo8 への append\nmemo10: index を指定して memo8 から値を取得\nmemo11: int.from_bytes<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\n0x1ca      67390a         get <span class=\"token string\">\"9\"</span>                     <span class=\"token punctuation\">;</span> 0x1cb\n0x1cd      6731310a       get <span class=\"token string\">\"11\"</span>                    <span class=\"token punctuation\">;</span> 0x1ce\n0x1d1      67360a         get <span class=\"token string\">\"6\"</span>                     <span class=\"token punctuation\">;</span> 0x1d2\n0x1d4      8c086275696c.  short_binunicode <span class=\"token string\">\"builtins\"</span> <span class=\"token punctuation\">;</span> 0x1d6\n0x1de      8c05736c6963.  short_binunicode <span class=\"token string\">\"slice\"</span>    <span class=\"token punctuation\">;</span> 0x1e0\n0x1e5      <span class=\"token number\">93</span>             stack_global\n0x1e6      67340a         get <span class=\"token string\">\"4\"</span>                     <span class=\"token punctuation\">;</span> 0x1e7\n0x1e9      67370a         get <span class=\"token string\">\"7\"</span>                     <span class=\"token punctuation\">;</span> 0x1ea\n0x1ec      4d0800         binint2 0x8\n// m8.append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// int.from_bytes<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// flag<span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span>\n// slice\n// mul<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// i <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n// 0x8\n\n0x1ef      <span class=\"token number\">86</span>             tuple2\n0x1f0      <span class=\"token number\">52</span>             reduce\n// m8.append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// int.from_bytes<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// flag<span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span>\n// slice\n// mul<span class=\"token punctuation\">(</span>i, 0x8<span class=\"token punctuation\">)</span>\n\n0x1f1      67340a         get <span class=\"token string\">\"4\"</span>                     <span class=\"token punctuation\">;</span> 0x1f2\n0x1f4      67330a         get <span class=\"token string\">\"3\"</span>                     <span class=\"token punctuation\">;</span> 0x1f5\n0x1f7      67370a         get <span class=\"token string\">\"7\"</span>                     <span class=\"token punctuation\">;</span> 0x1f8\n0x1fa      4d0100         binint2 0x1\n// m8.append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// int.from_bytes<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// flag<span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span>\n// slice\n// mul<span class=\"token punctuation\">(</span>i, 0x8<span class=\"token punctuation\">)</span>\n// mul<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// i <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n// <span class=\"token number\">1</span>\n\n0x1fd      <span class=\"token number\">86</span>             tuple2\n0x1fe      <span class=\"token number\">52</span>             reduce\n0x1ff      4d0800         binint2 0x8\n0x202      <span class=\"token number\">86</span>             tuple2\n0x203      <span class=\"token number\">52</span>             reduce\n0x204      <span class=\"token number\">86</span>             tuple2\n0x205      <span class=\"token number\">52</span>             reduce\n0x206      <span class=\"token number\">85</span>             tuple1\n\n// m8.append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// int.from_bytes<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// flag<span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span>\n// slice<span class=\"token punctuation\">[</span>mul<span class=\"token punctuation\">(</span>i, 0x8<span class=\"token punctuation\">)</span>, mul<span class=\"token punctuation\">(</span>add<span class=\"token punctuation\">(</span>i + <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>, <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n\n0x207      <span class=\"token number\">52</span>             reduce\n// m8.append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// int.from_bytes<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// flag<span class=\"token punctuation\">[</span>i*8:<span class=\"token punctuation\">(</span>i+1<span class=\"token punctuation\">)</span>*8<span class=\"token punctuation\">]</span>\n\n0x208      8c066c697474.  short_binunicode <span class=\"token string\">\"little\"</span>   <span class=\"token punctuation\">;</span> 0x20a\n0x210      <span class=\"token number\">86</span>             tuple2\n0x211      <span class=\"token number\">52</span>             reduce\n// m8.append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// int.from_bytes<span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">[</span>i*8:<span class=\"token punctuation\">(</span>i+1<span class=\"token punctuation\">)</span>*8<span class=\"token punctuation\">]</span>, little<span class=\"token punctuation\">)</span>\n\n0x212      <span class=\"token number\">85</span>             tuple1\n0x213      <span class=\"token number\">52</span>             reduce\n0x214      <span class=\"token number\">30</span>             pop\n\n<span class=\"token comment\"># 8 バイトずつ Flag 文字を int 化して抜き出して m8 に追加</span>\nmemo0: getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo1: Flag\nmemo2: dict.get<span class=\"token punctuation\">(</span>builtins.globals<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>, f<span class=\"token punctuation\">)</span>.seek<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> -<span class=\"token operator\">></span> jmp\nmemo3: add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo4: mul<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo5: eq<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo6: getattr<span class=\"token punctuation\">(</span>Flag, __getitem__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span> -<span class=\"token operator\">></span> 多分入力値の取得\nmemo7: i <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\nmemo8: <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\nmemo9: memo8 への append\nmemo10: index を指定して memo8 から値を取得\nmemo11: int.from_bytes<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\n0x215      67320a         get <span class=\"token string\">\"2\"</span>                     <span class=\"token punctuation\">;</span> 0x216\n0x218      67330a         get <span class=\"token string\">\"3\"</span>                     <span class=\"token punctuation\">;</span> 0x219\n0x21b      67340a         get <span class=\"token string\">\"4\"</span>                     <span class=\"token punctuation\">;</span> 0x21c\n0x21e      67350a         get <span class=\"token string\">\"5\"</span>                     <span class=\"token punctuation\">;</span> 0x21f\n0x221      67330a         get <span class=\"token string\">\"3\"</span>                     <span class=\"token punctuation\">;</span> 0x222\n0x224      67370a         get <span class=\"token string\">\"7\"</span>                     <span class=\"token punctuation\">;</span> 0x225\n0x227      4d0100         binint2 0x1\n0x22a      <span class=\"token number\">86</span>             tuple2\n0x22b      <span class=\"token number\">52</span>             reduce\n// jmp\n// add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// mul<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// eq<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// add<span class=\"token punctuation\">(</span>i + <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n0x22c      70370a         put <span class=\"token string\">\"7\"</span>                     <span class=\"token punctuation\">;</span> 0x22d\n0x22f      4d0800         binint2 0x8\n0x232      <span class=\"token number\">86</span>             tuple2\n0x233      <span class=\"token number\">52</span>             reduce\n0x234      4d7700         binint2 0x77                <span class=\"token punctuation\">;</span> <span class=\"token string\">'w'</span>\n0x237      <span class=\"token number\">86</span>             tuple2\n0x238      <span class=\"token number\">52</span>             reduce\n0x239      4dc901         binint2 0x1c9\n0x23c      <span class=\"token number\">86</span>             tuple2\n0x23d      <span class=\"token number\">52</span>             reduce\n<span class=\"token comment\"># i を上書き</span>\n// jmp\n// add<span class=\"token punctuation\">(</span>mul<span class=\"token punctuation\">(</span>eq<span class=\"token punctuation\">(</span>add<span class=\"token punctuation\">(</span>i + <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>, 0x8<span class=\"token punctuation\">)</span>, 0x77<span class=\"token punctuation\">)</span>, 0x1c9<span class=\"token punctuation\">)</span>\n\n0x23e      <span class=\"token number\">85</span>             tuple1\n0x23f      <span class=\"token number\">52</span>             reduce\n\n\n<span class=\"token comment\"># 8 バイトずつ Flag 文字を int 化して抜き出して m8 に追加</span>\nmemo0: getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo1: Flag\nmemo2: dict.get<span class=\"token punctuation\">(</span>builtins.globals<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>, f<span class=\"token punctuation\">)</span>.seek<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> -<span class=\"token operator\">></span> jmp\nmemo3: add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo4: mul<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo5: eq<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo6: getattr<span class=\"token punctuation\">(</span>Flag, __getitem__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span> -<span class=\"token operator\">></span> 多分入力値の取得\nmemo7: i <span class=\"token operator\">=</span> <span class=\"token number\">8</span>\nmemo8: <span class=\"token punctuation\">[</span><span class=\"token operator\">&lt;</span>Flag の <span class=\"token number\">8</span> バイトごとに little<span class=\"token operator\">></span><span class=\"token punctuation\">]</span>\nmemo9: memo8 への append\nmemo10: index を指定して memo8 から値を取得\nmemo11: int.from_bytes<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># i が 8 ならループを抜ける</span>\n0x240      <span class=\"token number\">30</span>             pop\n0x241      67300a         get <span class=\"token string\">\"0\"</span>                     <span class=\"token punctuation\">;</span> 0x242\n0x244      5d             empty_list\n0x245      <span class=\"token number\">94</span>             memoize\n// getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// empty_list\n\nmemo0: getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo1: Flag\nmemo2: dict.get<span class=\"token punctuation\">(</span>builtins.globals<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>, f<span class=\"token punctuation\">)</span>.seek<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> -<span class=\"token operator\">></span> jmp\nmemo3: add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo4: mul<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo5: eq<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo6: getattr<span class=\"token punctuation\">(</span>Flag, __getitem__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span> -<span class=\"token operator\">></span> 多分入力値の取得\nmemo7: i <span class=\"token operator\">=</span> <span class=\"token number\">8</span>\nmemo8: arr1 <span class=\"token punctuation\">[</span><span class=\"token operator\">&lt;</span>Flag の <span class=\"token number\">8</span> バイトごとに little<span class=\"token operator\">></span><span class=\"token punctuation\">]</span>\nmemo9: memo8 への append\nmemo10: index を指定して memo8 から値を取得\nmemo11: int.from_bytes<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo12: arr2 <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n0x246      8c0661707065.  short_binunicode <span class=\"token string\">\"append\"</span>   <span class=\"token punctuation\">;</span> 0x248\n0x24e      <span class=\"token number\">86</span>             tuple2\n0x24f      <span class=\"token number\">52</span>             reduce\n// getattr<span class=\"token punctuation\">(</span>empty_list, append<span class=\"token punctuation\">)</span>\n\n0x250      <span class=\"token number\">94</span>             memoize\n0x251      <span class=\"token number\">30</span>             pop\n\nmemo0: getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo1: Flag\nmemo2: dict.get<span class=\"token punctuation\">(</span>builtins.globals<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>, f<span class=\"token punctuation\">)</span>.seek<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> -<span class=\"token operator\">></span> jmp\nmemo3: add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo4: mul<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo5: eq<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo6: getattr<span class=\"token punctuation\">(</span>Flag, __getitem__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span> -<span class=\"token operator\">></span> 多分入力値の取得\nmemo7: i <span class=\"token operator\">=</span> <span class=\"token number\">8</span>\nmemo8: arr1 <span class=\"token punctuation\">[</span><span class=\"token operator\">&lt;</span>Flag の <span class=\"token number\">8</span> バイトごとに little<span class=\"token operator\">></span><span class=\"token punctuation\">]</span>\nmemo9: memo8 への append\nmemo10: index を指定して memo8 から値を取得\nmemo11: int.from_bytes<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo12: arr2 <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\nmemo13: memo12 への append\n\n0x252      67300a         get <span class=\"token string\">\"0\"</span>                     <span class=\"token punctuation\">;</span> 0x253\n0x255      6731320a       get <span class=\"token string\">\"12\"</span>                    <span class=\"token punctuation\">;</span> 0x256\n0x259      8c0b5f5f6765.  short_binunicode <span class=\"token string\">\"__getitem__\"</span> <span class=\"token punctuation\">;</span> 0x25b\n0x266      <span class=\"token number\">86</span>             tuple2\n0x267      <span class=\"token number\">52</span>             reduce\n0x268      <span class=\"token number\">94</span>             memoize\n0x269      <span class=\"token number\">30</span>             pop\nmemo0: getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo1: Flag\nmemo2: dict.get<span class=\"token punctuation\">(</span>builtins.globals<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>, f<span class=\"token punctuation\">)</span>.seek<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> -<span class=\"token operator\">></span> jmp\nmemo3: add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo4: mul<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo5: eq<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo6: getattr<span class=\"token punctuation\">(</span>Flag, __getitem__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span> -<span class=\"token operator\">></span> 多分入力値の取得\nmemo7: i <span class=\"token operator\">=</span> <span class=\"token number\">8</span>\nmemo8: arr1 <span class=\"token punctuation\">[</span><span class=\"token operator\">&lt;</span>Flag の <span class=\"token number\">8</span> バイトごとに little<span class=\"token operator\">></span><span class=\"token punctuation\">]</span>\nmemo9: memo8 への append\nmemo10: index を指定して memo8 から値を取得\nmemo11: int.from_bytes<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo12: arr2 <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\nmemo13: memo12 への append\nmemo14: index を指定して memo12 から値を取得\n\n\n0x26a      67300a         get <span class=\"token string\">\"0\"</span>                     <span class=\"token punctuation\">;</span> 0x26b\n0x26d      8c086275696c.  short_binunicode <span class=\"token string\">\"builtins\"</span> <span class=\"token punctuation\">;</span> 0x26f\n0x277      8c03696e74     short_binunicode <span class=\"token string\">\"int\"</span>      <span class=\"token punctuation\">;</span> 0x279\n0x27c      <span class=\"token number\">93</span>             stack_global\n0x27d      8c075f5f786f.  short_binunicode <span class=\"token string\">\"__xor__\"</span>  <span class=\"token punctuation\">;</span> 0x27f\n0x286      <span class=\"token number\">86</span>             tuple2\n0x287      <span class=\"token number\">52</span>             reduce\n// getattr<span class=\"token punctuation\">(</span>int, xor<span class=\"token punctuation\">)</span>\n0x288      <span class=\"token number\">94</span>             memoize\n0x289      <span class=\"token number\">30</span>             pop\n\nmemo0: getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo1: Flag\nmemo2: dict.get<span class=\"token punctuation\">(</span>builtins.globals<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>, f<span class=\"token punctuation\">)</span>.seek<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> -<span class=\"token operator\">></span> jmp\nmemo3: add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo4: mul<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo5: eq<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo6: getattr<span class=\"token punctuation\">(</span>Flag, __getitem__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span> -<span class=\"token operator\">></span> 多分入力値の取得\nmemo7: i <span class=\"token operator\">=</span> <span class=\"token number\">8</span>\nmemo8: arr1 <span class=\"token punctuation\">[</span><span class=\"token operator\">&lt;</span>Flag の <span class=\"token number\">8</span> バイトごとに little<span class=\"token operator\">></span><span class=\"token punctuation\">]</span>\nmemo9: memo8 への append\nmemo10: index を指定して memo8 から値を取得\nmemo11: int.from_bytes<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo12: arr2 <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\nmemo13: memo12 への append\nmemo14: index を指定して memo12 から値を取得\nmemo15: int.xor<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n0x28a      <span class=\"token number\">493132343434</span>.  int <span class=\"token string\">\"1244422970072434993\"</span>   <span class=\"token punctuation\">;</span> 0x28b\n0x29f      <span class=\"token number\">94</span>             memoize\n0x2a0      <span class=\"token number\">30</span>             pop\n0x2a1      4d0000         binint2 0x0\n0x2a4      70370a         put <span class=\"token string\">\"7\"</span>                     <span class=\"token punctuation\">;</span> 0x2a5\n0x2a7      <span class=\"token number\">30</span>             pop\n\nmemo0: getattr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo1: Flag\nmemo2: dict.get<span class=\"token punctuation\">(</span>builtins.globals<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>, f<span class=\"token punctuation\">)</span>.seek<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> -<span class=\"token operator\">></span> jmp\nmemo3: add<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo4: mul<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo5: eq<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo6: getattr<span class=\"token punctuation\">(</span>Flag, __getitem__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span> -<span class=\"token operator\">></span> 多分入力値の取得\nmemo7: i <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\nmemo8: arr1 <span class=\"token punctuation\">[</span><span class=\"token operator\">&lt;</span>Flag の <span class=\"token number\">8</span> バイトごとに little<span class=\"token operator\">></span><span class=\"token punctuation\">]</span>\nmemo9: memo8 への append\nmemo10: index を指定して memo8 から値を取得\nmemo11: int.from_bytes<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo12: arr2 <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\nmemo13: memo12 への append\nmemo14: index を指定して memo12 から値を取得\nmemo15: int.xor<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmemo16: key <span class=\"token operator\">=</span> <span class=\"token number\">1244422970072434993</span>\n\n0x2a8      6731330a       get <span class=\"token string\">\"13\"</span>                    <span class=\"token punctuation\">;</span> 0x2a9\n0x2ac      8c086275696c.  short_binunicode <span class=\"token string\">\"builtins\"</span> <span class=\"token punctuation\">;</span> 0x2ae\n0x2b6      8c03706f77     short_binunicode <span class=\"token string\">\"pow\"</span>      <span class=\"token punctuation\">;</span> 0x2b8\n0x2bb      <span class=\"token number\">93</span>             stack_global\n// arr2.append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// pow\n\n0x2bc      6731350a       get <span class=\"token string\">\"15\"</span>                    <span class=\"token punctuation\">;</span> 0x2bd\n0x2c0      6731300a       get <span class=\"token string\">\"10\"</span>                    <span class=\"token punctuation\">;</span> 0x2c1\n0x2c4      67370a         get <span class=\"token string\">\"7\"</span>                     <span class=\"token punctuation\">;</span> 0x2c5\n0x2c7      <span class=\"token number\">85</span>             tuple1\n0x2c8      <span class=\"token number\">52</span>             reduce\n0x2c9      6731360a       get <span class=\"token string\">\"16\"</span>                    <span class=\"token punctuation\">;</span> 0x2ca <span class=\"token punctuation\">;</span> <span class=\"token string\">\"16<span class=\"token entity\" title=\"\\n\">\\n</span><span class=\"token entity\" title=\"\\x86\">\\x86</span>RI65537<span class=\"token entity\" title=\"\\n\">\\n</span>I18446744073709551557<span class=\"token entity\" title=\"\\n\">\\n</span><span class=\"token entity\" title=\"\\x87\">\\x87</span>R<span class=\"token entity\" title=\"\\x85\">\\x85</span>R0g14<span class=\"token entity\" title=\"\\n\">\\n</span>g7<span class=\"token entity\" title=\"\\n\">\\n</span><span class=\"token entity\" title=\"\\x85\">\\x85</span>Rp16<span class=\"token entity\" title=\"\\n\">\\n</span>0g2<span class=\"token entity\" title=\"\\n\">\\n</span>g3<span class=\"token entity\" title=\"\\n\">\\n</span>g4<span class=\"token entity\" title=\"\\n\">\\n</span>g5<span class=\"token entity\" title=\"\\n\">\\n</span>g3<span class=\"token entity\" title=\"\\n\">\\n</span>g7<span class=\"token entity\" title=\"\\n\">\\n</span>M<span class=\"token entity\" title=\"\\x01\">\\x01</span>\"</span>\n0x2cd      <span class=\"token number\">86</span>             tuple2\n0x2ce      <span class=\"token number\">52</span>             reduce\n// arr2.append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// pow<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// xor<span class=\"token punctuation\">(</span>arr1<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span>, <span class=\"token number\">1244422970072434993</span><span class=\"token punctuation\">))</span>\n\n\n0x2cf      <span class=\"token number\">493635353337</span>.  int <span class=\"token string\">\"65537\"</span>                 <span class=\"token punctuation\">;</span> 0x2d0\n0x2d6      <span class=\"token number\">493138343436</span>.  int <span class=\"token string\">\"18446744073709551557\"</span>  <span class=\"token punctuation\">;</span> 0x2d7\n0x2ec      <span class=\"token number\">87</span>             tuple3\n0x2ed      <span class=\"token number\">52</span>             reduce\n// arr2.append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n// pow<span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">(</span>xor<span class=\"token punctuation\">(</span>arr1<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span>, <span class=\"token number\">1244422970072434993</span><span class=\"token punctuation\">)</span>, <span class=\"token number\">65537</span>, <span class=\"token number\">18446744073709551557</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span>\n\n0x2ee      <span class=\"token number\">85</span>             tuple1\n0x2ef      <span class=\"token number\">52</span>             reduce\n0x2f0      <span class=\"token number\">30</span>             pop\n<span class=\"token comment\"># 結果を memo12 に append</span>\n\n0x2f1      6731340a       get <span class=\"token string\">\"14\"</span>                    <span class=\"token punctuation\">;</span> 0x2f2 <span class=\"token punctuation\">;</span> <span class=\"token string\">\"14<span class=\"token entity\" title=\"\\n\">\\n</span>g7<span class=\"token entity\" title=\"\\n\">\\n</span><span class=\"token entity\" title=\"\\x85\">\\x85</span>Rp16<span class=\"token entity\" title=\"\\n\">\\n</span>0g2<span class=\"token entity\" title=\"\\n\">\\n</span>g3<span class=\"token entity\" title=\"\\n\">\\n</span>g4<span class=\"token entity\" title=\"\\n\">\\n</span>g5<span class=\"token entity\" title=\"\\n\">\\n</span>g3<span class=\"token entity\" title=\"\\n\">\\n</span>g7<span class=\"token entity\" title=\"\\n\">\\n</span>M<span class=\"token entity\" title=\"\\x01\">\\x01</span>\"</span>\n0x2f5      67370a         get <span class=\"token string\">\"7\"</span>                     <span class=\"token punctuation\">;</span> 0x2f6\n0x2f8      <span class=\"token number\">85</span>             tuple1\n// index を指定して memo12 から値を取得\n// i <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n\n0x2f9      <span class=\"token number\">52</span>             reduce\n0x2fa      7031360a       put <span class=\"token string\">\"16\"</span>                    <span class=\"token punctuation\">;</span> 0x2fb\n0x2fe      <span class=\"token number\">30</span>             pop\n\n<span class=\"token comment\"># 直前の暗号化処理を行った値を次の XOR キーに指定</span>\n0x2ff      67320a         get <span class=\"token string\">\"2\"</span>                     <span class=\"token punctuation\">;</span> 0x300\n0x302      67330a         get <span class=\"token string\">\"3\"</span>                     <span class=\"token punctuation\">;</span> 0x303\n0x305      67340a         get <span class=\"token string\">\"4\"</span>                     <span class=\"token punctuation\">;</span> 0x306\n0x308      67350a         get <span class=\"token string\">\"5\"</span>                     <span class=\"token punctuation\">;</span> 0x309\n0x30b      67330a         get <span class=\"token string\">\"3\"</span>                     <span class=\"token punctuation\">;</span> 0x30c\n0x30e      67370a         get <span class=\"token string\">\"7\"</span>                     <span class=\"token punctuation\">;</span> 0x30f\n0x311      4d0100         binint2 0x1\n0x314      <span class=\"token number\">86</span>             tuple2\n0x315      <span class=\"token number\">52</span>             reduce\n0x316      70370a         put <span class=\"token string\">\"7\"</span>                     <span class=\"token punctuation\">;</span> 0x317\n0x319      4d0800         binint2 0x8\n0x31c      <span class=\"token number\">86</span>             tuple2\n0x31d      <span class=\"token number\">52</span>             reduce\n0x31e      4d8300         binint2 0x83\n0x321      <span class=\"token number\">86</span>             tuple2\n0x322      <span class=\"token number\">52</span>             reduce\n0x323      4da702         binint2 0x2a7\n0x326      <span class=\"token number\">86</span>             tuple2\n0x327      <span class=\"token number\">52</span>             reduce\n0x328      <span class=\"token number\">85</span>             tuple1\n0x329      <span class=\"token number\">52</span>             reduce\n0x32a      <span class=\"token number\">30</span>             pop\n0x32b      67300a         get <span class=\"token string\">\"0\"</span>                     <span class=\"token punctuation\">;</span> 0x32c\n0x32e      6731320a       get <span class=\"token string\">\"12\"</span>                    <span class=\"token punctuation\">;</span> 0x32f\n0x332      8c065f5f6571.  short_binunicode <span class=\"token string\">\"__eq__\"</span>   <span class=\"token punctuation\">;</span> 0x334 <span class=\"token punctuation\">;</span> <span class=\"token string\">\"__eq__<span class=\"token entity\" title=\"\\x86\">\\x86</span>R(I8215359690687096682<span class=\"token entity\" title=\"\\n\">\\n</span>I1862662588367509514<span class=\"token entity\" title=\"\\n\">\\n</span>I8350772864914849965<span class=\"token entity\" title=\"\\n\">\\n</span>I11616510986494699232<span class=\"token entity\" title=\"\\n\">\\n</span>I3711648467207374797<span class=\"token entity\" title=\"\\n\">\\n</span>I9722127090168848805<span class=\"token entity\" title=\"\\n\">\\n</span>I16780197523811627561<span class=\"token entity\" title=\"\\n\">\\n</span>I18138828537077112905<span class=\"token entity\" title=\"\\n\">\\n</span>l<span class=\"token entity\" title=\"\\x85\">\\x85</span>R.\"</span>\n0x33a      <span class=\"token number\">86</span>             tuple2\n0x33b      <span class=\"token number\">52</span>             reduce\n0x33c      <span class=\"token number\">28</span>             mark\n0x33d      <span class=\"token number\">493832313533</span>.  int <span class=\"token string\">\"8215359690687096682\"</span>   <span class=\"token punctuation\">;</span> 0x33e <span class=\"token punctuation\">;</span> <span class=\"token string\">\"8215359690687096682<span class=\"token entity\" title=\"\\n\">\\n</span>I1862662588367509514<span class=\"token entity\" title=\"\\n\">\\n</span>I8350772864914849965<span class=\"token entity\" title=\"\\n\">\\n</span>I11616510986494699232<span class=\"token entity\" title=\"\\n\">\\n</span>I3711648467207374797<span class=\"token entity\" title=\"\\n\">\\n</span>I9722127090168848805<span class=\"token entity\" title=\"\\n\">\\n</span>I16780197523811627561<span class=\"token entity\" title=\"\\n\">\\n</span>I18138828537077112905<span class=\"token entity\" title=\"\\n\">\\n</span>l<span class=\"token entity\" title=\"\\x85\">\\x85</span>R.\"</span>\n0x352      <span class=\"token number\">493138363236</span>.  int <span class=\"token string\">\"1862662588367509514\"</span>   <span class=\"token punctuation\">;</span> 0x353 <span class=\"token punctuation\">;</span> <span class=\"token string\">\"1862662588367509514<span class=\"token entity\" title=\"\\n\">\\n</span>I8350772864914849965<span class=\"token entity\" title=\"\\n\">\\n</span>I11616510986494699232<span class=\"token entity\" title=\"\\n\">\\n</span>I3711648467207374797<span class=\"token entity\" title=\"\\n\">\\n</span>I9722127090168848805<span class=\"token entity\" title=\"\\n\">\\n</span>I16780197523811627561<span class=\"token entity\" title=\"\\n\">\\n</span>I18138828537077112905<span class=\"token entity\" title=\"\\n\">\\n</span>l<span class=\"token entity\" title=\"\\x85\">\\x85</span>R.\"</span>\n0x367      <span class=\"token number\">493833353037</span>.  int <span class=\"token string\">\"8350772864914849965\"</span>   <span class=\"token punctuation\">;</span> 0x368 <span class=\"token punctuation\">;</span> <span class=\"token string\">\"8350772864914849965<span class=\"token entity\" title=\"\\n\">\\n</span>I11616510986494699232<span class=\"token entity\" title=\"\\n\">\\n</span>I3711648467207374797<span class=\"token entity\" title=\"\\n\">\\n</span>I9722127090168848805<span class=\"token entity\" title=\"\\n\">\\n</span>I16780197523811627561<span class=\"token entity\" title=\"\\n\">\\n</span>I18138828537077112905<span class=\"token entity\" title=\"\\n\">\\n</span>l<span class=\"token entity\" title=\"\\x85\">\\x85</span>R.\"</span>\n0x37c      <span class=\"token number\">493131363136</span>.  int <span class=\"token string\">\"11616510986494699232\"</span>  <span class=\"token punctuation\">;</span> 0x37d <span class=\"token punctuation\">;</span> <span class=\"token string\">\"11616510986494699232<span class=\"token entity\" title=\"\\n\">\\n</span>I3711648467207374797<span class=\"token entity\" title=\"\\n\">\\n</span>I9722127090168848805<span class=\"token entity\" title=\"\\n\">\\n</span>I16780197523811627561<span class=\"token entity\" title=\"\\n\">\\n</span>I18138828537077112905<span class=\"token entity\" title=\"\\n\">\\n</span>l<span class=\"token entity\" title=\"\\x85\">\\x85</span>R.\"</span>\n0x392      <span class=\"token number\">493337313136</span>.  int <span class=\"token string\">\"3711648467207374797\"</span>   <span class=\"token punctuation\">;</span> 0x393 <span class=\"token punctuation\">;</span> <span class=\"token string\">\"3711648467207374797<span class=\"token entity\" title=\"\\n\">\\n</span>I9722127090168848805<span class=\"token entity\" title=\"\\n\">\\n</span>I16780197523811627561<span class=\"token entity\" title=\"\\n\">\\n</span>I18138828537077112905<span class=\"token entity\" title=\"\\n\">\\n</span>l<span class=\"token entity\" title=\"\\x85\">\\x85</span>R.\"</span>\n0x3a7      <span class=\"token number\">493937323231</span>.  int <span class=\"token string\">\"9722127090168848805\"</span>   <span class=\"token punctuation\">;</span> 0x3a8 <span class=\"token punctuation\">;</span> <span class=\"token string\">\"9722127090168848805<span class=\"token entity\" title=\"\\n\">\\n</span>I16780197523811627561<span class=\"token entity\" title=\"\\n\">\\n</span>I18138828537077112905<span class=\"token entity\" title=\"\\n\">\\n</span>l<span class=\"token entity\" title=\"\\x85\">\\x85</span>R.\"</span>\n0x3bc      <span class=\"token number\">493136373830</span>.  int <span class=\"token string\">\"16780197523811627561\"</span>  <span class=\"token punctuation\">;</span> 0x3bd <span class=\"token punctuation\">;</span> <span class=\"token string\">\"16780197523811627561<span class=\"token entity\" title=\"\\n\">\\n</span>I18138828537077112905<span class=\"token entity\" title=\"\\n\">\\n</span>l<span class=\"token entity\" title=\"\\x85\">\\x85</span>R.\"</span>\n0x3d2      <span class=\"token number\">493138313338</span>.  int <span class=\"token string\">\"18138828537077112905\"</span>  <span class=\"token punctuation\">;</span> 0x3d3\n0x3e8      6c             list\n0x3e9      <span class=\"token number\">85</span>             tuple1\n0x3ea      <span class=\"token number\">52</span>             reduce\n0x3eb      2e             stop</code></pre></div>\n<p>pickle によるデシリアライズは VM として動作します。</p>\n<p>基本操作は、「値をスタックに追加する」、「スタックの 1 つもしくは 2 つの値をタプル化する」、「スタックの 2 つの値(呼び出し可能タプルと引数タプル)を使用してコード実行」、「スタック上の値をメモに保存」の 4 つのみです。</p>\n<p>解析時のメモにコメントしている通り、上から愚直に「スタックにデータを追加 → タプル化 → 関数呼び出し」のような処理を順に繰り返していくと、最終的に以下のような処理を行っていることを特定できました。</p>\n<ol>\n<li>64 文字の Flag を 8 バイトごとに分割して little エンディアンで int 化して配列に格納</li>\n<li>\n<p>int 化した 8 つの値を以下の式で加工する。(この時、最初の key は 1244422970072434993 であるが、それ以降の key は直前に暗号化した結果が格納される)</p>\n<p><code class=\"language-text\">pow((xor(arr1[i], key), 65537, 18446744073709551557))</code></p>\n</li>\n<li>正しい Flag を入力した場合は、演算結果がハードコードされた long 値と一致する</li>\n</ol>\n<p>以上の結果から、ハードコードされた 8 つの long 値から平文を復号できれば Flag を取得することができそうです。</p>\n<p>ここで問題になるのは、秘密鍵の特定方法でした。</p>\n<p>暗号化の処理から、明らかに RSA 暗号を使用していると判断できます。</p>\n<p>しかし、秘密鍵は与えられておらず、n にあたる 18446744073709551557 も素数の積ではないため p,q の特定には至りませんでした。</p>\n<p>チームメンバーに相談したところ、<code class=\"language-text\">pow(e, -1, n)</code> の値が秘密鍵として復号に使えないかというドンピシャなアドバイスをもらいました。</p>\n<p>このアイデアを元に以下の Solver を作成した結果、暗号文を復号して正しい Flag を取得することができました。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> long_to_bytes\n\nans <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token number\">8215359690687096682</span><span class=\"token punctuation\">,</span>\n    <span class=\"token number\">1862662588367509514</span><span class=\"token punctuation\">,</span>\n    <span class=\"token number\">8350772864914849965</span><span class=\"token punctuation\">,</span>\n    <span class=\"token number\">11616510986494699232</span><span class=\"token punctuation\">,</span>\n    <span class=\"token number\">3711648467207374797</span><span class=\"token punctuation\">,</span>\n    <span class=\"token number\">9722127090168848805</span><span class=\"token punctuation\">,</span>\n    <span class=\"token number\">16780197523811627561</span><span class=\"token punctuation\">,</span>\n    <span class=\"token number\">18138828537077112905</span>\n<span class=\"token punctuation\">]</span>\n\nkey <span class=\"token operator\">=</span> <span class=\"token number\">1244422970072434993</span>\ne <span class=\"token operator\">=</span> <span class=\"token number\">65537</span>\nn <span class=\"token operator\">=</span> <span class=\"token number\">18446744073709551557</span>\nd <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span><span class=\"token number\">65537</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18446744073709551556</span><span class=\"token punctuation\">)</span>\n\nflag <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    m <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>ans<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span>\n    flag<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>m <span class=\"token operator\">^</span> ans<span class=\"token punctuation\">[</span>i<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>to_bytes<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token string\">'little'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># SECCON{Can_someone_please_make_a_debugger_for_Pickle_bytecode??}</span></code></pre></div>\n<p>ちなみに、他の方の Writeup を読んだところ、<a href=\"https://github.com/trailofbits/fickling\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">flickling</a>  というツールを使うと、以下のようなデコンパイル結果を得られるようでした。</p>\n<p>こちらの方が圧倒的に読みやすく、自分の苦労がなんだったのかという気持ちになりました。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">_var0 <span class=\"token operator\">=</span> <span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">'FLAG> '</span><span class=\"token punctuation\">)</span>\n_var1 <span class=\"token operator\">=</span> <span class=\"token builtin\">getattr</span><span class=\"token punctuation\">(</span>_var0<span class=\"token punctuation\">,</span> <span class=\"token string\">'encode'</span><span class=\"token punctuation\">)</span>\n_var2 <span class=\"token operator\">=</span> _var1<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n_var3 <span class=\"token operator\">=</span> <span class=\"token builtin\">getattr</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">dict</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'get'</span><span class=\"token punctuation\">)</span>\n_var4 <span class=\"token operator\">=</span> <span class=\"token builtin\">globals</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n_var5 <span class=\"token operator\">=</span> _var3<span class=\"token punctuation\">(</span>_var4<span class=\"token punctuation\">,</span> <span class=\"token string\">'f'</span><span class=\"token punctuation\">)</span>\n_var6 <span class=\"token operator\">=</span> <span class=\"token builtin\">getattr</span><span class=\"token punctuation\">(</span>_var5<span class=\"token punctuation\">,</span> <span class=\"token string\">'seek'</span><span class=\"token punctuation\">)</span>\n_var7 <span class=\"token operator\">=</span> <span class=\"token builtin\">getattr</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'__add__'</span><span class=\"token punctuation\">)</span>\n_var8 <span class=\"token operator\">=</span> <span class=\"token builtin\">getattr</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'__mul__'</span><span class=\"token punctuation\">)</span>\n_var9 <span class=\"token operator\">=</span> <span class=\"token builtin\">getattr</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'__eq__'</span><span class=\"token punctuation\">)</span>\n_var10 <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>_var2<span class=\"token punctuation\">)</span>\n_var11 <span class=\"token operator\">=</span> _var9<span class=\"token punctuation\">(</span>_var10<span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">)</span>\n_var12 <span class=\"token operator\">=</span> _var7<span class=\"token punctuation\">(</span>_var11<span class=\"token punctuation\">,</span> <span class=\"token number\">261</span><span class=\"token punctuation\">)</span>\n_var13 <span class=\"token operator\">=</span> _var6<span class=\"token punctuation\">(</span>_var12<span class=\"token punctuation\">)</span>\n_var14 <span class=\"token operator\">=</span> <span class=\"token builtin\">getattr</span><span class=\"token punctuation\">(</span>_var2<span class=\"token punctuation\">,</span> <span class=\"token string\">'__getitem__'</span><span class=\"token punctuation\">)</span>\n_var15 <span class=\"token operator\">=</span> _var14<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n_var16 <span class=\"token operator\">=</span> <span class=\"token builtin\">getattr</span><span class=\"token punctuation\">(</span>_var15<span class=\"token punctuation\">,</span> <span class=\"token string\">'__le__'</span><span class=\"token punctuation\">)</span>\n_var17 <span class=\"token operator\">=</span> _var16<span class=\"token punctuation\">(</span><span class=\"token number\">127</span><span class=\"token punctuation\">)</span>\n_var18 <span class=\"token operator\">=</span> _var7<span class=\"token punctuation\">(</span>_var17<span class=\"token punctuation\">,</span> <span class=\"token number\">330</span><span class=\"token punctuation\">)</span>\n_var19 <span class=\"token operator\">=</span> _var6<span class=\"token punctuation\">(</span>_var18<span class=\"token punctuation\">)</span>\n_var20 <span class=\"token operator\">=</span> _var7<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n_var21 <span class=\"token operator\">=</span> _var9<span class=\"token punctuation\">(</span>_var20<span class=\"token punctuation\">,</span> <span class=\"token number\">64</span><span class=\"token punctuation\">)</span>\n_var22 <span class=\"token operator\">=</span> _var8<span class=\"token punctuation\">(</span>_var21<span class=\"token punctuation\">,</span> <span class=\"token number\">85</span><span class=\"token punctuation\">)</span>\n_var23 <span class=\"token operator\">=</span> _var7<span class=\"token punctuation\">(</span>_var22<span class=\"token punctuation\">,</span> <span class=\"token number\">290</span><span class=\"token punctuation\">)</span>\n_var24 <span class=\"token operator\">=</span> _var6<span class=\"token punctuation\">(</span>_var23<span class=\"token punctuation\">)</span>\n_var25 <span class=\"token operator\">=</span> <span class=\"token builtin\">getattr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'append'</span><span class=\"token punctuation\">)</span>\n_var26 <span class=\"token operator\">=</span> <span class=\"token builtin\">getattr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'__getitem__'</span><span class=\"token punctuation\">)</span>\n_var27 <span class=\"token operator\">=</span> <span class=\"token builtin\">getattr</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'from_bytes'</span><span class=\"token punctuation\">)</span>\n_var28 <span class=\"token operator\">=</span> _var8<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span>\n_var29 <span class=\"token operator\">=</span> _var7<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n_var30 <span class=\"token operator\">=</span> _var8<span class=\"token punctuation\">(</span>_var29<span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span>\n_var31 <span class=\"token operator\">=</span> <span class=\"token builtin\">slice</span><span class=\"token punctuation\">(</span>_var28<span class=\"token punctuation\">,</span> _var30<span class=\"token punctuation\">)</span>\n_var32 <span class=\"token operator\">=</span> _var14<span class=\"token punctuation\">(</span>_var31<span class=\"token punctuation\">)</span>\n_var33 <span class=\"token operator\">=</span> _var27<span class=\"token punctuation\">(</span>_var32<span class=\"token punctuation\">,</span> <span class=\"token string\">'little'</span><span class=\"token punctuation\">)</span>\n_var34 <span class=\"token operator\">=</span> _var25<span class=\"token punctuation\">(</span>_var33<span class=\"token punctuation\">)</span>\n_var35 <span class=\"token operator\">=</span> _var7<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n_var36 <span class=\"token operator\">=</span> _var9<span class=\"token punctuation\">(</span>_var35<span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span>\n_var37 <span class=\"token operator\">=</span> _var8<span class=\"token punctuation\">(</span>_var36<span class=\"token punctuation\">,</span> <span class=\"token number\">119</span><span class=\"token punctuation\">)</span>\n_var38 <span class=\"token operator\">=</span> _var7<span class=\"token punctuation\">(</span>_var37<span class=\"token punctuation\">,</span> <span class=\"token number\">457</span><span class=\"token punctuation\">)</span>\n_var39 <span class=\"token operator\">=</span> _var6<span class=\"token punctuation\">(</span>_var38<span class=\"token punctuation\">)</span>\n_var40 <span class=\"token operator\">=</span> <span class=\"token builtin\">getattr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'append'</span><span class=\"token punctuation\">)</span>\n_var41 <span class=\"token operator\">=</span> <span class=\"token builtin\">getattr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'__getitem__'</span><span class=\"token punctuation\">)</span>\n_var42 <span class=\"token operator\">=</span> <span class=\"token builtin\">getattr</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'__xor__'</span><span class=\"token punctuation\">)</span>\n_var43 <span class=\"token operator\">=</span> _var26<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n_var44 <span class=\"token operator\">=</span> _var42<span class=\"token punctuation\">(</span>_var43<span class=\"token punctuation\">,</span> <span class=\"token number\">1244422970072434993</span><span class=\"token punctuation\">)</span>\n_var45 <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>_var44<span class=\"token punctuation\">,</span> <span class=\"token number\">65537</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18446744073709551557</span><span class=\"token punctuation\">)</span>\n_var46 <span class=\"token operator\">=</span> _var40<span class=\"token punctuation\">(</span>_var45<span class=\"token punctuation\">)</span>\n_var47 <span class=\"token operator\">=</span> _var41<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n_var48 <span class=\"token operator\">=</span> _var7<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n_var49 <span class=\"token operator\">=</span> _var9<span class=\"token punctuation\">(</span>_var48<span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span>\n_var50 <span class=\"token operator\">=</span> _var8<span class=\"token punctuation\">(</span>_var49<span class=\"token punctuation\">,</span> <span class=\"token number\">131</span><span class=\"token punctuation\">)</span>\n_var51 <span class=\"token operator\">=</span> _var7<span class=\"token punctuation\">(</span>_var50<span class=\"token punctuation\">,</span> <span class=\"token number\">679</span><span class=\"token punctuation\">)</span>\n_var52 <span class=\"token operator\">=</span> _var6<span class=\"token punctuation\">(</span>_var51<span class=\"token punctuation\">)</span>\n_var53 <span class=\"token operator\">=</span> <span class=\"token builtin\">getattr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'__eq__'</span><span class=\"token punctuation\">)</span>\n_var54 <span class=\"token operator\">=</span> _var53<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">8215359690687096682</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1862662588367509514</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8350772864914849965</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11616510986494699232</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3711648467207374797</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9722127090168848805</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16780197523811627561</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18138828537077112905</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nresult0 <span class=\"token operator\">=</span> _var54</code></pre></div>\n<p>参考：<a href=\"https://qiita.com/hiikunZ/items/e2ab86cf2792dd1394df#sickle-reversing\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">SECCON CTF 2023 Quals Writeup - Qiita</a></p>\n<p>とはいえ難解なアセンブリを読み解いたことで少しレベルアップしたような気はするので結果オーライです。</p>\n<h2 id=\"まとめ\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>国内 35 位、まだまだ本選への道のりは遠いですが引き続き精進していきたいです。</p>\n<p>今回 Rev 問を全完していれば本選出場も狙える得点を得られていたようですので、来年は Rev を全完できるように頑張っていこうと思います笑</p>","fields":{"slug":"/ctf-seccon-ctf-2023","tagSlugs":["/tag/ctf/","/tag/rev/"]},"frontmatter":{"date":"2023-09-17","description":"SECCON CTF 2023 QUALS の Writeup です。","tags":["CTF","Rev"],"title":"SECCON CTF 2023 QUALS Writeup","socialImage":{"publicURL":"/static/550b5803aac025ea209fc846daa8bc9c/ctf-seccon-ctf-2023.png"}}}},"pageContext":{"slug":"/ctf-seccon-ctf-2023"}},"staticQueryHashes":["251939775","401334301","825871152"]}