{"componentChunkName":"component---src-templates-post-template-js","path":"/himitsukichi-ctf-rev-ghidra-dynamic","result":{"data":{"markdownRemark":{"id":"8dd34f4a-9507-58c1-b88f-648ba09bd6a8","html":"<p>この記事は <a href=\"https://adventar.org/calendars/7550\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CTF Advent Calendar 2022 Day18</a> の記事として書きました。</p>\n<p>Advent Calendar 参加するのは初めてなので楽しみにしてました。</p>\n<p>昨日の記事は、Ark さんの「<a href=\"https://blog.arkark.dev/2022/12/17/best-web-challs/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">2022のweb問で特におもしろかった問題を紹介</a>」でした。</p>\n<p>明日の記事は、Satoooon さんの「CTFTimeの統計を雑に取ってみる」です。</p>\n<!-- omit in toc -->\n<h2 id=\"もくじ\" style=\"position:relative;\"><a href=\"#%E3%82%82%E3%81%8F%E3%81%98\" aria-label=\"もくじ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>もくじ</h2>\n<ul>\n<li><a href=\"#%E4%BB%8A%E5%9B%9E%E3%81%AE%E8%A8%98%E4%BA%8B%E3%81%AE%E3%83%86%E3%83%BC%E3%83%9E\">今回の記事のテーマ</a></li>\n<li><a href=\"#%E4%BB%8A%E5%9B%9E%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\">今回使用するプログラムについて</a></li>\n<li>\n<p><a href=\"#linux-%E3%81%A7-ghidra-%E3%81%AE%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%86\">Linux で Ghidra のデバッガを使う</a></p>\n<ul>\n<li><a href=\"#%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E8%B5%B7%E5%8B%95%E3%81%99%E3%82%8B\">デバッガを起動する</a></li>\n<li><a href=\"#%E3%83%96%E3%83%AC%E3%83%BC%E3%82%AF%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%82%92%E3%82%BB%E3%83%83%E3%83%88%E3%81%97%E3%81%A6%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B\">ブレークポイントをセットしてプログラムを実行する</a></li>\n<li><a href=\"#ghidra-%E3%81%AE%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%81%A7%E6%A8%99%E6%BA%96%E5%85%A5%E5%8A%9B%E3%82%92%E9%80%81%E3%82%8C%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B\">Ghidra のデバッガで標準入力を送れるようにする</a></li>\n<li><a href=\"#%E3%83%AC%E3%82%B8%E3%82%B9%E3%83%88%E3%83%AA%E3%81%A8%E3%83%A1%E3%83%A2%E3%83%AA%E3%81%AE%E6%83%85%E5%A0%B1%E3%82%92%E7%A2%BA%E8%AA%8D%E3%81%99%E3%82%8B\">レジストリとメモリの情報を確認する</a></li>\n<li><a href=\"#%E3%83%95%E3%83%A9%E3%82%B0%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B\">フラグを取得する</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#windows-%E3%81%A7-ghidra-%E3%81%AE%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%86\">Windows で Ghidra のデバッガを使う</a></p>\n<ul>\n<li><a href=\"#%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E8%B5%B7%E5%8B%95%E3%81%99%E3%82%8B-1\">デバッガを起動する</a></li>\n<li><a href=\"#%E3%83%96%E3%83%AC%E3%83%BC%E3%82%AF%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%99%E3%82%8B\">ブレークポイントを設定する</a></li>\n<li><a href=\"#%E3%83%AC%E3%82%B8%E3%82%B9%E3%82%BF%E3%81%AE%E6%83%85%E5%A0%B1%E3%82%92%E5%8F%82%E7%85%A7%E3%81%99%E3%82%8B\">レジスタの情報を参照する</a></li>\n<li><a href=\"#%E3%83%95%E3%83%A9%E3%82%B0%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B-1\">フラグを取得する</a></li>\n</ul>\n</li>\n<li><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\">まとめ</a></li>\n</ul>\n<h2 id=\"今回の記事のテーマ\" style=\"position:relative;\"><a href=\"#%E4%BB%8A%E5%9B%9E%E3%81%AE%E8%A8%98%E4%BA%8B%E3%81%AE%E3%83%86%E3%83%BC%E3%83%9E\" aria-label=\"今回の記事のテーマ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>今回の記事のテーマ</h2>\n<p>今回は、バージョン 10.0 から追加された Ghidra のデバッガ機能を使って、Windows と Linux でシンプルな Reversing 問題を解いていきます。</p>\n<p>本来は Android の NDK ライブラリを自作のバイナリから dlopen して解析するやつを書きたかったのですが、自環境での検証が上手くいかずに 5 日ほど溶かしてしまったので急遽こちらに内容を変更しました。</p>\n<p>バージョン 10.0 から Ghidra にデバッガが実装されるということが話題になってからずいぶん経ちます。</p>\n<p>Ghidra のデバッガは、Windows では WinDbg、Linux では GDB に依存して動作しており、ユーザモードアプリケーションの動的解析を行うことができますが、CTF の Writeup などを見ても、使用している例を全く見かけません。</p>\n<p>僕自身、まだプレビュー段階のころに一度デバッガを使ってみたものの、正直まだ使いづらいと感じたため、それ以来全く使っていませんでした。</p>\n<p>あれからしばらく時間が経ったものの、Ghidra のデバッガに関してはあまり情報を見かけないため、色々いじってみて使い方や感想について書いていこうと思います。</p>\n<p>簡単な動的解析の Rev 問を解く形式で、実際に Ghidra  のデバッガを試していきます。</p>\n<h2 id=\"今回使用するプログラムについて\" style=\"position:relative;\"><a href=\"#%E4%BB%8A%E5%9B%9E%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\" aria-label=\"今回使用するプログラムについて permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>今回使用するプログラムについて</h2>\n<p>今回は、以下のコードから作成したプログラムを使用します。</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;string.h></span></span>\n\n<span class=\"token keyword\">char</span> flag<span class=\"token punctuation\">[</span><span class=\"token number\">30</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token number\">0x4b</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x6a</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x6e</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x6a</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x77</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x70</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x76</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x68</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x6a</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x60</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x6b</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x6a</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x40</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x57</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x45</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x78</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x7a</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x6c</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x76</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x5c</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x74</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x33</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x6d</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x5c</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x67</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x71</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x62</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x22</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x22</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x7e</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">super_secure_checker</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> c<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>c <span class=\"token operator\">==</span> <span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token operator\">^</span><span class=\"token number\">0x3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">else</span> <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">char</span> password<span class=\"token punctuation\">[</span><span class=\"token number\">0x100</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Input yout password: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">scanf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\"</span><span class=\"token punctuation\">,</span> password<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    \n    <span class=\"token keyword\">int</span> len <span class=\"token operator\">=</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>password<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>len <span class=\"token operator\">!=</span> <span class=\"token number\">30</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Wrong!!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">30</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">super_secure_checker</span><span class=\"token punctuation\">(</span>password<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Wrong!!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Correct!!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>コードとしてはシンプルで、以下のステップで動作します。</p>\n<ol>\n<li><strong>ユーザからパスワードを標準入力で受け取る。</strong></li>\n<li><strong>パスワードの長さが 30 文字の場合のみ、先頭から一文字ずつを<code class=\"language-text\">super_secure_checker</code>関数に渡す。</strong></li>\n<li><strong>ハードコードされた値と入力値を 0x3 で XOR した値を比較して、すべての文字が一致する場合は<code class=\"language-text\">Correct</code>を返す。</strong></li>\n</ol>\n<p>よくある動的解析やシンボル解析でブルートフォースできるタイプのリバーシング問題です。</p>\n<p>また、非常にシンプルな処理なので、<code class=\"language-text\">super_secure_checker</code>関数の戻り値のレジスタを毎回書き換えて、1文字ずつレジスタに展開されたパスワードを取得していくことも可能です。</p>\n<p>もちろんこれくらいシンプルな処理であれば静的解析でも余裕でパスワードを取得することはできますが、今回は Ghidra のデバッガを使っていくことが目的なので、あえて動的解析で解いていきます。</p>\n<h2 id=\"linux-で-ghidra-のデバッガを使う\" style=\"position:relative;\"><a href=\"#linux-%E3%81%A7-ghidra-%E3%81%AE%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%86\" aria-label=\"linux で ghidra のデバッガを使う permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Linux で Ghidra のデバッガを使う</h2>\n<p>上記のソースコードをオプションなしの gcc でコンパイルした ELF バイナリを使用して解析を行います。</p>\n<p><a href=\"/file/task\">サンプルプログラム</a>からダウンロードできます。</p>\n<p>また、Ghidra はバージョン 10.2.2. を使用しています。</p>\n<h3 id=\"デバッガを起動する\" style=\"position:relative;\"><a href=\"#%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E8%B5%B7%E5%8B%95%E3%81%99%E3%82%8B\" aria-label=\"デバッガを起動する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>デバッガを起動する</h3>\n<p>まず、バイナリを読み込んだ後に<code class=\"language-text\">Tool Chest</code>の真ん中にある虫のようなボタンを押してデバッガを起動します。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 453px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b92a50fe0f5169bf503052a2517552e8/2108e/image-20221215215846618.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAABzUlEQVQ4y82QzU8aURTF359ikHajtQtXTQ2tsbFNF/2/uujKlS7qRwUFbWIryAjDOAM4gFAYPhxmYNCC2KYLtpbGgdP7Rhe2xGSqm97kl3Ny33sn9z72xjeH6clpjI0/wviDKXgfTjl65R+PqMc7iTHPBJ48fYFns68w45vH7Nxr+J6/hJfusKWl9wgGP2Ltwwb8gS2srPqx7g8isLmN5ZV1hLZ3sLoWoLOQcycSjSOyF4cQkxATZeyTxkm536MzFhESKJQqyOVLyH8pQ80WyGso10wUyzqaJ10YzTZMq+No6+s3B+v0fATeZ592BchKBqKUgiSnUdSOoVXq0KqGQ61uoaZfQ7563ERVvx0WjiawnxQRjgoQ4gpyWh2FMoXVGjRlg0JNR93CRDEJf+YdFhbeYnE5hN20CenIQKPVveYMunnqGhamD5YPM5BTOSiEmi0ipeZxkOS9LNJqgVZt0TqWK9jOZwFiIgmZAsSDNCRFJQ4Rox7/Vx7M1y5VDFewhJzDj+86OidHqBsWDNNEu32GwWAI2x7g8tLGz36f+OUKxqew6XH/4gLn3Q56vR7uU4yvyae4WcPh8M5cBdr2H0F/+3+f8Ebgfev/D/wNnLMcDowDcgEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b92a50fe0f5169bf503052a2517552e8/8ac56/image-20221215215846618.webp 240w,\n/static/b92a50fe0f5169bf503052a2517552e8/2430e/image-20221215215846618.webp 453w\"\n              sizes=\"(max-width: 453px) 100vw, 453px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b92a50fe0f5169bf503052a2517552e8/8ff5a/image-20221215215846618.png 240w,\n/static/b92a50fe0f5169bf503052a2517552e8/2108e/image-20221215215846618.png 453w\"\n            sizes=\"(max-width: 453px) 100vw, 453px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b92a50fe0f5169bf503052a2517552e8/2108e/image-20221215215846618.png\"\n            alt=\"image-20221215215846618\"\n            title=\"image-20221215215846618\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>次に、デバッガウィンドウの左上の [File]>[Open] から解析対象のファイルをロードします。</p>\n<p>ロードが完了すると中央の Listing ウィンドウにディスアセンブル結果が表示されます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 446px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/28e72c435a161c4ae9b02026b06493be/6244b/image-20221215215929166.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 134.58333333333331%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAYAAAB836/YAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEcElEQVRIx61VW1NbVRQ+P8FCfbEdxxcfanVGS623jj7ZcRjHlz744LvO6JRKW2hxLNYpWmYcHrAtFSQlgQYCpLmUkytBoRSEQBJyP8lJQsotUArkAgok4XOdk8tDZ0DKuGe+WXuvs86319r7rO8wrxx7DyUvvowXSl7CoZIjOFR6JDcnW1J6NGcPHy2uC/PCWogVfKWHc8+Y5tZ2NLe0oU3aAamsE3fbOiDv6oWErORuO6TtnaJtk94TIfhl5Ou4p6C1HJ2dCrT8LhE5WlqlYGx2F+QKFS5cuYbKizU4X3kZVZdryV5BxbfVuPpDHWq+u4artXW4VPU9vjl3UYzLxVajovoGbrZ0gQuE4OPCYFiTDl99XYm33v8Ex984hddefxvHjpeRPYmTpz5C+adn8fGZz1BefhanPzyDN098kEPZaZSdeAevvvsFPv/yR1itExgds4Pp7GnC9Z/qYbYMQme0kB0Cq++Hts+IR39NYsLuwfikC1abW5zbprw5OLywT/ngmHKjVSIjsgnyucEk4kno9CaMjjvIacPwqBVjVgc4PopgaIbwuGgDBfCPwYdn4PSFoftzHCp1H7a2tpBOZ4gwkYDeYKKdPHB5OLgJHm8AfIgI+eldITz3ByKw2r3QaFlksxkIQyRk9RZYBlmMT/wB8/Ak2IFHZK3wTS/AFxEwn7d5kN9LPi4agzc8ByVlmMmkc4SpVAq9ahbnf+1Fk9KChq5+1LbpUXlbhUt3NHui6jctzjUq0SzrJqosdnaIMB5PwGS2YPOfTRx0sDojtre3cxmKhKZ+JFProiOb3aGd9gmKT2cy6GMNSD9LmFrfEB37JhPqo5HJExYzXIvHYXyGcD9jV8IkXYqZzjC1vn5gQlZHJafztyx86V0KJTY2/s6d4XOULCCbzaJHqUY4EsXs3AIYo+UhqYSsmPJBhtApC4tLWFmNgzFrNbh1qwnLT1fFm15ZXXsOxJGgO5DLu+Gw2eF2OsHUXm9AxYUamAceYmxiCnPzMSw9Wcbi0jKW9gLFxGKLGHZE8HOjBPUtCjRI1WAau4yo+6UJTuphoeljSytEtkIlLP8HnmI+9gS+0ALqb8tQK3mAG3IzmMzWJsz9FoyQlk06PKLq2EiW3L7QnnARPP4wXN4gWFZfPE9mbS0uts7QI6tY8ghJmKB3vsA0qQkhuDsEiROIVRoWW3SpGbrxvHyZ4abdHC4OA4Mj+Qx5UftC07PgIzOE2fy8sJ5BeHpOJFaTfBXVpkAokAj6xgk7B3Na56VNvFyEXoqK1uMX/hu5tVCB4JtyB6DWsOIHXuxlo8kiPnT4oxhxBDFkdWPMHYGPF9Q6CofTR9lGKcM5igvB7vTS2QXEbDmK0fYZkCl0SjKZgsHYj/saPdp7dbjTrsJNCf0a5VooNQbcJ61U9KihfmCgF03FdbdSCy1rgkproE7RFDuHSk5CKNvn94MPBhHieYRDIXEeCOQQ5EOi5bgAAuTnaR0M8qLP7+ewSF1S6G9SmwT+j1EQi38BF10lpzl+DbIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/28e72c435a161c4ae9b02026b06493be/8ac56/image-20221215215929166.webp 240w,\n/static/28e72c435a161c4ae9b02026b06493be/5021b/image-20221215215929166.webp 446w\"\n              sizes=\"(max-width: 446px) 100vw, 446px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/28e72c435a161c4ae9b02026b06493be/8ff5a/image-20221215215929166.png 240w,\n/static/28e72c435a161c4ae9b02026b06493be/6244b/image-20221215215929166.png 446w\"\n            sizes=\"(max-width: 446px) 100vw, 446px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/28e72c435a161c4ae9b02026b06493be/6244b/image-20221215215929166.png\"\n            alt=\"image-20221215215929166\"\n            title=\"image-20221215215929166\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>次に、[Debugger] ツールバーから [in GDB locally IN-VM] を選択します。</p>\n<p><code class=\"language-text\">GDB launch command</code>は、特に問題なければ既定の<code class=\"language-text\">/usr/bin/gdb</code>ままにしておきます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 565px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/aeb5e74674f827a6be4e3ef49fc4be66/07eba/image-20221215223714073.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB0ElEQVQoz1VQy27TQBT1H/IHgFijLlghEAuoGuLWJm6RGgE7RBESC+gCiQpBiioUStrE8SOJE8dx/IjfD7opqxzujAqCkY7OndGdc8+5ws2N+7h26w6u376HRmMbsqSgsSVC2mlxyLICUZQ4y1ILYlPCo80mHhKkJ0+h7LWh7LbR2t1HS9mH8ODFIW40X+Hus/dov+tg7+1nPH75ATuvj7B98BHym0+8ZiweHOH54VcYUxf2wocXRPDDGEt/hTBKkWQlhC/fejj+PkB3MMLJmYHOqYbODx3HPeMvTo05R1e3oVouuqoN03Kg6Sb6qgZVMzC2ZoQFhDCMEAQ0gTiKkivEnOM4QVnWqOsL5HmJNCtQVzW6QxI2LKhDnYsNiJngYhlCYE0zx6UHG7O5y+1nRY04LZASF9UF0rzi9ygpkBcVeoYDczKHYY5hjiw4rscjR3EKYUVONN3A1F7wfaziDDHtggmwJnZnA/6grH7ipD+FNrJx3le5O8OcwCZTHiUVXC/AYOJhqI+h00S2E9Z0dq7CmjkUI/hPMCO3fphQXSFJaVhOCW2H9+ZUC1GSwXJ8OPSRuUmu3DGwuDzyP4Ip7fLX5SXYWa/XnJdkynEDXv8GvUom0RvHVlYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/aeb5e74674f827a6be4e3ef49fc4be66/8ac56/image-20221215223714073.webp 240w,\n/static/aeb5e74674f827a6be4e3ef49fc4be66/d3be9/image-20221215223714073.webp 480w,\n/static/aeb5e74674f827a6be4e3ef49fc4be66/acb73/image-20221215223714073.webp 565w\"\n              sizes=\"(max-width: 565px) 100vw, 565px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/aeb5e74674f827a6be4e3ef49fc4be66/8ff5a/image-20221215223714073.png 240w,\n/static/aeb5e74674f827a6be4e3ef49fc4be66/e85cb/image-20221215223714073.png 480w,\n/static/aeb5e74674f827a6be4e3ef49fc4be66/07eba/image-20221215223714073.png 565w\"\n            sizes=\"(max-width: 565px) 100vw, 565px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/aeb5e74674f827a6be4e3ef49fc4be66/07eba/image-20221215223714073.png\"\n            alt=\"image-20221215223714073\"\n            title=\"image-20221215223714073\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>[Connect] をクリックした後、<code class=\"language-text\">CommandLine</code> の設定を確認します。</p>\n<p>実行バイナリにコマンドライン引数が必要な場合はここで設定します。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 739px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/74dcaa5eaa9bf4ce6fe3ca9ef2be08b2/f1d1f/image-20221215224407819.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABCUlEQVQY002P2U7CQBSG+1Zd0BBRTErjjcsL+Hp6azRl6UaFwVq6lwIFo8aYmPgKv3Om1Xjx5Zvl/OfMSOpBH2rnBErnGIrWIGs9aId96MYl9ME5BmTjAsbZFbpHuqihjNpmZLUHWelCOb2GNLJ8PAwdjO1H2B6D5TLhkT2D4y/gTBew+N7mJqjOnExBuSFn4s7hs6XgzvQgBWEK9hRjmayQFlsk+QZRWiEpa+TVjrMXLtYvf27YC1f1G94/v/H68YUZCyFRgzAuOQWeo1wQhJkYEGUbxNlaDMrKbeu6cQutqYb6sCCBlK924kV0+AtdBvEKt+YcN/ceXBbzX0SCiAYllcj8h3LU8AdxdjXvrZI6mQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/74dcaa5eaa9bf4ce6fe3ca9ef2be08b2/8ac56/image-20221215224407819.webp 240w,\n/static/74dcaa5eaa9bf4ce6fe3ca9ef2be08b2/d3be9/image-20221215224407819.webp 480w,\n/static/74dcaa5eaa9bf4ce6fe3ca9ef2be08b2/26073/image-20221215224407819.webp 739w\"\n              sizes=\"(max-width: 739px) 100vw, 739px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/74dcaa5eaa9bf4ce6fe3ca9ef2be08b2/8ff5a/image-20221215224407819.png 240w,\n/static/74dcaa5eaa9bf4ce6fe3ca9ef2be08b2/e85cb/image-20221215224407819.png 480w,\n/static/74dcaa5eaa9bf4ce6fe3ca9ef2be08b2/f1d1f/image-20221215224407819.png 739w\"\n            sizes=\"(max-width: 739px) 100vw, 739px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/74dcaa5eaa9bf4ce6fe3ca9ef2be08b2/f1d1f/image-20221215224407819.png\"\n            alt=\"image-20221215224407819\"\n            title=\"image-20221215224407819\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>これで[Launch]をクリックするとデバッガが起動して色々な情報が出力されます。</p>\n<p>デフォルトでは、中央におなじみの Listing ウィンドウが表示され、右側に Interpreter が表示されています。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2f62b75f4cb39970779b2b081efef7e2/c1f3c/image-20221215224447357.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.583333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACkUlEQVQoz22Ta2/aSBSG/f9/wEq7n6r92nar7bZSm/QSkWwSoCHcA7bxBV8wGIMB34iBpydWL7tSLb06M/YZz5nnnaOcXd7w8abFp9s2F80el60hF7cd/nlTp3U/QZ2YaKaF7cxodwbU63W6vS6arqOKDNPEcT0W4ZIwjFD45XNE03Qei5LTf966nsc8mBOFMWEUEScxeZFTluWPHEVVdaaOi+cHohmOF2DYLs37ARMrIojWuNGCMN6g2iZzf81ysRVFbDdb0jQjzTIOhwPH4xFlalmsVit2ux3b7ZYkSYklceoGzBclWbEnyRPKwxHDtQkXcxa+bLBcSt7PCvf7fRWVYBYQrdZk+0e2SUbxWLKU+U39Dm3iYHsz4edWnMbCbKyp1bGD0CdNNqR59j9Yytj0aPVG3A81+prFxFvwMJmyjFayICPZJOzWUv1mJ1wNRkOLUPBEot0qJquOe+R0OlVSWq02o9GYh5EquxtYtoMqMc1yCjFlnx8rc8ryIC4/4DsFnrAN5ztBlRAL2+12VyGrjtwZqAzHBp6AtpcFThBjTGX3NGXqrfHnJzZpzmyZYE99YVUIt4NUdfrl/VDanS63jTam7bOOM2w3RDddcW/HYr6RK1JQpFLJMuaJ974oeJSfFnn+zeGcLC8qUwoxUHn59pzX5zVen9V48/GKtxd13l9+4fp+yIfrNr8//8Bvz9/zx4sznv31jj9fSXz5jr8l/9NVg7NanfPLJleNDretPspgbGI6cwzRxA6qsW7N0CxfOsTj36fOaQ753OhLN3X5XO9Vsdbsc3035OrLoFJNvtfbI5S79oB2X6XbH9MTng/C80kjzaQ31GlIpSPVQJ/Y6Mb0hzS5CapuS7Sr8ff5VwGWb5t91pc/AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2f62b75f4cb39970779b2b081efef7e2/8ac56/image-20221215224447357.webp 240w,\n/static/2f62b75f4cb39970779b2b081efef7e2/d3be9/image-20221215224447357.webp 480w,\n/static/2f62b75f4cb39970779b2b081efef7e2/e46b2/image-20221215224447357.webp 960w,\n/static/2f62b75f4cb39970779b2b081efef7e2/f992d/image-20221215224447357.webp 1440w,\n/static/2f62b75f4cb39970779b2b081efef7e2/882b9/image-20221215224447357.webp 1920w,\n/static/2f62b75f4cb39970779b2b081efef7e2/d9f7e/image-20221215224447357.webp 2123w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2f62b75f4cb39970779b2b081efef7e2/8ff5a/image-20221215224447357.png 240w,\n/static/2f62b75f4cb39970779b2b081efef7e2/e85cb/image-20221215224447357.png 480w,\n/static/2f62b75f4cb39970779b2b081efef7e2/d9199/image-20221215224447357.png 960w,\n/static/2f62b75f4cb39970779b2b081efef7e2/07a9c/image-20221215224447357.png 1440w,\n/static/2f62b75f4cb39970779b2b081efef7e2/29114/image-20221215224447357.png 1920w,\n/static/2f62b75f4cb39970779b2b081efef7e2/c1f3c/image-20221215224447357.png 2123w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2f62b75f4cb39970779b2b081efef7e2/d9199/image-20221215224447357.png\"\n            alt=\"image-20221215224447357\"\n            title=\"image-20221215224447357\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>Interpreter には、コマンドラインで GDB を起動した場合と同じ出力がされており、GDB コマンドによる操作も可能になっています。(この環境では gdb-peda をセットアップしているため、peda の出力が表示されています)</p>\n<p>左ペインには GDB によってデバッグされているプログラムのプロセスに関する情報が表示されます。</p>\n<p>ここから設定しているブレークポイントやロードされているモジュールなども確認することができます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 545px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8fc03d4b599231735c10d093ee9468e5/3ddad/image-20221215224911198.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.16666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACKElEQVQ4y6VSa08TQRTdf+0XxU8kjZrgoxEKJlgCJvKhaEuKFqmUvjAtbLH0sdSWfe922+6226eV9jgzBQJETdSbnNyZe++cOXPvcPfvrWHuYRgP5kKYnw/j8ZMPWHgawbPnu3jh3cWibw++lSiWV/aw6v+M9TcxvN2MI7CVRHA7jZ2PX/ApmkEsfoTUIQ9udSmCzY0sXvvTCIcF7O+LiEarxNdwED9HKiUifThDJivjmFfwNa+iUNQhnBn4VjUhShYUtQHDbIKzHQsYOrAsBbouArjA/xgnKxr6hglJklGt1tDpuCwxnf4ZvyX0+LexsBbGo1cBeNZ3sBRMYvF9At6tA+LjePluBhrzBQlCSVKTYFgOzWppnTcQg2cjAq54dg7LHUCqiMjxeSQyPDInBRitDupOF3XbnYGu2f4Gbu1dmARcw2owqd8dG6YoQpYl9Lruv/fQIP2jLXE1DVK5jEqt9tckU9LUKzBCaoNOBypRqKgqmbgF27bRbreZ75Ac9Y1Gg6HVarGc4zgYjUa3SDn9kvCCbGzThClJjLTf66Hb7cJ13WtP0SPxfr+PwWDA1uPx+A6hblwHfpAkfbpMvlClUoEgCBCJaqpKJZdQlcPhkBFeKaM2ufnk+uVQWGIywZAcNgyd/MkqAyWkT6QxOjBFUQhkNJvNXw+lUCyjZTugxBpRK5bKyOdPwedOkD06Bs/nUCoLyJ8WUCiUoGo6UauxWoucqd/BTzHYuhJcnk0VAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/8fc03d4b599231735c10d093ee9468e5/8ac56/image-20221215224911198.webp 240w,\n/static/8fc03d4b599231735c10d093ee9468e5/d3be9/image-20221215224911198.webp 480w,\n/static/8fc03d4b599231735c10d093ee9468e5/6305f/image-20221215224911198.webp 545w\"\n              sizes=\"(max-width: 545px) 100vw, 545px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/8fc03d4b599231735c10d093ee9468e5/8ff5a/image-20221215224911198.png 240w,\n/static/8fc03d4b599231735c10d093ee9468e5/e85cb/image-20221215224911198.png 480w,\n/static/8fc03d4b599231735c10d093ee9468e5/3ddad/image-20221215224911198.png 545w\"\n            sizes=\"(max-width: 545px) 100vw, 545px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/8fc03d4b599231735c10d093ee9468e5/3ddad/image-20221215224911198.png\"\n            alt=\"image-20221215224911198\"\n            title=\"image-20221215224911198\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h3 id=\"ブレークポイントをセットしてプログラムを実行する\" style=\"position:relative;\"><a href=\"#%E3%83%96%E3%83%AC%E3%83%BC%E3%82%AF%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%82%92%E3%82%BB%E3%83%83%E3%83%88%E3%81%97%E3%81%A6%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B\" aria-label=\"ブレークポイントをセットしてプログラムを実行する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ブレークポイントをセットしてプログラムを実行する</h3>\n<p>とりあえずデバッガが起動できたので、デコンパイルウィンドウで<code class=\"language-text\">super_secure_checker</code>関数の呼び出し直後の行を右クリックし、[Toggle Breakpoint] でブレークポイントを設定してみます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 669px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e07e9af9c49d07ac3e886d0b0fa07745/99272/image-20221215225117807.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 107.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsTAAALEwEAmpwYAAACqklEQVQ4y62Ua1PaQBSG+f9/pe30Q+vUVkWlaKv1BogoBBKSkPsmQEgIQXh7zkYRO+h0HHfmnbPJzj579ly2JMQEAytAIAyEoQ8z1DEcBUimGeIswWw2Rp6nZGPM5wnSaYL5fQ4ey+VypcdRStMZRqMxAq8GcxBB7YfQdQFVi6BoFlzPRjQ0EQR8IFlhI4xsZNn0GXQFzGZTTOIlVNVG3zBw2+6irai463Sh6Sa8YCgVhHRoNIYguX6IJEk3A3khTXPaEEPp9VGrN1FrNNFs3cF2AwnwxZAOUtDpqlC6mrRp+uTh+ij5fkwxu4dP8etppgQ1rlto3XbIY0vC2COlp8FyfDlnm6TpZqDjJhSfHE7gSuDFVZ2u3MNNq03xpJiFI7pyJK1PYsueTybJZqDrxnStOTwRUCJMXNau5dX5WrxRgsRwZTkEumljHMebgXGcYkH/ouGIkjCQML4Sq/BsLG1X1eU/Bg9s72UP8/lcTtib23aPYtiWm03LhTFwZBx5jWPH4ozzWvwiMC+AlitQv+mgThm+rDVwR+WzDmQvvYerF8DJZuDsAahZHi6aCq6bLarBHiXIkJs5ZgxzPCFjyOID1utwo4d+ICgRmvQoHMarzSwG8n+G8iFsXwY+xDCi9uMOOTu/konxRVEuj+KEOBRDLh0ORRxPXgdyTAIRwnZcshH1Nxf8eKXRmL8LcUVk2ex14FvGv7BnwPWn6H/1qoebTnvLWGX53YBchwxbLBbUgstCi7eJOSXyDe85Sj3Dh2776FtkHQGdOoaLuE8vijFw6WXh9ivmmkkyinbk777Jelq3qINKH7eO8eHrHj59O8Dn7z/xZaeCH7v72C1XUKmeYP/wCDs0rx6dYPvwFNvlY+zsHaJ6fIpy5Q92D36jfFDF0a8znJ438BcILZDLQs41GwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e07e9af9c49d07ac3e886d0b0fa07745/8ac56/image-20221215225117807.webp 240w,\n/static/e07e9af9c49d07ac3e886d0b0fa07745/d3be9/image-20221215225117807.webp 480w,\n/static/e07e9af9c49d07ac3e886d0b0fa07745/a6306/image-20221215225117807.webp 669w\"\n              sizes=\"(max-width: 669px) 100vw, 669px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e07e9af9c49d07ac3e886d0b0fa07745/8ff5a/image-20221215225117807.png 240w,\n/static/e07e9af9c49d07ac3e886d0b0fa07745/e85cb/image-20221215225117807.png 480w,\n/static/e07e9af9c49d07ac3e886d0b0fa07745/99272/image-20221215225117807.png 669w\"\n            sizes=\"(max-width: 669px) 100vw, 669px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e07e9af9c49d07ac3e886d0b0fa07745/99272/image-20221215225117807.png\"\n            alt=\"image-20221215225117807\"\n            title=\"image-20221215225117807\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>とりあえず<code class=\"language-text\">SW_EXECUTE</code>でブレークポイントを設定すると、 Listing ウィンドウでもブレークポイントを設定した行の色が変化しました。</p>\n<p>Interpreter でも、GDB のブレークポイントがセットされていることを確認できます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 670px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e77bf9a2a2c335a4fee30936556dde6a/d67fd/image-20221215225518574.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAz0lEQVQY061NTa+CMBDs//8xJt6MT6mCgBq1vRNejAmCoXRFCRcI89oazItnJ5md/ZjdZWmaQggBKSWSJIFSCqosnebXK9q2Rdd1aJoGVVWh73sMwwCLUf+D2aC1dgesoa5r5HkOIoJ9lmUZiqIwvLl+aXz2gb1l/Z9k+DLY7/kCTbUj3R9OK03v3pjTfaxfOY1zekLRw6ih2WecH8H9GOvNHtFOIIgOmC99eOvY1dzfYrEKEcZH+FuJqbfHwgvcThCfMOUCk3mIyU+E2UbiD5sNdi2kmzdDAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e77bf9a2a2c335a4fee30936556dde6a/8ac56/image-20221215225518574.webp 240w,\n/static/e77bf9a2a2c335a4fee30936556dde6a/d3be9/image-20221215225518574.webp 480w,\n/static/e77bf9a2a2c335a4fee30936556dde6a/6cceb/image-20221215225518574.webp 670w\"\n              sizes=\"(max-width: 670px) 100vw, 670px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e77bf9a2a2c335a4fee30936556dde6a/8ff5a/image-20221215225518574.png 240w,\n/static/e77bf9a2a2c335a4fee30936556dde6a/e85cb/image-20221215225518574.png 480w,\n/static/e77bf9a2a2c335a4fee30936556dde6a/d67fd/image-20221215225518574.png 670w\"\n            sizes=\"(max-width: 670px) 100vw, 670px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e77bf9a2a2c335a4fee30936556dde6a/d67fd/image-20221215225518574.png\"\n            alt=\"image-20221215225518574\"\n            title=\"image-20221215225518574\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>プログラムは、Object ウインドウの上部にある[Quick Lounch]ボタンから再起動できます。</p>\n<p>また、ここにあるボタンで、[Step into] などの操作を行うことができます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 692px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/46999ecf3220dad79948460785ea5a51/91e7e/image-20221215230937757.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.583333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABAklEQVQY06WOS0vDUBCF8+sVxL3udKMrXYkuRIQ0MSZNK0oVpVRtS6W1MfeRW036SD7bC/EPOPBxhjPDmXG2ty7Y2b1mb9/l4NDn6Djg5DTk7Dzm8uoO17snjDvctjr4cUQYRUShh+s3OG+0cYM2XtDEjx4IwhZOfPOC5z4SNbu89wXDoWD0IZlMNEmSIYRB6ZlFZ+YPqRRCb2ZrlMbMfhiMxjiF+iId9em9dVkuC/5TiTI432ZGNk1IhURLjZIKrTefyfVlhZSSNE2tCiGsbnxjDFVVWcqytIGfIsNZlRX5emH82uNp8MxUTFktV+R5TlEUzOdzq3Vf+4vFwobUoXXgLwVmc5EZgHVrAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/46999ecf3220dad79948460785ea5a51/8ac56/image-20221215230937757.webp 240w,\n/static/46999ecf3220dad79948460785ea5a51/d3be9/image-20221215230937757.webp 480w,\n/static/46999ecf3220dad79948460785ea5a51/f686e/image-20221215230937757.webp 692w\"\n              sizes=\"(max-width: 692px) 100vw, 692px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/46999ecf3220dad79948460785ea5a51/8ff5a/image-20221215230937757.png 240w,\n/static/46999ecf3220dad79948460785ea5a51/e85cb/image-20221215230937757.png 480w,\n/static/46999ecf3220dad79948460785ea5a51/91e7e/image-20221215230937757.png 692w\"\n            sizes=\"(max-width: 692px) 100vw, 692px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/46999ecf3220dad79948460785ea5a51/91e7e/image-20221215230937757.png\"\n            alt=\"image-20221215230937757\"\n            title=\"image-20221215230937757\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h3 id=\"ghidra-のデバッガで標準入力を送れるようにする\" style=\"position:relative;\"><a href=\"#ghidra-%E3%81%AE%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%81%A7%E6%A8%99%E6%BA%96%E5%85%A5%E5%8A%9B%E3%82%92%E9%80%81%E3%82%8C%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B\" aria-label=\"ghidra のデバッガで標準入力を送れるようにする permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ghidra のデバッガで標準入力を送れるようにする</h3>\n<p>ブレークポイントを設定したのでプログラムを実行していきます。</p>\n<p>普通にプログラムを実行していくと、<code class=\"language-text\">scanf(\"%s\", password);</code>の行で標準入力を待つため、処理が停止します。</p>\n<p>しかし、Ghidra のデバッガの未解決の制限事項で、Interpreter からプログラムに標準入力を与えることができません。</p>\n<p>参考：<a href=\"https://github.com/NationalSecurityAgency/ghidra/issues/3174\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Unable to put input value into interpreter. · Issue #3174 · NationalSecurityAgency/ghidra</a></p>\n<p>このような問題の回避のため、ターミナルの tty を確認し、Ghidra デバッガの Interpreter から接続するという方法を使用します。</p>\n<p>まず、端末で起動しているターミナルで<code class=\"language-text\">tty</code>コマンドを実行し、デバイスの pts を確認します。</p>\n<p>次に、ターミナル側でおまじないとして<code class=\"language-text\">sleep 10000000</code>を実行したのち、Ghidra デバッガの Interpreter で<code class=\"language-text\">set inferior-tty [TTY]</code>を入力し、プログラムを再起動します。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bf20302fa98d7b4c85a6d238d51dbf00/aa61c/image-20221215234644878.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABh0lEQVQoz5WQbWvaUBSA83M0ii9J1GvCNuh+dWEU9mW0vnSbIGZs+BJNTGYSrbWtNbHPbuI2BvuweeHhHA73Pveco5hvLtCbFlrTpKbpCNHCskzabZEjhMA023lumRYfBje44RrHD4hcH9/x8WYes3CGM7VRXl+8RZivaAiLqqbRbDYQrSatPxBCRlm3LIter89wOMS2bdz5nCAKcFyHh/0j6dMRRTfkg7aJKS9XKhVqtRqaVs/jL+r1OtVqJe+22+3Sv+3x8dMto9GIaL1iPP+K601JD3sUVS1SLJ4olUqoaob6M57I6oVCAcMw6HT6LN0NCycmWK54Wt9x567YeT6PYYxSLpf5H7JPjEaDy8t3zCcvjL8krNyIxXBC6IYsgy2zaXQSZh38UygnyIRXV+8J3KOUJvj+mm+2h7eI2MQHwiA5QyhXYxgNrq87bOWYQSBHjmO+y87utween/ekaXqOUM13+HkwYPewI4pC1tGG3b0UJUhZwvF4PE+o6zrj8YS/z8vv7Aep5bNv2c0nBwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/bf20302fa98d7b4c85a6d238d51dbf00/8ac56/image-20221215234644878.webp 240w,\n/static/bf20302fa98d7b4c85a6d238d51dbf00/d3be9/image-20221215234644878.webp 480w,\n/static/bf20302fa98d7b4c85a6d238d51dbf00/e46b2/image-20221215234644878.webp 960w,\n/static/bf20302fa98d7b4c85a6d238d51dbf00/fa9eb/image-20221215234644878.webp 1065w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/bf20302fa98d7b4c85a6d238d51dbf00/8ff5a/image-20221215234644878.png 240w,\n/static/bf20302fa98d7b4c85a6d238d51dbf00/e85cb/image-20221215234644878.png 480w,\n/static/bf20302fa98d7b4c85a6d238d51dbf00/d9199/image-20221215234644878.png 960w,\n/static/bf20302fa98d7b4c85a6d238d51dbf00/aa61c/image-20221215234644878.png 1065w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/bf20302fa98d7b4c85a6d238d51dbf00/d9199/image-20221215234644878.png\"\n            alt=\"image-20221215234644878\"\n            title=\"image-20221215234644878\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>これで<code class=\"language-text\">scanf(\"%s\", password);</code>が呼ばれるコードまで処理を進めると、ターミナル側に入力プロンプトが表示されるため、ここから標準入力を与えてデバッガの処理を継続することができます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9c0cdef24dd126bb30764bfbcd695e2f/7e881/image-20221215234728864.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.416666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABQUlEQVQoz4WR7UvCUByF988Y4guRm3dOF0V9SUJFKPL/NkZKZbm53bW39qLbnHm6LhwZVAcezreH87uXO7u4hNCScdwgEJpNSFILYkvMm+cbuL27wZOxALXeYasWDM2Eqr/Atkw4voskTbHLdrvN4c6ZcEdbPmUiAlluo9Nps+4w4QlGoxEURcH9eAydGlBNDcEqRJZlCKKwEBXCbvcKhAj5Gp7nIQh7BJRKJQyHQ0ynz5hMZrDNN3jUhM86DQKk6ZpJcBBOkiSUy2VUq1VUKpWCWq3GhEfo9a7xoBhYvAL6Izt9RmHqAXSVwnFs+L6PKIpyUnY+RwgpBN+p1+v5wn6/D21uwXMyUOrCsUPE8QdjjeVyxVgyDoTi38LBAJo6Z0s8eF6EMIix2azxW/4VDpjQdS0kydeSJInzd/v5GXs+AWfejUoii/N7AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/9c0cdef24dd126bb30764bfbcd695e2f/8ac56/image-20221215234728864.webp 240w,\n/static/9c0cdef24dd126bb30764bfbcd695e2f/d3be9/image-20221215234728864.webp 480w,\n/static/9c0cdef24dd126bb30764bfbcd695e2f/e46b2/image-20221215234728864.webp 960w,\n/static/9c0cdef24dd126bb30764bfbcd695e2f/f992d/image-20221215234728864.webp 1440w,\n/static/9c0cdef24dd126bb30764bfbcd695e2f/74c35/image-20221215234728864.webp 1521w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/9c0cdef24dd126bb30764bfbcd695e2f/8ff5a/image-20221215234728864.png 240w,\n/static/9c0cdef24dd126bb30764bfbcd695e2f/e85cb/image-20221215234728864.png 480w,\n/static/9c0cdef24dd126bb30764bfbcd695e2f/d9199/image-20221215234728864.png 960w,\n/static/9c0cdef24dd126bb30764bfbcd695e2f/07a9c/image-20221215234728864.png 1440w,\n/static/9c0cdef24dd126bb30764bfbcd695e2f/7e881/image-20221215234728864.png 1521w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/9c0cdef24dd126bb30764bfbcd695e2f/d9199/image-20221215234728864.png\"\n            alt=\"image-20221215234728864\"\n            title=\"image-20221215234728864\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>中々面倒な手順ですが、Ghidra デバッガで標準入力を与える方法としては、他にも GDB スクリプトや Python を使用する方法があるようです。</p>\n<p>また、Ghidra の Interpreter ウインドウから、<code class=\"language-text\">run &lt; input.txt</code>のように GDB コマンドを実行する方法でも標準入力を与えることができます。</p>\n<h3 id=\"レジストリとメモリの情報を確認する\" style=\"position:relative;\"><a href=\"#%E3%83%AC%E3%82%B8%E3%82%B9%E3%83%88%E3%83%AA%E3%81%A8%E3%83%A1%E3%83%A2%E3%83%AA%E3%81%AE%E6%83%85%E5%A0%B1%E3%82%92%E7%A2%BA%E8%AA%8D%E3%81%99%E3%82%8B\" aria-label=\"レジストリとメモリの情報を確認する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>レジストリとメモリの情報を確認する</h3>\n<p>無事に標準入力をプログラムに与えることができたので、先ほどブレークポイントを設定した以下の箇所で処理が停止しました。</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Input yout password: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">scanf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\"</span><span class=\"token punctuation\">,</span> password<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n \n<span class=\"token keyword\">int</span> len <span class=\"token operator\">=</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>password<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>len <span class=\"token operator\">!=</span> <span class=\"token number\">30</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Wrong!!\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ここで、デフォルトで右ペインに存在している Register ウインドウからレジストリの値を確認してみます。</p>\n<p>各レジストリの並び替えを好きなように変えられるのは結構便利ですね。</p>\n<p>Ghidra デバッガを使用すると、レジスタ値の表示、検索、変更などができるようです。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3529692da5cf1afce23446f7450949f7/4cdc7/image-20221216000323779.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 72.91666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAADB0lEQVQ4y01UW2/bNhj1/wf2th/QdSjQPqzBurZpN6AXdEjXJHZjx3F8d2xZkm1dKVJ3yWeHTJONAEGKgs53Lh/Vef32HV69PsWnz2f4++wc/5z30BsMcXM7RX84Rv96jNF4jqe/neKnJyf4+dcT/PLiBE+e389nL9/gxav3eHn6Ab//+Rkd27bQ7w8gVYmmaRBLiVBFqOvaTOCIMBK4GC7wbWxjvA0x2RzQHS2xcGOMJmuMbleY2SFmWx+d9391cfLHOb58neHyaoHuYIHryRKz+QqT6Rzj6QL9wTU2lgs/VKhbIM1q2K6H5sh9kiONFCqeV6zfuewucX3j4rI7x2DoEGRHMBfuboft1oLr6ucl5isboSgg8xZCVdi6ART3/naPyBNQBSCzFh2lJPRIkpAftyj4IssqViuQ5SkV12QWYXHn0A6elUckaQXLPnAPBFyFF4OfIC2O6ASB9quBZW1wd5chTRukLJepAEVKwJYehjGWa5vMCuT8UBLw4McoKFHPnP7n1RE5i3X8IERJY+42WywJmCgtqUTsSySeDgrwQkGGtmGoAfXq7FmQ72SSITpE5lyzJ8OQDFvDcDLNyKZFXpTYewlWa4k4zhFEMWYrB1FSUBbMuvOFkax9VHxWlKuKH4AV44miEI5T0cMWZVlBsLKk+XpEbBsdigEs7wGdffQIqJPWYI8easA4jqFUzXAqAmQ8YzBlodsQAUNZMpQHD/VqJNf3MhORGf+M5DgWJhTPO3DSu7iGlDnXBIKzqRoGEDAUAsr/AN0HQFJWIjXnJpREKrRM0rLWmExocNQadvtDwjNl2Hq+b9pGS82M5ByW45l9Pl0iY5Onpm3YhyKRhqHklfO8moE0yPMSBX0syU6PkKE8AD6EogF1M6/JfM+UU+PnD4b6DicJpROgLDR4if8PISQm8zXbJX9sG30VS163YMP+dPbItXzNMM3oV6KwCwT8WNFswaoH2FtO6wDfj2A7O3z8coHL3pDXc4zv/Rv0+iOc9W5wcTXGYDDCd/6Vrga3+BeKL2XpajlPrAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/3529692da5cf1afce23446f7450949f7/8ac56/image-20221216000323779.webp 240w,\n/static/3529692da5cf1afce23446f7450949f7/d3be9/image-20221216000323779.webp 480w,\n/static/3529692da5cf1afce23446f7450949f7/e46b2/image-20221216000323779.webp 960w,\n/static/3529692da5cf1afce23446f7450949f7/518ae/image-20221216000323779.webp 1327w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/3529692da5cf1afce23446f7450949f7/8ff5a/image-20221216000323779.png 240w,\n/static/3529692da5cf1afce23446f7450949f7/e85cb/image-20221216000323779.png 480w,\n/static/3529692da5cf1afce23446f7450949f7/d9199/image-20221216000323779.png 960w,\n/static/3529692da5cf1afce23446f7450949f7/4cdc7/image-20221216000323779.png 1327w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/3529692da5cf1afce23446f7450949f7/d9199/image-20221216000323779.png\"\n            alt=\"image-20221216000323779\"\n            title=\"image-20221216000323779\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>この時点では、パスワードの 1 文字目が間違っていたため、<code class=\"language-text\">super_secure_checker</code>関数の戻り値が格納される EAX の値は 0 になっています。</p>\n<p>この値を 1 に書き換えてみます。</p>\n<p>Register ウインドウは、デフォルトでは Read Only モードになっています。</p>\n<p>Edit モードに切り替えるには、右上のペンのようなマークのボタンをクリックします。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 708px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/092a294d440c80233ecb93db5b245475/3cb0f/image-20221216001217355.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.916666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABPUlEQVQY04WK2S8DcRRG5/9/8UgiggoRre7baElJqS6qy0w7Na0x3emuVVLq+LXBgxA3Obn3O/eTdnb3ObDaOXS4sdld2J0eHC4fTrcfj0/G7Q3i9R8RkI+RQxFOTs+JXiRJXOVIXSukskViyRynZ+f4RUeyBBOEoymUvEI+r6IoBdQFapFCQVuyuGOxONlsnnLZoFIxMM06BeG1nIJWvCGdzoi/ghRJ65TqffRGn3JjIPYXwglfaQ3JlEyiVypatbN0pVpX0KNotNFzN+hqBU1k5baFtGYLYQlesv0rMSxynHVXhFWrzFbg4ru78Ju+KCvbLjYOw8u8F0og3dU7/DeTyQu1WpP5+4/HK8yqDebD8TKORk9IunnP4/TtT8bP77QehpTKJt3BVOT5p58znMww6m0arR7TGTTvB3wAtnimOW+KbDYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/092a294d440c80233ecb93db5b245475/8ac56/image-20221216001217355.webp 240w,\n/static/092a294d440c80233ecb93db5b245475/d3be9/image-20221216001217355.webp 480w,\n/static/092a294d440c80233ecb93db5b245475/3f436/image-20221216001217355.webp 708w\"\n              sizes=\"(max-width: 708px) 100vw, 708px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/092a294d440c80233ecb93db5b245475/8ff5a/image-20221216001217355.png 240w,\n/static/092a294d440c80233ecb93db5b245475/e85cb/image-20221216001217355.png 480w,\n/static/092a294d440c80233ecb93db5b245475/3cb0f/image-20221216001217355.png 708w\"\n            sizes=\"(max-width: 708px) 100vw, 708px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/092a294d440c80233ecb93db5b245475/3cb0f/image-20221216001217355.png\"\n            alt=\"image-20221216001217355\"\n            title=\"image-20221216001217355\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>これで、各レジストリの値をダブルクリックすることで任意の値を書き込むことができるようになります。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 434px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8e9ae5e4f46f2cf408192eb896eee91e/ade6e/image-20221216001312549.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACQ0lEQVQoz02Sa08aQRSG9wc3TbVp+qX9C72pqTFNm5gmRo22xqqJqQVBLSK6sLDLXcpFRAiwXJbl6tOzS9F+eDIz533nzMyZo6haClVLE46micQex//R9IxL1Jgym0f0rMwdTwo9cU0snkV5887D0kcfyyt+Pn0+YfVrgPXNCza3gsI533dD7O6F+HEQ4vBI5divEbgwOA/F+HWisn9wiNd7zJfVNb7t7KOcnkY4+625BIM6P4/O2Nv3yPqKyyudK0FVhbBORIsTOL/kyOtDjeoYyRQejxefzy+coEUNlK49wqU3pFY3yeYK6PE0bWtIpzdyxxkda0St0SUfjlFTozTTf6hUW9xWTczOgHyxglKQwAzVyBKMJNzxttGjcNeiWJ3RdtfN7pDxYMKwY2Pf3FEWrVTvUhYi6RLK3MIG84sbPPuwzoulTV6tbPNamFtYZ160uX88F8+Tt2vs+FW6gyHmYET+rs7L5W1379P3ayxueVEanT4O9bZNNl9GM9JSnwQteW69PdUePX3avTG5WBI9ECIjXleTuCklicpPK70BONhDpBZNMtdFqWPJXc+0B49gCaNKnYkcPhJfr3/vaoMxpDJ5FEsCVn/iBhumJcmKZIQRTpKpNvXMfPfcVOtkS7cUxGfJjR3NuUAyLQltMfRld6vbd5M5qBHd/TFTCu+c7Hjs4SMNs0O11iBXKEuHjN3Yww1b1gTZR1V+1en6uJxyGpAeDBvoyRxSIhxPq3f/gOOXTqNUaUpdpaWcmPjiqTx/AajHE/84hS77AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/8e9ae5e4f46f2cf408192eb896eee91e/8ac56/image-20221216001312549.webp 240w,\n/static/8e9ae5e4f46f2cf408192eb896eee91e/e6590/image-20221216001312549.webp 434w\"\n              sizes=\"(max-width: 434px) 100vw, 434px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/8e9ae5e4f46f2cf408192eb896eee91e/8ff5a/image-20221216001312549.png 240w,\n/static/8e9ae5e4f46f2cf408192eb896eee91e/ade6e/image-20221216001312549.png 434w\"\n            sizes=\"(max-width: 434px) 100vw, 434px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/8e9ae5e4f46f2cf408192eb896eee91e/ade6e/image-20221216001312549.png\"\n            alt=\"image-20221216001312549\"\n            title=\"image-20221216001312549\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>続いてメモリの情報を参照していきます。</p>\n<p>メモリウインドウを起動するには、ツールバーの[Windows]>[Debugger]から[New Memory View]を選択します。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 642px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8e58cf5232b45d70de5c5c7baff3c8f2/1bba8/image-20221216001606201.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.08333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACDElEQVQoz3VSy27TUBD1Z/IjbPgGFqy6A6WoGyRaQAi1lSpWIU1rO3H8fsePOPHbSShleZi5bSokyuLoeuaOz8w5c6WXr9/ixas3OHr/ESefLjE6vcAx4+wSH75eYTyRcX2j4nqqinMyVR7iZzChGunLlYJ3nyc4uRhj9O0HRudTHBOOTr/j5HwM3bRh2i5cL4QXRIiWKfrtz3+w3f9CtiohTVUPeZxDUVW4jouu7XF//xtDP6AoNhjPA9wqGrSFiSBKUNYd6nZLGJ5QEdp+hzjJIWWbmj4yaLoFm6bwwyVW6wr97g4F3VlRDMP24PohHLrfVC26YS8I/gbnqqaDVFHHgCb0/EgU8/hNt30s6JFkMaY3tzAtVzTaVM1/Ccu6pQmzCLO5jPnCEj/phi2ImJjlWYYFWZkJ78I4QRSnSPO1AEtkyVw7kKJ13UBalQNMMyTJJpEaCEgyd0uyAss0h2xomOuGIOAGaV4gL0pxn6QrOle0jI3ILTPyMEkzGKYjvGOPeDomPHjihyFkdU6b9kRDy/HEpJbjw6Icx7x94bEbQmLdHCgzjaTr4vvgYU3kTphC1QwijsWUnH/u2Qz7O/J3gFSTjJCew0zTsaBNc1cm5CJeUhAtYbs+1mXztLADDgt5iHeiXpKJIM5T4R2DCVnqgZCfDhPy02r7RyImoGWsy06gbgaafEe1Df4AbaEXIkgyk/QAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/8e58cf5232b45d70de5c5c7baff3c8f2/8ac56/image-20221216001606201.webp 240w,\n/static/8e58cf5232b45d70de5c5c7baff3c8f2/d3be9/image-20221216001606201.webp 480w,\n/static/8e58cf5232b45d70de5c5c7baff3c8f2/7eb86/image-20221216001606201.webp 642w\"\n              sizes=\"(max-width: 642px) 100vw, 642px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/8e58cf5232b45d70de5c5c7baff3c8f2/8ff5a/image-20221216001606201.png 240w,\n/static/8e58cf5232b45d70de5c5c7baff3c8f2/e85cb/image-20221216001606201.png 480w,\n/static/8e58cf5232b45d70de5c5c7baff3c8f2/1bba8/image-20221216001606201.png 642w\"\n            sizes=\"(max-width: 642px) 100vw, 642px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/8e58cf5232b45d70de5c5c7baff3c8f2/1bba8/image-20221216001606201.png\"\n            alt=\"image-20221216001606201\"\n            title=\"image-20221216001606201\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>ここからメモリ内の情報を表示、編集することができます。</p>\n<p>今回は特に使用しないので割愛しますが、メモリ内の検索もここから行えます。</p>\n<p>また、右上のカメラのようなボタンからデバッグ時点でのメモリのスナップショットが取得できるようです。</p>\n<p>これはなかなか使えそうな機能ですね。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ce3724d57ef692c723970c4ca23d360f/fd84e/image-20221216003052034.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.41666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACXUlEQVQoz12SW08TURSF+281vigaDQZKFUi1cguRP2GiLxqkF0qpbedeZtphrr1MK4GXFpzahAIFlmtGI2iTnX3mtP3Ot/acxOzcIhZepZFcWMZc8jXmU8tYXF7BUnoN6cwG1ta3sLaxhdX193i3uok3mXXWxl29/f2cWdnEfHIJiQ8fPyFfLCNb2MN2No9scR/5vSpypQp2KyLKNQWyasBoOjDtFiy3A8cP4nLbfbSCY5iWD79zhGKphsT21xwkRYPTtOAbJkxNh6M3YbP77FGlFjN48GgGj2dm8WI2hWQqjafP5zHz7CUePlnAl2wZw9MQ2XwJCUVV0e52gTAEggDjVgvo9XDBPu33ccXvdnYK+LxdQKkiQ9IaqMk6KoIGieaFfQl6w0T0ESUVCUEQYTkOrgcD3BLyk+tJu41zy8IPwr6zVxlbIMRt9Vh9GKbLVDoOGjZ004Pr+XdAWVbgE3B9dhabTbkedTqYeB5wdISR7/OHdeyVRQKiObYJ9FAT66hxX9JMOK73r6Hturg5PcM1DYc0igwvbBsTgkM+i6KKqqjFFVlFYEE+gFI347Xj3AMqfwxBwyvO8IRwEHTDfsLIA9eByMi7+wLnpqJ56Meg0jcaG4zc9GA7/xk6/PPlcIhLxjvnDKeMe0vDCwJP2TW+iIbVYpIubC/g1enGFdlqugXXvTdDRVFjwykNQ/YwgnGWYx4SEjhiZK3Oa8SX0TgMaNQnKKoe4T00o4PuG1YqVTRME7c05FE4NgyMaQrujQgf0FCW68iVFV4Xzk0z4oselcT9qqCgG/T+An8BNZzpa9/rV0YAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ce3724d57ef692c723970c4ca23d360f/8ac56/image-20221216003052034.webp 240w,\n/static/ce3724d57ef692c723970c4ca23d360f/d3be9/image-20221216003052034.webp 480w,\n/static/ce3724d57ef692c723970c4ca23d360f/e46b2/image-20221216003052034.webp 960w,\n/static/ce3724d57ef692c723970c4ca23d360f/663aa/image-20221216003052034.webp 1056w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ce3724d57ef692c723970c4ca23d360f/8ff5a/image-20221216003052034.png 240w,\n/static/ce3724d57ef692c723970c4ca23d360f/e85cb/image-20221216003052034.png 480w,\n/static/ce3724d57ef692c723970c4ca23d360f/d9199/image-20221216003052034.png 960w,\n/static/ce3724d57ef692c723970c4ca23d360f/fd84e/image-20221216003052034.png 1056w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ce3724d57ef692c723970c4ca23d360f/d9199/image-20221216003052034.png\"\n            alt=\"image-20221216003052034\"\n            title=\"image-20221216003052034\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h3 id=\"フラグを取得する\" style=\"position:relative;\"><a href=\"#%E3%83%95%E3%83%A9%E3%82%B0%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B\" aria-label=\"フラグを取得する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>フラグを取得する</h3>\n<p>さて、いよいよフラグを取得していきます。</p>\n<p>本来であれば、 GhidraScript か、Ghidrathon から起動した Python インタプリタを使用してブルートフォースでフラグを取得する予定だったのですが、残念ながら断念しました。</p>\n<p>Python から Ghidra のデバッガを操作する API 自体は、<code class=\"language-text\">FlatDebuggerAPI</code>として用意されており、<code class=\"language-text\">from ghidra.debug.flatapi import FlatDebuggerAPI</code>でインポートすることで使用できそうなのですが、残念ながら<code class=\"language-text\">FlatDebuggerAPI</code>はまだ<a href=\"https://ghidra.re/ghidra_docs/api/index.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ghidra_docs</a>でドキュメント化されていない API で、issue やサンプルコードもなく、実装が難しかったです。</p>\n<p>一応<code class=\"language-text\">writeMemory</code>とか<code class=\"language-text\">breakpointSetSoftwareExecute</code>といった名前のメソッドは実装されているようでしたので、ソースコードレベルで参照していけば使えるかもですが、Ghithub のソースコード検索でも<code class=\"language-text\">ghidra.debug.flatapi</code>を使っているコードはほとんど見つからなかったので、現状はまだ使われていないようですね。</p>\n<p>一応<a href=\"https://github.com/NationalSecurityAgency/ghidra/blob/6a1a64921350bb4d9bbd2db6bb6f827afe4346c8/Ghidra/Debug/Debugger/ghidra_scripts/DemoDebuggerScript.java\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">唯一のサンプルコード</a>を使ってプログラムを再実行したりメモリやレジスタの値を読み取ったりなどはできたので、頑張れば実装できなくはなさそうですね。</p>\n<p>というわけで、 Ghidra のデバッガの GUI 操作を併用しつつ、フラグを取得していきたいと思います。</p>\n<p>まずは、先ほどセットした<code class=\"language-text\">super_secure_checker</code>関数の戻り値を取得するためのブレークポイントは削除し、<code class=\"language-text\">super_secure_checker</code>関数内で復号されたフラグ文字がレジスタに格納され、入力値との検証が行われるアドレスにブレークポイントを設定します。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d5dc91933069d29b0b3c26dd9bffd806/f680b/image-20221217210054982.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACT0lEQVQ4y4WTW2/TQBSE8///Ag8ggfqGeCqqoEKoBdTUSdNm08ROk/SStrn4nvV11/YwNrQQFYWVjrJWdj/NzDnbOvh0iP2PB/jy9TtOjR6M7gW65wLnYghzPGXNYF7N0L+0MJ7coN3p4+i4C8MQPC/Q6fDsmYDoj2CNrtBaLNYYDi8xHj+iXnlWIMlTBMkG/1piOMFyeQfoCloDKgMqVT3/3xLWHO0TA92za8RJBdfL4AQxHlwPMtKI4oKlIVlJVqE/GMN1bV4tURQFyrrKEmVVoqoqtGY3c1yIPkbjOZVp+IR5UmIZeASliKIYUsbYyAhxnEDQehhGjZoa8LTqfQN8t3eMV69/4M3bE+y9N/Bhv4f9zz0cHgl8OzWZ2QC98z7OLgZoGx2ctDsEyi3IUzWWHxc20lQhyxR8WyJgSSrwFiHcVQzXiZlV0djjLQzNKwTB5oXC5wxtx/2TgS4ZDYtBFz4Bstw6rCsFMTK3FL4Arm2HjIo5SVgcE8cBc1P8zvlrs1EhCipUuWoujKzpboVr262dYLMJIYSJ+bze51SRIQwcLBf3iIMQsV+romVrthu4Wv9SGMURbm/vcX0N+D7HJMqQpcyTIKW5z5gD525oTXYD7x5WKAi0vRDdrsCUQNvL4fgZ7lcrTO8eITcJQo6OoutLk5bDHUDX9ZHndZdTvgAHgc+eZBziRDHDlGrTv47XXZ78B+gFjR2lFQc3ZTPQNCQM08aqLovfl/nMyrrL1u4u10DFR5mmtUK7sRUxP9eNma3eGlpN4IDAYAfwJxErKu8+WqE6AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/d5dc91933069d29b0b3c26dd9bffd806/8ac56/image-20221217210054982.webp 240w,\n/static/d5dc91933069d29b0b3c26dd9bffd806/d3be9/image-20221217210054982.webp 480w,\n/static/d5dc91933069d29b0b3c26dd9bffd806/e46b2/image-20221217210054982.webp 960w,\n/static/d5dc91933069d29b0b3c26dd9bffd806/17ad2/image-20221217210054982.webp 1108w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/d5dc91933069d29b0b3c26dd9bffd806/8ff5a/image-20221217210054982.png 240w,\n/static/d5dc91933069d29b0b3c26dd9bffd806/e85cb/image-20221217210054982.png 480w,\n/static/d5dc91933069d29b0b3c26dd9bffd806/d9199/image-20221217210054982.png 960w,\n/static/d5dc91933069d29b0b3c26dd9bffd806/f680b/image-20221217210054982.png 1108w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/d5dc91933069d29b0b3c26dd9bffd806/d9199/image-20221217210054982.png\"\n            alt=\"image-20221217210054982\"\n            title=\"image-20221217210054982\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>これで処理を進めてみると、入力値として適当に与えた文字 A が DIL レジスタに格納され、復号されたフラグの 1 文字目である H と比較されていることがわかります。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 634px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/26dc471a395933675925351b06c00ec0/374ac/image-20221217212333909.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.916666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAABBUlEQVQY03XKW0vCcACG8X3lDIoONx2IogKjjIhCkbAuSopZmpptM09Z0YFmEGhYQZHmadOca0//uqirLn7wwPtKrn6ZoeEIfS6ZgcF9RkbDjI1HmZiMMTUdZ2Y2wdz8Me4FhSVPkkWPyvKK9mN1Lcm6N4XPn8a/kSGwlUVyezU2A3Hk0BmH0Svhku0djdDBKapyQzCoEI7kicbO2d3TUNRrjhIXnKRvSQnpjE4mq5PN6eTyBaRC6ZFqvcEn0HPAEmF+9OjYDr16k9fyE4ZlU2+a3Bcf6Iq93bURF8Gh8836I5WfK+h3RUrlF2otC6OD4GB0ofZuUqkamKIbhs1brf27t/7xBXriFDA5E9PkAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/26dc471a395933675925351b06c00ec0/8ac56/image-20221217212333909.webp 240w,\n/static/26dc471a395933675925351b06c00ec0/d3be9/image-20221217212333909.webp 480w,\n/static/26dc471a395933675925351b06c00ec0/14369/image-20221217212333909.webp 634w\"\n              sizes=\"(max-width: 634px) 100vw, 634px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/26dc471a395933675925351b06c00ec0/8ff5a/image-20221217212333909.png 240w,\n/static/26dc471a395933675925351b06c00ec0/e85cb/image-20221217212333909.png 480w,\n/static/26dc471a395933675925351b06c00ec0/374ac/image-20221217212333909.png 634w\"\n            sizes=\"(max-width: 634px) 100vw, 634px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/26dc471a395933675925351b06c00ec0/374ac/image-20221217212333909.png\"\n            alt=\"image-20221217212333909\"\n            title=\"image-20221217212333909\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>ちなみに、Ghidra のデバッガの Register ウインドウでは Type の列は任意のデータ型を設定でき、上記のように Value が指定した型と一致する場合は、 Repr 列にその型の表現を出力してくれます。</p>\n<p>このまま処理を続行してもらいたいので、 Register ウインドウの編集モードで、 AL レジスタの値を 0x41 に書き換えます。</p>\n<p>そうするとパスワードの検証をパスすることができるので、処理を進めることで、2 文字目のフラグを取得できます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 406px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f508f429e7ae78467e2a519c34af7451/e33ef/image-20221217213550602.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABUklEQVQY00WNy0sCcRhF53+sNklBYZtqUYuCalPRYx3tjBZKi4lwfCRqWO4UrKg0xMrHlIaa+RidyczJTr+xRYsD9ztc7iftbB1jG5eZmFQYt7kZGZUZHZOZmlawz3iw273MzQeYnfOzsBgYsrQcZmU1zOpamPWNc9Y3LSJs70aR9o5ibOxHOTiM4HCEkOUYbncCRUng8SRwuc5xOiP4vAmC4VtOlDgu5xmngUuCwWvRj+LzxwmFrvD7Y0gXN1miqQLppyyFlxea7Q6abtASNDs6pUoVtVjiva3TrtUp5/Jk8gVqjRYN4W6SKbLqM3XN6r4h3d0/kH58plgsY3S/MQfQ6//TF7flzB/Qak0qagnN6GF+w5cJmccc5Wp92OkLJyXTWZ7UihhVST/kxbdX3hoG+ie0PwZ/dAdixCSVyZEv1WiJbPlO94dq3eBd6w2z5X4BfxNR/M9mjb0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/f508f429e7ae78467e2a519c34af7451/8ac56/image-20221217213550602.webp 240w,\n/static/f508f429e7ae78467e2a519c34af7451/09a6f/image-20221217213550602.webp 406w\"\n              sizes=\"(max-width: 406px) 100vw, 406px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/f508f429e7ae78467e2a519c34af7451/8ff5a/image-20221217213550602.png 240w,\n/static/f508f429e7ae78467e2a519c34af7451/e33ef/image-20221217213550602.png 406w\"\n            sizes=\"(max-width: 406px) 100vw, 406px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/f508f429e7ae78467e2a519c34af7451/e33ef/image-20221217213550602.png\"\n            alt=\"image-20221217213550602\"\n            title=\"image-20221217213550602\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>この操作を 30 回繰り返すことで、<code class=\"language-text\">HimitsukichiCTF{you_w0n_dra!!}</code>というフラグを取得することができました。</p>\n<h2 id=\"windows-で-ghidra-のデバッガを使う\" style=\"position:relative;\"><a href=\"#windows-%E3%81%A7-ghidra-%E3%81%AE%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E4%BD%BF%E3%81%86\" aria-label=\"windows で ghidra のデバッガを使う permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Windows で Ghidra のデバッガを使う</h2>\n<p>さて、ここまで来たらついでに Windows でも Ghidra のデバッガを使ってみたいですよね。</p>\n<p>使用するファイルは、先ほどと同じ<code class=\"language-text\">task.c</code>を Visual Studio 2022 でビルドした PE ファイルです。</p>\n<p><a href=\"/file/task.exe\">サンプルプログラム</a>からダウンロードできます。</p>\n<h3 id=\"デバッガを起動する-1\" style=\"position:relative;\"><a href=\"#%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%82%92%E8%B5%B7%E5%8B%95%E3%81%99%E3%82%8B-1\" aria-label=\"デバッガを起動する 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>デバッガを起動する</h3>\n<p>基本的な操作は前述の Linux 環境と同様ですが、Windows の場合は、 GDB ではなく WinDbg に依存しているので、WinDbg のセットアップをしていない環境の場合は事前にインストールしておく必要があります。</p>\n<p>また、WinDbg と同様に、ユーザモードプログラムの解析であってもメモリアクセスのために High Integrity が必要になります。</p>\n<p>そのため、Ghidra を管理者権限で起動しておきます。</p>\n<p>Ghidra を起動したら、[Debugger] ツールバーから、[in dbgeng locally IN-VM] を選択してデバッガを起動します。</p>\n<p>dbgeng は、WinDbg などの Windows デバッガで使用されるインターフェースです。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 670px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a63190e7bd42b876fb867cfafbebe16a/d67fd/image-20221217221018539.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.91666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABzUlEQVQoz0VSaWsUQRCd/+1H/4Ug+E0IEsXgEoQgIRE0imFzGNy5tq/pue/J7mZn51ndm9VhHtV0V71+r6qdPMuQJikinWApY+gkw24zABjpXwPT0x67De1t7XoatxjHEdM04fAd1k6WJoiVgK9yvP6q8eaC4f0Vw8m1xsk8xel9idltjk83GU5/V5hRnC8EpJSIIo08zy2GYUDXdXDevvuAo+OPmJ1d4Jtf4vxe4exG4PwhwaVb4tKrcMUH/CB8Zz1+igF3YQIpJMIgQBiG8DwPRVnC9304L4/neHH0C68+30KLEHWRospiizrfY93V2AwNocX2sYXPIoRLDnexgJIKGbWtbVsIIeAcevC03aEoCmtDx9RLHVNfNe2VaNoO+fOZsRfwGIxLq8go5Fygqipr+5lwwmq1glCKbJgEbgvNBSVZMTAFBm3bwGOaCIW1zBiD67qISUTf9/8VPq7WcHliyYTgNkolbbQXELmx1RGhzzWWxvKfhVVoYOzaoRwI22GNLw+ZPTAEjBExqYhUZBMNWdM06LsWLvVwyehl0DCMo4CsM6ox5/8IB1J4HWTgRKiUtImaemaS6rreR4KxHJBCZgl9BGbSBDtpcvEX2jWZ91dLT7sAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a63190e7bd42b876fb867cfafbebe16a/8ac56/image-20221217221018539.webp 240w,\n/static/a63190e7bd42b876fb867cfafbebe16a/d3be9/image-20221217221018539.webp 480w,\n/static/a63190e7bd42b876fb867cfafbebe16a/6cceb/image-20221217221018539.webp 670w\"\n              sizes=\"(max-width: 670px) 100vw, 670px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a63190e7bd42b876fb867cfafbebe16a/8ff5a/image-20221217221018539.png 240w,\n/static/a63190e7bd42b876fb867cfafbebe16a/e85cb/image-20221217221018539.png 480w,\n/static/a63190e7bd42b876fb867cfafbebe16a/d67fd/image-20221217221018539.png 670w\"\n            sizes=\"(max-width: 670px) 100vw, 670px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a63190e7bd42b876fb867cfafbebe16a/d67fd/image-20221217221018539.png\"\n            alt=\"image-20221217221018539\"\n            title=\"image-20221217221018539\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>今回はローカルデバッグを行うので [Connect] の設定は既定値のまま進みます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 347px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/dd40bcc7e8e8a79e9d8c5ca03dfef1f8/39e45/image-20221217221345171.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 87.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAACR0lEQVQ4y6VU2a7aQAzN//9KX1q1j5UAAUK9atkhZF+AQIAkhPXx1McQilqhqreRjmbiGR8vY9tYJinsMMYmTZEkCTabDfI8R5Zluv4N1b3tdqv6RrTcYRKkyHc7JMsEp9MR7/mu1ytSccpYr1co8gzr9VoFr0DPX51Rl54ul0sYcRzj29sbWq0W2u02ms0m6vW67inrdDpoNBqo1WrodrsYDAZ/YDgcot/vw/M8IYwimFMTpmliNBrB9304jgPLsnQ/Ho91TxlBGRV934Nt2wiCQHUZqXoYhoEqEOPxBGEUw5KLrusiCEOxPIB9J5tMJip3BCS1rNu9kRhNVissFkJIVtf1MJvN7p7ZSmTfSeN4LnsHocgOxyP2+z3K8qDKJC6KPS7yIJSFEq2xWCyUjOHSSxJ5nvswwBC5Z2gsDT4OQUM8L8sS5/MFx+MJUUU4nU41uczF9J5PXqacBnhGYzTa6/UUnudrBCS7XC5SbmchjGHM53MUEsbhUIr7hYZUgdZ/XytUd6hDZFLcYRjdCLMsfxz8KyriPC9+EbJ1nq29h/RByOTSw/8nzLUS9FHS+8ul2l4vsHkhe2B7e2XWIa3sZDiwH/fS16XUVlnkD1BGD569ep42qrcvwPQZK6lwFqceCoIkgxlHsOYrOPONwktuw4PjiRER1KOsImbY2no80DKgl5LYjrPD5+9f8KkzwIevP/CxNUbLEUOBr/XJwcFBwbpkziqPyXHv5VALlL1JmLYrvSytaHN/+yeq4VCBBc+VOpU+15+RQC05grA2MAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/dd40bcc7e8e8a79e9d8c5ca03dfef1f8/8ac56/image-20221217221345171.webp 240w,\n/static/dd40bcc7e8e8a79e9d8c5ca03dfef1f8/2baae/image-20221217221345171.webp 347w\"\n              sizes=\"(max-width: 347px) 100vw, 347px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/dd40bcc7e8e8a79e9d8c5ca03dfef1f8/8ff5a/image-20221217221345171.png 240w,\n/static/dd40bcc7e8e8a79e9d8c5ca03dfef1f8/39e45/image-20221217221345171.png 347w\"\n            sizes=\"(max-width: 347px) 100vw, 347px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/dd40bcc7e8e8a79e9d8c5ca03dfef1f8/39e45/image-20221217221345171.png\"\n            alt=\"image-20221217221345171\"\n            title=\"image-20221217221345171\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>コマンドライン引数が必要な場合はここで指定できます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 478px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/29cb494942e9e0a149750fe37cdea72b/50978/image-20221217221439913.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.583333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABFUlEQVQY012QS2+DMBCE+f+/qVIPVQ99RU2TigZibGMetgOCAGmU5jDddYjU9PBp2LV3xmxUWo9MF/DOwloL73dwzsHWNfU8alKmaRqM44hhGIL+h/s8H+WlRe1aOCrq2ZCNyqIM6qyjnseeBs7nM06nH+KE7+PxhiPBwZFSCsbkyKSEUhqS6jw3MEWBLJOQUgX4bLsVoWdMga7r/9Ch6/d0TyLSWoeBzSaBEAKKaq1zcJAmJBlxgCAzFb7zcM4ruLJjbduLIT/zcDhgmqZ5HwMG0oXwuFsIPL5/4S2tYGqPbZogjmNUVYW+728IO+RfNsbMqZf0K89rgfuXTzy8fuBpRUZJivVqheVyiSRJbu4y7MMv/AVTwLs/nfb8oAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/29cb494942e9e0a149750fe37cdea72b/8ac56/image-20221217221439913.webp 240w,\n/static/29cb494942e9e0a149750fe37cdea72b/2b263/image-20221217221439913.webp 478w\"\n              sizes=\"(max-width: 478px) 100vw, 478px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/29cb494942e9e0a149750fe37cdea72b/8ff5a/image-20221217221439913.png 240w,\n/static/29cb494942e9e0a149750fe37cdea72b/50978/image-20221217221439913.png 478w\"\n            sizes=\"(max-width: 478px) 100vw, 478px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/29cb494942e9e0a149750fe37cdea72b/50978/image-20221217221439913.png\"\n            alt=\"image-20221217221439913\"\n            title=\"image-20221217221439913\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>デバッガが起動すると、GDB のときと同じく、Interpreter ウインドウに WinDbg のインタプリタと同様のコンソールが表示されます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f942deac71569cd22a69162b3f34cf6f/9239a/image-20221217221508893.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.16666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB70lEQVQ4y42T646jMAyFef+X2/7ptExbbgUawiWBhksS4IxD1e7MSrOqJSuCJJ/t+NgrygKXMEJ71+gn5xPk0EHP9uHWwCwz6rpGG8UYZYuxbbEohbXvAefzjBVk6wqPOWCS4MoGlEJB0MFSMlSt2LwdFAarwasSvOCQBJRth1FrTMZgonUm4INHQCEa3DIG0SyYxhlGz1BdDU2ZPk49FiEENF1+mrv83V9Ape5grMT9DlgKZO0K1VNZ0whj7AvQdd0ryBPw3Z7/vN1uh92fHT72Ps7nM8IwQBRH4LxASe7WgjHEUfjK8N/sfmR4Op2w90PsLxn8qIAfkF84okzgnFQIshqXtKLGxT+Av5m3lUOVFFRy2a/IhUXEJiTljLRetv+cGskqSU/wBtC9C5caYTHglE4ImMYh7hByg0zMuLUL8nZFVtSw7wAt6Uwog7TscQw63ARlI+i7GVGpBbWirOuR9qnL7wANaclaC0myyDMnDZB8SF8UaF6W7ZDbu3FOQPNrU57uuYd28pBSElDCKcMBlR5oSh6yaeoG7MZg3gE6lS/LuumMF8pND2jSsOBvWdM4oabpeAb4n3lNQ9FJZ2EQ4nA4k3/iePARhCGS6xVpmiIIAnwcffifFyQ0pnEc40p78TVFnKTI85wYfJv3L6x/62W5bBkbAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/f942deac71569cd22a69162b3f34cf6f/8ac56/image-20221217221508893.webp 240w,\n/static/f942deac71569cd22a69162b3f34cf6f/d3be9/image-20221217221508893.webp 480w,\n/static/f942deac71569cd22a69162b3f34cf6f/e46b2/image-20221217221508893.webp 960w,\n/static/f942deac71569cd22a69162b3f34cf6f/0d9bd/image-20221217221508893.webp 1246w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/f942deac71569cd22a69162b3f34cf6f/8ff5a/image-20221217221508893.png 240w,\n/static/f942deac71569cd22a69162b3f34cf6f/e85cb/image-20221217221508893.png 480w,\n/static/f942deac71569cd22a69162b3f34cf6f/d9199/image-20221217221508893.png 960w,\n/static/f942deac71569cd22a69162b3f34cf6f/9239a/image-20221217221508893.png 1246w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/f942deac71569cd22a69162b3f34cf6f/d9199/image-20221217221508893.png\"\n            alt=\"image-20221217221508893\"\n            title=\"image-20221217221508893\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h3 id=\"ブレークポイントを設定する\" style=\"position:relative;\"><a href=\"#%E3%83%96%E3%83%AC%E3%83%BC%E3%82%AF%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%99%E3%82%8B\" aria-label=\"ブレークポイントを設定する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ブレークポイントを設定する</h3>\n<p>デバッガが起動したら、デコンパイラを使って<code class=\"language-text\">main</code>関数のアドレスを特定して、ブレークポイントを設定していきます。</p>\n<p>PE ファイルの静的解析については今回はスコープ外ですが、 entry 関数から追っていくとすぐに<code class=\"language-text\">main</code>関数が見つかると思います。</p>\n<p>最適化の兼ね合いかよくわからないですが、デコンパイル結果では<code class=\"language-text\">super_secure_checker</code>関数の処理も<code class=\"language-text\">main</code>関数の処理の中に組み込まれてしまっているようでした。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 593px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cdd28ef8f7fa714cd3508ae79d0fee26/0b5b1/image-20221217222119584.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABoklEQVQ4y5VT6Y6bMBjk/R9uK20SSH+0arUhCRsOH+DbTAfSrZq0226MPhmwPJ7jc1GWe4yjg3MTYvQsh5gS5jmz5l+1jLf5X6PYbkukZKDkVwJ3kPI7Jmtxv/cjYCtgVVWw1qPvRxgjME0NrBvJWMJ7Mg9+QcP6fITh8/OG7DwOtUA3nGHGV4hRoBVfYKYeIaYb6f8rMvxM3wysqWGcxWADpjRD+oSYMx4dxXazobwMIRbQgf4p6EW6lfy2kGaC8gHCeShLC6xACA6Wdmid6bmGUgpSKNo1XT1cnNF6hFYDQc5cWIA1EuX6GOGYuk/X98ROSCmuneD9zAok5NY5cr3Y7XaIQaFrOww8pdUHXMYLTrLhxvS45KraMd0BKf/stbtWebSKp6dPeHlpcDqecGlfMToNx+YOlPUHKN7m69F/ayNKLmmypWwCecsAFEww9Mvf8b2hjvdasijLHU41cDgAR1bfMpCxZjBn9F2H5tuE7igh6wZ66OB5+HLO71fyBnC/r9C2Gc058sZcU4vJImem6zPTzrw5S4LT+j+uzN+X/AOqDPdU4Lb7cgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/cdd28ef8f7fa714cd3508ae79d0fee26/8ac56/image-20221217222119584.webp 240w,\n/static/cdd28ef8f7fa714cd3508ae79d0fee26/d3be9/image-20221217222119584.webp 480w,\n/static/cdd28ef8f7fa714cd3508ae79d0fee26/ee627/image-20221217222119584.webp 593w\"\n              sizes=\"(max-width: 593px) 100vw, 593px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/cdd28ef8f7fa714cd3508ae79d0fee26/8ff5a/image-20221217222119584.png 240w,\n/static/cdd28ef8f7fa714cd3508ae79d0fee26/e85cb/image-20221217222119584.png 480w,\n/static/cdd28ef8f7fa714cd3508ae79d0fee26/0b5b1/image-20221217222119584.png 593w\"\n            sizes=\"(max-width: 593px) 100vw, 593px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/cdd28ef8f7fa714cd3508ae79d0fee26/0b5b1/image-20221217222119584.png\"\n            alt=\"image-20221217222119584\"\n            title=\"image-20221217222119584\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>そのため、Linux のときと同じく入力値と復号されたパスワードを比較している行に<code class=\"language-text\">SW_EXECUTE</code>のブレークポイントを設定します。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 895px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/16f45ef5adfe5976d1ade4bca107cec6/fcbaf/image-20221217222250084.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA9klEQVQY0x3Py07DMBSE4bz/2yCxR6gLFkhIBaTS0pK0OG3iXHyJEzu3/lhsj3RmvknGEPB+ZAwQ/IJSA6OfuY8LQ+8ZhoFlmhA3xfYo2KU3dlnB10WSScu5tLSqorPV/29SVoq8sFQtOH+n1oE+rNSlo2gs2nn6WPApHA9vgsfXlKe9YnPqeD5aXn4MHyfBNb9iu45E5AVpVlGUMbBfqeqoCiPXUtKagRB107pGheZyzmhkidUtzmq8szTxvtl+c9jvMNaSaKWoK0MMZ5nvceLEuqzotkMbzxinz/OKcz1CCNI0o24ajDFIKbnJmvfjbxTmEdTzBw4XLa1NKPDoAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/16f45ef5adfe5976d1ade4bca107cec6/8ac56/image-20221217222250084.webp 240w,\n/static/16f45ef5adfe5976d1ade4bca107cec6/d3be9/image-20221217222250084.webp 480w,\n/static/16f45ef5adfe5976d1ade4bca107cec6/dcb2d/image-20221217222250084.webp 895w\"\n              sizes=\"(max-width: 895px) 100vw, 895px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/16f45ef5adfe5976d1ade4bca107cec6/8ff5a/image-20221217222250084.png 240w,\n/static/16f45ef5adfe5976d1ade4bca107cec6/e85cb/image-20221217222250084.png 480w,\n/static/16f45ef5adfe5976d1ade4bca107cec6/fcbaf/image-20221217222250084.png 895w\"\n            sizes=\"(max-width: 895px) 100vw, 895px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/16f45ef5adfe5976d1ade4bca107cec6/fcbaf/image-20221217222250084.png\"\n            alt=\"image-20221217222250084\"\n            title=\"image-20221217222250084\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>ブレークポイントを設定した状態でプログラムの実行を開始すると、コンソールプログラムが起動します。</p>\n<p>標準入力もここから与えることができるので Linux のようにハマることもありませんでした。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b37474bf187f3c0428a158efaa4faef0/cc7de/image-20221217222748920.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.833333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB0ElEQVQoz5WS22oaURSGxxOigo/QUS/jQ+mFqQR6oi0U+jqhBwliaQsWrEadUUfj2aitQlppsZhJPEZFIXzdY2igF4X04uffe7P4+dZaW4rH40SjMTKZLGouR7lSoV6vU6lW0YpFca5xUm3wKa2hnDRJZEuopSaFWpdkuYfa/Ear/4PW1+/k6z2kfD7P0VGMVCrN52SKbE5B0zQKhQJFEVgqavQHQ75MoTeHti50Ad0JtMS5OFiRP7si09U5bg2RFEUh8jZKJq3w/sNHwgcHhEIhwvfDBINBAoEA+/shnj5+yLMnf/RI3B/w8sVzfg7O2CwXXM0mLOdTpFxOFYTvBGGBw8PXSJL0X6pUayyXKy4ux4wnk5vASCRGImEEvsHhcOwKzWbzrSwWC1ar9S+ZTCbcbjeNRoP1es1EhE2nglBRlZsZJlUR+Aq73X5nOqfTSUUscTabMRqN0HUdqSqQy+Uyp6cdksnjW0KD4F8yqI0al8tFQStyrl8y/HW+c2kxX7DdbJjPN3Q6A2w2650JbTYbtVqN1cpoeSpanhmBc7bbLdfX0Bf/aW/Pj3xPxuPx4ZF9yLLhMl6vB5/PJ9y7c1m8+f1+2u22WMqS8Xi8m+Nv3qa30i5fye4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b37474bf187f3c0428a158efaa4faef0/8ac56/image-20221217222748920.webp 240w,\n/static/b37474bf187f3c0428a158efaa4faef0/d3be9/image-20221217222748920.webp 480w,\n/static/b37474bf187f3c0428a158efaa4faef0/e46b2/image-20221217222748920.webp 960w,\n/static/b37474bf187f3c0428a158efaa4faef0/f992d/image-20221217222748920.webp 1440w,\n/static/b37474bf187f3c0428a158efaa4faef0/a120e/image-20221217222748920.webp 1605w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b37474bf187f3c0428a158efaa4faef0/8ff5a/image-20221217222748920.png 240w,\n/static/b37474bf187f3c0428a158efaa4faef0/e85cb/image-20221217222748920.png 480w,\n/static/b37474bf187f3c0428a158efaa4faef0/d9199/image-20221217222748920.png 960w,\n/static/b37474bf187f3c0428a158efaa4faef0/07a9c/image-20221217222748920.png 1440w,\n/static/b37474bf187f3c0428a158efaa4faef0/cc7de/image-20221217222748920.png 1605w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b37474bf187f3c0428a158efaa4faef0/d9199/image-20221217222748920.png\"\n            alt=\"image-20221217222748920\"\n            title=\"image-20221217222748920\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h3 id=\"レジスタの情報を参照する\" style=\"position:relative;\"><a href=\"#%E3%83%AC%E3%82%B8%E3%82%B9%E3%82%BF%E3%81%AE%E6%83%85%E5%A0%B1%E3%82%92%E5%8F%82%E7%85%A7%E3%81%99%E3%82%8B\" aria-label=\"レジスタの情報を参照する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>レジスタの情報を参照する</h3>\n<p>さて、復号されたフラグの文字列を確認するためにレジスタの情報を確認したいのですが、今回は Register ウインドウではなく Watches ウインドウを使ってみたいと思います。</p>\n<p>デフォルトで右下に配置されている Watches ウインドウを開き、[+] ボタンから対象を追加します。</p>\n<p>今回は、 [Expression] 列に RCX と RSP を設定し、それぞれのレジスタの値をウォッチすることにしました。</p>\n<p>プログラムを実行すると、ブレークポイントを設定したタイミングで RCX に復号された 1 文字目のフラグ文字が格納されていることがわかります。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/778a72ba9cbc46ad955cf8eb34b03342/a8c87/image-20221218012400616.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 19.583333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA+UlEQVQY0y2MTVOCYBSF+f+/pBZtaoEtGxchIpqkUvJNIh8Wgvo6ovD0at2Z555z75w5ysgwWCUJiSR0HaIoRogju70gL/aUVUe9b6i2gu9tTV2fKH8EYRjgeT6BH1CWJVVVcT5fUMRhR9deJC3XOciyVnohDqyTa7CT/sRWFh6PZ7oOWrnSLGdTFGRpSp5nbDYFTdOg9PUxL5pJ/3WIphsMjDHW3MY0J+jDMeZkxsSaYb3bzG0X+9PD8QIWHy5uEBFEX4TxCsePWCxdlDst5l5f8aB5qCOfp1HEoxGiDuRtxqhviWSNOl3ftPev139vmt54trI/b6X8AtB0IkGKzB5YAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/778a72ba9cbc46ad955cf8eb34b03342/8ac56/image-20221218012400616.webp 240w,\n/static/778a72ba9cbc46ad955cf8eb34b03342/d3be9/image-20221218012400616.webp 480w,\n/static/778a72ba9cbc46ad955cf8eb34b03342/e46b2/image-20221218012400616.webp 960w,\n/static/778a72ba9cbc46ad955cf8eb34b03342/f992d/image-20221218012400616.webp 1440w,\n/static/778a72ba9cbc46ad955cf8eb34b03342/5e0a5/image-20221218012400616.webp 1538w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/778a72ba9cbc46ad955cf8eb34b03342/8ff5a/image-20221218012400616.png 240w,\n/static/778a72ba9cbc46ad955cf8eb34b03342/e85cb/image-20221218012400616.png 480w,\n/static/778a72ba9cbc46ad955cf8eb34b03342/d9199/image-20221218012400616.png 960w,\n/static/778a72ba9cbc46ad955cf8eb34b03342/07a9c/image-20221218012400616.png 1440w,\n/static/778a72ba9cbc46ad955cf8eb34b03342/a8c87/image-20221218012400616.png 1538w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/778a72ba9cbc46ad955cf8eb34b03342/d9199/image-20221218012400616.png\"\n            alt=\"image-20221218012400616\"\n            title=\"image-20221218012400616\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>ユーザが入力した文字列についてはローカルスタックに格納されます。</p>\n<p>しかし、どうやら現在の Ghidra のデバッガではメモリ内の値を参照することはできないようです。</p>\n<p>ヘルプを見ると<code class=\"language-text\">*:4 (RSP+8)</code>のような記法でメモリ内の情報が参照できるような記載があったのですが、僕の環境では例外を発生して値が取得できませんでした。</p>\n<p>以下の issue を見る限り、現時点では Ghidra からメモリ内の情報を参照する機能は上手く動作しない場合があるようで、 Interpreter からデバッガコマンドを使う方法以外に回避策はなさそうでした。</p>\n<p>参考：<a href=\"https://github.com/NationalSecurityAgency/ghidra/issues/2866\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">[Debugger]: Stack Frame Memory Viewer / Editor · Issue #2866 · NationalSecurityAgency/ghidra</a></p>\n<p>というわけで、上記のスクショ上でも WinDbg の da コマンドを使って、ローカルスタック内の入力文字列を確認しています。</p>\n<h3 id=\"フラグを取得する-1\" style=\"position:relative;\"><a href=\"#%E3%83%95%E3%83%A9%E3%82%B0%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B-1\" aria-label=\"フラグを取得する 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>フラグを取得する</h3>\n<p>最後にフラグを取得していきます。</p>\n<p>Linux の時は Register ウインドウからレジスタの情報を書き換えて 1 文字ずつフラグを取得していきましたが、 Watches ウインドウからも同様に編集モードでレジスタの値を変更することが可能です。</p>\n<p>今回は RCX の値を入力値と同じ 0x41 に変更することでパスワード検証をパスし、2 文字目以降のフラグを取得できるようになりました。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 724px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/74ec389870f47b777adc984436c5acfb/a242d/image-20221218012444054.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA+UlEQVQY00XKzU7CUBCG4d6wN6ByASYYtSqN0QjCBhsXilFBWltKz+HYYo0s2OpCF0Ytgr9E8fWkkbh4Mt/MfEbLqdN26wivyVUsiUKfrgy4jBWxClFtnySSmuLiXNBLYvq9RGdJ6LsZoXUCD6kZM0s2s0WX+bLHXOmMXMUnV3LJ79TY3GtQPhJUjkO2D3zWqydYdoNiraVvgq19j2ozYteJKR0G2G4XY0WkmGqE2Rlq0zlktXXLsnNN3r1jUbM6KWviEbN9j6UGbMgHCqc3WbZUyoLOBfmEwXhE5nNqmO2T92e+XgdM3gZ8a9lv/PLf+9A93ZnuP3/5F5Y9DSAD7Ar4AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/74ec389870f47b777adc984436c5acfb/8ac56/image-20221218012444054.webp 240w,\n/static/74ec389870f47b777adc984436c5acfb/d3be9/image-20221218012444054.webp 480w,\n/static/74ec389870f47b777adc984436c5acfb/79561/image-20221218012444054.webp 724w\"\n              sizes=\"(max-width: 724px) 100vw, 724px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/74ec389870f47b777adc984436c5acfb/8ff5a/image-20221218012444054.png 240w,\n/static/74ec389870f47b777adc984436c5acfb/e85cb/image-20221218012444054.png 480w,\n/static/74ec389870f47b777adc984436c5acfb/a242d/image-20221218012444054.png 724w\"\n            sizes=\"(max-width: 724px) 100vw, 724px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/74ec389870f47b777adc984436c5acfb/a242d/image-20221218012444054.png\"\n            alt=\"image-20221218012444054\"\n            title=\"image-20221218012444054\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"まとめ\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>今回は Ghidra のデバッガ機能を使ってシンプルなリバーシング問題を解いてみました。</p>\n<p>軽く使ってみた感想としては、「良さそう」と「使いづらい」が 4:6 くらいの印象でした。</p>\n<p>使いづらいなと思った主な点は、致命的にナレッジが少ない点と、非常に動作が不安定な点です。</p>\n<p>ナレッジについては、Ghidra のヘルプの情報自体が最小限である上に、英語でググってもブログ記事すらほとんどヒットしない状況でした。</p>\n<p>一方で、 issue には結構いろんな質問や回答が上がっており、 issue がほぼ唯一の有用な情報ソースとして重宝していました。</p>\n<p>また、動作については単純に僕の環境が悪い可能性もありますが、よくわからないタイミングで例外発生してクラッシュしたりデバッガがハングしたりすることがかなり頻繁に発生しました。</p>\n<p>Ghidra のデバッガ側で未実装の機能はまだ多そうですが、Interpreter ウインドウから GDB と WinDbg のコマンドが実行できるので、デバッグ能力的な面での制限はあんまりないように思いますが、大した解析もしてないのに頻繁に動作が不安定になるのはちょっと辛いものがありました。</p>\n<p>しかし、無料で使えるツールにも関わらず PE と ELF を同じ UI で操作できるのは普通に嬉しいですし、デコンパイル結果からそのままブレークポイントを設定したりできるのも便利だと感じました。(IDA はほぼ使ったことがないので、、、)</p>\n<p>また、今回の記事では触れませんでしたが、 Ghidra デバッガの Time 機能という、実行時トレースのスナップショットを取得して、その時点に遡って解析を行える機能が非常によさそうでした。</p>\n<p>スナップショットのタイミングしか追えないとはいえ、WinDbg Preview の Time Travel Debugging(TTD) に近い機能を ELF の解析でも使えるのがとても嬉しいですね。</p>\n<p>もう少し使いこなせるようになると活用の幅が広がりそうに感じているので、今後もできるだけ Ghidra のデバッガを使っていきたいと思います。</p>","fields":{"slug":"/himitsukichi-ctf-rev-ghidra-dynamic","tagSlugs":["/tag/ctf/","/tag/rev/","/tag/ghidra/"]},"frontmatter":{"date":"2022-12-19","description":"バージョン 10.0 から追加された Ghidra のデバッガ機能を使って、Windows と Linux でシンプルな Reversing 問題を解いていきます。","tags":["CTF","Rev","Ghidra"],"title":"2023 年こそ使いたい！Ghidra デバッガのすゝめ","socialImage":{"publicURL":"/static/83a9435807117e1e99c60e9c8ad1fb67/himitsukichi-ctf-rev-ghidra-dynamic.png"}}}},"pageContext":{"slug":"/himitsukichi-ctf-rev-ghidra-dynamic"}},"staticQueryHashes":["251939775","401334301","825871152"]}