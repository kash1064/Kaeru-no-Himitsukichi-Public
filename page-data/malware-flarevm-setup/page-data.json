{"componentChunkName":"component---src-templates-post-template-js","path":"/malware-flarevm-setup","result":{"data":{"markdownRemark":{"id":"51718675-4ca9-54eb-ba21-15e5a113ac6c","html":"<p>今回はマルウェア解析のためのWindowsディストリビューションであるFLARE VMをセットアップしたので、構築手順について記録しておこうと思います。</p>\n<p>FLARE VMはオープンソースのリバースエンジニア、マルウェアアナリスト、インシデントレスポンダー、フォレンジケーター、およびペネトレーションテスター向けに設計された、Windowsベースのセキュリティディストリビューションです。</p>\n<p>Version3.0からはWindows10にも対応しています。</p>\n<p>参考：<a href=\"https://github.com/mandiant/flare-vm\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">mandiant/flare-vm</a></p>\n<p>参考：<a href=\"https://www.mandiant.com/resources/flare-vm-update\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">FLARE VM Update | Mandiant</a></p>\n<!-- omit in toc -->\n<h2 id=\"もくじ\" style=\"position:relative;\"><a href=\"#%E3%82%82%E3%81%8F%E3%81%98\" aria-label=\"もくじ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>もくじ</h2>\n<ul>\n<li><a href=\"#%E7%92%B0%E5%A2%83\">環境</a></li>\n<li>\n<p><a href=\"#%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E5%89%8D%E3%81%AE%E6%BA%96%E5%82%99\">インストール前の準備</a></p>\n<ul>\n<li><a href=\"#windows-defender%E3%81%AE%E7%84%A1%E5%8A%B9%E5%8C%96\">Windows Defenderの無効化</a></li>\n<li><a href=\"#%E3%82%B9%E3%83%8A%E3%83%83%E3%83%97%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%E3%81%AE%E5%8F%96%E5%BE%97\">スナップショットの取得</a></li>\n<li><a href=\"#flarevm%E3%81%AE%E3%83%80%E3%82%A6%E3%83%B3%E3%83%AD%E3%83%BC%E3%83%89\">FlareVMのダウンロード</a></li>\n</ul>\n</li>\n<li><a href=\"#flarevm%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\">FlareVMのインストール</a></li>\n<li><a href=\"#flarevm%E3%81%AE%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E6%96%B9%E6%B3%95\">FlareVMのパッケージインストール方法</a></li>\n<li>\n<p><a href=\"#flarevm%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E5%AE%9F%E8%A1%8C%E5%BE%8C%E3%81%AE%E4%BD%9C%E6%A5%AD\">FlareVMのインストールスクリプト実行後の作業</a></p>\n<ul>\n<li><a href=\"#%E8%BF%BD%E5%8A%A0%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\">追加パッケージのインストール</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E3%81%8A%E3%81%BE%E3%81%91flarevm%E3%81%A7%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B%E3%83%84%E3%83%BC%E3%83%AB%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\">おまけ：FlareVMでインストールしているツールについて</a></p>\n<ul>\n<li><a href=\"#android\">Android</a></li>\n<li><a href=\"#decompilers\">Decompilers</a></li>\n<li><a href=\"#disassemblers\">Disassemblers</a></li>\n<li><a href=\"#net\">.NET</a></li>\n<li><a href=\"#autoit\">AutoIt</a></li>\n<li><a href=\"#flash\">Flash</a></li>\n<li><a href=\"#forensic\">Forensic</a></li>\n<li><a href=\"#hex-editors\">Hex Editors</a></li>\n<li><a href=\"#java\">Java</a></li>\n<li><a href=\"#office\">Office</a></li>\n<li><a href=\"#pdf\">PDF</a></li>\n<li><a href=\"#pe\">PE</a></li>\n<li><a href=\"#pentest\">Pentest</a></li>\n<li><a href=\"#powershell\">Powershell</a></li>\n<li><a href=\"#text-editors\">Text Editors</a></li>\n<li><a href=\"#visual-basic\">Visual Basic</a></li>\n<li><a href=\"#web-application\">Web Application</a></li>\n<li><a href=\"#utilities\">Utilities</a></li>\n</ul>\n</li>\n<li><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\">まとめ</a></li>\n</ul>\n<h2 id=\"環境\" style=\"position:relative;\"><a href=\"#%E7%92%B0%E5%A2%83\" aria-label=\"環境 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>環境</h2>\n<p>今回は、以下のバージョンの仮想マシンにFlareVMを導入していきます。</p>\n<ul>\n<li>\n<p>Windows 10 Pro 1903 English</p>\n<ul>\n<li>CPU: 3 core</li>\n<li>RAM: 8192GB</li>\n<li>Strage: 80GB</li>\n</ul>\n</li>\n<li>FlareVM 3.1</li>\n</ul>\n<p>※今回は手元では試していないのですが、Windows 10 の1903より新しいバージョンではFlareVMの導入に失敗するという記事を見かけたため、今回は1903で構築しました。</p>\n<p>システム要件については、<a href=\"https://github.com/mandiant/flare-vm\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">mandiant/flare-vm</a>には以下の記載になっています。</p>\n<p>ここで、VMのストレージではなく、OSインストール後のストレージ空き容量が60GB以上必要な点に注意が必要です。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">Requirements\n・60 GB Hard Drive\n  Additional space needed after VM is downloaded/installed\n・2 GB RAM</code></pre></div>\n<h2 id=\"インストール前の準備\" style=\"position:relative;\"><a href=\"#%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E5%89%8D%E3%81%AE%E6%BA%96%E5%82%99\" aria-label=\"インストール前の準備 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>インストール前の準備</h2>\n<h3 id=\"windows-defenderの無効化\" style=\"position:relative;\"><a href=\"#windows-defender%E3%81%AE%E7%84%A1%E5%8A%B9%E5%8C%96\" aria-label=\"windows defenderの無効化 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Windows Defenderの無効化</h3>\n<p>基本的には以下の記事の通りに設定すればOKです。</p>\n<p>参考：<a href=\"https://www.howtogeek.com/howto/15788/how-to-uninstall-disable-and-remove-windows-defender.-also-how-turn-it-off/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">How To Uninstall, Disable, and Remove Windows Defender</a></p>\n<p>今回の環境は1903だったので、Defenderを無効化するためには改ざん防止機能も無効化する必要があります。</p>\n<p>以下の記事が参考になります。</p>\n<p>参考：<a href=\"https://www.pasoble.jp/windows/10/08885.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Windows 10 Windows Defenderを完全に無効化する-パソブル</a></p>\n<p>なお、要件には入ってませんがついでにWindows Firewallも無効化しておきました。</p>\n<h3 id=\"スナップショットの取得\" style=\"position:relative;\"><a href=\"#%E3%82%B9%E3%83%8A%E3%83%83%E3%83%97%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%E3%81%AE%E5%8F%96%E5%BE%97\" aria-label=\"スナップショットの取得 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>スナップショットの取得</h3>\n<p>FlareVMのインストールに進む前に、VMのスナップショットを取得しておきます。</p>\n<h3 id=\"flarevmのダウンロード\" style=\"position:relative;\"><a href=\"#flarevm%E3%81%AE%E3%83%80%E3%82%A6%E3%83%B3%E3%83%AD%E3%83%BC%E3%83%89\" aria-label=\"flarevmのダウンロード permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>FlareVMのダウンロード</h3>\n<p>以下のReleaseページからFlareVMの3.1をダウンロードしておきます。</p>\n<p>参考：<a href=\"https://github.com/mandiant/flare-vm/releases\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Releases · mandiant/flare-vm</a></p>\n<h2 id=\"flarevmのインストール\" style=\"position:relative;\"><a href=\"#flarevm%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\" aria-label=\"flarevmのインストール permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>FlareVMのインストール</h2>\n<p>先ほどダウンロードしたFlareVMのファイルを、VM上で展開しておきます。</p>\n<p>管理者権限で起動したPowerShellでVM上で展開したフォルダに移動して、以下のコマンドを順に実行します。</p>\n<p>※インターネット接続が必要です。</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">Unblock-File</span> <span class=\"token punctuation\">.</span>\\install<span class=\"token punctuation\">.</span>ps1\n<span class=\"token function\">Set-ExecutionPolicy</span> Unrestricted\n<span class=\"token punctuation\">.</span>\\install<span class=\"token punctuation\">.</span>ps1 <span class=\"token operator\">-</span>password &lt;password></code></pre></div>\n<p>実行に成功すると、こんな感じで順次インストールやらセットアップやらがすすんでいきます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 767px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/eec952e1be0ff1806c8ce4e1e75d34c3/6c2f2/image-16.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAADVklEQVQ4y3XS/0/VVRzH8fNhiN7MyxexLvde4XK5BEhKKQkoIZKbKF8vIHCN79wL93K593qBKajlZYJYS9eocLqotFw40TDTzdZaK1v1Q1tbbW6trbW1cjb7F569P/eyuHP1w2Pv8+VzXp9zPp+j2m89xHPnL/pvP8B9S9y8j/vGnwRu/03gk4cElh4QuHaf4JU/CF7+neDF3wjO/0rowi8E537GP3uP8Jv3qBn/DlX1KWrs/FUm5xeIvLPAyXelzn/IqUuLTH/wEZH3Fpm8eI3JSzERvb5/nUic4/LM1OWrvHHlLgkvfIZSE2OoiUOo8RHUyGFUWIyKkPSD4RWhQzHBR4Rkzj9Mx6uLGKq/QKWcfZnCt0PYz41imxsj9/wo1reOiAls5yawzh0Vx1g/e4KU1yMki5Rlejt1NoLxzHGGL9xhTfVXKFPPOJaOINbuMJauEOaOEBsOhkhrC5BY62FVnYckofZ7Ufv+iw9V3Y/vtY8x1H6LMpcNYirqxbS1D0uxB2N+JwmZLShrk0w64zSiLHFV5rWNumY0Sz1DU0sYnD+gbHuCZD3vxVbpI7tyCOvOQTLKPJh3DGCWai33xtrCVOqJSt/eT/Iz3awr6mLtli4e39yG//RNDE0/ofKqR8mt9GPb5SOj1E1GiYSVDWARmTvlRRVD0WDH7mE2FPexfltvNMxQ+CIJjlY0RxvKUY9v5oYE/ogq2D9GflWAnCp/NCir3IepxE22BOmhGyXUumMwKl3CntzuJn05+Inn9J328NimVoZn5Bs6v0fl7h0hT96eWeGNBukh5tIB2a0nulhv6+Pp2/owyhGTi7oxyjHXbelk7dMdctxOjJtdErjEmka53GmyME2OkLq1J3qUNKn64tRne0iJ9ntZXXCQxKfaScp3/Wt1gYvEvHbhYlVeM0Mz1zE0fiMXe5NL/kwzyn5AyN/NXmZvWenrczkHlp+Jo4/ltEq7Ad8pudgNX6O0ws7oh9VkB1ru/2lb4XiUzDuceKf1wLuyQ4fszlqLyqpHZdatyKqLjelscbJ1DTF2ndxLew2h0xJY/6Xs0PUKWvMUWst0rDYJp2g4iVY3iVYTQdt3Am2v2PMSWtUxtF1H0crH0cqOoJUcJqE4TIVvgaTaz/kHZG422Ctr0LcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/eec952e1be0ff1806c8ce4e1e75d34c3/8ac56/image-16.webp 240w,\n/static/eec952e1be0ff1806c8ce4e1e75d34c3/d3be9/image-16.webp 480w,\n/static/eec952e1be0ff1806c8ce4e1e75d34c3/e0ad8/image-16.webp 767w\"\n              sizes=\"(max-width: 767px) 100vw, 767px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/eec952e1be0ff1806c8ce4e1e75d34c3/8ff5a/image-16.png 240w,\n/static/eec952e1be0ff1806c8ce4e1e75d34c3/e85cb/image-16.png 480w,\n/static/eec952e1be0ff1806c8ce4e1e75d34c3/6c2f2/image-16.png 767w\"\n            sizes=\"(max-width: 767px) 100vw, 767px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/eec952e1be0ff1806c8ce4e1e75d34c3/6c2f2/image-16.png\"\n            alt=\"image-16.png\"\n            title=\"image-16.png\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>すべて完了するまでに恐ろしく時間がかかりました（一晩かけても終わらなかった）。</p>\n<p>気長に待ちましょう。</p>\n<h2 id=\"flarevmのパッケージインストール方法\" style=\"position:relative;\"><a href=\"#flarevm%E3%81%AE%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E6%96%B9%E6%B3%95\" aria-label=\"flarevmのパッケージインストール方法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>FlareVMのパッケージインストール方法</h2>\n<p>FlareVMはPowerShellスクリプトを実行したら後は自動でパッケージのインストールやレジストリの変更、OSの再起動などが行われます。</p>\n<p>Windows環境でパッケージのインストールを自動化するために、Chocolateyというパッケージマネージャを使用しているようです。</p>\n<p>参考：<a href=\"https://en.wikipedia.org/wiki/Chocolatey\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Chocolatey - Wikipedia</a></p>\n<p>パッケージの更新なんかも、<code class=\"language-text\">chocolatey upgrade ${packageName}</code>のコマンドで可能なので、ラボ環境の新規構築や管理に非常に役に立ちそうですね。</p>\n<p>少なくとも現時点のwingetよりも対応パッケージが豊富な点も非常によさそうです。</p>\n<p>参考：<a href=\"https://qiita.com/konta220/items/95b40b4647a737cb51aa\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Chocolateyを使った環境構築の時のメモ - Qiita</a></p>\n<p>そのうちChocolateyを使った環境構築方法については記事にまとめたいと思います。</p>\n<h2 id=\"flarevmのインストールスクリプト実行後の作業\" style=\"position:relative;\"><a href=\"#flarevm%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E5%AE%9F%E8%A1%8C%E5%BE%8C%E3%81%AE%E4%BD%9C%E6%A5%AD\" aria-label=\"flarevmのインストールスクリプト実行後の作業 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>FlareVMのインストールスクリプト実行後の作業</h2>\n<p>無事にインストールが完了すると、以下のように壁紙が変更されます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 500px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/501290d06d3811ab2de677a9991d430d/0b533/image.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 76.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAARlAAAEZQAGA43XUAAABX0lEQVQ4y62TX0vCUBjGtzPn/uh0iBQmKW3iUsmJFonsYkUohTdREUTRXVd9gaibwC/QB4igz6FpRNDch3ra5qBAnaJe/Dh/3nPe87zPOYf6/PpGr9fDR7/vtd1uF4PBAMOh7TD0scexbdg+7vjHsmA5UJfnp9jRKyhXd0FRFAghoGna6y9EIluEKCchRKTFk/ynfPWERKGBdKE6mlhGnYuSSiEZj0GWZymc86CGuYf9qobaoeFN0JMSOb7OrXBb2wQvcCBM8KZoWgGfWJ+dsN2qQ4pyU0sU0yrWageoP74itlWa7XNOyYALh8cCxC9TN47Q6ryj+fyGbLEysoUOqKZ93HQuJD4xSJgQ7m5v0Ljv4OThBdcXZ37CAIVFbQMcF5oYFEQROVUFESSEJRlaPg+GYYI9NI0K5HhkNY/aRS9lIPDs1AV/5dHzfUnT0BGTxNUp9FQ4N+p6swwsy3r8AppEdC6cLpGbAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/501290d06d3811ab2de677a9991d430d/8ac56/image.webp 240w,\n/static/501290d06d3811ab2de677a9991d430d/d3be9/image.webp 480w,\n/static/501290d06d3811ab2de677a9991d430d/b0a15/image.webp 500w\"\n              sizes=\"(max-width: 500px) 100vw, 500px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/501290d06d3811ab2de677a9991d430d/8ff5a/image.png 240w,\n/static/501290d06d3811ab2de677a9991d430d/e85cb/image.png 480w,\n/static/501290d06d3811ab2de677a9991d430d/0b533/image.png 500w\"\n            sizes=\"(max-width: 500px) 100vw, 500px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/501290d06d3811ab2de677a9991d430d/0b533/image.png\"\n            alt=\"image.png\"\n            title=\"image.png\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>最後に、追加のパッケージのインストールと、ネットワーク設定をホストオンリーアダプタに変更します。</p>\n<p>マルウェア解析を行うためにFlareVMを導入する場合は、ネットワークから完全に隔離された環境になっていることを必ず確認してください。</p>\n<h3 id=\"追加パッケージのインストール\" style=\"position:relative;\"><a href=\"#%E8%BF%BD%E5%8A%A0%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\" aria-label=\"追加パッケージのインストール permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>追加パッケージのインストール</h3>\n<p>まずは、以下の記事で追加パッケージとしてインストールされているツールを一通りインストールします。</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">choco install exiftool<span class=\"token punctuation\">,</span> trid<span class=\"token punctuation\">,</span> grep<span class=\"token punctuation\">,</span> stirling-jp<span class=\"token punctuation\">,</span> sakuraeditor<span class=\"token punctuation\">,</span> irfanview<span class=\"token punctuation\">,</span> irfanviewplugins<span class=\"token punctuation\">,</span> hashtab<span class=\"token punctuation\">,</span> audacity<span class=\"token punctuation\">,</span> winmerge<span class=\"token punctuation\">,</span> teraterm<span class=\"token punctuation\">,</span> fiddler<span class=\"token punctuation\">,</span> sqlitebrowser<span class=\"token punctuation\">,</span> ultravnc<span class=\"token punctuation\">,</span> gnuwin32-coreutils<span class=\"token punctuation\">.</span>install</code></pre></div>\n<p>参考：<a href=\"https://soji256.hatenablog.jp/entry/2019/10/14/224121\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">FLARE VM を使って Windows10 に解析環境を構築する - setodaNote</a></p>\n<p>特にexiftoolやfiddlerなどは僕もよく使うので入れておきました。</p>\n<p>また、WindowsTerminalとNoriben、PowerToysも追加でインストールしておきました。</p>\n<p>NoribenはFlareVMのデフォルトでは上手く動作しないので、<a href=\"/malware-flarevm-loadpmlerror\">こちら</a>の設定が必要になります。</p>\n<h2 id=\"おまけflarevmでインストールしているツールについて\" style=\"position:relative;\"><a href=\"#%E3%81%8A%E3%81%BE%E3%81%91flarevm%E3%81%A7%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B%E3%83%84%E3%83%BC%E3%83%AB%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\" aria-label=\"おまけflarevmでインストールしているツールについて permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>おまけ：FlareVMでインストールしているツールについて</h2>\n<p>FlareVMで展開しているツールについて、Readmeに一覧されていました。</p>\n<p>参考：<a href=\"https://github.com/mandiant/flare-vm#readme\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">mandiant/flare-vm</a></p>\n<p>いくつかおもしろそうなツールがあったので、ピックアップしてまとめておきます。</p>\n<h3 id=\"android\" style=\"position:relative;\"><a href=\"#android\" aria-label=\"android permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Android</h3>\n<ul>\n<li>dex2jar</li>\n<li>apktool</li>\n</ul>\n<p>以下の2つのツールは、CTFでもAndroidアプリ問題が出たときに使ったことがあります。</p>\n<p>APKファイルを展開してJavaとして読めるような形にデコンパイルできます。</p>\n<h3 id=\"decompilers\" style=\"position:relative;\"><a href=\"#decompilers\" aria-label=\"decompilers permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Decompilers</h3>\n<ul>\n<li>RetDec</li>\n</ul>\n<p>RetDecは使ったことがなかったのですが、Avastの開発しているOSSのデコンパイラのようです。</p>\n<p>ELFやPEのデコンパイル、またCだけでなくPythonライクな言語でのデコンパイル結果を出力することもできるようです。すごい。</p>\n<p>参考：<a href=\"https://github.com/avast/retdec\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">avast/retdec: RetDec is a retargetable machine-code decompiler based on LLVM.</a></p>\n<p>参考：<a href=\"https://qiita.com/hogehuga/items/b502cd572a5065881c91\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">avastのretdecをインストールする - Qiita</a></p>\n<h3 id=\"disassemblers\" style=\"position:relative;\"><a href=\"#disassemblers\" aria-label=\"disassemblers permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Disassemblers</h3>\n<ul>\n<li>Ghidra</li>\n<li>IDA Free (5.0 &#x26; 7.0)</li>\n<li>Binary Ninja Demo</li>\n<li>radare2</li>\n<li>Cutter</li>\n</ul>\n<p>Disassemblerは色々入っているようです。</p>\n<p>Cutterは使ったことなかったのですが結構きれいにディスアセンブルされてますね。</p>\n<p>ダークモードがあるのも良い。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2f94f5708ee99f3736b639d52de6ad76/db664/screenshot.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.833333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA3XAAANiQFmEOuiAAAB5ElEQVQozyWRS47UMBCGcxaEBjFqpjN5OS87tuMknXdP00OLAYklG07FQdjhDdIwC1ZcAGXDAZCtopJZ/Pot2/W5fpfDRPstLw5/mej+UN4tWdEt7NAtfOwXOU+bxLT6vMjjvPBpxLMBfVjE+HyvGLCmbzc53f3nX5k6A6USpOggyhoIkwq9hoS2QNAJyeA2yGF3m4BPBMT5AcK0Bq5maIYLyOYMvD4Br07gzA9ffvL2AVgmjFSjTYvWhmllg1ht8iJuXY/YV9euffl6b2+83IZJjfvSsnKy4+mjrbp7W6ijpeVsnWb88ETFCDSTtqyPwOSAXaity1VeJCAgFHb7AF5cvYG9l0OE3fmkhLTooR0v0E7voWrPWDuDI4ZPTxkuGAJF2UPKDgiREMQlAmuEleAHGexcAlfXHrgBQ2CD5wpyPkDTX6Dq3j3HXiMj9TGhhxX4D4GGitb4RBoEGi8qjB8xg1ATpcokrEKXxg0Ls/eZKcrRjMcHw9WdKVZVJ+Pkov+NAl5OUMgJcoy/vhzjQPxYbgriNb6ChCnwCIN9SOEGh5SzFjjWJGxN1m11Tszar6y6+6G6y3dRv9X4ksbWNRWTxj/UOE2N8TRJlE7TUoexwD2p3YjrijW6FL0mfNAJKma9/g85NxC03+MxeQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2f94f5708ee99f3736b639d52de6ad76/8ac56/screenshot.webp 240w,\n/static/2f94f5708ee99f3736b639d52de6ad76/d3be9/screenshot.webp 480w,\n/static/2f94f5708ee99f3736b639d52de6ad76/e46b2/screenshot.webp 960w,\n/static/2f94f5708ee99f3736b639d52de6ad76/f992d/screenshot.webp 1440w,\n/static/2f94f5708ee99f3736b639d52de6ad76/882b9/screenshot.webp 1920w,\n/static/2f94f5708ee99f3736b639d52de6ad76/f2379/screenshot.webp 2509w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2f94f5708ee99f3736b639d52de6ad76/8ff5a/screenshot.png 240w,\n/static/2f94f5708ee99f3736b639d52de6ad76/e85cb/screenshot.png 480w,\n/static/2f94f5708ee99f3736b639d52de6ad76/d9199/screenshot.png 960w,\n/static/2f94f5708ee99f3736b639d52de6ad76/07a9c/screenshot.png 1440w,\n/static/2f94f5708ee99f3736b639d52de6ad76/29114/screenshot.png 1920w,\n/static/2f94f5708ee99f3736b639d52de6ad76/db664/screenshot.png 2509w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2f94f5708ee99f3736b639d52de6ad76/d9199/screenshot.png\"\n            alt=\"img\"\n            title=\"img\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>参考：<a href=\"https://github.com/rizinorg/cutter\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">rizinorg/cutter: Free and Open Source Reverse Engineering Platform powered by rizin</a></p>\n<h3 id=\"net\" style=\"position:relative;\"><a href=\"#net\" aria-label=\"net permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>.NET</h3>\n<ul>\n<li>de4dot</li>\n<li>Dot Net String Decoder (DNSD)</li>\n<li>dnSpy</li>\n<li>DotPeek</li>\n<li>ILSpy</li>\n<li>RunDotNetDll</li>\n</ul>\n<p>ILSpyとdnSpyは定番ですが、他にも色々あるんですね。</p>\n<p>de4dotは難読化解除のツールらしいです。マルウェア解析で重宝しそう。</p>\n<p>参考：<a href=\"https://github.com/de4dot/de4dot\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">de4dot/de4dot: .NET deobfuscator and unpacker.</a></p>\n<h3 id=\"autoit\" style=\"position:relative;\"><a href=\"#autoit\" aria-label=\"autoit permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AutoIt</h3>\n<ul>\n<li>AutoItExtractor</li>\n<li>UnAutoIt</li>\n<li>Exe2Aut</li>\n</ul>\n<p>AutoIt初めて知りました。VBScriptみたいな感じなのかな。</p>\n<p>参考：<a href=\"https://en.wikipedia.org/wiki/AutoIt\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">AutoIt - Wikipedia</a></p>\n<h3 id=\"flash\" style=\"position:relative;\"><a href=\"#flash\" aria-label=\"flash permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Flash</h3>\n<ul>\n<li>FFDec</li>\n</ul>\n<p>Flashにもデコンパイラがあるんですね。</p>\n<h3 id=\"forensic\" style=\"position:relative;\"><a href=\"#forensic\" aria-label=\"forensic permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Forensic</h3>\n<ul>\n<li>Volatility</li>\n<li>Autopsy</li>\n</ul>\n<p>Volatilityはメモリフォレンジックツールって100回復唱します。</p>\n<p>ChatEngineとかとの違いはどこなんだろうと思ったけど、CLIで使えるんですね。便利。</p>\n<p>参考：<a href=\"https://github.com/volatilityfoundation/volatility\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">volatilityfoundation/volatility: An advanced memory forensics framework</a></p>\n<h3 id=\"hex-editors\" style=\"position:relative;\"><a href=\"#hex-editors\" aria-label=\"hex editors permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Hex Editors</h3>\n<ul>\n<li>FileInsight</li>\n<li>HxD</li>\n<li>010 Editor</li>\n</ul>\n<p>僕のお気に入りのTweakが入ってない。。</p>\n<h3 id=\"java\" style=\"position:relative;\"><a href=\"#java\" aria-label=\"java permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Java</h3>\n<ul>\n<li>JD-GUI</li>\n<li>Bytecode-Viewer</li>\n<li>Java-Deobfuscator</li>\n</ul>\n<p>Javaの難読化解除ツールも入ってるんですね。</p>\n<p>CTFではまだ出会ったことないですが、マルウェア解析とかだとよく使うんでしょうか。</p>\n<h3 id=\"office\" style=\"position:relative;\"><a href=\"#office\" aria-label=\"office permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Office</h3>\n<ul>\n<li>Offvis</li>\n<li>OfficeMalScanner</li>\n<li>oledump.py</li>\n<li>rtfdump.py</li>\n<li>msoffcrypto-crack.py</li>\n</ul>\n<p>Officeファイルのマルウェアをピンポイントでスキャンするツールがあるんですね。</p>\n<p>参考：<a href=\"https://www.optimizationcore.com/security/officemalscanner-microsoft-office-files-malware-scanner/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">OfficeMalScanner - Microsoft Office Files Malware Scanner</a></p>\n<h3 id=\"pdf\" style=\"position:relative;\"><a href=\"#pdf\" aria-label=\"pdf permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PDF</h3>\n<ul>\n<li>PDFiD</li>\n<li>PDFParser</li>\n<li>PDFStreamDumper</li>\n</ul>\n<h3 id=\"pe\" style=\"position:relative;\"><a href=\"#pe\" aria-label=\"pe permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PE</h3>\n<ul>\n<li>PEiD</li>\n<li>ExplorerSuite (CFF Explorer)</li>\n<li>PEview</li>\n<li>DIE</li>\n<li>PeStudio</li>\n<li>PEBear</li>\n<li>ResourceHacker</li>\n<li>LordPE</li>\n<li>PPEE(puppy)</li>\n</ul>\n<p>PEiD、PeStudioあたりはよく使いますが、他にも結構色々あるんですね。</p>\n<p>そのうち試してみようと思います。</p>\n<h3 id=\"pentest\" style=\"position:relative;\"><a href=\"#pentest\" aria-label=\"pentest permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Pentest</h3>\n<ul>\n<li>Windows binaries from Kali Linux</li>\n</ul>\n<p>netcatとか、Windowsで使えるKaliツールの詰め合わせ？みたいです。</p>\n<p>参考：<a href=\"https://www.kali.org/tools/windows-binaries/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">windows-binaries | Kali Linux Tools</a></p>\n<h3 id=\"powershell\" style=\"position:relative;\"><a href=\"#powershell\" aria-label=\"powershell permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Powershell</h3>\n<ul>\n<li>PSDecode</li>\n</ul>\n<h3 id=\"text-editors\" style=\"position:relative;\"><a href=\"#text-editors\" aria-label=\"text editors permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Text Editors</h3>\n<ul>\n<li>SublimeText3</li>\n<li>Notepad++</li>\n<li>Vim</li>\n</ul>\n<p>VSCodeは手動で追加したい。。</p>\n<h3 id=\"visual-basic\" style=\"position:relative;\"><a href=\"#visual-basic\" aria-label=\"visual basic permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Visual Basic</h3>\n<ul>\n<li>VBDecompiler</li>\n</ul>\n<h3 id=\"web-application\" style=\"position:relative;\"><a href=\"#web-application\" aria-label=\"web application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Web Application</h3>\n<ul>\n<li>BurpSuite Free Edition</li>\n<li>HTTrack</li>\n</ul>\n<p>HTTrackは再帰的にWebサイトをダウンロードして疑似的なミラーサイトをローカル環境に構築できるようです。</p>\n<p>参考：<a href=\"https://eririn25.com/tool/httrack/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">【画像付き】httrackでホームページを丸ごとダウンロードする使い方</a></p>\n<h3 id=\"utilities\" style=\"position:relative;\"><a href=\"#utilities\" aria-label=\"utilities permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Utilities</h3>\n<p>割愛。</p>\n<p>Hash系のツールはいくつか入ってるのにHashcatはないんですね。</p>\n<h2 id=\"まとめ\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>以前から気になっていたFlareVMをセットアップしてみました。</p>\n<p>Windowsでもこんな感じでカスタムディストリビューションのようなものを作れるというのは非常に参考になりました。</p>","fields":{"slug":"/malware-flarevm-setup","tagSlugs":["/tag/malware/","/tag/flare-vm/","/tag/備忘録/"]},"frontmatter":{"date":"2021-12-01","description":"マルウェア解析のためのWindowsディストリビューションであるFLARE VMをセットアップしたので、構築手順について記録しておこうと思います。","tags":["Malware","FlareVM","備忘録"],"title":"Windows10にマルウェア解析用ディストリビューションのFlareVM3.1をインストールしてみた","socialImage":{"publicURL":"/static/dc4d8b7f8795f3c3d3489d9957d155f2/no-image.png"}}}},"pageContext":{"slug":"/malware-flarevm-setup"}},"staticQueryHashes":["251939775","401334301","825871152"]}