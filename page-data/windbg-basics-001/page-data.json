{"componentChunkName":"component---src-templates-post-template-js","path":"/windbg-basics-001","result":{"data":{"markdownRemark":{"id":"f8eceff5-080d-52b5-ba1c-50dcf8385066","html":"<p>個人的によく使う WinDbg コマンドなどをまとめたチートシートです。</p>\n<p>内容については今後追加していく予定です。</p>\n<!-- omit in toc -->\n<h2 id=\"もくじ\" style=\"position:relative;\"><a href=\"#%E3%82%82%E3%81%8F%E3%81%98\" aria-label=\"もくじ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>もくじ</h2>\n<ul>\n<li><a href=\"#%E3%81%BE%E3%81%88%E3%81%8C%E3%81%8D\">まえがき</a></li>\n<li><a href=\"#%E3%82%88%E3%81%8F%E4%BD%BF%E3%81%86%E3%83%AA%E3%83%B3%E3%82%AF%E9%9B%86\">よく使うリンク集</a></li>\n<li><a href=\"#%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E4%B8%80%E8%A6%A7%E3%81%AE%E6%93%8D%E4%BD%9C%E6%83%85%E5%A0%B1%E5%8F%96%E5%BE%97lm-x-ln\">モジュール一覧の操作、情報取得(lm, x, ln)</a></li>\n<li><a href=\"#%E3%83%AC%E3%82%B8%E3%82%B9%E3%82%BF%E3%81%AE%E5%8F%82%E7%85%A7%E3%81%A8%E6%93%8D%E4%BD%9Cr\">レジスタの参照と操作(r)</a></li>\n<li><a href=\"#%E3%83%A1%E3%83%A2%E3%83%AA%E3%81%AE%E5%8F%82%E7%85%A7%E3%81%A8%E7%B7%A8%E9%9B%86dcdpsetc\">メモリの参照と編集(dc,dps,etc..)</a></li>\n<li><a href=\"#%E3%83%A1%E3%83%A2%E3%83%AA%E5%86%85%E3%81%AE%E6%A4%9C%E7%B4%A2s\">メモリ内の検索(s)</a></li>\n<li><a href=\"#%E3%82%A2%E3%82%BB%E3%83%B3%E3%83%96%E3%83%AA%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E5%87%BA%E5%8A%9Buubetc\">アセンブリコードの出力(u,ub,etc…)</a></li>\n<li>\n<p><a href=\"#%E5%A4%89%E6%95%B0%E3%81%A8%E6%A7%8B%E9%80%A0%E4%BD%93%E3%81%AE%E5%87%BA%E5%8A%9Bdvdt\">変数と構造体の出力(dv,dt)</a></p>\n<ul>\n<li><a href=\"#pe-%E3%83%90%E3%82%A4%E3%83%8A%E3%83%AA%E3%81%AE%E6%83%85%E5%A0%B1%E3%82%92%E5%8F%82%E7%85%A7%E3%81%99%E3%82%8B\">PE バイナリの情報を参照する</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E3%83%96%E3%83%AC%E3%83%BC%E3%82%AF%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AE%E8%A8%AD%E5%AE%9Abpbubm\">ブレークポイントの設定(bp,bu,bm)</a></p>\n<ul>\n<li><a href=\"#%E8%AA%AD%E3%81%BF%E5%8F%96%E3%82%8A%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%81%BF%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%82%92%E7%9B%A3%E8%A6%96%E3%81%99%E3%82%8Bba\">読み取り、書き込みアクセスを監視する(ba)</a></li>\n<li><a href=\"#%E3%83%96%E3%83%AC%E3%83%BC%E3%82%AF%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E8%A8%AD%E5%AE%9A%E3%81%AE%E7%AE%A1%E7%90%86blbdetc\">ブレークポイント設定の管理(bl,bd,etc…)</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E5%AE%9F%E8%A1%8C%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89\">コード実行コマンド</a></p>\n<ul>\n<li><a href=\"#step-overp\">Step Over(p)</a></li>\n<li><a href=\"#step-intot\">Step Into(t)</a></li>\n<li><a href=\"#gog\">go(g)</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E5%87%BA%E5%8A%9B%E3%82%92%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AB%E4%BF%9D%E5%AD%98%E3%81%99%E3%82%8B\">コマンド出力をファイルに保存する</a></p>\n<ul>\n<li><a href=\"#%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%83%A9%E3%82%A4%E3%83%B3%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E5%87%BA%E5%8A%9B%E3%82%92%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AB%E4%BF%9D%E5%AD%98%E3%81%99%E3%82%8B\">コマンドラインオプションを使用して出力をファイルに保存する</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E6%8B%A1%E5%BC%B5%E6%A9%9F%E8%83%BD\">拡張機能</a></p>\n<ul>\n<li><a href=\"#help%E6%8B%A1%E5%BC%B5%E6%A9%9F%E8%83%BD%E3%81%AE%E3%83%98%E3%83%AB%E3%83%97\">!help：拡張機能のヘルプ</a></li>\n<li><a href=\"#analyze%E4%BE%8B%E5%A4%96%E3%82%84%E3%83%90%E3%82%B0%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF%E3%81%AB%E9%96%A2%E3%81%99%E3%82%8B%E6%83%85%E5%A0%B1%E3%81%AE%E5%8F%96%E5%BE%97\">!analyze：例外やバグチェックに関する情報の取得</a></li>\n<li><a href=\"#address%E3%83%A1%E3%83%A2%E3%83%AA%E3%82%84%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E3%81%AB%E9%96%A2%E3%81%99%E3%82%8B%E6%83%85%E5%A0%B1%E3%81%AE%E5%8F%82%E7%85%A7\">!address：メモリやプロセスに関する情報の参照</a></li>\n<li><a href=\"#handle%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%E3%81%BE%E3%81%9F%E3%81%AF%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E3%81%AE%E3%83%8F%E3%83%B3%E3%83%89%E3%83%AB%E6%83%85%E5%A0%B1%E3%81%AE%E5%8F%82%E7%85%A7\">!handle：システムまたはプロセスのハンドル情報の参照</a></li>\n<li><a href=\"#%E3%82%B9%E3%83%AC%E3%83%83%E3%83%89%E7%92%B0%E5%A2%83%E3%83%96%E3%83%AD%E3%83%83%E3%82%AFteb%E3%81%AE%E6%83%85%E5%A0%B1%E5%8F%96%E5%BE%97\">スレッド環境ブロック(TEB)の情報取得</a></li>\n<li><a href=\"#%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E7%92%B0%E5%A2%83%E3%83%96%E3%83%AD%E3%83%83%E3%82%AFpeb%E3%81%AE%E6%83%85%E5%A0%B1%E5%8F%96%E5%BE%97\">プロセス環境ブロック(PEB)の情報取得</a></li>\n<li><a href=\"#dumpext-%E6%8B%A1%E5%BC%B5%E6%A9%9F%E8%83%BD%E3%81%AB%E3%82%88%E3%82%8B-pe-%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E6%8A%BD%E5%87%BA\">!dumpext 拡張機能による PE ファイルの抽出</a></li>\n</ul>\n</li>\n<li><a href=\"#config-%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89\">Config コマンド</a></li>\n<li><a href=\"#%E3%81%9D%E3%81%AE%E4%BB%96%E3%81%AE%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89\">その他のコマンド</a></li>\n<li>\n<p><a href=\"#%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E4%BD%BF%E7%94%A8\">スクリプトファイルの使用</a></p>\n<ul>\n<li><a href=\"#%E6%9D%A1%E4%BB%B6%E5%88%86%E5%B2%90\">条件分岐</a></li>\n<li><a href=\"#%E3%83%AB%E3%83%BC%E3%83%97%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89\">ループコマンド</a></li>\n<li><a href=\"#%E3%83%96%E3%83%AD%E3%83%83%E3%82%AF%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B\">ブロックを作成する</a></li>\n<li><a href=\"#%E3%82%A8%E3%82%A4%E3%83%AA%E3%82%A2%E3%82%B9%E3%82%92%E4%BD%9C%E6%88%90%E5%89%8A%E9%99%A4%E3%81%99%E3%82%8B\">エイリアスを作成、削除する</a></li>\n<li><a href=\"#%E7%96%91%E4%BC%BC%E3%83%AC%E3%82%B8%E3%82%B9%E3%82%BF%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B\">疑似レジスタを使用する</a></li>\n<li><a href=\"#%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB\">スクリプトサンプル</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%A2%E3%83%BC%E3%83%89%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E3%81%AE%E8%A7%A3%E6%9E%90\">ユーザモードプロセスの解析</a></p>\n<ul>\n<li><a href=\"#%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%A2%E3%83%BC%E3%83%89%E3%82%B9%E3%83%AC%E3%83%83%E3%83%89\">ユーザモードスレッド</a></li>\n<li><a href=\"#%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%A2%E3%83%BC%E3%83%89%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9\">ユーザモードプロセス</a></li>\n<li><a href=\"#%E3%82%B9%E3%82%BF%E3%83%83%E3%82%AF%E3%83%90%E3%83%83%E3%82%AF%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%81%A8%E3%83%95%E3%83%AC%E3%83%BC%E3%83%A0%E3%81%AE%E8%A1%A8%E7%A4%BA\">スタックバックトレースとフレームの表示</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E3%82%AB%E3%83%BC%E3%83%8D%E3%83%AB%E3%83%A2%E3%83%BC%E3%83%89%E3%83%80%E3%83%B3%E3%83%97%E3%81%AE%E8%A7%A3%E6%9E%90\">カーネルモードダンプの解析</a></p>\n<ul>\n<li><a href=\"#%E3%83%95%E3%83%AB%E3%83%A1%E3%83%A2%E3%83%AA%E3%83%80%E3%83%B3%E3%83%97%E3%81%AE%E5%8F%96%E5%BE%97%E8%A8%AD%E5%AE%9A\">フルメモリダンプの取得設定</a></li>\n<li><a href=\"#%E3%82%AB%E3%83%BC%E3%83%8D%E3%83%AB%E6%A7%8B%E9%80%A0%E4%BD%93%E3%81%AE%E6%83%85%E5%A0%B1%E3%82%92%E5%88%97%E6%8C%99%E3%81%99%E3%82%8B\">カーネル構造体の情報を列挙する</a></li>\n<li><a href=\"#%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E6%83%85%E5%A0%B1%E3%82%92%E5%88%97%E6%8C%99%E3%81%99%E3%82%8B\">プロセス情報を列挙する</a></li>\n<li><a href=\"#%E3%82%B9%E3%83%AC%E3%83%83%E3%83%89%E6%83%85%E5%A0%B1%E3%82%92%E5%88%97%E6%8C%99%E3%81%99%E3%82%8B\">スレッド情報を列挙する</a></li>\n<li><a href=\"#%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E3%81%AE%E3%83%8F%E3%83%B3%E3%83%89%E3%83%AB%E6%83%85%E5%A0%B1%E3%82%92%E5%88%97%E6%8C%99%E3%81%99%E3%82%8B\">プロセスのハンドル情報を列挙する</a></li>\n<li><a href=\"#%E7%89%A9%E7%90%86%E4%BB%AE%E6%83%B3%E3%83%A1%E3%83%A2%E3%83%AA%E3%81%AE%E6%83%85%E5%A0%B1%E3%82%92%E5%87%BA%E5%8A%9B%E3%81%99%E3%82%8B\">物理、仮想メモリの情報を出力する</a></li>\n<li><a href=\"#%E3%82%AB%E3%83%BC%E3%83%8D%E3%83%AB%E3%83%A1%E3%83%A2%E3%83%AA%E3%83%80%E3%83%B3%E3%83%97%E3%81%A7%E3%82%B3%E3%83%B3%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%82%92%E5%90%88%E3%82%8F%E3%81%9B%E3%82%8B\">カーネルメモリダンプでコンテキストを合わせる</a></li>\n<li><a href=\"#%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3-id-%E3%81%A8%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E3%81%AE%E8%AA%BF%E6%9F%BB\">セッション ID とプロセスの調査</a></li>\n<li><a href=\"#kpcr-%E3%81%A8-kprcb-%E3%82%92%E5%8F%82%E7%85%A7%E3%81%97%E3%81%A6-cpu-%E3%81%AE%E7%B5%B1%E8%A8%88%E6%83%85%E5%A0%B1%E3%82%92%E8%AA%AD%E3%82%80\">KPCR と KPRCB を参照して CPU の統計情報を読む</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E3%83%A9%E3%82%A4%E3%83%96%E3%83%87%E3%83%90%E3%83%83%E3%82%B0\">ライブデバッグ</a></p>\n<ul>\n<li><a href=\"#%E3%82%AB%E3%83%BC%E3%83%8D%E3%83%AB%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%81%AE%E6%8E%A5%E7%B6%9Ahyper-vvirtualbox\">カーネルデバッガの接続(Hyper-V、VirtualBox)</a></li>\n<li><a href=\"#%E4%BE%8B%E5%A4%96%E3%82%84%E7%89%B9%E5%AE%9A%E3%81%AE%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E7%99%BA%E7%94%9F%E6%99%82%E3%81%AE%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%81%AE%E6%93%8D%E4%BD%9C%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%99%E3%82%8B\">例外や特定のイベント発生時のデバッガの操作を設定する</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF%E3%83%89%E3%83%A9%E3%82%A4%E3%83%90%E3%81%AE%E8%AA%BF%E6%9F%BB\">フィルタドライバの調査</a></p>\n<ul>\n<li><a href=\"#fltkd-%E6%8B%A1%E5%BC%B5%E6%A9%9F%E8%83%BD%E3%81%AE%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89\">fltkd 拡張機能のコマンド</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E8%A7%A3%E6%9E%90%E3%81%AB%E5%BF%85%E8%A6%81%E3%81%AA%E7%9F%A5%E8%AD%98\">解析に必要な知識</a></p>\n<ul>\n<li><a href=\"#32bit-%E3%81%A8-64bit-%E3%81%AE%E5%91%BC%E3%81%B3%E5%87%BA%E3%81%97%E8%A6%8F%E7%B4%84%E3%82%92%E7%90%86%E8%A7%A3%E3%81%99%E3%82%8B\">32bit と 64bit の呼び出し規約を理解する</a></li>\n<li><a href=\"#ntglobalflag\">NTGLOBALFLAG</a></li>\n<li><a href=\"#exception_record\">EXCEPTION_RECORD</a></li>\n<li><a href=\"#eprocessethread\">EPROCESS、ETHREAD</a></li>\n<li><a href=\"#guard-page\">Guard page</a></li>\n<li><a href=\"#sysenter-%E5%91%BD%E4%BB%A4\">sysenter 命令</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E3%82%88%E3%81%8F%E3%81%82%E3%82%8B%E4%BE%8B%E5%A4%96\">よくある例外</a></p>\n<ul>\n<li><a href=\"#access-violation-%E4%BE%8B%E5%A4%96\">Access Violation 例外</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E7%92%B0%E5%A2%83%E8%A8%AD%E5%AE%9A\">環境設定</a></p>\n<ul>\n<li><a href=\"#visual-studio-%E3%81%AE%E3%83%AA%E3%83%B3%E3%82%AB%E8%A8%AD%E5%AE%9A%E3%82%92%E5%A4%89%E6%9B%B4%E3%81%99%E3%82%8B\">Visual Studio のリンカ設定を変更する</a></li>\n<li><a href=\"#release-%E3%83%93%E3%83%AB%E3%83%89%E6%99%82%E3%81%AE%E6%9C%80%E9%81%A9%E5%8C%96%E3%82%92%E7%84%A1%E5%8A%B9%E5%8C%96%E3%81%99%E3%82%8B\">Release ビルド時の最適化を無効化する</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#windbg-%E3%81%AE%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0\">WinDbg のトラブルシューティング</a></p>\n<ul>\n<li><a href=\"#nt-symbols-are-incorrect-please-fix-symbols%E3%81%AE%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%8C%E5%87%BA%E5%8A%9B%E3%81%95%E3%82%8C%E3%82%8B%E5%A0%B4%E5%90%88\">「NT symbols are incorrect, please fix symbols」のエラーが出力される場合</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E3%81%9D%E3%81%AE%E4%BB%96%E3%81%AE-tips\">その他の Tips</a></p>\n<ul>\n<li><a href=\"#windbgx86-%E3%81%A8-windbgx64-%E3%81%A9%E3%81%A1%E3%82%89%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%81%B9%E3%81%8D%E3%81%A7%E3%81%99%E3%81%8B\">WinDbg(X86) と WinDbg(X64) どちらを使用すべきですか？</a></li>\n<li><a href=\"#windbgclassic-%E3%81%A7%E3%83%80%E3%83%BC%E3%82%AF%E3%83%86%E3%83%BC%E3%83%9E%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B\">WinDbg(Classic) でダークテーマを使用する</a></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"まえがき\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%88%E3%81%8C%E3%81%8D\" aria-label=\"まえがき permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まえがき</h2>\n<p>本記事の内容はすべて一般に公開されている情報や、出版された書籍、または個人の検証環境で動作確認を実施した結果のみを元に作成しています。</p>\n<p>関連記事はこちら。</p>\n<ul>\n<li><a href=\"/windbg-process-001\">WinDbg で Windows のプロセス情報を読むためのメモ書き</a></li>\n<li><a href=\"/windbg-gflags-tutorial\">GFlags でグローバルフラグを設定して詳細デバッグを行うためのナレッジ集 </a></li>\n</ul>\n<h2 id=\"よく使うリンク集\" style=\"position:relative;\"><a href=\"#%E3%82%88%E3%81%8F%E4%BD%BF%E3%81%86%E3%83%AA%E3%83%B3%E3%82%AF%E9%9B%86\" aria-label=\"よく使うリンク集 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>よく使うリンク集</h2>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/debugging-resources\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Debugging Resources - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/commands\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Commands - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://www.google.com/search?q=site%3Ahttps%3A%2F%2Flearn.microsoft.com%2Fen-us%2Fwindows-hardware%2Fdrivers%2Fdebugger%20\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Docs 検索用リンク</a></p>\n<p>参考：<a href=\"https://degiuli.github.io/WinDBG/Intro.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">WinDBG</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/windbg-release-notes\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">WinDbg Release notes - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"http://windbg.info/download/doc/pdf/WinDbg_A_to_Z_color_JP.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">WinDbg<em>A</em>to_Z</a></p>\n<p>参考：<a href=\"http://www.windbg.info/apps/46-crashme.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CrashMe Application</a> / <a href=\"https://mikedoszhang.blogspot.com/search?q=WinDbg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Mike Dos Zhang: Search results for WinDbg</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/shows/inside/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Inside Show | Microsoft Learn</a></p>\n<h2 id=\"モジュール一覧の操作情報取得lm-x-ln\" style=\"position:relative;\"><a href=\"#%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E4%B8%80%E8%A6%A7%E3%81%AE%E6%93%8D%E4%BD%9C%E6%83%85%E5%A0%B1%E5%8F%96%E5%BE%97lm-x-ln\" aria-label=\"モジュール一覧の操作情報取得lm x ln permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>モジュール一覧の操作、情報取得(lm, x, ln)</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># モジュールの列挙</span>\nlm\n\n<span class=\"token comment\"># a から始まるモジュールの列挙</span>\nlm m a*\n\n<span class=\"token comment\"># モジュール情報の表示、タイムスタンプなども表示できる</span>\n<span class=\"token comment\"># !lmi でも、モジュールの詳細情報を取得できる</span>\nlm Dvm <span class=\"token operator\">&lt;</span>modulename<span class=\"token operator\">></span>\n\n<span class=\"token comment\"># シンボルからモジュールの main 関数のアドレスを解決</span>\nx modulename<span class=\"token operator\">!</span>*main*\n\n<span class=\"token comment\"># a から始まる関数名の列挙</span>\nx /D /f modulename<span class=\"token operator\">!</span>a*\n\n<span class=\"token comment\"># アドレスからシンボル名を解決</span>\n<span class=\"token function\">ln</span> address</code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/lm--list-loaded-modules-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">lm (List Loaded Modules) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/x--examine-symbols-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">x (Examine Symbols) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/ln--list-nearest-symbols-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ln (List Nearest Symbols) - Windows drivers | Microsoft Learn</a></p>\n<h2 id=\"レジスタの参照と操作r\" style=\"position:relative;\"><a href=\"#%E3%83%AC%E3%82%B8%E3%82%B9%E3%82%BF%E3%81%AE%E5%8F%82%E7%85%A7%E3%81%A8%E6%93%8D%E4%BD%9Cr\" aria-label=\"レジスタの参照と操作r permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>レジスタの参照と操作(r)</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># レジスタの一覧表示</span>\nr\n\n<span class=\"token comment\"># 特定レジスタ、複数レジスタの表示</span>\nr eip\nr zf\nr eax,ebx,ecx,edx,ebp,eip\n\n<span class=\"token comment\"># レジスタの値の書き換え</span>\nr <span class=\"token assign-left variable\">eax</span><span class=\"token operator\">=</span>00000001\nr <span class=\"token assign-left variable\">zf</span><span class=\"token operator\">=</span><span class=\"token number\">0</span>\n\n<span class=\"token comment\"># 2 番目のスレッドに割り当てられているレジスタの表示</span>\n<span class=\"token comment\"># または、~1s などで現在のスレッドを切り替えてから出力する</span>\n~1 r\n\n<span class=\"token comment\"># すべてのスレッドに関連づけられているレジスタの表示</span>\n~* r eax\n\n<span class=\"token comment\"># xmm0 を符号なし 16 バイトとして表示</span>\n<span class=\"token comment\"># xmm1 は倍精度浮動小数点形式で表示</span>\nr xmm0:16ub, xmm1:d\n\n<span class=\"token comment\"># 疑似レジスタの表示</span>\nr <span class=\"token variable\">$peb</span>,<span class=\"token variable\">$teb</span>\n\n<span class=\"token comment\"># eax に ebx の値をコピー</span>\nr eax <span class=\"token operator\">=</span> @ebx</code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/r--registers-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">r (Registers) - Windows drivers | Microsoft Learn</a></p>\n<h2 id=\"メモリの参照と編集dcdpsetc\" style=\"position:relative;\"><a href=\"#%E3%83%A1%E3%83%A2%E3%83%AA%E3%81%AE%E5%8F%82%E7%85%A7%E3%81%A8%E7%B7%A8%E9%9B%86dcdpsetc\" aria-label=\"メモリの参照と編集dcdpsetc permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>メモリの参照と編集(dc,dps,etc..)</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># メモリアドレスの範囲またはオフセットを指定してメモリ内の Hex と ASCII を出力</span>\n<span class=\"token function\">dc</span> 0x1000 0x1200\n\n<span class=\"token comment\"># L はオブジェクトカウントを指す</span>\n<span class=\"token comment\"># dc @addr L1 は DWORD 1 つ分、dq @addr L1 は QWORD 1 つ分</span>\n<span class=\"token function\">dc</span> @eip L1\n<span class=\"token function\">dc</span> 0x1000 L20\n\n<span class=\"token comment\"># アドレス単体や、アドレス値を持つレジスタを参照することも可能</span>\n<span class=\"token function\">dc</span> 0x1000\n<span class=\"token function\">dc</span> eax\n\n<span class=\"token comment\"># ポインタサイズの値を取得できる</span>\ndps 0x1000\ndqs 0x1000\n\n<span class=\"token comment\"># 32bit(ddp)、64bit(dqp)でメモリを表示</span>\nddp 0x1000\ndqp 0x1000\n\n<span class=\"token comment\"># ASCII 文字列で表示</span>\nda 0x1000\n\n<span class=\"token comment\"># バイト値の書き換え</span>\neb 0x1000 \n\n<span class=\"token comment\"># ASCII 文字列の書き換え</span>\nea 0x1000 <span class=\"token string\">\"change ascii\"</span></code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/d--da--db--dc--dd--dd--df--dp--dq--du--dw--dw--dyb--dyd--display-memor\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">d, da, db, dc, dd, dD, df, dp, dq, du, dw (Display Memory) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/dda--ddp--ddu--dpa--dpp--dpu--dqa--dqp--dqu--display-referenced-memory\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">dda, ddp, ddu, dpa, dpp, dpu, dqa, dqp, dqu (Display Referenced Memory) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/dds--dps--dqs--display-words-and-symbols-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">dds, dps, dqs (Display Words and Symbols) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/e--ea--eb--ed--ed--ef--ep--eq--eu--ew--eza--ezu--enter-values-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">e, ea, eb, ed, eD, ef, ep, eq, eu, ew, eza (Enter Values) - Windows drivers | Microsoft Learn</a></p>\n<h2 id=\"メモリ内の検索s\" style=\"position:relative;\"><a href=\"#%E3%83%A1%E3%83%A2%E3%83%AA%E5%86%85%E3%81%AE%E6%A4%9C%E7%B4%A2s\" aria-label=\"メモリ内の検索s permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>メモリ内の検索(s)</h2>\n<p>基本的なメモリ内の探索は以下のコマンドで実現できます。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># RSP のアドレスから 1000000 バイトの範囲で DWORD 値 H を検索する</span>\ns -d @rsp L1000000 <span class=\"token string\">'H'</span>\n\n<span class=\"token comment\"># RSP のアドレスから 1000000 バイトの範囲で ASCII 文字列 Hello を検索する</span>\ns -a @rsp L10000000 <span class=\"token string\">\"Hello\"</span>  \n\n<span class=\"token comment\"># 0 から 0x7fffffff までの広い範囲で ASCII 文字列 Hello を検索する</span>\n<span class=\"token comment\"># 256 MB 以上の大きな範囲を検索する場合は、 L? の指定が必ず必要になる</span>\ns -a <span class=\"token number\">0</span> L?7fffffff <span class=\"token string\">\"Hello\"</span>\n\n<span class=\"token comment\"># ASCII と同様に、Unicord 文字列も検索することができる</span>\ns -u @rsp L1000000 <span class=\"token string\">'Hello'</span>\ns -u <span class=\"token number\">0</span> L?7fffffff <span class=\"token string\">\"Hello\"</span></code></pre></div>\n<p>以下は、ASCII 文字列と Unicord 文字列をそれぞれ検索した場合の差分を確認した結果です。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 698px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/742a93bd4df2cc77104334db0c2392ce/487bb/image-20230401234723850.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.583333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA00lEQVQY0z2QWQqAMAxEvf/BBAUVcd93cRdR/HRkAloYkrTN5BHFsizkeS5KkgRVVaFpGqnHccS+71iWBdu2YV1XEXPe8a3rOkzThGEYcN83FE3T4Ps+HMdBEASo61pEw7Zt5SOHlGUp4htrRg4mEHsNw8BxHFCYkCyOY4lpmkr+mdOQ6vv+p/mIz/OUmmTP84gUXdfheR5s2xbDoigQhqGYfpH3zDmE5CSkOY1JfV0XeMRQVVVBNk1Tmkjouq40cxVRFP3mrLMs+/c8z7MAkPQzfAH8ImvrJ/lMfgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/742a93bd4df2cc77104334db0c2392ce/8ac56/image-20230401234723850.webp 240w,\n/static/742a93bd4df2cc77104334db0c2392ce/d3be9/image-20230401234723850.webp 480w,\n/static/742a93bd4df2cc77104334db0c2392ce/d1b7f/image-20230401234723850.webp 698w\"\n              sizes=\"(max-width: 698px) 100vw, 698px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/742a93bd4df2cc77104334db0c2392ce/8ff5a/image-20230401234723850.png 240w,\n/static/742a93bd4df2cc77104334db0c2392ce/e85cb/image-20230401234723850.png 480w,\n/static/742a93bd4df2cc77104334db0c2392ce/487bb/image-20230401234723850.png 698w\"\n            sizes=\"(max-width: 698px) 100vw, 698px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/742a93bd4df2cc77104334db0c2392ce/487bb/image-20230401234723850.png\"\n            alt=\"image-20230401234723850\"\n            title=\"image-20230401234723850\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>また、特定のバイトパターンを指定してメモリ内の情報を検索することもできます。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># RSP のアドレスから 400 バイトの範囲で「長さ 4 文字以上の ASCII 文字列」を検索</span>\ns -<span class=\"token punctuation\">[</span>l4<span class=\"token punctuation\">]</span>sa @rsp L400\n\n<span class=\"token comment\"># RSP のアドレスから 400 バイトの範囲内の「書き込み可能アドレス」から「長さ 4 文字以上の ASCII 文字列」を検索</span>\ns -<span class=\"token punctuation\">[</span>wl4<span class=\"token punctuation\">]</span>sa @rsp L400</code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/s--search-memory-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">s (Search Memory) - Windows drivers | Microsoft Learn</a></p>\n<h2 id=\"アセンブリコードの出力uubetc\" style=\"position:relative;\"><a href=\"#%E3%82%A2%E3%82%BB%E3%83%B3%E3%83%96%E3%83%AA%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E5%87%BA%E5%8A%9Buubetc\" aria-label=\"アセンブリコードの出力uubetc permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>アセンブリコードの出力(u,ub,etc…)</h2>\n<p>以下のコマンドで Disassembly ウインドウで参照できるものと同じアセンブリコードを出力できます。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># EIP から数行のアセンブリコードを出力(ub は逆方向に出力)</span>\nu\nub\n\n<span class=\"token comment\"># 指定のアドレスから 10 行分のアセンブリコードを出力</span>\nu 0x1000 L10\n\n<span class=\"token comment\"># 特定のレジスタ内のアドレスを使用することも可能</span>\nu eax L10\nu eip L20\n\n<span class=\"token comment\"># 関数のアドレスまたはシンボル名から特定の関数全体のコードを出力</span>\nuf 0x1000\nuf module<span class=\"token operator\">!</span>function\n\n<span class=\"token comment\"># 対象関するルーチン内の call 命令のみ抽出</span>\nuf /c 0x1000</code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/u--unassemble-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">u, ub, uu (Unassemble) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/uf--unassemble-function-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">uf (Unassemble Function) - Windows drivers | Microsoft Learn</a></p>\n<h2 id=\"変数と構造体の出力dvdt\" style=\"position:relative;\"><a href=\"#%E5%A4%89%E6%95%B0%E3%81%A8%E6%A7%8B%E9%80%A0%E4%BD%93%E3%81%AE%E5%87%BA%E5%8A%9Bdvdt\" aria-label=\"変数と構造体の出力dvdt permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>変数と構造体の出力(dv,dt)</h2>\n<p>変数や構造体情報を取得できるコマンドです。</p>\n<p>特に、<code class=\"language-text\">dt</code> でカーネル構造体の情報を取得することは非常に多くあります。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># 現在のスコープ内のローカル変数を出力(/t で型名を表示)</span>\ndv\ndv /t\n\n<span class=\"token comment\"># 変数の型名は dt コマンドからも解決することができる</span>\ndt local_val_name\n\n<span class=\"token comment\"># シンボル名またはアドレスから構造体を解決</span>\ndt MyStruct\n\n<span class=\"token comment\"># 構造体のメンバになっているサブ構造体の情報も再帰的に列挙するために -r もしくは -b を使用する</span>\ndt -r MyStruct\n\n<span class=\"token comment\"># -r1 -r2 などのようにして再帰的に表示する構造体の階層を指定できる</span>\ndt -r2 MyStruct\n\n<span class=\"token comment\"># カーネル構造体の型情報を列挙できる</span>\ndt nt<span class=\"token operator\">!</span>_*\ndt nt<span class=\"token operator\">!</span>*PEB*\n\n<span class=\"token comment\"># 特定の構造体のアドレスを指定することで実際の値を取得できる</span>\ndt nt<span class=\"token operator\">!</span>_EPROCESS <span class=\"token operator\">&lt;</span>EPROCESSのアドレス<span class=\"token operator\">></span>\n\n<span class=\"token comment\"># サブタイプ名を指定することで、特定の値のみ抽出することもできる</span>\ndt nt<span class=\"token operator\">!</span>_EPROCESS ImageFileName <span class=\"token operator\">&lt;</span>EPROCESSのアドレス<span class=\"token operator\">></span>\n\n<span class=\"token comment\"># -l オプションでリンクされたリストをたどって構造体情報をダンプする</span>\n<span class=\"token comment\"># -y オプションで「指定の文字列が名前の先頭部分に一致する」行を出力する</span>\n<span class=\"token comment\"># -o オプションでオフセットを非表示にする</span>\n<span class=\"token comment\"># -i オプションでサブタイプのインデントを行わない</span>\ndt nt<span class=\"token operator\">!</span>_EPROCESS -l ActiveProcessLinks.Flink  -y Ima -yoi Uni <span class=\"token operator\">&lt;</span>EPROCESSのアドレス<span class=\"token operator\">></span>\n\n<span class=\"token comment\"># dt ではサブ構造体の情報を取得できないので -r か -b スイッチを使う</span>\ndt ntdll<span class=\"token operator\">!</span>_EPROCESS -r <span class=\"token operator\">&lt;</span>EPROCESSのアドレス<span class=\"token operator\">></span>\ndt ntdll<span class=\"token operator\">!</span>_EPROCESS -b <span class=\"token operator\">&lt;</span>EPROCESSのアドレス<span class=\"token operator\">></span></code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/dv--display-local-variables-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">dv (Display Local Variables) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/dt--display-type-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">dt (Display Type) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/ja-jp/sysinternals/resources/windows-internals\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">インサイド Windows 第 7 版 上 P.44</a></p>\n<p>解析対象の構造体に双方向リストが含まれる場合、dt コマンドで再帰的にリストで連結された情報を取得することができます。(カーネルデバッグ時の<code class=\"language-text\">_EPROCESS</code>構造体の列挙など)</p>\n<p>また、dv コマンドは 64bit 呼び出し規約や<code class=\"language-text\">Fast calling convention</code>(引数を可能な限りレジスタ経由で渡す呼び出し規約)では有効に動作しません。</p>\n<p>例えば、x86 Windows で標準的に使用される呼び出し規約<code class=\"language-text\">__cdecl</code>は引数がすべてスタック経由で与えられるため、dv コマンドで安定してローカル引数を参照することが可能です。</p>\n<p>参考：<a href=\"https://www.glamenv-septzen.net/view/581#id2d585d\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">抄訳メモ/Calling Conventions Demystified - Glamenv-Septzen.net</a></p>\n<h3 id=\"pe-バイナリの情報を参照する\" style=\"position:relative;\"><a href=\"#pe-%E3%83%90%E3%82%A4%E3%83%8A%E3%83%AA%E3%81%AE%E6%83%85%E5%A0%B1%E3%82%92%E5%8F%82%E7%85%A7%E3%81%99%E3%82%8B\" aria-label=\"pe バイナリの情報を参照する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PE バイナリの情報を参照する</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># テーブル情報を参照する</span>\n<span class=\"token operator\">!</span>dh -f <span class=\"token operator\">!</span><span class=\"token operator\">&lt;</span>module_name<span class=\"token operator\">></span>\n\n<span class=\"token comment\"># テーブル情報から特定したアドレスとサイズからインポートテーブルの情報を列挙する</span>\ndps <span class=\"token operator\">!</span><span class=\"token operator\">&lt;</span>module_name<span class=\"token operator\">></span>+<span class=\"token operator\">&lt;</span>IAT のアドレス<span class=\"token operator\">></span> <span class=\"token operator\">!</span><span class=\"token operator\">&lt;</span>module_name<span class=\"token operator\">></span>+<span class=\"token operator\">&lt;</span>IAT のアドレス<span class=\"token operator\">></span>+<span class=\"token operator\">&lt;</span>IAT のサイズ<span class=\"token operator\">></span>\n\n<span class=\"token comment\"># DOS ヘッダの列挙</span>\ndt /r _IMAGE_DOS_HEADER @@masm<span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">&lt;</span>module_name<span class=\"token operator\">></span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># NT ヘッダ(FileHeader / OptionalHeader)の列挙</span>\n<span class=\"token comment\"># e_lfanew は、DOS ヘッダの 0x3C にある PE ヘッダのポインタから取得</span>\ndt /r _IMAGE_NT_HEADERS64 @@masm<span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">&lt;</span>module_name<span class=\"token operator\">></span>+<span class=\"token operator\">&lt;</span>e_lfanew の値<span class=\"token operator\">></span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># NT ヘッダ の FileHeader のサイズに SizeOfOptionalHeader の値を足したアドレスから最初の SectionHeader を取得する </span>\ndt /r _IMAGE_SECTION_HEADER @@masm<span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">&lt;</span>module_name<span class=\"token operator\">></span>+0xF8+0x018+<span class=\"token operator\">&lt;</span>SizeOfOptionalHeader<span class=\"token operator\">></span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># _IMAGE_SECTION_HEADER のサイズである 0x28 を足して行くと次のセクションの情報を参照できる(事前に構造体のシンボルをロードする必要あり)</span>\ndt /r _IMAGE_SECTION_HEADER @@masm<span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token operator\">&lt;</span>module_name<span class=\"token operator\">></span>+0xF8+0x018+<span class=\"token operator\">&lt;&lt;</span>SizeOfOptionalHeader<span class=\"token operator\">></span>+0x28<span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"ブレークポイントの設定bpbubm\" style=\"position:relative;\"><a href=\"#%E3%83%96%E3%83%AC%E3%83%BC%E3%82%AF%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AE%E8%A8%AD%E5%AE%9Abpbubm\" aria-label=\"ブレークポイントの設定bpbubm permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ブレークポイントの設定(bp,bu,bm)</h2>\n<p>ブレークポイントは、bp、bu、bm の 3 つのコマンドを使用して設定することができます。</p>\n<p>bp は通常のブレークポイント設定で、コマンドで指定したシンボルやアドレスにブレークポイントを設定します。</p>\n<p>一方で、未解決のアドレスや bp で解決できなかったアドレスについては bu を使用してブレークポイントを設定します。</p>\n<p>さらに、bm コマンドを使用することでパターンを使用してシンボルに対してブレークポイントを設定できます。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># オフセットを指定してブレークポイントを設定</span>\nbp module+0x123\nbu dllmodule<span class=\"token operator\">!</span>DLLMain\n\n<span class=\"token comment\"># mem から始まる複数のモジュールにまとめてブレークポイントを設定</span>\nbm myprogram<span class=\"token operator\">!</span>mem*</code></pre></div>\n<p>また、ブレークポイントを設定する場合にはブレークポイントにマッチした場合の処理や、停止されるまでに該当のコードが呼び出される回数を指定することも可能です。</p>\n<p>加えて、IF 文などの条件分岐を定義してブレーク時の動作を細かく条件付けできます。</p>\n<p>条件式に使用できる演算子しては、<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/masm-numbers-and-operators\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">MASM Numbers and Operators</a> などが利用できます。</p>\n<p>条件分岐は .if や j コマンドで定義できますが、現在はこの記法は推奨されておらず、<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/setting-a-conditional-breakpoint\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Conditional breakpoints in WinDbg</a> の通り<code class=\"language-text\">bp /w \"(Condition)\" Address</code>の記法を使用することができます。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># ブレークポイントを設定した処理が 7 回目に呼び出された場合に実行を停止する</span>\nbp MyTest+0xb <span class=\"token number\">7</span>\n\n<span class=\"token comment\"># ブレークポイントにマッチした後、 EAX と変数 MyVar の出力を行い、自動的に実行を再開する</span>\nbp ntdll<span class=\"token operator\">!</span>RtlRaiseException <span class=\"token string\">\"r eax; dt MyVar; gc\"</span>\n\n<span class=\"token comment\"># echo で任意の文字列を出力して処理を続行</span>\nbp module<span class=\"token operator\">!</span>myFunction <span class=\"token string\">\".echo myFunction executed; gc\"</span>\n\n<span class=\"token comment\"># IF 文条件式の基本的な構文</span>\nbp module<span class=\"token operator\">!</span>myFunction <span class=\"token string\">\".if () {} .else {}\"</span>\n\n<span class=\"token comment\"># var のアドレスを poi で逆解決し、10 進数の 10 と比較</span>\n<span class=\"token comment\"># 一致すれば何もせずブレークし、一致しない場合は処理を継続する</span>\nbp module<span class=\"token operator\">!</span>myFunction <span class=\"token string\">\".if ( poi(var) == 0n10 ) {} .else { gc }\"</span>\n\n<span class=\"token comment\"># 以下も上記と同等の結果を得られる</span>\nbp module<span class=\"token operator\">!</span>myFunction <span class=\"token string\">\"j ( poi(var) == 0n10 ) ''; 'gc'\"</span></code></pre></div>\n<p>ちなみに、gc コマンドは条件付きブレークポイントからの移動を指示するコマンドで、これをブレーク時の条件に含める場合、このブレークポイントに到達した際の実行コマンド(g や F10 など)と同じ方法で処理を進めるように指定することができます。</p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/bp--bu--bm--set-breakpoint-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">bp, bu, bm (Set Breakpoint) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/gc--go-from-conditional-breakpoint-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">gc (Go from Conditional Breakpoint) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/j--execute-if---else-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">j (Execute If - Else) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/setting-a-conditional-breakpoint\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Conditional breakpoints in WinDbg and other Windows debuggers - Windows drivers | Microsoft Learn</a></p>\n<p>また、ブレークポイントの条件はスクリプトファイルを使用して制御することも可能です。</p>\n<p>詳しくは<a href=\"#%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E4%BD%BF%E7%94%A8\">スクリプトファイルの使用</a>に記載します。</p>\n<h3 id=\"読み取り書き込みアクセスを監視するba\" style=\"position:relative;\"><a href=\"#%E8%AA%AD%E3%81%BF%E5%8F%96%E3%82%8A%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%81%BF%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%82%92%E7%9B%A3%E8%A6%96%E3%81%99%E3%82%8Bba\" aria-label=\"読み取り書き込みアクセスを監視するba permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>読み取り、書き込みアクセスを監視する(ba)</h3>\n<p>ba コマンドを使用することで、実行コードだけでなく、特定のメモリ領域にアクセスが発生した場合のブレークポイントも設定することができます。</p>\n<p>この時指定可能な値は大きく「実行(e)」、「読み取り/書き込み(r)」、「書き込み(w)」の 3 つです。</p>\n<p>また、カーネルデバッグ時限定で、「I/O(i)」オプションで特定の I/O ポートに対するアクセスが行われた場合のブレークポイントを構成することもできます。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># 変数名または変数のアドレスから「4 バイト分の領域に読み取りアクセスが発生した場合」にブレークする</span>\nba r4 myVar\nba r4 0x1000\n\n<span class=\"token comment\"># 対象に書き込みアクセスが発生した場合にブレークする</span>\nba w4 0x1000\n\n<span class=\"token comment\"># 3f8 から 3f8+4 の範囲のポートで I/O が発生した場合にブレークする(カーネルデバッグ時のみ)</span>\nba i4 3f8</code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/ba--break-on-access-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ba (Break on Access) - Windows drivers | Microsoft Learn</a></p>\n<h3 id=\"ブレークポイント設定の管理blbdetc\" style=\"position:relative;\"><a href=\"#%E3%83%96%E3%83%AC%E3%83%BC%E3%82%AF%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E8%A8%AD%E5%AE%9A%E3%81%AE%E7%AE%A1%E7%90%86blbdetc\" aria-label=\"ブレークポイント設定の管理blbdetc permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ブレークポイント設定の管理(bl,bd,etc…)</h3>\n<p>現在のブレークポイント設定の確認や有効化/無効化は以下のコマンドで行うことができます。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># 現在設定されているブレークポイントの列挙</span>\n<span class=\"token comment\"># ここで表示されるブレークポイントの ID は他の管理コマンドで対象を指定する際に使用できる</span>\nbl\n\n<span class=\"token comment\"># すべてのブレークポイントを無効化する</span>\nbd *\n\n<span class=\"token comment\"># ID 1 のブレークポイントのみを無効化する</span>\nbd <span class=\"token number\">1</span>\n\n<span class=\"token comment\"># すべてのブレークポイントを有効化する</span>\nbe *\n\n<span class=\"token comment\"># ID 1 のブレークポイントのみを有効化する</span>\nbe <span class=\"token number\">1</span>\n\n<span class=\"token comment\"># 現在のブレークポイント設定に使用したコマンドを上から順にリストする</span>\n.bpcmds</code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/bl--breakpoint-list-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">bl (Breakpoint List) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/be--breakpoint-enable-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">be (Breakpoint Enable) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/bd--breakpoint-disable-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">bd (Breakpoint Disable) - Windows drivers | Microsoft Learn</a></p>\n<p>また、現在のブレークポイント設定や条件式を更新したい場合は以下のコマンドを使用します。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># ブレークポイントの ID を変更します</span>\n<span class=\"token comment\"># 複数の ID 変更を一括で行うこともできます</span>\nbr OldID NewID\nbr OldID NewID OldID2 NewID2 OldID3 NewID3 \n\n<span class=\"token comment\"># ブレークポイントのコマンド部分を修正できます</span>\nbs ID <span class=\"token punctuation\">[</span><span class=\"token string\">\"CommandString\"</span><span class=\"token punctuation\">]</span> \n\n<span class=\"token comment\"># ブレークポイントの条件文を変更できます</span>\nbsc ID Condition <span class=\"token punctuation\">[</span><span class=\"token string\">\"CommandString\"</span><span class=\"token punctuation\">]</span> </code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/br--breakpoint-renumber-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">br (Breakpoint Renumber) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/bs--update-breakpoint-command-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">bs (Update Breakpoint Command) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/bsc--update-conditional-breakpoint-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">bsc (Update Conditional Breakpoint) - Windows drivers | Microsoft Learn</a></p>\n<h2 id=\"コード実行コマンド\" style=\"position:relative;\"><a href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E5%AE%9F%E8%A1%8C%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89\" aria-label=\"コード実行コマンド permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>コード実行コマンド</h2>\n<p>WinDbg でコード実行を行う場合、大きく分けて以下の 3 つの操作を行うことができます。</p>\n<ul>\n<li>Step：単一の命令またはコードを実行する(Step Over)</li>\n<li>Trace：単一の命令またはソース行を実行する(Step Into)</li>\n<li>Go：プロセスまたはスレッドの実行を再開する</li>\n</ul>\n<h3 id=\"step-overp\" style=\"position:relative;\"><a href=\"#step-overp\" aria-label=\"step overp permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step Over(p)</h3>\n<p>p コマンドや F10 キーで単一の命令またはコードを実行します。</p>\n<p>WinDbg では p コマンドや F10 キーで実行する操作は Step Over に該当し、 call 命令では呼び出し先の関数には移動せず、call 命令の次の行の処理に進みます。</p>\n<p>ちなみに、デフォルトでは Step Over 時にレジスタとフラグが出力されますが、pr のように各コマンドに r を付与するか、<code class=\"language-text\">.prompt_allow -reg</code>コマンドを実行することでレジスタとフラグの出力を無効化することができます。(元に戻す場合は<code class=\"language-text\">.prompt_allow +reg</code>コマンドを実行します)</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># ステップオーバーの処理を行う</span>\np <span class=\"token punctuation\">(</span>または F10<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 5 行分ステップオーバーを実行する</span>\np <span class=\"token number\">5</span>\n\n<span class=\"token comment\"># ステップオーバーの実行後に WinDbg コマンドを実行する</span>\np <span class=\"token string\">\"k;r eax\"</span>\n\n<span class=\"token comment\"># 指定のアドレスに到達するまで Step Over を繰り返す</span>\npa StopAddress\n\n<span class=\"token comment\"># 次の call 命令の呼び出し行まで Step Over する</span>\npc\n\n<span class=\"token comment\"># pc の場合もカウント実行が可能</span>\npc <span class=\"token number\">3</span>\n\n<span class=\"token comment\"># 次の ret 命令の呼び出し行まで Step Over する</span>\npt\n\n<span class=\"token comment\"># 次の call 命令または ret 命令の呼び出し行まで Step Over する</span>\npct\n\n<span class=\"token comment\"># 次の条件分岐の呼び出しまで Step Over する</span>\nph</code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/p--step-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">p (Step) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/pa--step-to-address-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">pa (Step to Address) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/pc--step-to-next-call-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">pc (Step to Next Call) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/pt--step-to-next-return-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">pt (Step to Next Return) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/pct--step-to-next-call-or-return-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">pct (Step to Next Call or Return) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/ph--step-to-next-branching-instruction-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ph (Step to Next Branching Instruction) - Windows drivers | Microsoft Learn</a></p>\n<h3 id=\"step-intot\" style=\"position:relative;\"><a href=\"#step-intot\" aria-label=\"step intot permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step Into(t)</h3>\n<p>TODO：追記予定</p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/t--trace-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">t (Trace) - Windows drivers | Microsoft Learn</a></p>\n<h3 id=\"gog\" style=\"position:relative;\"><a href=\"#gog\" aria-label=\"gog permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>go(g)</h3>\n<p>TODO：追記予定</p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/g--go-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">g (Go) - Windows drivers | Microsoft Learn</a></p>\n<h2 id=\"コマンド出力をファイルに保存する\" style=\"position:relative;\"><a href=\"#%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E5%87%BA%E5%8A%9B%E3%82%92%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AB%E4%BF%9D%E5%AD%98%E3%81%99%E3%82%8B\" aria-label=\"コマンド出力をファイルに保存する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>コマンド出力をファイルに保存する</h2>\n<p>.logopen コマンドを使用すると、WinDbg のコマンド実行とその出力結果を任意のファイルに保存することができます。</p>\n<p>デフォルトでは出力されるテキストは ASCII 文字列ですが、 /u オプションを使用することで Unicord 文字列を指定することができます。</p>\n<p>特に、process コマンドなどのような大量の情報を一気に出力する場合などに便利です。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># 任意のログファイルにコマンド出力を記録する(ASCII テキスト)</span>\n.logopen C:<span class=\"token punctuation\">\\</span>Users<span class=\"token punctuation\">\\</span>Public<span class=\"token punctuation\">\\</span>windbg.log\n\n<span class=\"token comment\"># プロセス ID と現在の日時を付与(/t)して任意のログファイルにコマンド出力を記録する</span>\n.logopen /t C:<span class=\"token punctuation\">\\</span>Users<span class=\"token punctuation\">\\</span>Public<span class=\"token punctuation\">\\</span>windbg.log\n\n<span class=\"token comment\"># プロセスやファイル情報などから自動的にファイル名を決定して保存</span>\n.logopen /d\n\n<span class=\"token comment\"># 既存のログファイルに追記する</span>\n.logappend C:<span class=\"token punctuation\">\\</span>Users<span class=\"token punctuation\">\\</span>Public<span class=\"token punctuation\">\\</span>windbg.log\n\n<span class=\"token comment\"># ファイルを閉じて記録を終了する</span>\n.logclose</code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/keeping-a-log-file-in-windbg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Keeping a Log File in WinDbg - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/-logopen--open-log-file-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">.logopen (Open Log File) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/-logappend--append-log-file-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">.logappend (Append Log File) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/-logclose--close-log-file-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">.logclose (Close Log File) - Windows drivers | Microsoft Learn</a></p>\n<h3 id=\"コマンドラインオプションを使用して出力をファイルに保存する\" style=\"position:relative;\"><a href=\"#%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%83%A9%E3%82%A4%E3%83%B3%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E5%87%BA%E5%8A%9B%E3%82%92%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AB%E4%BF%9D%E5%AD%98%E3%81%99%E3%82%8B\" aria-label=\"コマンドラインオプションを使用して出力をファイルに保存する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>コマンドラインオプションを使用して出力をファイルに保存する</h3>\n<p><code class=\"language-text\">-logo FilePath</code>オプションを使用して WinDbg を起動することで、コマンドウインドウの出力をすべて指定のファイルに記録することができます。</p>\n<p>これは、アプリケーションの Debugger フラグに WinDbg のパスを指定する場合にも使用できます。</p>\n<p>また、ショートカットの編集から、WinDbg の起動時に<code class=\"language-text\">-logo</code>オプションを指定することもできます。</p>\n<p>例えば、以下のコマンドラインをショートカットに設定すると、<code class=\"language-text\">C:\\Users\\Public\\debug.log</code>に常に出力結果が保存されるようになります。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">C:<span class=\"token punctuation\">\\</span>Program Files <span class=\"token punctuation\">(</span>x86<span class=\"token punctuation\">)</span><span class=\"token punctuation\">\\</span>Windows Kits<span class=\"token punctuation\">\\</span><span class=\"token number\">10</span><span class=\"token punctuation\">\\</span>Debuggers<span class=\"token punctuation\">\\</span>x64<span class=\"token punctuation\">\\</span>windbg.exe -logo  C:<span class=\"token punctuation\">\\</span>Users<span class=\"token punctuation\">\\</span>Public<span class=\"token punctuation\">\\</span>debug.log</code></pre></div>\n<p>なお、上記の例で<code class=\"language-text\">-logo</code>オプションを使用する場合、ファイルは毎回 WinDbg を起動するたびに上書きされるので注意が必要です。</p>\n<h2 id=\"拡張機能\" style=\"position:relative;\"><a href=\"#%E6%8B%A1%E5%BC%B5%E6%A9%9F%E8%83%BD\" aria-label=\"拡張機能 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>拡張機能</h2>\n<p>ロードされている拡張機能は<code class=\"language-text\">.chain</code>で確認できます。</p>\n<p>デフォルトの拡張機能は以下の種類があり、それぞれ DLL として読み込まれます。</p>\n<ul>\n<li>ext</li>\n<li>wow64exts</li>\n<li>dbghelp</li>\n<li>exts</li>\n<li>uext</li>\n<li>ntsdexts</li>\n</ul>\n<h3 id=\"help拡張機能のヘルプ\" style=\"position:relative;\"><a href=\"#help%E6%8B%A1%E5%BC%B5%E6%A9%9F%E8%83%BD%E3%81%AE%E3%83%98%E3%83%AB%E3%83%97\" aria-label=\"help拡張機能のヘルプ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>!help：拡張機能のヘルプ</h3>\n<p><code class=\"language-text\">!help</code>拡張機能は既定では ext 拡張機能のコマンド一覧を出力します。</p>\n<p>ただし、help 拡張機能は他にもいくつかの拡張機能に存在しており、<code class=\"language-text\">!ext.help</code>や<code class=\"language-text\">!wow64exts.help</code>などの記法でそれぞれの拡張機能のコマンド一覧にアクセスできます。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># ext 拡張機能のヘルプを出力</span>\n<span class=\"token operator\">!</span>ext.help\n\nanalyze <span class=\"token punctuation\">[</span>-v<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>level<span class=\"token punctuation\">]</span>        - Analyzes current exception or bugcheck <span class=\"token punctuation\">(</span>levels are <span class=\"token number\">0</span><span class=\"token punctuation\">..</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span>\nowner <span class=\"token punctuation\">[</span>symbol<span class=\"token operator\">!</span>module<span class=\"token punctuation\">]</span>      - Displays the Owner <span class=\"token keyword\">for</span> current exception or bugcheck\ncomment                    - Displays the Dump's Comment<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span>\n\nerror <span class=\"token punctuation\">[</span>errorcode<span class=\"token punctuation\">]</span>          - Displays Win32 or NTSTATUS error string\ngle <span class=\"token punctuation\">[</span>-all<span class=\"token punctuation\">]</span>                 - Displays the Last Error <span class=\"token operator\">&amp;</span> Last Status of the current thread\n\naddress <span class=\"token punctuation\">[</span>address<span class=\"token punctuation\">]</span>          - Displays the address space layout\n        <span class=\"token punctuation\">[</span>-UsageType<span class=\"token punctuation\">]</span>       - Displays the address space regions of the given <span class=\"token builtin class-name\">type</span>\n\ncpuid <span class=\"token punctuation\">[</span>processor<span class=\"token punctuation\">]</span>          - Displays the CPU information <span class=\"token keyword\">for</span> a specific or all CPUs\n\nexchain                    - Displays exception chain <span class=\"token keyword\">for</span> the current thread\n\nfor_each_process <span class=\"token operator\">&lt;</span>cmd<span class=\"token operator\">></span>     - Executes <span class=\"token builtin class-name\">command</span> <span class=\"token keyword\">for</span> each process\nfor_each_thread <span class=\"token operator\">&lt;</span>cmd<span class=\"token operator\">></span>      - Executes <span class=\"token builtin class-name\">command</span> <span class=\"token keyword\">for</span> each thread\nfor_each_frame <span class=\"token operator\">&lt;</span>cmd<span class=\"token operator\">></span>       - Executes <span class=\"token builtin class-name\">command</span> <span class=\"token keyword\">for</span> each frame <span class=\"token keyword\">in</span> the current thread\nfor_each_local <span class=\"token operator\">&lt;</span>cmd<span class=\"token operator\">></span> <span class=\"token variable\">$$</span><span class=\"token operator\">&lt;</span>n<span class=\"token operator\">></span> - Executes <span class=\"token builtin class-name\">command</span> <span class=\"token keyword\">for</span> each <span class=\"token builtin class-name\">local</span> variable <span class=\"token keyword\">in</span> the current frame,\n                             substituting the fixed-name <span class=\"token builtin class-name\">alias</span> <span class=\"token variable\">$u</span><span class=\"token operator\">&lt;</span>n<span class=\"token operator\">></span> <span class=\"token keyword\">for</span> each occurrence of <span class=\"token variable\">$$</span><span class=\"token operator\">&lt;</span>n<span class=\"token operator\">></span>\n\nimggp <span class=\"token operator\">&lt;</span>imagebase<span class=\"token operator\">></span>          - Displays GP directory entry <span class=\"token keyword\">for</span> <span class=\"token number\">64</span>-bit image\nimgreloc <span class=\"token operator\">&lt;</span>imagebase<span class=\"token operator\">></span>       - Relocates modules <span class=\"token keyword\">for</span> an image\n\nstr <span class=\"token operator\">&lt;</span>address<span class=\"token operator\">></span>              - Displays ANSI_STRING or OEM_STRING\nustr <span class=\"token operator\">&lt;</span>address<span class=\"token operator\">></span>             - Displays UNICODE_STRING\n\nlist <span class=\"token punctuation\">[</span>-? <span class=\"token operator\">|</span> parameters<span class=\"token punctuation\">]</span>     - Displays lists\n\ncppexr <span class=\"token operator\">&lt;</span>exraddress<span class=\"token operator\">></span>        - Displays a C++ EXCEPTION_RECORD\nobja <span class=\"token operator\">&lt;</span>address<span class=\"token operator\">></span>             - Displays OBJECT_ATTRIBUTES<span class=\"token punctuation\">[</span><span class=\"token number\">32</span><span class=\"token operator\">|</span><span class=\"token number\">64</span><span class=\"token punctuation\">]</span>\nrtlavl <span class=\"token operator\">&lt;</span>address<span class=\"token operator\">></span>           - Displays RTL_AVL_TABLE\nstd_map <span class=\"token operator\">&lt;</span>address<span class=\"token operator\">></span>          - Displays a std::map<span class=\"token operator\">&lt;></span></code></pre></div>\n<h3 id=\"analyze例外やバグチェックに関する情報の取得\" style=\"position:relative;\"><a href=\"#analyze%E4%BE%8B%E5%A4%96%E3%82%84%E3%83%90%E3%82%B0%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF%E3%81%AB%E9%96%A2%E3%81%99%E3%82%8B%E6%83%85%E5%A0%B1%E3%81%AE%E5%8F%96%E5%BE%97\" aria-label=\"analyze例外やバグチェックに関する情報の取得 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>!analyze：例外やバグチェックに関する情報の取得</h3>\n<p><code class=\"language-text\">!analyze</code>は ext 拡張に含まれるコマンドで、クラッシュダンプなどの解析で非常に有用です。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># 主要な解析の実行</span>\n<span class=\"token operator\">!</span>analyze -v\n\n<span class=\"token comment\"># グローバルフラグ</span>\nNTGLOBALFLAG\n\n<span class=\"token comment\"># プロセスやアプリケーション関連の情報が記録される</span>\nPROCESS_BAM_CURRENT_THROTTLED\nPROCESS_BAM_PREVIOUS_THROTTLED\nAPPLICATION_VERIFIER_FLAGS\n\n<span class=\"token comment\"># EXCEPTION_RECORD には例外発生、クラッシュしたプロセスの情報が記録される</span>\nEXCEPTION_RECORD:  <span class=\"token punctuation\">(</span>.exr -1<span class=\"token punctuation\">)</span>\nExceptionAddress: 00007ffce5c60910 <span class=\"token punctuation\">(</span>ntdll<span class=\"token operator\">!</span>LdrpDoDebuggerBreak+0x0000000000000030<span class=\"token punctuation\">)</span>\n\tExceptionCode: <span class=\"token number\">80000003</span> <span class=\"token punctuation\">(</span>Break instruction exception<span class=\"token punctuation\">)</span>\n\tExceptionFlags: 00000000\n\n<span class=\"token comment\"># 例外発生時のスタックコールバックがきろくされる</span>\n<span class=\"token comment\"># ~0s ; .cxr ; kb のコマンドでも同等の内容を出力できる</span>\nSTACK_TEXT\n\n<span class=\"token comment\"># 問題のカテゴリを表示する</span>\nFAILURE_BUCKET_ID</code></pre></div>\n<p>参考：<a href=\"https://degiuli.github.io/WinDBG/WinDBG.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">WinDBG !analyze extension command</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/-analyze\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">analyze (WinDbg) - Windows drivers | Microsoft Learn</a></p>\n<h3 id=\"addressメモリやプロセスに関する情報の参照\" style=\"position:relative;\"><a href=\"#address%E3%83%A1%E3%83%A2%E3%83%AA%E3%82%84%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E3%81%AB%E9%96%A2%E3%81%99%E3%82%8B%E6%83%85%E5%A0%B1%E3%81%AE%E5%8F%82%E7%85%A7\" aria-label=\"addressメモリやプロセスに関する情報の参照 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>!address：メモリやプロセスに関する情報の参照</h3>\n<p><code class=\"language-text\">!address</code>も ext 拡張に含まれるコマンドで、指定したアドレスのメモリ領域やプロセスに関する情報を表示します。</p>\n<p>例えば、<code class=\"language-text\">malloc</code>関数の戻り値のアドレスに対して<code class=\"language-text\">!address</code>コマンドを発行するなどによって、対象のメモリ領域に関する情報を取得することができます。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># 各メモリブロックの情報を出力する </span>\n<span class=\"token operator\">!</span>address\n\n<span class=\"token comment\"># 指定のアドレスに関する情報を出力する</span>\n<span class=\"token operator\">!</span>address <span class=\"token operator\">&lt;</span>Address<span class=\"token operator\">></span>\n\n<span class=\"token comment\"># ユーザモードデバッグでメモリに関する統計情報を出力する</span>\n<span class=\"token operator\">!</span>address -summary </code></pre></div>\n<p>以下の Docs のパラメータ表の通り、対象のメモリ領域の用途やステータス、保護の状態など様々な情報を取得することができます。</p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/-address\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">address (WinDbg) - Windows drivers | Microsoft Learn</a></p>\n<h3 id=\"handleシステムまたはプロセスのハンドル情報の参照\" style=\"position:relative;\"><a href=\"#handle%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%E3%81%BE%E3%81%9F%E3%81%AF%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E3%81%AE%E3%83%8F%E3%83%B3%E3%83%89%E3%83%AB%E6%83%85%E5%A0%B1%E3%81%AE%E5%8F%82%E7%85%A7\" aria-label=\"handleシステムまたはプロセスのハンドル情報の参照 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>!handle：システムまたはプロセスのハンドル情報の参照</h3>\n<p><code class=\"language-text\">!handle</code>も ext 拡張に含まれるコマンドで、システムやプロセスのハンドルに関する情報を取得できます。</p>\n<p>ユーザモードデバッグで使用した場合、そのプロセスのハンドル情報の一覧や統計情報を取得できる。</p>\n<p>オプションなしの<code class=\"language-text\">!handle</code>コマンドで取得できる情報は、Process Explorer のハンドルビューと非常に近しい情報を取得することができます。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># ハンドル情報の取得</span>\n<span class=\"token operator\">!</span>handle\n\n<span class=\"token comment\"># すべてのハンドルの詳細な情報をダンプ</span>\n<span class=\"token operator\">!</span>handle <span class=\"token number\">0</span> 0xf\n\n<span class=\"token comment\"># ハンドル ID が 430 のハンドルの詳細な情報を取得</span>\n<span class=\"token operator\">!</span>handle <span class=\"token number\">430</span> 0xf</code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/-handle\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">handle (WinDbg) - Windows drivers | Microsoft Learn</a></p>\n<h3 id=\"スレッド環境ブロックtebの情報取得\" style=\"position:relative;\"><a href=\"#%E3%82%B9%E3%83%AC%E3%83%83%E3%83%89%E7%92%B0%E5%A2%83%E3%83%96%E3%83%AD%E3%83%83%E3%82%AFteb%E3%81%AE%E6%83%85%E5%A0%B1%E5%8F%96%E5%BE%97\" aria-label=\"スレッド環境ブロックtebの情報取得 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>スレッド環境ブロック(TEB)の情報取得</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># TEB の情報をダンプ</span>\n<span class=\"token operator\">!</span>teb</code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/-teb\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">teb (WinDbg) - Windows drivers | Microsoft Learn</a></p>\n<h3 id=\"プロセス環境ブロックpebの情報取得\" style=\"position:relative;\"><a href=\"#%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E7%92%B0%E5%A2%83%E3%83%96%E3%83%AD%E3%83%83%E3%82%AFpeb%E3%81%AE%E6%83%85%E5%A0%B1%E5%8F%96%E5%BE%97\" aria-label=\"プロセス環境ブロックpebの情報取得 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>プロセス環境ブロック(PEB)の情報取得</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># PEB の情報をダンプ</span>\n<span class=\"token operator\">!</span>peb</code></pre></div>\n<h3 id=\"dumpext-拡張機能による-pe-ファイルの抽出\" style=\"position:relative;\"><a href=\"#dumpext-%E6%8B%A1%E5%BC%B5%E6%A9%9F%E8%83%BD%E3%81%AB%E3%82%88%E3%82%8B-pe-%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E6%8A%BD%E5%87%BA\" aria-label=\"dumpext 拡張機能による pe ファイルの抽出 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>!dumpext 拡張機能による PE ファイルの抽出</h3>\n<p>オープンソースの !dumpext 拡張機能を使用することで、PE ヘッダの情報を簡単にダンプしたり、ダンプファイル内から PE バイナリを抽出することができます。</p>\n<p>事前に、以下の Github リポジトリの手順で拡張機能をビルドしておきます。</p>\n<p>参考：<a href=\"https://github.com/pstolarz/dumpext\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">pstolarz/dumpext: WinDbg debugger extension library providing various tools to analyse, dump and fix (restore) Microsoft Portable Executable files for both 32 (PE) and 64-bit (PE+) platforms.</a></p>\n<p>あとは以下でダンプファイルから PE バイナリをエクスポートできます。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># ビルド済みバイナリを https://kashiwaba-yuki.com/file/dumpext.dll からダウンロードしておく。</span>\n.load C:<span class=\"token punctuation\">\\</span>Users<span class=\"token punctuation\">\\</span>User<span class=\"token punctuation\">\\</span>Downloads<span class=\"token punctuation\">\\</span>dumpext.dll\n\n<span class=\"token comment\"># プロセスダンプから PE バイナリを \"C:\\Program Files (x86)\\Windows Kits\\10\\Debuggers\\x64\" に dump.out としてエクスポートする</span>\n<span class=\"token operator\">!</span>dumpext.dump_pe <span class=\"token operator\">!</span><span class=\"token operator\">&lt;</span>module_name<span class=\"token operator\">></span></code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/-peb\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">peb (WinDbg) - Windows drivers | Microsoft Learn</a></p>\n<h2 id=\"config-コマンド\" style=\"position:relative;\"><a href=\"#config-%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89\" aria-label=\"config コマンド permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Config コマンド</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># シンボル設定の確認</span>\n.sympath\n\n<span class=\"token comment\"># シンボルキャッシュとソースの設定</span>\n.sympath cache*C:<span class=\"token punctuation\">\\</span>symbols<span class=\"token punctuation\">;</span>srv*https://msdl.microsoft.com/download/symbols\n.reload\n\n<span class=\"token comment\"># シンボル読み込み時の詳細を出力/抑制</span>\n<span class=\"token operator\">!</span>sym noisy\n<span class=\"token operator\">!</span>sym quiet\n\n<span class=\"token comment\"># 不一致シンボルの強制読み込み(非推奨)</span>\n.reload /f /i <span class=\"token operator\">&lt;</span>modulename<span class=\"token operator\">></span>\n\n<span class=\"token comment\"># ロードされている拡張機能のリストを出力</span>\n.chain\n\n<span class=\"token comment\"># 追加の拡張機能のロード</span>\n.load <span class=\"token operator\">&lt;</span>拡張機能 DLL のパス<span class=\"token operator\">></span>\n\n<span class=\"token comment\"># 拡張機能の詳細を表示</span>\n.extmatch /D /e <span class=\"token operator\">&lt;</span>モジュール<span class=\"token operator\">></span> *\n\n<span class=\"token comment\"># ヘルプウィンドウの起動</span>\n.hh\n\n<span class=\"token comment\"># ダンプファイルとして保存</span>\n<span class=\"token comment\"># https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/-dump--create-dump-file-</span>\n.dump <span class=\"token punctuation\">[</span>options<span class=\"token punctuation\">]</span> FileName</code></pre></div>\n<h2 id=\"その他のコマンド\" style=\"position:relative;\"><a href=\"#%E3%81%9D%E3%81%AE%E4%BB%96%E3%81%AE%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89\" aria-label=\"その他のコマンド permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>その他のコマンド</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># ?&lt;Hex> で 10 進数変換が可能</span>\n?ff\n<span class=\"token operator\">></span> Evaluate expression: <span class=\"token number\">255</span> <span class=\"token operator\">=</span> 000000ff\n\n<span class=\"token comment\"># 以下のように演算結果を評価することも可能</span>\n?ffff-f\n<span class=\"token operator\">></span> Evaluate expression: <span class=\"token number\">65520</span> <span class=\"token operator\">=</span> 0000fff0\n\n<span class=\"token comment\"># ユーザモードデバッグで現在のプロセスのステータスを表示する</span>\n<span class=\"token operator\">|</span>\n\n<span class=\"token comment\"># デバッグ中のシステムを表示する</span>\n<span class=\"token operator\">||</span></code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/commands\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Commands - Windows drivers | Microsoft Learn</a></p>\n<h2 id=\"スクリプトファイルの使用\" style=\"position:relative;\"><a href=\"#%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E4%BD%BF%E7%94%A8\" aria-label=\"スクリプトファイルの使用 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>スクリプトファイルの使用</h2>\n<p>WinDgb コマンドを記載したテキストファイルを使用することで、WinDgb のコマンド実行をある程度自動化することができます。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># ファイルで定義したスクリプトを実行</span>\n$<span class=\"token operator\">&lt;</span>C:<span class=\"token punctuation\">\\</span>windbgcmd.txt\n\n<span class=\"token comment\"># 単一のコマンドブロックとして実行(ブレークポイントを使うならこちらの方がよい)</span>\n$<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>C:<span class=\"token punctuation\">\\</span>windbgcmd.txt\n\n<span class=\"token comment\"># コマンド引数を設定(標準入力ではない)</span>\n<span class=\"token comment\"># .echo argument is ${$arg1} などのコマンドを使う場合に使用可能</span>\n<span class=\"token variable\">$$</span><span class=\"token operator\">></span>a<span class=\"token operator\">&lt;</span>C:<span class=\"token punctuation\">\\</span>windbgcmd.txt test_text\n\n<span class=\"token comment\"># eax レジスタに 1234 が含まれるまで実行を続けるスクリプト eaxstep を再帰的に呼び出す</span>\n<span class=\"token comment\"># .if (@eax == 1234) { .echo 1234 } .else { t \"$&lt;eaxstep\" }</span>\nt <span class=\"token string\">\"$&lt;C:<span class=\"token entity\" title=\"\\\\\">\\\\</span>eaxstep\"</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 869px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ccac49f8fefcf145e70c1bca37f258ae/2b2c6/image-20230407210644712.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.49999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABC0lEQVQoz2WQWW6EMBBEuQJi3xezDpqFJROJL8T971RxeWICykfL6rb7VZWNLMvgeZ6qpm7wer0wzzPatoWoBPq+x+P5xLqu6LoO98cDw3BD0zTgbi13bsOAZZnlfQsjCAIFcxwHbdfj/f3GNE2Io1gu37HvO8ZxxLZtSmRZvhSYe6wwDBHHMfI8V6dBmO/7qpIkgW3bsCwLruuqB2VZqplpmkqYM52IRRChNMT+APKsqgpRFP0KeFIghZDAs6AQ4ug9z5eR60OEswuQbtI0PdT5R9mppxiBjKqBQpq4AGlXP+BjQrQDxsmy9OKwLD6O9U5Vf4B6ZuiIVCiK4p/Dc08gRf7+PVCpNJz1A5dGvJ61TLF6AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ccac49f8fefcf145e70c1bca37f258ae/8ac56/image-20230407210644712.webp 240w,\n/static/ccac49f8fefcf145e70c1bca37f258ae/d3be9/image-20230407210644712.webp 480w,\n/static/ccac49f8fefcf145e70c1bca37f258ae/c3694/image-20230407210644712.webp 869w\"\n              sizes=\"(max-width: 869px) 100vw, 869px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ccac49f8fefcf145e70c1bca37f258ae/8ff5a/image-20230407210644712.png 240w,\n/static/ccac49f8fefcf145e70c1bca37f258ae/e85cb/image-20230407210644712.png 480w,\n/static/ccac49f8fefcf145e70c1bca37f258ae/2b2c6/image-20230407210644712.png 869w\"\n            sizes=\"(max-width: 869px) 100vw, 869px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ccac49f8fefcf145e70c1bca37f258ae/2b2c6/image-20230407210644712.png\"\n            alt=\"image-20230407210644712\"\n            title=\"image-20230407210644712\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/-----------------------a---run-script-file-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">,</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3em;vertical-align:-0.1944em;\"></span><span class=\"mpunct\">,</span></span></span></span> , <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">,</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3em;vertical-align:-0.1944em;\"></span><span class=\"mpunct\">,</span></span></span></span> , $$ a (Run Script File) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/executing-until-a-specified-state-is-reached\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Executing Until a Specified State is Reached - Windows drivers | Microsoft Learn</a></p>\n<h3 id=\"条件分岐\" style=\"position:relative;\"><a href=\"#%E6%9D%A1%E4%BB%B6%E5%88%86%E5%B2%90\" aria-label=\"条件分岐 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>条件分岐</h3>\n<p>WinDbg コマンドもしくはスクリプトの内部では以下のような条件式を扱うことができます。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># IF トークンの使用</span>\n.if <span class=\"token punctuation\">(</span>Condition<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> Commands <span class=\"token punctuation\">}</span> \n.if <span class=\"token punctuation\">(</span>Condition<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> Commands <span class=\"token punctuation\">}</span> .else <span class=\"token punctuation\">{</span> Commands <span class=\"token punctuation\">}</span> \n.if <span class=\"token punctuation\">(</span>Condition<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> Commands <span class=\"token punctuation\">}</span> .elsif <span class=\"token punctuation\">(</span>Condition<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> Commands <span class=\"token punctuation\">}</span> \n.if <span class=\"token punctuation\">(</span>Condition<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> Commands <span class=\"token punctuation\">}</span> .elsif <span class=\"token punctuation\">(</span>Condition<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> Commands <span class=\"token punctuation\">}</span> .else <span class=\"token punctuation\">{</span> Commands <span class=\"token punctuation\">}</span></code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/-if\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">.if (WinDbg) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/control-flow-tokens\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Control Flow Tokens - Windows drivers | Microsoft Learn</a></p>\n<p>この時、Condition には様々な上限を含めることができます。</p>\n<p>WinDbg の場合、MASM 演算子と C++ の演算子がサポートされています。</p>\n<p>特に MASM 演算子の<code class=\"language-text\">poi</code>によるアドレス解決や Non-Numeric な演算子である<code class=\"language-text\">$scmp(\"String1\", \"String2\")</code>による文字列比較などは頻繁に使用します。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># $scmp は C++ の strcmp と同等の評価を行うため、文字列が一致した場合は 0 を返す</span>\n.if <span class=\"token punctuation\">(</span><span class=\"token variable\">$scmp</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"<span class=\"token variable\">${$ImageName}</span>\"</span>,<span class=\"token string\">\"notepad.exe\"</span><span class=\"token punctuation\">))</span> <span class=\"token punctuation\">{</span>  <span class=\"token punctuation\">}</span> .else <span class=\"token punctuation\">{</span> .echo match <span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\"># 疑似レジスタ $t1 のアドレスが指す値を $t1 に再代入する</span>\nr <span class=\"token variable\">$t1</span> <span class=\"token operator\">=</span> poi<span class=\"token punctuation\">(</span>@<span class=\"token variable\">$t1</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/masm-numbers-and-operators\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">MASM Numbers and Operators - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/c---numbers-and-operators\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">C++ numbers and operators - Windows drivers | Microsoft Learn</a></p>\n<p>その他、条件式に使える演算子は以下から探すことができます。</p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/numerical-expression-syntax\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Numerical Expression Syntax - Windows drivers | Microsoft Learn</a></p>\n<h3 id=\"ループコマンド\" style=\"position:relative;\"><a href=\"#%E3%83%AB%E3%83%BC%E3%83%97%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89\" aria-label=\"ループコマンド permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ループコマンド</h3>\n<p>WinDbg の<code class=\"language-text\">.for</code>コマンドは C 言語の for とほぼ同等の動作になります。</p>\n<p>また、<code class=\"language-text\">.foreach</code>コマンドは WinDbg のコマンド出力やファイル内の情報を要素ごとに分割して 1 つずつ指定のコマンドに与えることができます。</p>\n<p><code class=\"language-text\">.foreach</code>コマンドで与えられる要素は、処理中の<code class=\"language-text\">place</code>を置き換えます。</p>\n<p>また、<code class=\"language-text\">.while</code>と<code class=\"language-text\">.do</code>もループコマンドとして使用できます。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># WinDbg の for 構文(カンマではなくセミコロンで分割)</span>\n.for <span class=\"token punctuation\">(</span>InitialCommand <span class=\"token punctuation\">;</span> Condition <span class=\"token punctuation\">;</span> IncrementCommands<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> Commands <span class=\"token punctuation\">}</span> \n\n<span class=\"token comment\"># foreach 構文</span>\n.foreach <span class=\"token punctuation\">[</span>Options<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">(</span> Variable  <span class=\"token punctuation\">{</span> InCommands <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> OutCommands <span class=\"token punctuation\">}</span> \n.foreach <span class=\"token punctuation\">[</span>Options<span class=\"token punctuation\">]</span> /s <span class=\"token punctuation\">(</span> Variable  <span class=\"token string\">\"InString\"</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> OutCommands <span class=\"token punctuation\">}</span> \n.foreach <span class=\"token punctuation\">[</span>Options<span class=\"token punctuation\">]</span> /f <span class=\"token punctuation\">(</span> Variable  <span class=\"token string\">\"InFile\"</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> OutCommands <span class=\"token punctuation\">}</span> \n\n<span class=\"token comment\"># 処理をループさせて実行させたい場合</span>\n.while <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> Commands <span class=\"token punctuation\">}</span></code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/-for\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">.for (WinDbg) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/-foreach\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">.foreach (WinDbg) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/-while\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">.while (WinDbg) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/-do\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">.do (WinDbg) - Windows drivers | Microsoft Learn</a></p>\n<p><code class=\"language-text\">.for</code>コマンドは以下のような構文で使用できます。</p>\n<p><code class=\"language-text\">.continue</code>と<code class=\"language-text\">.break</code>によるループ操作は、C 言語と同じように動作します。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># 疑似レジスタを使用して for ループを実行</span>\n.for <span class=\"token punctuation\">(</span>r <span class=\"token variable\">$t1</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$t1</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">7</span><span class=\"token punctuation\">;</span> r <span class=\"token variable\">$t1</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$t1</span> + <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> r <span class=\"token variable\">$t1</span> <span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\"># continue で次のループにジャンプする</span>\n.for <span class=\"token punctuation\">(</span>r <span class=\"token variable\">$t1</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$t1</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">7</span><span class=\"token punctuation\">;</span> r <span class=\"token variable\">$t1</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$t1</span> + <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> .if <span class=\"token punctuation\">(</span> <span class=\"token variable\">$t1</span> <span class=\"token operator\">==</span> <span class=\"token number\">3</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> .echo skip <span class=\"token punctuation\">;</span> .continue <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">;</span> r <span class=\"token variable\">$t1</span> <span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\"># break でループを停止する</span>\n.for <span class=\"token punctuation\">(</span>r <span class=\"token variable\">$t1</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$t1</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">7</span><span class=\"token punctuation\">;</span> r <span class=\"token variable\">$t1</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$t1</span> + <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> .if <span class=\"token punctuation\">(</span> <span class=\"token variable\">$t1</span> <span class=\"token operator\">==</span> <span class=\"token number\">3</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> .echo stop <span class=\"token punctuation\">;</span> .break <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">;</span> r <span class=\"token variable\">$t1</span> <span class=\"token punctuation\">}</span></code></pre></div>\n<p>以下は、関数内の call 時の引数をすべてファイルにダンプすることができるサンプルです。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">.logopen /t C:<span class=\"token punctuation\">\\</span>Users<span class=\"token punctuation\">\\</span>Public<span class=\"token punctuation\">\\</span>windbg.log\n.while <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> pc<span class=\"token punctuation\">;</span>.echo rcd<span class=\"token punctuation\">;</span><span class=\"token function\">dc</span> @rcx L10<span class=\"token punctuation\">;</span>.echo rdx<span class=\"token punctuation\">;</span> <span class=\"token function\">dc</span> @rdx L10<span class=\"token punctuation\">;</span>.echo r8<span class=\"token punctuation\">;</span> <span class=\"token function\">dc</span> @r8 L10<span class=\"token punctuation\">;</span>.echo r9<span class=\"token punctuation\">;</span> <span class=\"token function\">dc</span> @r9 L10<span class=\"token punctuation\">;</span>.echo stack<span class=\"token punctuation\">;</span> <span class=\"token function\">dc</span> @rsp L10<span class=\"token punctuation\">;</span>.echo rip<span class=\"token punctuation\">;</span> u rip L1 <span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"ブロックを作成する\" style=\"position:relative;\"><a href=\"#%E3%83%96%E3%83%AD%E3%83%83%E3%82%AF%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B\" aria-label=\"ブロックを作成する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ブロックを作成する</h3>\n<p><code class=\"language-text\">.block</code>コマンドは、コード内に新しいブロックを追加します。</p>\n<p>これは、後述する Alias を変数のように使用する場合などに頻繁に使用します。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">Commands <span class=\"token punctuation\">;</span> .block <span class=\"token punctuation\">{</span> Commands <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">;</span> Commands </code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/-block\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">.block (WinDbg) - Windows drivers | Microsoft Learn</a></p>\n<h3 id=\"エイリアスを作成削除する\" style=\"position:relative;\"><a href=\"#%E3%82%A8%E3%82%A4%E3%83%AA%E3%82%A2%E3%82%B9%E3%82%92%E4%BD%9C%E6%88%90%E5%89%8A%E9%99%A4%E3%81%99%E3%82%8B\" aria-label=\"エイリアスを作成削除する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>エイリアスを作成、削除する</h3>\n<p><code class=\"language-text\">as</code>と<code class=\"language-text\">aS</code>コマンドは、Alias の定義を行います。</p>\n<p>WinDbg では、疑似レジスタと同様に、Alias を変数のように使用できます。</p>\n<p>ただし、定義した Alias は現在のブロックでは機能しないため、Alias を定義した後に<code class=\"language-text\">.block</code>コマンドで新しいブロックを作成する必要があります。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># 文字列や数値を定義する</span>\nas Name <span class=\"token number\">10</span>\naS Name <span class=\"token string\">\"Test Value\"</span> <span class=\"token punctuation\">;</span> .block <span class=\"token punctuation\">{</span> .echo Name <span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\"># Address からヌル終端までの ASCII 文字列を定義</span>\nas /ma Name Address \n\n<span class=\"token comment\"># Address からヌル終端までの Unicode 文字列を定義</span>\nas /mu Name Address \n\n<span class=\"token comment\"># Address から 64bit の値を定義</span>\nas /x Name Expression \n\n<span class=\"token comment\"># ファイル の内容と同等の値を定義</span>\naS /f Name File \n\n<span class=\"token comment\"># コマンド出力の値を定義</span>\nas /c Name CommandString </code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/as--as--set-alias-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">as, aS (Set Alias) - Windows drivers | Microsoft Learn</a></p>\n<h3 id=\"疑似レジスタを使用する\" style=\"position:relative;\"><a href=\"#%E7%96%91%E4%BC%BC%E3%83%AC%E3%82%B8%E3%82%B9%E3%82%BF%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B\" aria-label=\"疑似レジスタを使用する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>疑似レジスタを使用する</h3>\n<p>WinDbg では値を保持するための疑似レジスタをサポートしており、既定の疑似レジスタを通して値を参照したり、任意の疑似レジスタを登録することができます。</p>\n<p>疑似レジスタは、<code class=\"language-text\">$</code>マークを先頭に持ちます。MASM 構文を使用する場合は<code class=\"language-text\">@</code>を付与することができます。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># 疑似レジスタの値を出力</span>\n? <span class=\"token variable\">$ip</span>\n? @<span class=\"token variable\">$ip</span>\nr <span class=\"token variable\">$ip</span>\nr @<span class=\"token variable\">$ip</span>\n\n<span class=\"token comment\"># 任意の疑似レジスタを定義する</span>\nr <span class=\"token variable\">$t0</span> <span class=\"token operator\">=</span> <span class=\"token number\">7</span>\n\n<span class=\"token comment\"># 疑似レジスタを使用して、任意のアドレスのポインタを poi で参照する</span>\nr <span class=\"token variable\">$t0</span> <span class=\"token operator\">=</span> nt<span class=\"token operator\">!</span>PsActiveProcessHead<span class=\"token punctuation\">;</span>r <span class=\"token variable\">$t1</span> <span class=\"token operator\">=</span> poi<span class=\"token punctuation\">(</span>@<span class=\"token variable\">$t0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>r <span class=\"token variable\">$t1</span>\n\n<span class=\"token comment\"># 疑似レジスタで演算を行う</span>\n?? @<span class=\"token variable\">$t0</span>+10\n\n<span class=\"token comment\"># r コマンドで型を指定して疑似レジスタを定義する</span>\nr? <span class=\"token variable\">$t15</span> <span class=\"token operator\">=</span> * <span class=\"token punctuation\">(</span>UNICODE_STRING*<span class=\"token punctuation\">)</span> 0x12ffbc\n\n<span class=\"token comment\"># 現在のスレッドが ntopenfile を呼び出した場合のみ処理を停止する</span>\nbp /t @<span class=\"token variable\">$thread</span> nt<span class=\"token operator\">!</span>ntopenfile</code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/pseudo-register-syntax\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Pseudo-Register Syntax - Windows drivers | Microsoft Learn</a></p>\n<p>既定で設定されている疑似レジスタは <a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/pseudo-register-syntax#automatic-pseudo-registers\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">疑似レジスタ</a> にまとめられていますが、いくつかの疑似レジスタを以下に記載します。</p>\n<ul>\n<li>$ea：最後の命令の実効アドレス</li>\n<li>$ip：命令ポインタレジスタ</li>\n<li>$scopeip：現在のローカル コンテキストの命令ポインター</li>\n<li>$exentry：現在のプロセスの実行可能ファイルのエントリ ポイントのアドレス</li>\n<li>$thread：現在のスレッドのアドレス(カーネルデバッグの場合は ETHREAD ブロック、ユーザモードの場合は TEB のアドレス)</li>\n<li>$peb：現在のプロセスの PEB のアドレス</li>\n<li>$teb：現在のプロセスの TEB のアドレス</li>\n<li>$tpid: 現在のプロセスの PID を取得する</li>\n</ul>\n<h3 id=\"スクリプトサンプル\" style=\"position:relative;\"><a href=\"#%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB\" aria-label=\"スクリプトサンプル permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>スクリプトサンプル</h3>\n<ul>\n<li>カーネルデバッグ中にプロセスを列挙し、<code class=\"language-text\">notepad.exe</code>のアドレスを取得するスクリプト。</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token variable\">$$</span>  Get process list LIST_ENTRY <span class=\"token keyword\">in</span> <span class=\"token variable\">$t0</span><span class=\"token builtin class-name\">.</span>\nr <span class=\"token variable\">$t0</span> <span class=\"token operator\">=</span> nt<span class=\"token operator\">!</span>PsActiveProcessHead\n\n<span class=\"token variable\">$$</span>  Iterate over all processes <span class=\"token keyword\">in</span> list.\n.for <span class=\"token punctuation\">(</span>r <span class=\"token variable\">$t1</span> <span class=\"token operator\">=</span> poi<span class=\"token punctuation\">(</span>@<span class=\"token variable\">$t0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">(</span>@<span class=\"token variable\">$t1</span> <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token punctuation\">(</span>@<span class=\"token variable\">$t1</span> <span class=\"token operator\">!=</span> @<span class=\"token variable\">$t0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      r <span class=\"token variable\">$t1</span> <span class=\"token operator\">=</span> poi<span class=\"token punctuation\">(</span>@<span class=\"token variable\">$t1</span><span class=\"token punctuation\">))</span>\n<span class=\"token punctuation\">{</span>\n    r? <span class=\"token variable\">$t2</span> <span class=\"token operator\">=</span> <span class=\"token comment\">#CONTAINING_RECORD(@$t1, nt!_EPROCESS, ActiveProcessLinks);</span>\n    as /x Procc @<span class=\"token variable\">$t2</span>\n\n    <span class=\"token variable\">$$</span>  Get image name into <span class=\"token variable\">$ImageName</span><span class=\"token builtin class-name\">.</span>\n    as /ma <span class=\"token variable\">$ImageName</span> @@c++<span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>@<span class=\"token variable\">$t2</span>-<span class=\"token operator\">></span>ImageFileName<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n    .block\n    <span class=\"token punctuation\">{</span>\n\t.if <span class=\"token punctuation\">(</span><span class=\"token variable\">$scmp</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"notepad.exe\"</span>,<span class=\"token string\">\"<span class=\"token variable\">${$ImageName}</span>\"</span><span class=\"token punctuation\">))</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">}</span> .else <span class=\"token punctuation\">{</span>.echo <span class=\"token variable\">${$ImageName}</span> at <span class=\"token variable\">${Procc}</span><span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    ad <span class=\"token variable\">$ImageName</span>\n    ad Procc\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"ユーザモードプロセスの解析\" style=\"position:relative;\"><a href=\"#%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%A2%E3%83%BC%E3%83%89%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E3%81%AE%E8%A7%A3%E6%9E%90\" aria-label=\"ユーザモードプロセスの解析 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ユーザモードプロセスの解析</h2>\n<h3 id=\"ユーザモードスレッド\" style=\"position:relative;\"><a href=\"#%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%A2%E3%83%BC%E3%83%89%E3%82%B9%E3%83%AC%E3%83%83%E3%83%89\" aria-label=\"ユーザモードスレッド permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ユーザモードスレッド</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># ユーザモードデバッグもしくはプロセスダンプの解析にて、すべてのスレッドのコールスタックをダンプ</span>\n~*k\n\n<span class=\"token comment\"># TEB の情報をダンプ</span>\n<span class=\"token operator\">!</span>teb\n\n<span class=\"token comment\"># ！teb で特定した TEB のアドレスを使用して構造体を出力</span>\ndt ntdll<span class=\"token operator\">!</span>_TEB <span class=\"token operator\">&lt;</span>TEB のアドレス<span class=\"token operator\">></span></code></pre></div>\n<h3 id=\"ユーザモードプロセス\" style=\"position:relative;\"><a href=\"#%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%A2%E3%83%BC%E3%83%89%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9\" aria-label=\"ユーザモードプロセス permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ユーザモードプロセス</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># PEB の情報をダンプ</span>\n<span class=\"token operator\">!</span>peb\n\n<span class=\"token comment\"># ！peb で特定した PEB のアドレスを使用して構造体を出力</span>\ndt ntdll<span class=\"token operator\">!</span>_PEB <span class=\"token operator\">&lt;</span>PEB のアドレス<span class=\"token operator\">></span></code></pre></div>\n<h3 id=\"スタックバックトレースとフレームの表示\" style=\"position:relative;\"><a href=\"#%E3%82%B9%E3%82%BF%E3%83%83%E3%82%AF%E3%83%90%E3%83%83%E3%82%AF%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%81%A8%E3%83%95%E3%83%AC%E3%83%BC%E3%83%A0%E3%81%AE%E8%A1%A8%E7%A4%BA\" aria-label=\"スタックバックトレースとフレームの表示 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>スタックバックトレースとフレームの表示</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># スタックバックトレースの表示(先頭の数字はフレーム番号)</span>\n<span class=\"token comment\"># フレーム番号(n)、フレームポインタ(v)、フレームが使用しているメモリサイズ(f)を含めて表示させる</span>\nkvnf\n\n<span class=\"token comment\"># すべてのスレッドのスタックバックトレースの表示</span>\n~*kvnf\n\n<span class=\"token comment\"># 特定のスレッドのスタックバックトレースのみ表示</span>\n~1kvnf\n\n<span class=\"token comment\"># 現在のプロセスのすべてのスレッドのコールスタックを表示</span>\n<span class=\"token operator\">!</span>uniqstack</code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/k--kb--kc--kd--kp--kp--kv--display-stack-backtrace-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">k, kb, kc, kd, kp, kP, kv (Display Stack Backtrace) - Windows drivers | Microsoft Learn</a></p>\n<p><code class=\"language-text\">kvn</code>コマンドなどを実行してスタックトレースの<code class=\"language-text\">ChildEBP</code>(保存された EBP)や<code class=\"language-text\">RetAddr</code>、<code class=\"language-text\">Args to Child</code>を取得できますが、これは基本的にスタック内の情報を参照しています。</p>\n<p>そのため、64bit バイナリの呼び出し規約では有効な値を含まないため注意が必要です。</p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/cpp/build/x64-calling-convention?view=msvc-170\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">x64 calling convention | Microsoft Learn</a></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># フレーム番号を指定してローカル変数を表示</span>\n<span class=\"token comment\"># /t は変数の型、/V はローカル変数の相対アドレスを含めて表示するオプション</span>\n.frame 01<span class=\"token punctuation\">;</span>dv\n.frame 01<span class=\"token punctuation\">;</span>dv /t /V</code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/dv--display-local-variables-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">dv (Display Local Variables) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/-frame--set-local-context-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">.frame (Set Local Context) - Windows drivers | Microsoft Learn</a></p>\n<h2 id=\"カーネルモードダンプの解析\" style=\"position:relative;\"><a href=\"#%E3%82%AB%E3%83%BC%E3%83%8D%E3%83%AB%E3%83%A2%E3%83%BC%E3%83%89%E3%83%80%E3%83%B3%E3%83%97%E3%81%AE%E8%A7%A3%E6%9E%90\" aria-label=\"カーネルモードダンプの解析 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>カーネルモードダンプの解析</h2>\n<h3 id=\"フルメモリダンプの取得設定\" style=\"position:relative;\"><a href=\"#%E3%83%95%E3%83%AB%E3%83%A1%E3%83%A2%E3%83%AA%E3%83%80%E3%83%B3%E3%83%97%E3%81%AE%E5%8F%96%E5%BE%97%E8%A8%AD%E5%AE%9A\" aria-label=\"フルメモリダンプの取得設定 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>フルメモリダンプの取得設定</h3>\n<p>以下の記事にまとめています。</p>\n<p>参考：<a href=\"/windows-windbg-005-kernel-dump\">Windows環境でカーネルメモリダンプを手動で取得し、WinDbgで解析する方法</a></p>\n<h3 id=\"カーネル構造体の情報を列挙する\" style=\"position:relative;\"><a href=\"#%E3%82%AB%E3%83%BC%E3%83%8D%E3%83%AB%E6%A7%8B%E9%80%A0%E4%BD%93%E3%81%AE%E6%83%85%E5%A0%B1%E3%82%92%E5%88%97%E6%8C%99%E3%81%99%E3%82%8B\" aria-label=\"カーネル構造体の情報を列挙する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>カーネル構造体の情報を列挙する</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># NT カーネル構造体の情報を列挙する</span>\ndt nt<span class=\"token operator\">!</span>_*\ndt nt<span class=\"token operator\">!</span>_*interrupt*\n\n<span class=\"token comment\"># カーネル構造体の情報をダンプする</span>\ndt nt<span class=\"token operator\">!</span>_KINTERRUPT</code></pre></div>\n<h3 id=\"プロセス情報を列挙する\" style=\"position:relative;\"><a href=\"#%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E6%83%85%E5%A0%B1%E3%82%92%E5%88%97%E6%8C%99%E3%81%99%E3%82%8B\" aria-label=\"プロセス情報を列挙する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>プロセス情報を列挙する</h3>\n<p>カーネルデバッグやフルダンプの解析を行う場合、以下のコマンドでプロセスの情報をダンプできます。</p>\n<p><code class=\"language-text\">.process</code>は、デバッガのコンテキストを変更できるコマンドで、非常に有用です。</p>\n<p>カーネルデバッグは通常、ほとんどのユーザモードアドレス空間の情報は表示されませんが、<code class=\"language-text\">.process</code>で特定のユーザモードプロセスの紺的とに変更することで、カーネルデバッグ中に特定のユーザモードプロセスを解析することができるようになります。</p>\n<p>※ コンテキストを変更した後、元のようにカーネル情報を表示する状態に戻す方法はわからないので、都度カーネルデバッガを再接続させています。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># システム内のすべてのプロセスを列挙</span>\n<span class=\"token operator\">!</span>process <span class=\"token number\">0</span> <span class=\"token number\">0</span>\n\n<span class=\"token comment\"># 特定のプロセスの完全な詳細情報を取得</span>\n<span class=\"token operator\">!</span>process <span class=\"token number\">0</span> <span class=\"token number\">7</span> notepad.exe\n\n<span class=\"token comment\"># 指定のプロセスの EPROCESS 構造体の情報を取得する</span>\ndt nt_EPROCESS <span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span>process で特定した EPROCESS ブロックのアドレス<span class=\"token operator\">></span>\n\n<span class=\"token comment\"># デバッガのコンテキストを指定のプロセスに変更する(！peb などが使えるようになる)</span>\n.process /r /P <span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span>process で特定した EPROCESS ブロックのアドレス<span class=\"token operator\">></span>\n\n<span class=\"token comment\"># すべてのプロセスを探索する(すべてのプロセスに対してコマンドを発行することも可能)</span>\n<span class=\"token operator\">!</span>for_each_process</code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/-process\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">!process (WinDbg) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/-process--set-process-context-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">.process (Set Process Context) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/-for-each-process\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">for<em>each</em>process - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/changing-contexts\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Changing Contexts - Windows drivers | Microsoft Learn</a></p>\n<p><code class=\"language-text\">nt!_EPROCESS</code>からプロセス情報を直接列挙することもできます。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># System プロセスの ActiveProcessLinks へのポインタアドレスを取得</span>\nr <span class=\"token variable\">$t0</span> <span class=\"token operator\">=</span> nt<span class=\"token operator\">!</span>PsActiveProcessHead<span class=\"token punctuation\">;</span>r <span class=\"token variable\">$t1</span> <span class=\"token operator\">=</span> poi<span class=\"token punctuation\">(</span>@<span class=\"token variable\">$t0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>r <span class=\"token variable\">$t1</span>\n\n<span class=\"token comment\"># ActiveProcessLinks.Flink のオフセットを参照</span>\ndt nt<span class=\"token operator\">!</span>_EPROCESS ActiveProcessLinks\n<span class=\"token operator\">></span> +0x448 ActiveProcessLinks \n\n<span class=\"token comment\"># _EPROCESS をダンプ(.process 0 0 と同等の出力)</span>\ndt nt<span class=\"token operator\">!</span>_EPROCESS -l ActiveProcessLinks.Flink -y Ima -yoi Uni <span class=\"token variable\">$t1</span>-0x448</code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/ja-jp/windows-hardware/drivers/debugger/debugger-command-program-examples\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">デバッガー コマンド プログラムの例 - Windows drivers | Microsoft Learn</a></p>\n<h3 id=\"スレッド情報を列挙する\" style=\"position:relative;\"><a href=\"#%E3%82%B9%E3%83%AC%E3%83%83%E3%83%89%E6%83%85%E5%A0%B1%E3%82%92%E5%88%97%E6%8C%99%E3%81%99%E3%82%8B\" aria-label=\"スレッド情報を列挙する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>スレッド情報を列挙する</h3>\n<p>カーネルデバッグの場合でも、<code class=\"language-text\">!teb</code> コマンドによる TEB の参照はユーザモードと同様に使用できます。</p>\n<p>その際には、以下のように対象の TEB のアドレスを指定します。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># TEB の情報を参照する</span>\n<span class=\"token operator\">!</span>teb <span class=\"token operator\">&lt;</span>TEB のアドレス<span class=\"token operator\">></span></code></pre></div>\n<h3 id=\"プロセスのハンドル情報を列挙する\" style=\"position:relative;\"><a href=\"#%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E3%81%AE%E3%83%8F%E3%83%B3%E3%83%89%E3%83%AB%E6%83%85%E5%A0%B1%E3%82%92%E5%88%97%E6%8C%99%E3%81%99%E3%82%8B\" aria-label=\"プロセスのハンドル情報を列挙する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>プロセスのハンドル情報を列挙する</h3>\n<p><code class=\"language-text\">!handle</code>コマンドは、ユーザモードデバッグとカーネルデバッグで少々利用方法に差異が発生します。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">!</span>handle notepad.exe</code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/-handle\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">handle (WinDbg) - Windows drivers | Microsoft Learn</a></p>\n<h3 id=\"物理仮想メモリの情報を出力する\" style=\"position:relative;\"><a href=\"#%E7%89%A9%E7%90%86%E4%BB%AE%E6%83%B3%E3%83%A1%E3%83%A2%E3%83%AA%E3%81%AE%E6%83%85%E5%A0%B1%E3%82%92%E5%87%BA%E5%8A%9B%E3%81%99%E3%82%8B\" aria-label=\"物理仮想メモリの情報を出力する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>物理、仮想メモリの情報を出力する</h3>\n<p><code class=\"language-text\">!memusage</code> コマンドで物理メモリ、<code class=\"language-text\">！vm</code> コマンドで仮想メモリの使用統計情報を取得できます。</p>\n<p>特に <code class=\"language-text\">!memusage</code> の出力はかなり大きいので事前に出力ログを設定しておく方が良いと思います。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># 物理メモリの使用統計情報を出力</span>\n<span class=\"token operator\">!</span>memusage\n\n<span class=\"token comment\"># 仮想メモリの使用統計情報を出力</span>\n<span class=\"token operator\">!</span>vm</code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/-memusage\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">memusage (WinDbg) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/-vm\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">vm (WinDbg) - Windows drivers | Microsoft Learn</a></p>\n<p>また、<code class=\"language-text\">!address</code>コマンドはカーネルデバッグでも使用できます。</p>\n<p>ただし、カーネルデバッグ時は出力される情報が少し少なくなります。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># 特定のプロセスの使用するメモリ領域を特定する</span>\n<span class=\"token operator\">!</span>address <span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span>process で特定した EPROCESS ブロックのアドレス<span class=\"token operator\">></span></code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/ja-jp/windows-hardware/drivers/debugger/-address\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">address (WinDbg) - Windows drivers | Microsoft Learn</a></p>\n<h3 id=\"カーネルメモリダンプでコンテキストを合わせる\" style=\"position:relative;\"><a href=\"#%E3%82%AB%E3%83%BC%E3%83%8D%E3%83%AB%E3%83%A1%E3%83%A2%E3%83%AA%E3%83%80%E3%83%B3%E3%83%97%E3%81%A7%E3%82%B3%E3%83%B3%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%82%92%E5%90%88%E3%82%8F%E3%81%9B%E3%82%8B\" aria-label=\"カーネルメモリダンプでコンテキストを合わせる permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>カーネルメモリダンプでコンテキストを合わせる</h3>\n<p><code class=\"language-text\">!analyze -v</code> の出力結果からコンテキストレコードを特定したら、<code class=\"language-text\">.cxr</code> コマンドを使用します。</p>\n<p>以下のように使用することで、レジスタコンテキストをコンテキストレコードに合わせることがでいます。</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token punctuation\">.</span>cxr &lt;アドレス> <span class=\"token punctuation\">;</span> kb</code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/ja-jp/windows-hardware/drivers/debuggercmds/-cxr--display-context-record-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">.cxr (コンテキスト レコードの表示) - Windows drivers | Microsoft Learn</a></p>\n<h3 id=\"セッション-id-とプロセスの調査\" style=\"position:relative;\"><a href=\"#%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3-id-%E3%81%A8%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E3%81%AE%E8%AA%BF%E6%9F%BB\" aria-label=\"セッション id とプロセスの調査 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>セッション ID とプロセスの調査</h3>\n<p>セッション ID を調べることで、プロセスがどのセッションのメンバーなのか調べることができます。</p>\n<p>また、<code class=\"language-text\">!sprocess</code> で取得した <em>MM</em>SESSION_SPACE のアドレスを使用して構造体情報をダンプすることもできます。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># アクティブなセッションの一覧を取得</span>\n<span class=\"token operator\">!</span>session\n\n<span class=\"token comment\"># ID 1 のセッションを現在のアクティブなセッションに指定</span>\n<span class=\"token operator\">!</span>session -s <span class=\"token number\">1</span>\n\n<span class=\"token comment\"># 現在のセッション内のプロセスを列挙</span>\n<span class=\"token operator\">!</span>sprocess\n\n<span class=\"token comment\"># セッションの詳細情報を参照する</span>\ndt nt<span class=\"token operator\">!</span>_MM_SESSION_SPACE ffffd080ba83d000\n\n<span class=\"token comment\"># セッション領域のメモリ使用状況をそれぞれ出力することもできる</span>\n<span class=\"token operator\">!</span>vm <span class=\"token number\">4</span></code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/-session\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">session (WinDbg) - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/ja-jp/sysinternals/resources/windows-internals\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">インサイド Windows 第 7 版 上 P.389</a></p>\n<p>参考：<a href=\"https://www.nirsoft.net/kernel_struct/vista/MM_SESSION_SPACE.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">struct MM<em>SESSION</em>SPACE</a></p>\n<h3 id=\"kpcr-と-kprcb-を参照して-cpu-の統計情報を読む\" style=\"position:relative;\"><a href=\"#kpcr-%E3%81%A8-kprcb-%E3%82%92%E5%8F%82%E7%85%A7%E3%81%97%E3%81%A6-cpu-%E3%81%AE%E7%B5%B1%E8%A8%88%E6%83%85%E5%A0%B1%E3%82%92%E8%AA%AD%E3%82%80\" aria-label=\"kpcr と kprcb を参照して cpu の統計情報を読む permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>KPCR と KPRCB を参照して CPU の統計情報を読む</h3>\n<p>カーネルプロセッサ制御領域(KPCR)とカーネルプロセッサ制御ブロック(KPRCB)には、プロセッサ固有のデータや状態、統計に関する情報が記録されています。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># 指定のプロセッサの KPRCB の情報を出力</span>\n<span class=\"token operator\">!</span>prcb <span class=\"token operator\">&lt;</span>CPU 番号<span class=\"token operator\">></span>\n\n<span class=\"token comment\"># KPCR の情報をダンプ</span>\ndt nt<span class=\"token operator\">!</span>_KPCR @<span class=\"token variable\">$pcr</span></code></pre></div>\n<h2 id=\"ライブデバッグ\" style=\"position:relative;\"><a href=\"#%E3%83%A9%E3%82%A4%E3%83%96%E3%83%87%E3%83%90%E3%83%83%E3%82%B0\" aria-label=\"ライブデバッグ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ライブデバッグ</h2>\n<h3 id=\"カーネルデバッガの接続hyper-vvirtualbox\" style=\"position:relative;\"><a href=\"#%E3%82%AB%E3%83%BC%E3%83%8D%E3%83%AB%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%81%AE%E6%8E%A5%E7%B6%9Ahyper-vvirtualbox\" aria-label=\"カーネルデバッガの接続hyper vvirtualbox permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>カーネルデバッガの接続(Hyper-V、VirtualBox)</h3>\n<p>以下の記事にまとめています。</p>\n<p>参考：<a href=\"/windows-windbg-004-kernel-debug\">WinDbgでWindows10環境のカーネルデバッグを行う最初の一歩</a></p>\n<h3 id=\"例外や特定のイベント発生時のデバッガの操作を設定する\" style=\"position:relative;\"><a href=\"#%E4%BE%8B%E5%A4%96%E3%82%84%E7%89%B9%E5%AE%9A%E3%81%AE%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E7%99%BA%E7%94%9F%E6%99%82%E3%81%AE%E3%83%87%E3%83%90%E3%83%83%E3%82%AC%E3%81%AE%E6%93%8D%E4%BD%9C%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%99%E3%82%8B\" aria-label=\"例外や特定のイベント発生時のデバッガの操作を設定する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>例外や特定のイベント発生時のデバッガの操作を設定する</h3>\n<p>TODO：追記予定</p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/sx--sxd--sxe--sxi--sxn--sxr--sx---set-exceptions-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">sx, sxd, sxe, sxi, sxn, sxr, sx- (Set exceptions) - Windows drivers | Microsoft Learn</a></p>\n<h2 id=\"フィルタドライバの調査\" style=\"position:relative;\"><a href=\"#%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF%E3%83%89%E3%83%A9%E3%82%A4%E3%83%90%E3%81%AE%E8%AA%BF%E6%9F%BB\" aria-label=\"フィルタドライバの調査 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>フィルタドライバの調査</h2>\n<h3 id=\"fltkd-拡張機能のコマンド\" style=\"position:relative;\"><a href=\"#fltkd-%E6%8B%A1%E5%BC%B5%E6%A9%9F%E8%83%BD%E3%81%AE%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89\" aria-label=\"fltkd 拡張機能のコマンド permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>fltkd 拡張機能のコマンド</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># フィルタドライバの情報を列挙(fltmc コマンドでの列挙も有用)</span>\n<span class=\"token operator\">!</span>fltkd.filters <span class=\"token number\">1</span>\n\n<span class=\"token comment\"># 特定のフィルタの FLT_FILTER アドレスを指定することで、特定のフィルタの詳細情報を取得</span>\n<span class=\"token operator\">!</span>fltkd.filter ffffac8ce4df1010\n\n<span class=\"token comment\"># ここで特定した DeviceObject のアドレスを使用して詳細情報を表示</span>\ndt nt<span class=\"token operator\">!</span>_DRIVER_OBJECT ffffac8ce357c850\n<span class=\"token operator\">></span>\n+0x000 Type             <span class=\"token builtin class-name\">:</span> 0n4\n+0x030 DriverExtension  <span class=\"token builtin class-name\">:</span> 0xffffac8c<span class=\"token variable\"><span class=\"token variable\">`</span>e357c9a0 _DRIVER_EXTENSION\n+0x070 MajorFunction    <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">28</span><span class=\"token punctuation\">]</span> 0xfffff800<span class=\"token variable\">`</span></span>65e72000     long  +fffff80065e72000\n\n<span class=\"token comment\"># 次に、DeviceObject 内の MajorFunction までのオフセットを特定して、MajorFunction の情報を表示</span>\n<span class=\"token comment\"># MajorFunction のリンクをクリックしてもちかい情報が得られる</span>\ndps ffffac8ce357c850 + 0x70 L0n28\n\n<span class=\"token comment\"># DRIVER_EXTENSION のアドレスから構造体を調査することも可能</span>\ndt nt<span class=\"token operator\">!</span>_DRIVER_EXTENSION ffffac8ce357c850+0x30</code></pre></div>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/ifs/development-and-testing-tools#fltkd-debugger-extension\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Tools for minifilter development and testing - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"http://fsfilters.blogspot.com/2011/12/debugging-minifilters-finding-callbacks.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Of Filesystems And Other Demons: Debugging Minifilters: Finding the Callbacks</a></p>\n<h2 id=\"解析に必要な知識\" style=\"position:relative;\"><a href=\"#%E8%A7%A3%E6%9E%90%E3%81%AB%E5%BF%85%E8%A6%81%E3%81%AA%E7%9F%A5%E8%AD%98\" aria-label=\"解析に必要な知識 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>解析に必要な知識</h2>\n<h3 id=\"32bit-と-64bit-の呼び出し規約を理解する\" style=\"position:relative;\"><a href=\"#32bit-%E3%81%A8-64bit-%E3%81%AE%E5%91%BC%E3%81%B3%E5%87%BA%E3%81%97%E8%A6%8F%E7%B4%84%E3%82%92%E7%90%86%E8%A7%A3%E3%81%99%E3%82%8B\" aria-label=\"32bit と 64bit の呼び出し規約を理解する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>32bit と 64bit の呼び出し規約を理解する</h3>\n<p>TODO：別記事で作成予定。</p>\n<h3 id=\"ntglobalflag\" style=\"position:relative;\"><a href=\"#ntglobalflag\" aria-label=\"ntglobalflag permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>NTGLOBALFLAG</h3>\n<p><code class=\"language-text\">NTGLOBALFLAG</code>は PEB に存在しており、デフォルト値は 0 ですがデバッグ時に値が設定されます。</p>\n<p>32bit プロセスの場合は <code class=\"language-text\">0x68</code>、64bit プロセスの場合は<code class=\"language-text\">0xBC</code>のオフセットに存在しています。</p>\n<p>そのため、プログラムが PEB 構造体のアドレスに対して <code class=\"language-text\">ZwQueryInformationProcess</code> などでアクセスし、アンチデバッグの目的で使用する場合もあります。</p>\n<p>参考：<a href=\"https://ctf-wiki.mahaloz.re/reverse/windows/anti-debug/ntglobalflag/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">NtGlobalFlag - CTF Wiki EN</a></p>\n<p>参考：<a href=\"https://osandamalith.com/2016/04/23/debugger-detection-using-ntglobalflag/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Debugger Detection Using NtGlobalFlag | 🔐Blog of Osanda</a></p>\n<h3 id=\"exception_record\" style=\"position:relative;\"><a href=\"#exception_record\" aria-label=\"exception_record permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>EXCEPTION_RECORD</h3>\n<p><code class=\"language-text\">EXCEPTION_RECORD</code>には例外やクラッシュに関する情報が含まれます。</p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-exception_record?redirectedfrom=MSDN\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">EXCEPTION_RECORD (winnt.h) - Win32 apps | Microsoft Learn</a></p>\n<p><code class=\"language-text\">ExceptionCode</code>には例外の発生理由が含まれています。</p>\n<p>一般的に記録される例外の種類については上記のページに記載があります。</p>\n<h3 id=\"eprocessethread\" style=\"position:relative;\"><a href=\"#eprocessethread\" aria-label=\"eprocessethread permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>EPROCESS、ETHREAD</h3>\n<p><code class=\"language-text\">EPROCESS</code>構造体はドキュメンテーションされていない構造体ですが、システムプロセスを記述するカーネルメモリ構造体であり、<code class=\"language-text\">nt!_EPROCESS</code>としてアクセスできることが知られています。</p>\n<p>この構造体は、双方向連結リスト(<code class=\"language-text\">LIST_ENTRY</code>)<code class=\"language-text\">ActiveProcessLinks</code>によって連結されており、<code class=\"language-text\">cmd /c tasklist</code>コマンドなどが実行された場合には、このリストをたどって<code class=\"language-text\">EPROCESS</code>構造体が探索されることで、プロセスの一覧として出力されます。</p>\n<p>そのため、WinDbg 上でもカーネルデバッガでこのリストをたどることで、アクティブなプロセスを探索することができます。</p>\n<p>一方で、マルウェアなどがカーネルメモリにアクセスできる場合には、<code class=\"language-text\">ActiveProcessLinks</code>のポインタを付け替えることで、プロセス一覧に悪意のあるプロセスが表示されないように隠ぺいを行う場合があります。</p>\n<p>参考：<a href=\"https://www.nirsoft.net/kernel_struct/vista/EPROCESS.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">struct EPROCESS</a></p>\n<p>参考：<a href=\"https://www.nirsoft.net/kernel_struct/vista/ETHREAD.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">struct ETHREAD</a></p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/kernel/eprocess\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Windows kernel opaque structures - Windows drivers | Microsoft Learn</a></p>\n<p>参考：<a href=\"https://www.ired.team/miscellaneous-reversing-forensics/windows-kernel-internals/manipulating-activeprocesslinks-to-unlink-processes-in-userland\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Manipulating ActiveProcessLinks to Hide Processes in Userland - Red Team Notes</a></p>\n<h3 id=\"guard-page\" style=\"position:relative;\"><a href=\"#guard-page\" aria-label=\"guard page permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Guard page</h3>\n<p>プログラムが Guard Page として作成されたメモリ領域にアクセスした場合、<code class=\"language-text\">STATUS_GUARD_PAGE_VIOLATION (0x80000001)</code> 例外が発生します。</p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows/win32/memory/creating-guard-pages\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Creating Guard Pages - Win32 apps | Microsoft Learn</a></p>\n<h3 id=\"sysenter-命令\" style=\"position:relative;\"><a href=\"#sysenter-%E5%91%BD%E4%BB%A4\" aria-label=\"sysenter 命令 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>sysenter 命令</h3>\n<p>TODO：追記</p>\n<p>参考：<a href=\"https://wiki.osdev.org/SYSENTER\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">SYSENTER - OSDev Wiki</a></p>\n<h2 id=\"よくある例外\" style=\"position:relative;\"><a href=\"#%E3%82%88%E3%81%8F%E3%81%82%E3%82%8B%E4%BE%8B%E5%A4%96\" aria-label=\"よくある例外 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>よくある例外</h2>\n<h3 id=\"access-violation-例外\" style=\"position:relative;\"><a href=\"#access-violation-%E4%BE%8B%E5%A4%96\" aria-label=\"access violation 例外 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Access Violation 例外</h3>\n<p>Access Violation 例外(エラーコード：C0000005)は、プログラムが保護されたメモリや破損したメモリ、存在しないポインタアドレスなどに対して読み取りや書き込みを試みた際の例外です。</p>\n<p>例えば、Use after free のように解放済みのメモリにアクセスした場合などにもこの例外がトリガーされます。</p>\n<p>また、0x0 から 0x10000(64K) までの領域のメモリにアクセスした場合は NULL ポインタ参照によって例外がトリガーされます。 </p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/shows/Inside/C0000005\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Access Violation C0000005 | Microsoft Learn</a></p>\n<h2 id=\"環境設定\" style=\"position:relative;\"><a href=\"#%E7%92%B0%E5%A2%83%E8%A8%AD%E5%AE%9A\" aria-label=\"環境設定 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>環境設定</h2>\n<h3 id=\"visual-studio-のリンカ設定を変更する\" style=\"position:relative;\"><a href=\"#visual-studio-%E3%81%AE%E3%83%AA%E3%83%B3%E3%82%AB%E8%A8%AD%E5%AE%9A%E3%82%92%E5%A4%89%E6%9B%B4%E3%81%99%E3%82%8B\" aria-label=\"visual studio のリンカ設定を変更する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Visual Studio のリンカ設定を変更する</h3>\n<p>最新の Visual Studio のデフォルト設定では、エクスポートテーブルがシンボルファイルに含まれません。</p>\n<p>そのため、プロジェクトの設定から、以下のように<code class=\"language-text\">/DEBUG:FULL</code>の構成を設定します。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 897px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/17c37100f84508e3d99da94643445558/3a737/image-20230401113053380.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 61.24999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACA0lEQVQoz5VT227TQBD1//8AVAhekCp4QDwBago8IFFqSKImTezE8XV9t3OxHSeRwM5hZlNHog+VGOlodjWzZ+fMziq2bSOOY3iehyiKkec5qvUJW0K9OWGTJzKP48vl8uwZQRAgyzIMBgMopmnCtCwwMQf8MMbVnY8PQx/vfgq8vfXwRhV4r1rQ9BkWlO+4LhUg6JxNaw/TqSaLuVVVKFEUwaWEerdDVZVEmOD7LMXXscDHoYfraYYbccBAbCEcC4FrI40C7LcFSlZQrAhrsBkzDUqSpCQlkRJWqxVCumlXFsgiH82hRmdVvcezqwleftHx/FrHxec5Ln8IXKoRXt8IvFBXePXpFxTWniQJyrJERYiIvCi3iOmiTVHhT3vE8QjUh98Yu0voYSn9nZPDSGuY+YH8Dvamwbf+PRTfjxCQTMv2SHqANE3x2I7M+KSd4o5lcg8TehAPhmFRpVxteibp0O1bqrbtfLcmNE176qFhQOG+5XkG01xI6Sm1gK1t239InwLnngm7Hi4WJ8LsgfB/rFPBHAqT+ELI0eGX5uHtsKNRYtR1ffYdeL/f7yV43zQNzeMUShiG8pe4NKBVVclH4dJ1XZekHPd9X3rHcWSu93B5URRYr9cSTDoej6FMJhNZKpOw5x8jDxGY4DFYyXw+x2g0gqZp6Pf7YI7hcIher4e/+6x+teeBCeQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/17c37100f84508e3d99da94643445558/8ac56/image-20230401113053380.webp 240w,\n/static/17c37100f84508e3d99da94643445558/d3be9/image-20230401113053380.webp 480w,\n/static/17c37100f84508e3d99da94643445558/10735/image-20230401113053380.webp 897w\"\n              sizes=\"(max-width: 897px) 100vw, 897px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/17c37100f84508e3d99da94643445558/8ff5a/image-20230401113053380.png 240w,\n/static/17c37100f84508e3d99da94643445558/e85cb/image-20230401113053380.png 480w,\n/static/17c37100f84508e3d99da94643445558/3a737/image-20230401113053380.png 897w\"\n            sizes=\"(max-width: 897px) 100vw, 897px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/17c37100f84508e3d99da94643445558/3a737/image-20230401113053380.png\"\n            alt=\"image-20230401113053380\"\n            title=\"image-20230401113053380\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h3 id=\"release-ビルド時の最適化を無効化する\" style=\"position:relative;\"><a href=\"#release-%E3%83%93%E3%83%AB%E3%83%89%E6%99%82%E3%81%AE%E6%9C%80%E9%81%A9%E5%8C%96%E3%82%92%E7%84%A1%E5%8A%B9%E5%8C%96%E3%81%99%E3%82%8B\" aria-label=\"release ビルド時の最適化を無効化する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Release ビルド時の最適化を無効化する</h3>\n<p>WinDbg の検証目的でプログラムをビルドする場合は、Release ビルド時の最適化設定を無効化しておくと良い場合があります。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 783px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4f1e8aa569235a94d4368c2cca556318/e51a6/image-20230401221935008.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABgklEQVQoz32RzWrbQBRG9eSF0kUeIBBCF912V9qGPkAhNUmgjRMrrSTrz/ZIo//Ikq1iGftkNK5LC2kvfDAwd86cO2OEYYjn+9i2jRCCKIqYLyLu3QW3U6Hz1Z4zmnh8uzOZ+S55KsmSmCJNkGKO59gsQp9IrY08z7EsiziWrNdrMtUUypI3l4IX7ya8urA4+5Jxepnz4cphbPl4aYOv4sqaafz4KzWmkjDadqXNpJR0XafAMUlaEAbK+sd3As8F9gx1ceNy8vGBk082L98/cPo55vVVyfko52xU8PZaYCyXS9I01aDVavUbKESkzG2CcMb+wMOdOkzuxpj3Y1w1ZlM/qrt2HGvzs8OI4kwdirm+uSWcSaZuQFXVavyONMvI80IBD8S2bSnKkqZpKctKZ+jr+y39dqv3jbquVUODYzuUVaU/ZbD+qxTwCH2ujnt93x9Gblv1yL5HkiQEQaCAjW7Y7Xa6ef/HwX9Fj7zZDIZLrWqaJr6CDW94NPyf1XOGA/AJBvFVy7h7xugAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4f1e8aa569235a94d4368c2cca556318/8ac56/image-20230401221935008.webp 240w,\n/static/4f1e8aa569235a94d4368c2cca556318/d3be9/image-20230401221935008.webp 480w,\n/static/4f1e8aa569235a94d4368c2cca556318/b408c/image-20230401221935008.webp 783w\"\n              sizes=\"(max-width: 783px) 100vw, 783px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4f1e8aa569235a94d4368c2cca556318/8ff5a/image-20230401221935008.png 240w,\n/static/4f1e8aa569235a94d4368c2cca556318/e85cb/image-20230401221935008.png 480w,\n/static/4f1e8aa569235a94d4368c2cca556318/e51a6/image-20230401221935008.png 783w\"\n            sizes=\"(max-width: 783px) 100vw, 783px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4f1e8aa569235a94d4368c2cca556318/e51a6/image-20230401221935008.png\"\n            alt=\"image-20230401221935008\"\n            title=\"image-20230401221935008\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>なお、Debug ビルドはデフォルトで最適化が無効化されています。</p>\n<h2 id=\"windbg-のトラブルシューティング\" style=\"position:relative;\"><a href=\"#windbg-%E3%81%AE%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0\" aria-label=\"windbg のトラブルシューティング permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WinDbg のトラブルシューティング</h2>\n<h3 id=\"nt-symbols-are-incorrect-please-fix-symbolsのエラーが出力される場合\" style=\"position:relative;\"><a href=\"#nt-symbols-are-incorrect-please-fix-symbols%E3%81%AE%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%8C%E5%87%BA%E5%8A%9B%E3%81%95%E3%82%8C%E3%82%8B%E5%A0%B4%E5%90%88\" aria-label=\"nt symbols are incorrect please fix symbolsのエラーが出力される場合 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>「NT symbols are incorrect, please fix symbols」のエラーが出力される場合</h3>\n<p><code class=\"language-text\">!process 0 0</code> コマンド実行時などに <code class=\"language-text\">「NT symbols are incorrect, please fix symbols」</code> というエラーが出力される場合、シンボルの読み込みに何らかの問題が発生している可能性があります。</p>\n<p>このような場合、まずは以下の例のようなコマンドでシンボルロード時にどのような問題が発生しているのかを特定します。</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token comment\"># nt シンボルロード時の詳細な情報を出力</span>\n<span class=\"token operator\">!</span>sym noisy<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">.</span>reload <span class=\"token operator\">/</span>f nt</code></pre></div>\n<p>参考：<a href=\"https://stackoverflow.com/questions/66540126/process-0-0-nt-symbols-are-incorrect-please-fix-symbols\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">windows 10 - !process 0 0 - NT symbols are incorrect, please fix symbols - Stack Overflow</a></p>\n<p>僕の環境の場合、誤ったシンボルパス設定を解消することで、この問題も解消しました。</p>\n<h2 id=\"その他の-tips\" style=\"position:relative;\"><a href=\"#%E3%81%9D%E3%81%AE%E4%BB%96%E3%81%AE-tips\" aria-label=\"その他の tips permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>その他の Tips</h2>\n<h3 id=\"windbgx86-と-windbgx64-どちらを使用すべきですか\" style=\"position:relative;\"><a href=\"#windbgx86-%E3%81%A8-windbgx64-%E3%81%A9%E3%81%A1%E3%82%89%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%81%B9%E3%81%8D%E3%81%A7%E3%81%99%E3%81%8B\" aria-label=\"windbgx86 と windbgx64 どちらを使用すべきですか permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WinDbg(X86) と WinDbg(X64) どちらを使用すべきですか？</h3>\n<p>基本的には、64bit アプリケーションのデバッグやダンプ解析を行う場合には WinDbg(X64) を使用し、32 bit アプリケーションの場合は WinDbg(X86) を使用します。</p>\n<p>WinDbg(X64) は 64bit と 32bit どちらのアプリケーションも解析することができますが、WinDbg(X64) で 32bit アプリケーションを解析する場合には WOW64 レイヤーが追加される影響で、とくにダンプの解析を行う場合に解析を困難にする問題を引き起こす可能性があります。</p>\n<p>なお、<code class=\"language-text\">.effmach x86</code>コマンドを使用することで問題を回避できる場合もありますが、WinDbg(X86) を使用する場合とイコールではないため、可能な限り WinDbg(X86) を使用する方が良いです。</p>\n<p>参考：<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/-effmach--effective-machine-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">.effmach (Effective Machine) - Windows drivers | Microsoft Learn</a></p>\n<h3 id=\"windbgclassic-でダークテーマを使用する\" style=\"position:relative;\"><a href=\"#windbgclassic-%E3%81%A7%E3%83%80%E3%83%BC%E3%82%AF%E3%83%86%E3%83%BC%E3%83%9E%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B\" aria-label=\"windbgclassic でダークテーマを使用する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WinDbg(Classic) でダークテーマを使用する</h3>\n<p>僕が普段使用しているテーマは以下から取得できます。</p>\n<p>参考：<a href=\"https://github.com/kash1064/WinDbg-Classic-Dark\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">kash1064/WinDbg-Classic-Dark: The Dark theme of WinDbg Classic</a></p>\n<p>見た目としては以下のような感じで、できるだけ色の種類を減らしてシンプルにしつつ、使い慣れた VSCode のダークテーマに近い配色を目指してカスタマイズしています。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/07f9d0c5f8b40c4a9f60b6c8cea2cd0d/e2d85/main-windows.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAIDBAH/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABwSjYVhN4XoP/xAAcEAACAQUBAAAAAAAAAAAAAAABAgADERITFAT/2gAIAQEAAQUCNR5tqY7asxDEpZQog8yCcyW5Un//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAeEAADAAEEAwAAAAAAAAAAAAAAAQIxESEiMiMzof/aAAgBAQAGPwLuxc2d2aK5F5IPbP0e9GaM0f/EACAQAAIBAgcBAAAAAAAAAAAAAAABEUFRITFhkaGx4dH/2gAIAQEAAT8hxfeNUeXfUVbfE4AUq1cngPglFC6Jo1LoXuI//9oADAMBAAIAAwAAABCj/wAA/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPxAf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPxAf/8QAHRABAAIBBQEAAAAAAAAAAAAAAQARIUFRYYHwkf/aAAgBAQABPxAZTpcTCql35Rw2W4tDMtqhRykFiFli53eg7wI58wIBco8EpFUJ6DiAPR8n/9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/07f9d0c5f8b40c4a9f60b6c8cea2cd0d/8ac56/main-windows.webp 240w,\n/static/07f9d0c5f8b40c4a9f60b6c8cea2cd0d/d3be9/main-windows.webp 480w,\n/static/07f9d0c5f8b40c4a9f60b6c8cea2cd0d/e46b2/main-windows.webp 960w,\n/static/07f9d0c5f8b40c4a9f60b6c8cea2cd0d/6970a/main-windows.webp 1411w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/07f9d0c5f8b40c4a9f60b6c8cea2cd0d/09b79/main-windows.jpg 240w,\n/static/07f9d0c5f8b40c4a9f60b6c8cea2cd0d/7cc5e/main-windows.jpg 480w,\n/static/07f9d0c5f8b40c4a9f60b6c8cea2cd0d/6a068/main-windows.jpg 960w,\n/static/07f9d0c5f8b40c4a9f60b6c8cea2cd0d/e2d85/main-windows.jpg 1411w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/07f9d0c5f8b40c4a9f60b6c8cea2cd0d/6a068/main-windows.jpg\"\n            alt=\"img\"\n            title=\"img\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>","fields":{"slug":"/windbg-basics-001","tagSlugs":["/tag/win-dbg/","/tag/reversing/"]},"frontmatter":{"date":"2023-04-07","description":"個人的によく使う WinDbg コマンドなどをまとめたチートシートです。内容については今後追加していく予定です。","tags":["WinDbg","Reversing"],"title":"WinDbg でダンプ解析、ライブデバッグを行う時のチートシート","socialImage":{"publicURL":"/static/b0fbf9e03e8ff058d29fe4543b9d3f45/windbg-basics-001.png"}}}},"pageContext":{"slug":"/windbg-basics-001"}},"staticQueryHashes":["251939775","401334301","825871152"]}