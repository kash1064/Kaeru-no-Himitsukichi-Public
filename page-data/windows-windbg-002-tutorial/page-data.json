{"componentChunkName":"component---src-templates-post-template-js","path":"/windows-windbg-002-tutorial","result":{"data":{"markdownRemark":{"id":"9ac09fcc-4f35-551b-8ecd-5c0143b45d77","html":"<p>WinDbgによるWindowsデバッグやダンプ解析によるトラブルシューティングに習熟することを目指しています。</p>\n<p>今回はとりあえず公式チュートリアル内の手順を再現して、WinDbgによるユーザモードプロセスのデバッグについて試してみました。</p>\n<p>WinDbgを用いたWindowsのデバッグやダンプの解析方法について公開している情報については、以下のページに一覧をまとめているので、よければご覧ください。</p>\n<p>参考：<a href=\"/windows-windbg-001-index\">WinDbgを用いたデバッグとトラブルシューティングのテクニック</a></p>\n<p>この記事では以下の内容についてまとめています。</p>\n<!-- omit in toc -->\n<h2 id=\"もくじ\" style=\"position:relative;\"><a href=\"#%E3%82%82%E3%81%8F%E3%81%98\" aria-label=\"もくじ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>もくじ</h2>\n<ul>\n<li><a href=\"#widbg%E3%81%A8%E3%81%AF\">WiDbgとは</a></li>\n<li>\n<p><a href=\"#windbg%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB\">WinDbgチュートリアル</a></p>\n<ul>\n<li><a href=\"#%E4%BB%8A%E5%9B%9E%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B%E7%92%B0%E5%A2%83\">今回使用する環境</a></li>\n<li><a href=\"#notepadexe%E3%81%AE%E8%B5%B7%E5%8B%95\">Notepad.exeの起動</a></li>\n<li><a href=\"#%E3%82%B7%E3%83%B3%E3%83%9C%E3%83%AB%E3%83%91%E3%82%B9%E3%81%AE%E8%A8%AD%E5%AE%9A%E3%81%A8%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF\">シンボルパスの設定と読み込み</a></li>\n<li><a href=\"#%E3%82%B7%E3%83%B3%E3%83%9C%E3%83%AB%E4%B8%80%E8%A6%A7%E3%81%AE%E5%87%BA%E5%8A%9B\">シンボル一覧の出力</a></li>\n<li><a href=\"#%E3%83%96%E3%83%AC%E3%83%BC%E3%82%AF%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AE%E8%A8%AD%E5%AE%9A\">ブレークポイントの設定</a></li>\n<li><a href=\"#notepadexe%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B\">Notepad.exeを実行する</a></li>\n<li><a href=\"#%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E3%81%AB%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BE%E3%82%8C%E3%81%A6%E3%81%84%E3%82%8B%E3%82%B3%E3%83%BC%E3%83%89%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E3%81%AE%E4%B8%80%E8%A6%A7%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B\">プロセスに読み込まれているコードモジュールの一覧を表示する</a></li>\n<li><a href=\"#%E3%82%B9%E3%82%BF%E3%83%83%E3%82%AF%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B\">スタックトレースを表示する</a></li>\n<li><a href=\"#notepadexe%E3%82%92%E5%86%8D%E9%96%8B%E3%81%99%E3%82%8B\">Notepad.exeを再開する</a></li>\n<li><a href=\"#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%81%BF%E6%99%82%E3%81%AB%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E3%82%92%E5%81%9C%E6%AD%A2%E3%81%99%E3%82%8B\">ファイル書き込み時にプロセスを停止する</a></li>\n<li><a href=\"#%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E5%86%85%E3%81%AE%E3%82%B9%E3%83%AC%E3%83%83%E3%83%89%E4%B8%80%E8%A6%A7%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B\">プロセス内のスレッド一覧を表示する</a></li>\n<li><a href=\"#%E7%89%B9%E5%AE%9A%E3%81%AE%E3%82%B9%E3%83%AC%E3%83%83%E3%83%89%E3%81%AE%E3%82%B9%E3%82%BF%E3%83%83%E3%82%AF%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B\">特定のスレッドのスタックトレースを取得する</a></li>\n<li><a href=\"#%E3%83%87%E3%83%90%E3%83%83%E3%82%B0%E3%82%92%E7%B5%82%E4%BA%86%E3%81%97%E3%81%A6%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E3%81%8B%E3%82%89%E3%83%87%E3%82%BF%E3%83%83%E3%83%81%E3%81%99%E3%82%8B\">デバッグを終了して、プロセスからデタッチする</a></li>\n</ul>\n</li>\n<li><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\">まとめ</a></li>\n</ul>\n<h2 id=\"widbgとは\" style=\"position:relative;\"><a href=\"#widbg%E3%81%A8%E3%81%AF\" aria-label=\"widbgとは permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WiDbgとは</h2>\n<p>Windows環境のデバッグやトラブルシューティングに使用するツールです。</p>\n<p>参考：<a href=\"https://docs.microsoft.com/ja-jp/windows-hardware/drivers/debugger/getting-started-with-windows-debugging\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Windows のデバッグの概要 - Windows drivers | Microsoft Docs</a></p>\n<p>WinDbgは、主に以下の用途に利用されます。</p>\n<ul>\n<li>Windowsメモリダンプやプロセスダンプの解析</li>\n<li>カーネルモードのライブデバッグ</li>\n<li>ユーザモードのライブデバッグ</li>\n</ul>\n<p>MicrosoftのWindows開発チームも使用している公式のデバッガです。</p>\n<p>VisualStudioデバッガとの違いとして、WinDbgはカーネルモードのデバッグやスレッドスタックの分析まで実現することができます。</p>\n<h2 id=\"windbgチュートリアル\" style=\"position:relative;\"><a href=\"#windbg%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB\" aria-label=\"windbgチュートリアル permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WinDbgチュートリアル</h2>\n<p>WinDbgのはじめの一歩として、<a href=\"https://docs.microsoft.com/ja-jp/windows-hardware/drivers/debugger/getting-started-with-windbg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">公式ドキュメントのチュートリアル</a>を実践していきます。</p>\n<p>このチュートリアルでは、WinDbgを使用してユーザモードのプロセスにアタッチし、デバッグを行います。</p>\n<h3 id=\"今回使用する環境\" style=\"position:relative;\"><a href=\"#%E4%BB%8A%E5%9B%9E%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B%E7%92%B0%E5%A2%83\" aria-label=\"今回使用する環境 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>今回使用する環境</h3>\n<p>今回使用している環境は以下の環境です。</p>\n<ul>\n<li>Windows10 20H2</li>\n<li>WinDbg 10.0.22000.1 AMD64（管理者権限で起動）</li>\n</ul>\n<h3 id=\"notepadexeの起動\" style=\"position:relative;\"><a href=\"#notepadexe%E3%81%AE%E8%B5%B7%E5%8B%95\" aria-label=\"notepadexeの起動 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Notepad.exeの起動</h3>\n<p>Windows環境でWinDbgを起動した後、[Ctrl+E]キーで[Open Executable File]を呼び出し、<code class=\"language-text\">C:\\Windows\\System32\\notepad.exe</code>を選択します。</p>\n<p>実行ファイルを開くと、Commandウィンドウが起動しました。</p>\n<h3 id=\"シンボルパスの設定と読み込み\" style=\"position:relative;\"><a href=\"#%E3%82%B7%E3%83%B3%E3%83%9C%E3%83%AB%E3%83%91%E3%82%B9%E3%81%AE%E8%A8%AD%E5%AE%9A%E3%81%A8%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF\" aria-label=\"シンボルパスの設定と読み込み permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>シンボルパスの設定と読み込み</h3>\n<p>Commandウィンドウの下部にあるコンソールに、以下のコマンドを入力します。</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token punctuation\">.</span>sympath srv*</code></pre></div>\n<p><code class=\"language-text\">.sympath</code>コマンドは、シンボルパスを設定するコマンドです。\nシンボルパスとは、デバッガがシンボルファイルを探す際の探索先を意味します。</p>\n<p>シンボルファイルは、デバッガがコード モジュール (関数名、変数名など) に関する情報を取得するために必要です。</p>\n<p>参考：<a href=\"https://docs.microsoft.com/ja-jp/windows-hardware/drivers/debugger/-sympath--set-symbol-path-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">.sympath (シンボル パスの設定) - Windows drivers | Microsoft Docs</a></p>\n<p>シンボルパスの設定が完了したので、以下のコマンドを実行します。</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token punctuation\">.</span>reload</code></pre></div>\n<p><code class=\"language-text\">.reload</code>コマンドによって、シンボル情報を削除した後、再読み込みします。</p>\n<p>参考：<a href=\"https://docs.microsoft.com/ja-jp/windows-hardware/drivers/debugger/-reload--reload-module-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">.reload (モジュールの再読み込み) - Windows drivers | Microsoft Docs</a></p>\n<p><code class=\"language-text\">.reload</code>コマンドを実行しても、特にレスポンスはない点に注意が必要です。\n以下の出力が得られたら次に進みます。</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">0:000> <span class=\"token punctuation\">.</span>reload\nReloading current modules\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></code></pre></div>\n<h3 id=\"シンボル一覧の出力\" style=\"position:relative;\"><a href=\"#%E3%82%B7%E3%83%B3%E3%83%9C%E3%83%AB%E4%B8%80%E8%A6%A7%E3%81%AE%E5%87%BA%E5%8A%9B\" aria-label=\"シンボル一覧の出力 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>シンボル一覧の出力</h3>\n<p>上記の出力確認後に、<code class=\"language-text\">x notepad!*</code>コマンドを実行して<code class=\"language-text\">Notepad.exe</code>モジュールのシンボルを表示します。\n※ ここで出力が得られない場合は<code class=\"language-text\">.reload</code>コマンドを再実行します。</p>\n<p>参考：<a href=\"https://docs.microsoft.com/ja-jp/windows-hardware/drivers/debugger/x--examine-symbols-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">x notepad!*</a></p>\n<p>出力結果は1500行近い数になりました。\nかなり多いですね。</p>\n<h3 id=\"ブレークポイントの設定\" style=\"position:relative;\"><a href=\"#%E3%83%96%E3%83%AC%E3%83%BC%E3%82%AF%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AE%E8%A8%AD%E5%AE%9A\" aria-label=\"ブレークポイントの設定 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ブレークポイントの設定</h3>\n<p>次に、上記の出力で確認したシンボル情報を用いて、wWinMain関数にブレークポイントを設定します。</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">bu notepad!wWinMain</code></pre></div>\n<p>特に出力は返ってきませんが、<code class=\"language-text\">bl</code>コマンドでブレークポイントの一覧を参照できます。\n参考：<a href=\"https://docs.microsoft.com/ja-jp/windows-hardware/drivers/debugger/bl--breakpoint-list-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">bl (ブレークポイントの一覧) - Windows drivers | Microsoft Docs</a></p>\n<p>これで、<code class=\"language-text\">notepad!wWinMain</code>にブレークポイントが設定されたことが確認できました。</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">0:000> bu notepad!wWinMain\n0:000> bl\n     0 e Disable Clear  00007ff6`8402c0f8     0001 <span class=\"token punctuation\">(</span>0001<span class=\"token punctuation\">)</span>  0:<span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> notepad!wWinMain</code></pre></div>\n<h3 id=\"notepadexeを実行する\" style=\"position:relative;\"><a href=\"#notepadexe%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B\" aria-label=\"notepadexeを実行する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Notepad.exeを実行する</h3>\n<p>ブレークポイントの設定が完了したので、<code class=\"language-text\">g</code>コマンドで起動しているアプリケーションを実行します。\n参考：<a href=\"https://docs.microsoft.com/ja-jp/windows-hardware/drivers/debugger/g--go-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">g (実行) - Windows drivers | Microsoft Docs</a></p>\n<p>ブレークポイントで設定されたwWinMain関数の呼び出し時点で停止しました。</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">0:000> g\nModLoad: 00007ff9`9cd70000 00007ff9`9cda0000   C:\\WINDOWS\\System32\\IMM32<span class=\"token punctuation\">.</span>DLL\nBreakpoint 0 hit\nnotepad!wWinMain:\n00007ff6`8402c0f8 488bc4          mov     rax<span class=\"token punctuation\">,</span>rsp</code></pre></div>\n<h3 id=\"プロセスに読み込まれているコードモジュールの一覧を表示する\" style=\"position:relative;\"><a href=\"#%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E3%81%AB%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BE%E3%82%8C%E3%81%A6%E3%81%84%E3%82%8B%E3%82%B3%E3%83%BC%E3%83%89%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E3%81%AE%E4%B8%80%E8%A6%A7%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B\" aria-label=\"プロセスに読み込まれているコードモジュールの一覧を表示する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>プロセスに読み込まれているコードモジュールの一覧を表示する</h3>\n<p>ブレークポイントでプロセスが停止した状態で<code class=\"language-text\">lm</code>コマンドを実行し、現在プロセスに読み込まれているコードモジュールを確認します。\n参考：<a href=\"https://docs.microsoft.com/ja-jp/windows-hardware/drivers/debugger/lm--list-loaded-modules-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">lm (読み込まれたモジュールの一覧表示) - Windows drivers | Microsoft Docs</a></p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">0:000> lm\n<span class=\"token function\">start</span>             <span class=\"token keyword\">end</span>                 module name\n00007ff6`84020000 00007ff6`8405a000   notepad    <span class=\"token punctuation\">(</span>pdb symbols<span class=\"token punctuation\">)</span>          C:\\Program Files <span class=\"token punctuation\">(</span>x86<span class=\"token punctuation\">)</span>\\Windows Kits\\10\\Debuggers\\x64\\sym\\notepad<span class=\"token punctuation\">.</span>pdb\\6539CE998C7CAFD73A8E13A54542E1121\\notepad<span class=\"token punctuation\">.</span>pdb\n00007ff9`8ef30000 00007ff9`8f1ca000   COMCTL32   <span class=\"token punctuation\">(</span>deferred<span class=\"token punctuation\">)</span>             \n00007ff9`982c0000 00007ff9`98350000   apphelp    <span class=\"token punctuation\">(</span>deferred<span class=\"token punctuation\">)</span>             \n00007ff9`9aa40000 00007ff9`9aadd000   msvcp_win   <span class=\"token punctuation\">(</span>deferred<span class=\"token punctuation\">)</span>             \n00007ff9`9ab90000 00007ff9`9ae59000   KERNELBASE   <span class=\"token punctuation\">(</span>deferred<span class=\"token punctuation\">)</span>             \n00007ff9`9aec0000 00007ff9`9afc0000   ucrtbase   <span class=\"token punctuation\">(</span>deferred<span class=\"token punctuation\">)</span>             \n00007ff9`9b010000 00007ff9`9b11b000   gdi32full   <span class=\"token punctuation\">(</span>deferred<span class=\"token punctuation\">)</span>             \n00007ff9`9b340000 00007ff9`9b362000   win32u     <span class=\"token punctuation\">(</span>deferred<span class=\"token punctuation\">)</span>             \n00007ff9`9bbc0000 00007ff9`9bcea000   RPCRT4     <span class=\"token punctuation\">(</span>deferred<span class=\"token punctuation\">)</span>             \n00007ff9`9bf20000 00007ff9`9c275000   combase    <span class=\"token punctuation\">(</span>deferred<span class=\"token punctuation\">)</span>             \n00007ff9`9c3c0000 00007ff9`9c46e000   shcore     <span class=\"token punctuation\">(</span>deferred<span class=\"token punctuation\">)</span>             \n00007ff9`9cc50000 00007ff9`9cd0e000   KERNEL32   <span class=\"token punctuation\">(</span>deferred<span class=\"token punctuation\">)</span>             \n00007ff9`9cd70000 00007ff9`9cda0000   IMM32      <span class=\"token punctuation\">(</span>deferred<span class=\"token punctuation\">)</span>             \n00007ff9`9cfd0000 00007ff9`9cffb000   GDI32      <span class=\"token punctuation\">(</span>deferred<span class=\"token punctuation\">)</span>             \n00007ff9`9d000000 00007ff9`9d1a1000   USER32     <span class=\"token punctuation\">(</span>deferred<span class=\"token punctuation\">)</span>             \n00007ff9`9d1b0000 00007ff9`9d24e000   msvcrt     <span class=\"token punctuation\">(</span>deferred<span class=\"token punctuation\">)</span>             \n00007ff9`9d290000 00007ff9`9d485000   ntdll      <span class=\"token punctuation\">(</span>pdb symbols<span class=\"token punctuation\">)</span>          C:\\Program Files <span class=\"token punctuation\">(</span>x86<span class=\"token punctuation\">)</span>\\Windows Kits\\10\\Debuggers\\x64\\sym\\ntdll<span class=\"token punctuation\">.</span>pdb\\E2BF5EA3ECAA1D5310F1E166306A0BCC1\\ntdll<span class=\"token punctuation\">.</span>pdb</code></pre></div>\n<h3 id=\"スタックトレースを表示する\" style=\"position:relative;\"><a href=\"#%E3%82%B9%E3%82%BF%E3%83%83%E3%82%AF%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B\" aria-label=\"スタックトレースを表示する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>スタックトレースを表示する</h3>\n<p>プロセスが停止した状態で<code class=\"language-text\">k</code>コマンドを実行して、スタックトレースを表示します。</p>\n<p>今回は<code class=\"language-text\">notepad!wWinMain</code>で停止したタイミングでのスタックトレースを取得できました。</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">0:000> k\n <span class=\"token comment\"># Child-SP          RetAddr               Call Site</span>\n00 00000055`5f11f7b8 00007ff6`840459b6     notepad!wWinMain\n01 00000055`5f11f7c0 00007ff9`9cc67034     notepad!__scrt_common_main_seh+0x106\n02 00000055`5f11f800 00007ff9`9d2e2651     KERNEL32!BaseThreadInitThunk+0x14\n03 00000055`5f11f830 00000000`00000000     ntdll!RtlUserThreadStart+0x21</code></pre></div>\n<h3 id=\"notepadexeを再開する\" style=\"position:relative;\"><a href=\"#notepadexe%E3%82%92%E5%86%8D%E9%96%8B%E3%81%99%E3%82%8B\" aria-label=\"notepadexeを再開する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Notepad.exeを再開する</h3>\n<p>もう一度<code class=\"language-text\">g</code>コマンドを実行すると、中断されていたプロセスが再開され、メモ帳アプリが起動しました。</p>\n<p>この状態では、デバッガはBusy状態となり、追加のコマンド入力を受け付けなくなります。</p>\n<p>再びメモ帳プロセスを停止してデバッガを使用するために、Breakボタンか、[Ctrl+Break]キーを押します。</p>\n<p>これで再度メモ帳プロセスが停止され、デバッガ操作が可能になりました。</p>\n<h3 id=\"ファイル書き込み時にプロセスを停止する\" style=\"position:relative;\"><a href=\"#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%81%BF%E6%99%82%E3%81%AB%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E3%82%92%E5%81%9C%E6%AD%A2%E3%81%99%E3%82%8B\" aria-label=\"ファイル書き込み時にプロセスを停止する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ファイル書き込み時にプロセスを停止する</h3>\n<p>続いて、<code class=\"language-text\">bu ntdll!ZwWriteFile</code>を実行して、ファイル書き込み時にプロセスを中断するためのブレークポイントを設定します。</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">0:002> bu ntdll!ZwWriteFile\n0:002> bl\n     0 e Disable Clear  00007ff6`8402c0f8     0001 <span class=\"token punctuation\">(</span>0001<span class=\"token punctuation\">)</span>  0:<span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> notepad!wWinMain\n     1 e Disable Clear  00007ff9`9d32ce60     0001 <span class=\"token punctuation\">(</span>0001<span class=\"token punctuation\">)</span>  0:<span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> ntdll!NtWriteFile</code></pre></div>\n<p>再び<code class=\"language-text\">g</code>コマンドを入力してプロセスを再開したのち、メモ帳に書き込み保存を実行しようとすると、プロセスが停止されます。</p>\n<p>このタイミングでスタックトレースを表示すると、書き込み時のスタックトレースを取得することができます。</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">0:011> k\n <span class=\"token comment\"># Child-SP          RetAddr               Call Site</span>\n00 00000055`5f8fdb78 00007ff9`9bc1f6f4     ntdll!NtWriteFile\n01 00000055`5f8fdb80 00007ff9`9bc0c641     RPCRT4!UTIL_WriteFile+0x5c\n02 00000055`5f8fdbe0 00007ff9`9bbf5863     RPCRT4!NMP_SyncSend+0x81\n03 00000055`5f8fdc60 00007ff9`9bbf2a56     RPCRT4!OSF_CCONNECTION::TransSendReceive+0xf7\n04 00000055`5f8fdcd0 00007ff9`9bbf239b     RPCRT4!OSF_CCONNECTION::SendBindPacket+0x2ee\n05 00000055`5f8fdf20 00007ff9`9bbf3ed1     RPCRT4!OSF_CCONNECTION::ActuallyDoBinding+0xeb\n06 00000055`5f8fdfd0 00007ff9`9bbf3c0e     RPCRT4!OSF_CCONNECTION::OpenConnectionAndBind+0x225\n07 00000055`5f8fe080 00007ff9`9bbf7736     RPCRT4!OSF_CCALL::BindToServer+0xce\n08 00000055`5f8fe120 00007ff9`9bbf84d6     RPCRT4!OSF_BINDING_HANDLE::InitCCallWithAssociation+0x8a\n09 00000055`5f8fe180 00007ff9`9bbf75e7     RPCRT4!OSF_BINDING_HANDLE::AllocateCCall+0x256\n0a 00000055`5f8fe2e0 00007ff9`9bca00f5     RPCRT4!OSF_BINDING_HANDLE::NegotiateTransferSyntax+0x37\n0b 00000055`5f8fe330 00007ff9`9bca3840     RPCRT4!NdrpClientCall3+0x715\n0c 00000055`5f8fe6a0 00007ff9`99bc139e     RPCRT4!NdrClientCall3+0xf0\n0d 00000055`5f8fea30 00007ff9`775c1e00     wkscli!NetWkstaGetInfo+0x5e\n0e 00000055`5f8feae0 00007ff9`83c62df6     ntlanman!NPOpenEnum+0x50\n0f 00000055`5f8fec40 00007ff9`83c61b7f     MPR!MprOpenEnumConnect+0x176</code></pre></div>\n<h3 id=\"プロセス内のスレッド一覧を表示する\" style=\"position:relative;\"><a href=\"#%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E5%86%85%E3%81%AE%E3%82%B9%E3%83%AC%E3%83%83%E3%83%89%E4%B8%80%E8%A6%A7%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B\" aria-label=\"プロセス内のスレッド一覧を表示する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>プロセス内のスレッド一覧を表示する</h3>\n<p><code class=\"language-text\">~</code>コマンドを使って、プロセス内のスレッド一覧を取得できます。\n参考：<a href=\"https://docs.microsoft.com/ja-jp/windows-hardware/drivers/debugger/---thread-status-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">~ (スレッドの状態) - Windows drivers | Microsoft Docs</a></p>\n<p>現在のメモ帳プロセスには、以下の14個のスレッドが存在するようです。</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">0:011> ~\n   0  Id: de4<span class=\"token punctuation\">.</span>7ac Suspend: 1 Teb: 00000055`5f35c000 Unfrozen\n   1  Id: de4<span class=\"token punctuation\">.</span>22f0 Suspend: 1 Teb: 00000055`5f36a000 Unfrozen\n   2  Id: de4<span class=\"token punctuation\">.</span>1500 Suspend: 1 Teb: 00000055`5f36e000 Unfrozen\n   3  Id: de4<span class=\"token punctuation\">.</span>198c Suspend: 1 Teb: 00000055`5f370000 Unfrozen\n   4  Id: de4<span class=\"token punctuation\">.</span>2094 Suspend: 1 Teb: 00000055`5f364000 Unfrozen\n   5  Id: de4<span class=\"token punctuation\">.</span>1d6c Suspend: 1 Teb: 00000055`5f372000 Unfrozen\n   6  Id: de4<span class=\"token punctuation\">.</span>1048 Suspend: 1 Teb: 00000055`5f368000 Unfrozen\n   7  Id: de4<span class=\"token punctuation\">.</span>1408 Suspend: 1 Teb: 00000055`5f374000 Unfrozen\n   8  Id: de4<span class=\"token punctuation\">.</span>30c Suspend: 1 Teb: 00000055`5f376000 Unfrozen\n   9  Id: de4<span class=\"token punctuation\">.</span>1b18 Suspend: 1 Teb: 00000055`5f378000 Unfrozen\n  10  Id: de4<span class=\"token punctuation\">.</span>af8 Suspend: 1 Teb: 00000055`5f37a000 Unfrozen\n<span class=\"token punctuation\">.</span> 11  Id: de4<span class=\"token punctuation\">.</span>898 Suspend: 1 Teb: 00000055`5f37e000 Unfrozen\n  12  Id: de4<span class=\"token punctuation\">.</span>1720 Suspend: 1 Teb: 00000055`5f380000 Unfrozen\n  13  Id: de4<span class=\"token punctuation\">.</span>37c Suspend: 1 Teb: 00000055`5f382000 Unfrozen</code></pre></div>\n<h3 id=\"特定のスレッドのスタックトレースを取得する\" style=\"position:relative;\"><a href=\"#%E7%89%B9%E5%AE%9A%E3%81%AE%E3%82%B9%E3%83%AC%E3%83%83%E3%83%89%E3%81%AE%E3%82%B9%E3%82%BF%E3%83%83%E3%82%AF%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B\" aria-label=\"特定のスレッドのスタックトレースを取得する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>特定のスレッドのスタックトレースを取得する</h3>\n<p>ここで、特定のスレッドのスタックトレースを取得するには、以下のコマンドを続けて使用します。</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">~0s\nk</code></pre></div>\n<p><code class=\"language-text\">~0s</code>コマンドは、スレッド番号0の設定を取得します。\n参考：<a href=\"https://docs.microsoft.com/ja-jp/windows-hardware/drivers/debugger/-s--set-current-thread-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">~s (現在のスレッドの設定) - Windows drivers | Microsoft Docs</a></p>\n<p>出力は次のようになりました。</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">0:011> ~0s\nwin32u!NtGdiGetCharABCWidthsW+0x14:\n00007ff9`9b3465e4 c3              ret\n0:000> k\n <span class=\"token comment\"># Child-SP          RetAddr               Call Site</span>\n00 00000055`5f117108 00007ff9`9b01a2ae     win32u!NtGdiGetCharABCWidthsW+0x14\n01 00000055`5f117110 00007ff9`9b01a211     gdi32full!LoadGlyphMetricsWithGetCharABCWidthsI+0x5e\n02 00000055`5f1174b0 00007ff9`9b019d60     gdi32full!LoadGlyphMetrics+0x99\n03 00000055`5f1174f0 00007ff9`8aa29016     gdi32full!CUspShapingFont::GetGlyphDefaultAdvanceWidths+0x150\n04 00000055`5f117550 00007ff9`9b020b65     TextShaping!ShapingGetGlyphPositions+0x516\n05 00000055`5f117750 00007ff9`9b0266e3     gdi32full!ShlPlaceOT+0x255\n06 00000055`5f117970 00007ff9`9b025d9b     gdi32full!RenderItemNoFallback+0x573\n07 00000055`5f117aa0 00007ff9`9b025c6b     gdi32full!RenderItemWithFallback+0xeb\n08 00000055`5f117af0 00007ff9`9b025a3f     gdi32full!RenderItem+0x3b\n09 00000055`5f117b40 00007ff9`9b027ac6     gdi32full!ScriptStringAnalyzeGlyphs+0x20f\n0a 00000055`5f117bf0 00007ff9`9b024ca2     gdi32full!ScriptStringAnalyse+0x626\n0b 00000055`5f117dc0 00007ff9`9b0246be     gdi32full!LpkCharsetDraw+0x5c2\n0c 00000055`5f117ff0 00007ff9`9d01f5f2     gdi32full!LpkDrawTextEx+0x5e\n0d 00000055`5f118060 00007ff9`9d01e9bf     USER32!DT_DrawStr+0xb6\n0e 00000055`5f118110 00007ff9`9d01eede     USER32!DT_GetLineBreak+0xf3\n0f 00000055`5f1181b0 00007ff9`9d01eb50     USER32!DrawTextExWorker+0x36e\n10 00000055`5f118300 00007ff9`6b8a6123     USER32!DrawTextW+0x40\n11 00000055`5f118370 00007ff9`6b89ac60     DUI70!DirectUI::Element::GetContentSize+0x463\n12 00000055`5f118450 00007ff9`6b8a7196     DUI70!DirectUI::Element::_UpdateDesiredSize+0x6a0\n<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> 以下略 <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"デバッグを終了してプロセスからデタッチする\" style=\"position:relative;\"><a href=\"#%E3%83%87%E3%83%90%E3%83%83%E3%82%B0%E3%82%92%E7%B5%82%E4%BA%86%E3%81%97%E3%81%A6%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9%E3%81%8B%E3%82%89%E3%83%87%E3%82%BF%E3%83%83%E3%83%81%E3%81%99%E3%82%8B\" aria-label=\"デバッグを終了してプロセスからデタッチする permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>デバッグを終了して、プロセスからデタッチする</h3>\n<p>最後に<code class=\"language-text\">qd</code>コマンドを使用して、デバッグを終了してプロセスからデタッチします。</p>\n<p>デバッグを終了すると、Commandウィンドウが終了し、停止されていたメモ帳の書き込み処理が再開されました。</p>\n<h2 id=\"まとめ\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>とりあえず<a href=\"https://docs.microsoft.com/ja-jp/windows-hardware/drivers/debugger/getting-started-with-windbg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">公式チュートリアル</a>のユーザモードデバッグの手順について一通り実践してみました。</p>\n<p>WinDbgを用いたWindowsのデバッグやダンプの解析方法について公開しているその他情報については、以下のページのリストをご覧ください。</p>\n<p>参考：<a href=\"/windows-windbg-001-index\">WinDbgを用いたデバッグとトラブルシューティングのテクニック</a></p>","fields":{"slug":"/windows-windbg-002-tutorial","tagSlugs":["/tag/win-dbg/","/tag/kernel/","/tag/reversing/"]},"frontmatter":{"date":"2021-10-05","description":"","tags":["WinDbg","Kernel","Reversing"],"title":"WinDbgのユーザモードデバッグチュートリアルを試してみた","socialImage":{"publicURL":"/static/60c8ad2e26b79782f87890c91ca6d65f/windows-windbg-002-tutorial.png"}}}},"pageContext":{"slug":"/windows-windbg-002-tutorial"}},"staticQueryHashes":["251939775","401334301","825871152"]}